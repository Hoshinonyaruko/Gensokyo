"use strict";(globalThis["webpackChunkfrontend"]=globalThis["webpackChunkfrontend"]||[]).push([[185],{36875:(e,t,i)=>{i.d(t,{CH:()=>l,CR:()=>d,D4:()=>a,u7:()=>s,xh:()=>o,yu:()=>r});class n{constructor(e,t){this._restrictedRenderingContextBrand=void 0,this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const i=this._viewLayout.getCurrentViewport();this.scrollTop=i.top,this.scrollLeft=i.left,this.viewportWidth=i.width,this.viewportHeight=i.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class o extends n{constructor(e,t,i){super(e,t),this._renderingContextBrand=void 0,this._viewLines=i}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}}class s{constructor(e,t,i,n){this.outsideRenderedLine=e,this.lineNumber=t,this.ranges=i,this.continuesOnNextLine=n}}class r{static from(e){const t=new Array(e.length);for(let i=0,n=e.length;i<n;i++){const n=e[i];t[i]=new r(n.left,n.width)}return t}constructor(e,t){this._horizontalRangeBrand=void 0,this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}}class d{constructor(e,t){this._floatHorizontalRangeBrand=void 0,this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}}class a{constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}}class l{constructor(e,t){this.outsideRenderedLine=e,this.ranges=t}}},64778:(e,t,i)=>{i.d(t,{F:()=>d,G:()=>a});var n=i(26090),o=i(82168),s=i(98642),r=i(69427);class d{constructor(e){this._createLine=e,this._set(1,[])}flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){const t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new s.he("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(0===this.getCount())return null;const i=this.getStartLineNumber(),n=this.getEndLineNumber();if(t<i){const i=t-e+1;return this._rendLineNumberStart-=i,null}if(e>n)return null;let o=0,s=0;for(let d=i;d<=n;d++){const i=d-this._rendLineNumberStart;e<=d&&d<=t&&(0===s?(o=i,s=1):s++)}if(e<i){let n=0;n=t<i?t-e+1:i-e,this._rendLineNumberStart-=n}const r=this._lines.splice(o,s);return r}onLinesChanged(e,t){const i=e+t-1;if(0===this.getCount())return!1;const n=this.getStartLineNumber(),o=this.getEndLineNumber();let s=!1;for(let r=e;r<=i;r++)r>=n&&r<=o&&(this._lines[r-this._rendLineNumberStart].onContentChanged(),s=!0);return s}onLinesInserted(e,t){if(0===this.getCount())return null;const i=t-e+1,n=this.getStartLineNumber(),o=this.getEndLineNumber();if(e<=n)return this._rendLineNumberStart+=i,null;if(e>o)return null;if(i+e>o){const t=this._lines.splice(e-this._rendLineNumberStart,o-e+1);return t}const s=[];for(let h=0;h<i;h++)s[h]=this._createLine();const r=e-this._rendLineNumberStart,d=this._lines.slice(0,r),a=this._lines.slice(r,this._lines.length-i),l=this._lines.slice(this._lines.length-i,this._lines.length);return this._lines=d.concat(s).concat(a),l}onTokensChanged(e){if(0===this.getCount())return!1;const t=this.getStartLineNumber(),i=this.getEndLineNumber();let n=!1;for(let o=0,s=e.length;o<s;o++){const s=e[o];if(s.toLineNumber<t||s.fromLineNumber>i)continue;const r=Math.max(t,s.fromLineNumber),d=Math.min(i,s.toLineNumber);for(let e=r;e<=d;e++){const t=e-this._rendLineNumberStart;this._lines[t].onTokensChanged(),n=!0}}return n}}class a{constructor(e){this._host=e,this.domNode=this._createDomNode(),this._linesCollection=new d((()=>this._host.createVisibleLine()))}_createDomNode(){const e=(0,n.X)(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(143)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){const t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++){const e=t[i].getDomNode();e&&this.domNode.domNode.removeChild(e)}return!0}onLinesInserted(e){const t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++){const e=t[i].getDomNode();e&&this.domNode.domNode.removeChild(e)}return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){const t=this._linesCollection._get(),i=new l(this.domNode.domNode,this._host,e),n={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},o=i.render(n,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(o.rendLineNumberStart,o.lines)}}class l{constructor(e,t,i){this.domNode=e,this.host=t,this.viewportData=i}render(e,t,i,n){const o={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(o.rendLineNumberStart+o.linesLength-1<t||i<o.rendLineNumberStart){o.rendLineNumberStart=t,o.linesLength=i-t+1,o.lines=[];for(let e=t;e<=i;e++)o.lines[e-t]=this.host.createVisibleLine();return this._finishRendering(o,!0,n),o}if(this._renderUntouchedLines(o,Math.max(t-o.rendLineNumberStart,0),Math.min(i-o.rendLineNumberStart,o.linesLength-1),n,t),o.rendLineNumberStart>t){const e=t,s=Math.min(i,o.rendLineNumberStart-1);e<=s&&(this._insertLinesBefore(o,e,s,n,t),o.linesLength+=s-e+1)}else if(o.rendLineNumberStart<t){const e=Math.min(o.linesLength,t-o.rendLineNumberStart);e>0&&(this._removeLinesBefore(o,e),o.linesLength-=e)}if(o.rendLineNumberStart=t,o.rendLineNumberStart+o.linesLength-1<i){const e=o.rendLineNumberStart+o.linesLength,s=i;e<=s&&(this._insertLinesAfter(o,e,s,n,t),o.linesLength+=s-e+1)}else if(o.rendLineNumberStart+o.linesLength-1>i){const e=Math.max(0,i-o.rendLineNumberStart+1),t=o.linesLength-1,n=t-e+1;n>0&&(this._removeLinesAfter(o,n),o.linesLength-=n)}return this._finishRendering(o,!1,n),o}_renderUntouchedLines(e,t,i,n,o){const s=e.rendLineNumberStart,r=e.lines;for(let d=t;d<=i;d++){const e=s+d;r[d].layoutLine(e,n[e-o])}}_insertLinesBefore(e,t,i,n,o){const s=[];let r=0;for(let d=t;d<=i;d++)s[r++]=this.host.createVisibleLine();e.lines=s.concat(e.lines)}_removeLinesBefore(e,t){for(let i=0;i<t;i++){const t=e.lines[i].getDomNode();t&&this.domNode.removeChild(t)}e.lines.splice(0,t)}_insertLinesAfter(e,t,i,n,o){const s=[];let r=0;for(let d=t;d<=i;d++)s[r++]=this.host.createVisibleLine();e.lines=e.lines.concat(s)}_removeLinesAfter(e,t){const i=e.linesLength-t;for(let n=0;n<t;n++){const t=e.lines[i+n].getDomNode();t&&this.domNode.removeChild(t)}e.lines.splice(i,t)}_finishRenderingNewLines(e,t,i,n){l._ttPolicy&&(i=l._ttPolicy.createHTML(i));const o=this.domNode.lastChild;t||!o?this.domNode.innerHTML=i:o.insertAdjacentHTML("afterend",i);let s=this.domNode.lastChild;for(let r=e.linesLength-1;r>=0;r--){const t=e.lines[r];n[r]&&(t.setDomNode(s),s=s.previousSibling)}}_finishRenderingInvalidLines(e,t,i){const n=document.createElement("div");l._ttPolicy&&(t=l._ttPolicy.createHTML(t)),n.innerHTML=t;for(let o=0;o<e.linesLength;o++){const t=e.lines[o];if(i[o]){const e=n.firstChild,i=t.getDomNode();i.parentNode.replaceChild(e,i),t.setDomNode(e)}}}_finishRendering(e,t,i){const n=l._sb,o=e.linesLength,s=e.lines,r=e.rendLineNumberStart,d=[];{n.reset();let a=!1;for(let e=0;e<o;e++){const t=s[e];d[e]=!1;const o=t.getDomNode();if(o)continue;const l=t.renderLine(e+r,i[e],this.viewportData,n);l&&(d[e]=!0,a=!0)}a&&this._finishRenderingNewLines(e,t,n.build(),d)}{n.reset();let t=!1;const a=[];for(let e=0;e<o;e++){const o=s[e];if(a[e]=!1,d[e])continue;const l=o.renderLine(e+r,i[e],this.viewportData,n);l&&(a[e]=!0,t=!0)}t&&this._finishRenderingInvalidLines(e,n.build(),a)}}}l._ttPolicy=(0,o.Z)("editorViewLayer",{createHTML:e=>e}),l._sb=new r.HT(1e5)},69114:(e,t,i)=>{i.d(t,{E:()=>o,K:()=>s});var n=i(1300);class o extends n.O{constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class s{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){const t=e.getAttribute("data-mprt");return null===t?0:parseInt(t,10)}static collect(e,t){const i=[];let n=0;while(e&&e!==e.ownerDocument.body){if(e===t)break;e.nodeType===e.ELEMENT_NODE&&(i[n++]=this.read(e)),e=e.parentElement}const o=new Uint8Array(n);for(let s=0;s<n;s++)o[s]=i[n-s-1];return o}}},97469:(e,t,i)=>{i.d(t,{Gm:()=>Fe});i(52950);var n=i(25206),o=i(2548),s=i(98642),r=i(11271),d=i(70959),a=i(50200),l=i(35273),h=i(48077),c=i(35195),u=i(54644),g=i(33162),m=i(26090),_=i(19030),f=i(22229),p=i(25109),v=i(89999),C=i(47606);class w{constructor(e,t,i,n){this.configuration=e,this.viewModel=t,this.userInputEvents=i,this.commandDelegate=n}paste(e,t,i,n){this.commandDelegate.paste(e,t,i,n)}type(e){this.commandDelegate.type(e)}compositionType(e,t,i,n){this.commandDelegate.compositionType(e,t,i,n)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){p.Ox.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){const t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new v.L(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(77)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(77)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){const t=this.configuration.options,i=C.IJ&&t.get(106),n=t.get(22);e.middleButton&&!i?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():3===e.mouseDownCount?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):2===e.mouseDownCount?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey||n?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){p.Ox.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){p.Ox.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,i){e=this._validateViewColumn(e),p.Ox.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:i})}_createCursor(e,t){e=this._validateViewColumn(e),p.Ox.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){p.Ox.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){p.Ox.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){p.Ox.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){p.Ox.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){p.Ox.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){p.Ox.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){p.Ox.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){p.Ox.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){p.Ox.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}}class b{constructor(e){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=e}emitKeyDown(e){var t;null===(t=this.onKeyDown)||void 0===t||t.call(this,e)}emitKeyUp(e){var t;null===(t=this.onKeyUp)||void 0===t||t.call(this,e)}emitContextMenu(e){var t;null===(t=this.onContextMenu)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseMove(e){var t;null===(t=this.onMouseMove)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){var t;null===(t=this.onMouseLeave)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDown(e){var t;null===(t=this.onMouseDown)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseUp(e){var t;null===(t=this.onMouseUp)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){var t;null===(t=this.onMouseDrag)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){var t;null===(t=this.onMouseDrop)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){var e;null===(e=this.onMouseDropCanceled)||void 0===e||e.call(this)}emitMouseWheel(e){var t;null===(t=this.onMouseWheel)||void 0===t||t.call(this,e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return b.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){const i=Object.assign({},e);return i.position&&(i.position=t.convertViewPositionToModelPosition(i.position)),i.range&&(i.range=t.convertViewRangeToModelRange(i.range)),5!==i.type&&8!==i.type||(i.detail=this.convertViewToModelViewZoneData(i.detail,t)),i}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new v.L(e.afterLineNumber,1)).lineNumber}}}var D=i(6155),L=i(64778),y=i(69114);class S extends y.E{constructor(e){super(e),this._visibleLines=new L.G(this),this.domNode=this._visibleLines.domNode;const t=this._context.configuration.options,i=t.get(50);(0,D.N)(this.domNode,i),this._dynamicOverlays=[],this._isFocused=!1,this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++){const t=this._dynamicOverlays[e];if(t.shouldRender())return!0}return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++){const t=this._dynamicOverlays[e];t.dispose()}this._dynamicOverlays=[]}getDomNode(){return this.domNode}createVisibleLine(){return new N(this._context.configuration,this._dynamicOverlays)}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let s=t;s<=i;s++){const t=this._visibleLines.getVisibleLine(s);t.onConfigurationChanged(e)}const n=this._context.configuration.options,o=n.get(50);return(0,D.N)(this.domNode,o),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){const t=this._dynamicOverlays.filter((e=>e.shouldRender()));for(let i=0,n=t.length;i<n;i++){const n=t[i];n.prepareRender(e),n.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}}class N{constructor(e,t){this._configuration=e,this._lineHeight=this._configuration.options.get(66),this._dynamicOverlays=t,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=(0,m.X)(e)}onContentChanged(){}onTokensChanged(){}onConfigurationChanged(e){this._lineHeight=this._configuration.options.get(66)}renderLine(e,t,i,n){let o="";for(let s=0,r=this._dynamicOverlays.length;s<r;s++){const t=this._dynamicOverlays[s];o+=t.render(i.startLineNumber,e)}return this._renderedContent!==o&&(this._renderedContent=o,n.appendString('<div style="position:absolute;top:'),n.appendString(String(t)),n.appendString("px;width:100%;height:"),n.appendString(String(this._lineHeight)),n.appendString('px;">'),n.appendString(o),n.appendString("</div>"),!0)}layoutLine(e,t){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(this._lineHeight))}}class M extends S{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(143);this._contentWidth=i.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(143);return this._contentWidth=i.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}}class E extends S{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(143);this._contentLeft=i.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),(0,D.N)(this.domNode,t.get(50))}onConfigurationChanged(e){const t=this._context.configuration.options;(0,D.N)(this.domNode,t.get(50));const i=t.get(143);return this._contentLeft=i.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);const t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}}var R=i(66066),T=i(42652),x=i(27909),I=i(33832),P=i(7844),O=i(73840),V=i(51935),A=i(76304),W=i(96577),F=i(85852),H=i(55693),k=i(84306),U=i(21665),B=i(71946),K=i(4586),z=i(47643),Z=i(17547),j=i(4915),Q=i(16287),$=i(36875),G=i(2200),q=i(6117),J=i(1300),Y=i(32656),X=i(52817),ee=i(26025),te=i(53007),ie=i(42594),ne=i(58865),oe=i(79857),se=i(21881),re=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},de=function(e,t){return function(i,n){t(i,n,e)}};let ae=class extends J.O{constructor(e,t,i,n,o,s,r){super(),this._instantiationService=r,this._shouldRecomputeGlyphMarginLanes=!1,this._selections=[new u.Y(1,1,1,1)],this._renderAnimationFrame=null;const d=new w(t,n,o,e);this._context=new G.A(t,i,n),this._context.addEventHandler(this),this._viewParts=[],this._textAreaHandler=this._instantiationService.createInstance(f.H,this._context,d,this._createTextAreaHandlerHelper()),this._viewParts.push(this._textAreaHandler),this._linesContent=(0,m.X)(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=(0,m.X)(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=(0,m.X)(document.createElement("div")),y.K.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new I.E(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new V.U(this._context,this._linesContent),this._viewZones=new Q.q(this._context),this._viewParts.push(this._viewZones);const a=new U.p(this._context);this._viewParts.push(a);const l=new z.X(this._context);this._viewParts.push(l);const h=new M(this._context);this._viewParts.push(h),h.addDynamicOverlay(new T.BX(this._context)),h.addDynamicOverlay(new Z.K(this._context)),h.addDynamicOverlay(new P.R(this._context)),h.addDynamicOverlay(new x.r(this._context)),h.addDynamicOverlay(new ie.K(this._context));const c=new E(this._context);this._viewParts.push(c),c.addDynamicOverlay(new T.gM(this._context)),c.addDynamicOverlay(new F.X(this._context)),c.addDynamicOverlay(new A.U(this._context)),c.addDynamicOverlay(new O.x(this._context)),this._glyphMarginWidgets=new ne.Iz(this._context),this._viewParts.push(this._glyphMarginWidgets);const g=new W.Z(this._context);g.getDomNode().appendChild(this._viewZones.marginDomNode),g.getDomNode().appendChild(c.getDomNode()),g.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(g),this._contentWidgets=new R.Y(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new j.o(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new k.c(this._context),this._viewParts.push(this._overlayWidgets);const p=new K.b(this._context);this._viewParts.push(p);const v=new ee.z(this._context);this._viewParts.push(v);const C=new H.N(this._context);if(this._viewParts.push(C),a){const e=this._scrollbar.getOverviewRulerLayoutInfo();e.parent.insertBefore(a.getDomNode(),e.insertBefore)}this._linesContent.appendChild(h.getDomNode()),this._linesContent.appendChild(p.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(g.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(l.getDomNode()),this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea),this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(C.getDomNode()),this._overflowGuardContainer.appendChild(v.domNode),this.domNode.appendChild(this._overflowGuardContainer),s?s.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode):this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this._applyLayout(),this._pointerHandler=this._register(new _.a(this._context,d,this._createPointerHandlerHelper()))}_flushAccumulatedAndRenderNow(){this._shouldRecomputeGlyphMarginLanes&&(this._shouldRecomputeGlyphMarginLanes=!1,this._context.configuration.setGlyphMarginDecorationLaneCount(this._computeGlyphMarginLaneCount())),te.B.onRenderStart(),this._renderNow()}_computeGlyphMarginLaneCount(){const e=this._context.viewModel.model;let t=[];t=t.concat(e.getAllMarginDecorations().map((e=>{var t,i;const n=null!==(i=null===(t=e.options.glyphMargin)||void 0===t?void 0:t.position)&&void 0!==i?i:oe.U.Left;return{range:e.range,lane:n}}))),t=t.concat(this._glyphMarginWidgets.getWidgets().map((t=>{const i=e.validateRange(t.preference.range);return{range:i,lane:t.preference.lane}}))),t.sort(((e,t)=>g.e.compareRangesUsingStarts(e.range,t.range)));let i=null,n=null;for(const o of t)if(o.lane===oe.U.Left&&(!i||g.e.compareRangesUsingEnds(i,o.range)<0)&&(i=o.range),o.lane===oe.U.Right&&(!n||g.e.compareRangesUsingEnds(n,o.range)<0)&&(n=o.range),i&&n){if(i.endLineNumber<n.startLineNumber){i=null;continue}if(n.endLineNumber<i.startLineNumber){n=null;continue}return 2}return 1}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:e=>{this._textAreaHandler.textArea.domNode.dispatchEvent(e)},getLastRenderData:()=>{const e=this._viewCursors.getLastRenderData()||[],t=this._textAreaHandler.getLastRenderData();return new X.sB(e,t)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:e=>this._viewZones.shouldSuppressMouseDownOnViewZone(e),shouldSuppressMouseDownOnWidget:e=>this._contentWidgets.shouldSuppressMouseDownOnWidget(e),getPositionFromDOMInfo:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(e,t)),visibleRangeForPosition:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new v.L(e,t))),getLineWidth:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(e))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(e))}}_applyLayout(){const e=this._context.configuration.options,t=e.get(143);this.domNode.setWidth(t.width),this.domNode.setHeight(t.height),this._overflowGuardContainer.setWidth(t.width),this._overflowGuardContainer.setHeight(t.height),this._linesContent.setWidth(1e6),this._linesContent.setHeight(1e6)}_getEditorClassName(){const e=this._textAreaHandler.isFocused()?" focused":"";return this._context.configuration.options.get(140)+" "+(0,Y.m6)(this._context.theme.type)+e}handleEvents(e){super.handleEvents(e),this._scheduleRender()}onConfigurationChanged(e){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(e){return this._selections=e.selections,!1}onDecorationsChanged(e){return e.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(e){return this._context.theme.update(e.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){null!==this._renderAnimationFrame&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(const e of this._viewParts)e.dispose();super.dispose()}_scheduleRender(){null===this._renderAnimationFrame&&(this._renderAnimationFrame=o.lI(this._onRenderScheduled.bind(this),100))}_onRenderScheduled(){this._renderAnimationFrame=null,this._flushAccumulatedAndRenderNow()}_renderNow(){le((()=>this._actualRender()))}_getViewPartsToRender(){const e=[];let t=0;for(const i of this._viewParts)i.shouldRender()&&(e[t++]=i);return e}_actualRender(){if(!o.Uw(this.domNode.domNode))return;let e=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&0===e.length)return;const t=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(t.startLineNumber,t.endLineNumber,t.centeredLineNumber);const i=new q.x(this._selections,t,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),e=this._getViewPartsToRender());const n=new $.xh(this._context.viewLayout,i,this._viewLines);for(const o of e)o.prepareRender(n);for(const o of e)o.render(n),o.onDidRender()}delegateVerticalScrollbarPointerDown(e){this._scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._scrollbar.delegateScrollFromMouseWheelEvent(e)}restoreState(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(e,t){const i=this._context.viewModel.model.validatePosition({lineNumber:e,column:t}),n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();const o=this._viewLines.visibleRangeForPosition(new v.L(n.lineNumber,n.column));return o?o.left:-1}getTargetAtClientPoint(e,t){const i=this._pointerHandler.getTargetAtClientPoint(e,t);return i?b.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(e){return new B.V(this._context,e)}change(e){this._viewZones.changeViewZones(e),this._scheduleRender()}render(e,t){if(t){this._viewLines.forceShouldRender();for(const e of this._viewParts)e.forceShouldRender()}e?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(e){this._textAreaHandler.writeScreenReaderContent(e)}focus(){this._textAreaHandler.focusTextArea()}isFocused(){return this._textAreaHandler.isFocused()}setAriaOptions(e){this._textAreaHandler.setAriaOptions(e)}addContentWidget(e){this._contentWidgets.addWidget(e.widget),this.layoutContentWidget(e),this._scheduleRender()}layoutContentWidget(e){var t,i,n,o,s,r,d,a;this._contentWidgets.setWidgetPosition(e.widget,null!==(i=null===(t=e.position)||void 0===t?void 0:t.position)&&void 0!==i?i:null,null!==(o=null===(n=e.position)||void 0===n?void 0:n.secondaryPosition)&&void 0!==o?o:null,null!==(r=null===(s=e.position)||void 0===s?void 0:s.preference)&&void 0!==r?r:null,null!==(a=null===(d=e.position)||void 0===d?void 0:d.positionAffinity)&&void 0!==a?a:null),this._scheduleRender()}removeContentWidget(e){this._contentWidgets.removeWidget(e.widget),this._scheduleRender()}addOverlayWidget(e){this._overlayWidgets.addWidget(e.widget),this.layoutOverlayWidget(e),this._scheduleRender()}layoutOverlayWidget(e){const t=e.position?e.position.preference:null,i=this._overlayWidgets.setWidgetPosition(e.widget,t);i&&this._scheduleRender()}removeOverlayWidget(e){this._overlayWidgets.removeWidget(e.widget),this._scheduleRender()}addGlyphMarginWidget(e){this._glyphMarginWidgets.addWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(e){const t=e.position,i=this._glyphMarginWidgets.setWidgetPosition(e.widget,t);i&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(e){this._glyphMarginWidgets.removeWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};function le(e){try{return e()}catch(t){(0,s.dL)(t)}}ae=re([de(6,se.TG)],ae);var he=i(93215),ce=i(16779),ue=i(51177),ge=i(22668),me=i(44950),_e=i(16375),fe=i(27193),pe=i(47277),ve=i(62362),Ce=i(46871),we=i(37174),be=i(39159),De=i(18736),Le=i(55907),ye=i(41675),Se=i(75662),Ne=i(69256),Me=i(97297),Ee=i(16458),Re=i(85398);class Te extends d.JT{constructor(){super(),this._editor=null,this._instantiationService=null,this._instances=this._register(new d.b2),this._pending=new Map,this._finishedInstantiation=[],this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,i){this._editor=e,this._instantiationService=i;for(const n of t)this._pending.has(n.id)?(0,s.dL)(new Error(`Cannot have two contributions with the same id ${n.id}`)):this._pending.set(n.id,n);this._instantiateSome(0),this._register((0,Re.To)((()=>{this._instantiateSome(1)}))),this._register((0,Re.To)((()=>{this._instantiateSome(2)}))),this._register((0,Re.To)((()=>{this._instantiateSome(3)}),5e3))}saveViewState(){const e={};for(const[t,i]of this._instances)"function"===typeof i.saveViewState&&(e[t]=i.saveViewState());return e}restoreViewState(e){for(const[t,i]of this._instances)"function"===typeof i.restoreViewState&&i.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){this._register((0,Re.To)((()=>{this._instantiateSome(1)}),50))}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;const t=this._findPendingContributionsByInstantiation(e);for(const i of t)this._instantiateById(i.id)}_findPendingContributionsByInstantiation(e){const t=[];for(const[,i]of this._pending)i.instantiation===e&&t.push(i);return t}_instantiateById(e){const t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{const e=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,e),"function"===typeof e.restoreViewState&&0!==t.instantiation&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(i){(0,s.dL)(i)}}}}var xe,Ie=i(61817),Pe=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},Oe=function(e,t){return function(i,n){t(i,n,e)}},Ve=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function d(e){try{a(n["throw"](e))}catch(t){s(t)}}function a(e){e.done?i(e.value):o(e.value).then(r,d)}a((n=n.apply(e,t||[])).next())}))};let Ae=0;class We{constructor(e,t,i,n,o,s){this.model=e,this.viewModel=t,this.view=i,this.hasRealView=n,this.listenersToRemove=o,this.attachedView=s}dispose(){(0,d.B9)(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}}let Fe=xe=class extends d.JT{get isSimpleWidget(){return this._configuration.isSimpleWidget}constructor(e,t,i,n,d,a,l,c,u,g,m,_){var f;super(),this.languageConfigurationService=m,this._deliveryQueue=(0,r.Sp)(),this._contributions=this._register(new Te),this._onDidDispose=this._register(new r.Q5),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeModelTokens=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelTokens=this._onDidChangeModelTokens.event,this._onDidChangeConfiguration=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onDidChangeModel=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new ke(this._contributions,this._deliveryQueue)),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new He({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new He({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new ke(this._contributions,this._deliveryQueue)),this.onWillType=this._onWillType.event,this._onDidType=this._register(new ke(this._contributions,this._deliveryQueue)),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new ke(this._contributions,this._deliveryQueue)),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new ke(this._contributions,this._deliveryQueue)),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new ke(this._contributions,this._deliveryQueue)),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new ke(this._contributions,this._deliveryQueue)),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new ke(this._contributions,this._deliveryQueue)),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new ke(this._contributions,this._deliveryQueue)),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new ke(this._contributions,this._deliveryQueue)),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new ke(this._contributions,this._deliveryQueue)),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onDropIntoEditor=this._register(new ke(this._contributions,this._deliveryQueue)),this.onDropIntoEditor=this._onDropIntoEditor.event,this._onContextMenu=this._register(new ke(this._contributions,this._deliveryQueue)),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new ke(this._contributions,this._deliveryQueue)),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new ke(this._contributions,this._deliveryQueue)),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new ke(this._contributions,this._deliveryQueue)),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new ke(this._contributions,this._deliveryQueue)),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new ke(this._contributions,this._deliveryQueue)),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._actions=new Map,this._bannerDomNode=null,this._dropIntoEditorDecorations=this.createDecorationsCollection(),d.willCreateCodeEditor();const p=Object.assign({},t);let v;this._domElement=e,this._overflowWidgetsDomNode=p.overflowWidgetsDomNode,delete p.overflowWidgetsDomNode,this._id=++Ae,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,p,g)),this._register(this._configuration.onDidChange((e=>{this._onDidChangeConfiguration.fire(e);const t=this._configuration.options;if(e.hasChanged(143)){const e=t.get(143);this._onDidLayoutChange.fire(e)}}))),this._contextKeyService=this._register(l.createScoped(this._domElement)),this._notificationService=u,this._codeEditorService=d,this._commandService=a,this._themeService=c,this._register(new Ue(this,this._contextKeyService)),this._register(new Be(this,this._contextKeyService,_)),this._instantiationService=n.createChild(new be.y([we.i6,this._contextKeyService])),this._modelData=null,this._focusTracker=new Ke(e),this._register(this._focusTracker.onChange((()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())}))),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={},v=Array.isArray(i.contributions)?i.contributions:h.Uc.getEditorContributions(),this._contributions.initialize(this,v,this._instantiationService);for(const o of h.Uc.getEditorActions()){if(this._actions.has(o.id)){(0,s.dL)(new Error(`Cannot have two actions with the same id ${o.id}`));continue}const e=new ue.p(o.id,o.label,o.alias,null!==(f=o.precondition)&&void 0!==f?f:void 0,(()=>this._instantiationService.invokeFunction((e=>Promise.resolve(o.runEditorCommand(e,this,null))))),this._contextKeyService);this._actions.set(e.id,e)}const C=()=>!this._configuration.options.get(90)&&this._configuration.options.get(36).enabled;this._register(new o.eg(this._domElement,{onDragEnter:()=>{},onDragOver:e=>{if(!C())return;const t=this.getTargetAtClientPoint(e.clientX,e.clientY);(null===t||void 0===t?void 0:t.position)&&this.showDropIndicatorAt(t.position)},onDrop:e=>Ve(this,void 0,void 0,(function*(){if(!C())return;if(this.removeDropIndicator(),!e.dataTransfer)return;const t=this.getTargetAtClientPoint(e.clientX,e.clientY);(null===t||void 0===t?void 0:t.position)&&this._onDropIntoEditor.fire({position:t.position,event:e})})),onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}writeScreenReaderContent(e){var t;null===(t=this._modelData)||void 0===t||t.view.writeScreenReaderContent(e)}_createConfiguration(e,t,i){return new l.z(e,t,this._domElement,i)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return ge.g.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e||{})}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?Ne.w.getWordAtPosition(this._modelData.model,this._configuration.options.get(129),e):null}getValue(e=null){if(!this._modelData)return"";const t=!(!e||!e.preserveBOM);let i=0;return e&&e.lineEnding&&"\n"===e.lineEnding?i=1:e&&e.lineEnding&&"\r\n"===e.lineEnding&&(i=2),this._modelData.model.getValue(i,t)}setValue(e){this._modelData&&this._modelData.model.setValue(e)}getModel(){return this._modelData?this._modelData.model:null}setModel(e=null){const t=e;if(null===this._modelData&&null===t)return;if(this._modelData&&this._modelData.model===t)return;const i=this.hasTextFocus(),n=this._detachModel();this._attachModel(t),i&&this.hasModel()&&this.focus();const o={oldModelUrl:n?n.uri:null,newModelUrl:t?t.uri:null};this._removeDecorationTypes(),this._onDidChangeModel.fire(o),this._postDetachModelCleanup(n),this._contributions.onAfterModelAttached()}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(const e in this._decorationTypeSubtypes){const t=this._decorationTypeSubtypes[e];for(const i in t)this._removeDecorationType(e+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(e,t,i,n){const o=e.model.validatePosition({lineNumber:t,column:i}),s=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(o);return e.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(s.lineNumber,n)}getTopForLineNumber(e,t=!1){return this._modelData?xe._getVerticalOffsetForPosition(this._modelData,e,1,t):-1}getTopForPosition(e,t){return this._modelData?xe._getVerticalOffsetForPosition(this._modelData,e,t,!1):-1}static _getVerticalOffsetForPosition(e,t,i,n=!1){const o=e.model.validatePosition({lineNumber:t,column:i}),s=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(o);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(s.lineNumber,n)}getBottomForLineNumber(e,t=!1){return this._modelData?xe._getVerticalOffsetAfterPosition(this._modelData,e,1,t):-1}setHiddenAreas(e,t){var i;null===(i=this._modelData)||void 0===i||i.viewModel.setHiddenAreas(e.map((e=>g.e.lift(e))),t)}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;const t=this._modelData.model.validatePosition(e),i=this._modelData.model.getOptions().tabSize;return ce.i.visibleColumnFromColumn(this._modelData.model.getLineContent(t.lineNumber),t.column,i)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e,t="api"){if(this._modelData){if(!v.L.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,t,i,n){if(!this._modelData)return;if(!g.e.isIRange(e))throw new Error("Invalid arguments");const o=this._modelData.model.validateRange(e),s=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(o);this._modelData.viewModel.revealRange("api",i,s,t,n)}revealLine(e,t=0){this._revealLine(e,0,t)}revealLineInCenter(e,t=0){this._revealLine(e,1,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._revealLine(e,2,t)}revealLineNearTop(e,t=0){this._revealLine(e,5,t)}_revealLine(e,t,i){if("number"!==typeof e)throw new Error("Invalid arguments");this._sendRevealRange(new g.e(e,1,e,1),t,!1,i)}revealPosition(e,t=0){this._revealPosition(e,0,!0,t)}revealPositionInCenter(e,t=0){this._revealPosition(e,1,!0,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._revealPosition(e,2,!0,t)}revealPositionNearTop(e,t=0){this._revealPosition(e,5,!0,t)}_revealPosition(e,t,i,n){if(!v.L.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new g.e(e.lineNumber,e.column,e.lineNumber,e.column),t,i,n)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e,t="api"){const i=u.Y.isISelection(e),n=g.e.isIRange(e);if(!i&&!n)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(e,t);else if(n){const i={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(i,t)}}_setSelectionImpl(e,t){if(!this._modelData)return;const i=new u.Y(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections(t,[i])}revealLines(e,t,i=0){this._revealLines(e,t,0,i)}revealLinesInCenter(e,t,i=0){this._revealLines(e,t,1,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._revealLines(e,t,2,i)}revealLinesNearTop(e,t,i=0){this._revealLines(e,t,5,i)}_revealLines(e,t,i,n){if("number"!==typeof e||"number"!==typeof t)throw new Error("Invalid arguments");this._sendRevealRange(new g.e(e,1,t,1),i,!1,n)}revealRange(e,t=0,i=!1,n=!0){this._revealRange(e,i?1:0,n,t)}revealRangeInCenter(e,t=0){this._revealRange(e,1,!0,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._revealRange(e,2,!0,t)}revealRangeNearTop(e,t=0){this._revealRange(e,5,!0,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._revealRange(e,6,!0,t)}revealRangeAtTop(e,t=0){this._revealRange(e,3,!0,t)}_revealRange(e,t,i,n){if(!g.e.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(g.e.lift(e),t,i,n)}setSelections(e,t="api",i=0){if(this._modelData){if(!e||0===e.length)throw new Error("Invalid arguments");for(let t=0,i=e.length;t<i;t++)if(!u.Y.isISelection(e[t]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,e,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e,t=1){if(this._modelData){if("number"!==typeof e)throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:e},t)}}setScrollTop(e,t=1){if(this._modelData){if("number"!==typeof e)throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:e},t)}}setScrollPosition(e,t=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(e,t)}hasPendingScrollAnimation(){return!!this._modelData&&this._modelData.viewModel.viewLayout.hasPendingScrollAnimation()}saveViewState(){if(!this._modelData)return null;const e=this._contributions.saveViewState(),t=this._modelData.viewModel.saveCursorState(),i=this._modelData.viewModel.saveState();return{cursorState:t,viewState:i,contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;const t=e;if(t&&t.cursorState&&t.viewState){const e=t.cursorState;Array.isArray(e)?e.length>0&&this._modelData.viewModel.restoreCursorState(e):this._modelData.viewModel.restoreCursorState([e]),this._contributions.restoreViewState(t.contributionsState||{});const i=this._modelData.viewModel.reduceRestoreState(t.viewState);this._modelData.view.restoreState(i)}}handleInitialized(){var e;null===(e=this._getViewModel())||void 0===e||e.visibleLinesStabilized()}getContribution(e){return this._contributions.get(e)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let e=this.getActions();return e=e.filter((e=>e.isSupported())),e}getAction(e){return this._actions.get(e)||null}trigger(e,t,i){switch(i=i||{},t){case"compositionStart":return void this._startComposition();case"compositionEnd":return void this._endComposition(e);case"type":{const t=i;return void this._type(e,t.text||"")}case"replacePreviousChar":{const t=i;return void this._compositionType(e,t.text||"",t.replaceCharCnt||0,0,0)}case"compositionType":{const t=i;return void this._compositionType(e,t.text||"",t.replacePrevCharCnt||0,t.replaceNextCharCnt||0,t.positionDelta||0)}case"paste":{const t=i;return void this._paste(e,t.text||"",t.pasteOnNewLine||!1,t.multicursorText||null,t.mode||null)}case"cut":return void this._cut(e)}const n=this.getAction(t);n?Promise.resolve(n.run(i)).then(void 0,s.dL):this._modelData&&(this._triggerEditorCommand(e,t,i)||this._triggerCommand(t,i))}_triggerCommand(e,t){this._commandService.executeCommand(e,t)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,t){this._modelData&&0!==t.length&&("keyboard"===e&&this._onWillType.fire(t),this._modelData.viewModel.type(t,e),"keyboard"===e&&this._onDidType.fire(t))}_compositionType(e,t,i,n,o){this._modelData&&this._modelData.viewModel.compositionType(t,i,n,o,e)}_paste(e,t,i,n,o){if(!this._modelData||0===t.length)return;const s=this._modelData.viewModel,r=s.getSelection().getStartPosition();s.paste(t,i,n,e);const d=s.getSelection().getStartPosition();"keyboard"===e&&this._onDidPaste.fire({range:new g.e(r.lineNumber,r.column,d.lineNumber,d.column),languageId:o})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,t,i){const n=h.Uc.getEditorCommand(t);return!!n&&(i=i||{},i.source=e,this._instantiationService.invokeFunction((e=>{Promise.resolve(n.runEditorCommand(e,this,i)).then(void 0,s.dL)})),!0)}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!!this._modelData&&(!this._configuration.options.get(90)&&(this._modelData.model.pushStackElement(),!0))}popUndoStop(){return!!this._modelData&&(!this._configuration.options.get(90)&&(this._modelData.model.popStackElement(),!0))}executeEdits(e,t,i){if(!this._modelData)return!1;if(this._configuration.options.get(90))return!1;let n;return n=i?Array.isArray(i)?()=>i:i:()=>null,this._modelData.viewModel.executeEdits(e,t,n),!0}executeCommand(e,t){this._modelData&&this._modelData.viewModel.executeCommand(t,e)}executeCommands(e,t){this._modelData&&this._modelData.viewModel.executeCommands(t,e)}createDecorationsCollection(e){return new ze(this,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){return this._modelData?this._modelData.model.getLineDecorations(e,this._id,(0,he.$J)(this._configuration.options)):null}getDecorationsInRange(e){return this._modelData?this._modelData.model.getDecorationsInRange(e,this._id,(0,he.$J)(this._configuration.options)):null}deltaDecorations(e,t){return this._modelData?0===e.length&&0===t.length?e:this._modelData.model.deltaDecorations(e,t,this._id):[]}removeDecorations(e){this._modelData&&0!==e.length&&this._modelData.model.changeDecorations((t=>{t.deltaDecorations(e,[])}))}removeDecorationsByType(e){const t=this._decorationTypeKeysToIds[e];t&&this.deltaDecorations(t,[]),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){const e=this._configuration.options,t=e.get(143);return t}createOverviewRuler(e){return this._modelData&&this._modelData.hasRealView?this._modelData.view.createOverviewRuler(e):null}getContainerDomNode(){return this._domElement}getDomNode(){return this._modelData&&this._modelData.hasRealView?this._modelData.view.domNode.domNode:null}delegateVerticalScrollbarPointerDown(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.delegateScrollFromMouseWheelEvent(e)}layout(e){this._configuration.observeContainer(e),this.render()}focus(){this._modelData&&this._modelData.hasRealView&&this._modelData.view.focus()}hasTextFocus(){return!(!this._modelData||!this._modelData.hasRealView)&&this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(e){const t={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id."),this._contentWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(t)}layoutContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const e=this._contentWidgets[t];delete this._contentWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(e)}}addOverlayWidget(e){const t={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(t)}layoutOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const e=this._overlayWidgets[t];delete this._overlayWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(e)}}addGlyphMarginWidget(e){const t={widget:e,position:e.getPosition()};this._glyphMarginWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(t)}layoutGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(i)}}removeGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const e=this._glyphMarginWidgets[t];delete this._glyphMarginWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(e)}}changeViewZones(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.change(e)}getTargetAtClientPoint(e,t){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getTargetAtClientPoint(e,t):null}getScrolledVisiblePosition(e){if(!this._modelData||!this._modelData.hasRealView)return null;const t=this._modelData.model.validatePosition(e),i=this._configuration.options,n=i.get(143),o=xe._getVerticalOffsetForPosition(this._modelData,t.lineNumber,t.column)-this.getScrollTop(),s=this._modelData.view.getOffsetForColumn(t.lineNumber,t.column)+n.glyphMarginWidth+n.lineNumbersWidth+n.decorationsWidth-this.getScrollLeft();return{top:o,left:s,height:i.get(66)}}getOffsetForColumn(e,t){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getOffsetForColumn(e,t):-1}render(e=!1){this._modelData&&this._modelData.hasRealView&&this._modelData.view.render(!0,e)}setAriaOptions(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.setAriaOptions(e)}applyFontInfo(e){(0,D.N)(e,this._configuration.options.get(50))}setBanner(e,t){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),this._bannerDomNode=e,this._configuration.setReservedHeight(e?t:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(e){if(!e)return void(this._modelData=null);const t=[];this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setModelLineCount(e.getLineCount());const i=e.onBeforeAttached(),s=new ve.j(this._id,this._configuration,e,Se.C.create(),ye.p.create(this._configuration.options),(e=>o.jL(e)),this.languageConfigurationService,this._themeService,i);t.push(e.onWillDispose((()=>this.setModel(null)))),t.push(s.onEvent((t=>{switch(t.kind){case 0:this._onDidContentSizeChange.fire(t);break;case 1:this._editorTextFocus.setValue(t.hasFocus);break;case 2:this._onDidScrollChange.fire(t);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(t.reachedMaxCursorCount){const e=this.getOption(79),t=n.NC("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",e);this._notificationService.prompt(De.zb.Warning,t,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:n.NC("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}const e=[];for(let n=0,s=t.selections.length;n<s;n++)e[n]=t.selections[n].getPosition();const i={position:e[0],secondaryPositions:e.slice(1),reason:t.reason,source:t.source};this._onDidChangeCursorPosition.fire(i);const o={selection:t.selections[0],secondarySelections:t.selections.slice(1),modelVersionId:t.modelVersionId,oldSelections:t.oldSelections,oldModelVersionId:t.oldModelVersionId,source:t.source,reason:t.reason};this._onDidChangeCursorSelection.fire(o);break}case 7:this._onDidChangeModelDecorations.fire(t.event);break;case 8:this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._onDidChangeModelLanguage.fire(t.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(t.event);break;case 10:this._onDidChangeModelContent.fire(t.event);break;case 11:this._onDidChangeModelOptions.fire(t.event);break;case 12:this._onDidChangeModelTokens.fire(t.event);break}})));const[r,d]=this._createView(s);if(d){this._domElement.appendChild(r.domNode.domNode);let t=Object.keys(this._contentWidgets);for(let e=0,i=t.length;e<i;e++){const i=t[e];r.addContentWidget(this._contentWidgets[i])}t=Object.keys(this._overlayWidgets);for(let e=0,i=t.length;e<i;e++){const i=t[e];r.addOverlayWidget(this._overlayWidgets[i])}t=Object.keys(this._glyphMarginWidgets);for(let e=0,i=t.length;e<i;e++){const i=t[e];r.addGlyphMarginWidget(this._glyphMarginWidgets[i])}r.render(!1,!0),r.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new We(e,s,r,d,t,i)}_createView(e){let t;t=this.isSimpleWidget?{paste:(e,t,i,n)=>{this._paste("keyboard",e,t,i,n)},type:e=>{this._type("keyboard",e)},compositionType:(e,t,i,n)=>{this._compositionType("keyboard",e,t,i,n)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:{paste:(e,t,i,n)=>{const o={text:e,pasteOnNewLine:t,multicursorText:i,mode:n};this._commandService.executeCommand("paste",o)},type:e=>{const t={text:e};this._commandService.executeCommand("type",t)},compositionType:(e,t,i,n)=>{if(i||n){const o={text:e,replacePrevCharCnt:t,replaceNextCharCnt:i,positionDelta:n};this._commandService.executeCommand("compositionType",o)}else{const i={text:e,replaceCharCnt:t};this._commandService.executeCommand("replacePreviousChar",i)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const i=new b(e.coordinatesConverter);i.onKeyDown=e=>this._onKeyDown.fire(e),i.onKeyUp=e=>this._onKeyUp.fire(e),i.onContextMenu=e=>this._onContextMenu.fire(e),i.onMouseMove=e=>this._onMouseMove.fire(e),i.onMouseLeave=e=>this._onMouseLeave.fire(e),i.onMouseDown=e=>this._onMouseDown.fire(e),i.onMouseUp=e=>this._onMouseUp.fire(e),i.onMouseDrag=e=>this._onMouseDrag.fire(e),i.onMouseDrop=e=>this._onMouseDrop.fire(e),i.onMouseDropCanceled=e=>this._onMouseDropCanceled.fire(e),i.onMouseWheel=e=>this._onMouseWheel.fire(e);const n=new ae(t,this._configuration,this._themeService.getColorTheme(),e,i,this._overflowWidgetsDomNode,this._instantiationService);return[n,!0]}_postDetachModelCleanup(e){null===e||void 0===e||e.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(!this._modelData)return null;const e=this._modelData.model,t=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),t&&this._domElement.contains(t)&&this._domElement.removeChild(t),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),e}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}hasModel(){return null!==this._modelData}showDropIndicatorAt(e){const t=[{range:new g.e(e.lineNumber,e.column,e.lineNumber,e.column),options:xe.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(t),this.revealPosition(e,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(e,t){this._contextKeyService.createKey(e,t)}};Fe.dropIntoEditorDecorationOptions=_e.qx.register({description:"workbench-dnd-target",className:"dnd-target"}),Fe=xe=Pe([Oe(3,se.TG),Oe(4,c.$),Oe(5,Ce.H),Oe(6,we.i6),Oe(7,Y.XE),Oe(8,De.lT),Oe(9,Le.F),Oe(10,Me.c_),Oe(11,Ee.p)],Fe);class He extends d.JT{constructor(e){super(),this._emitterOptions=e,this._onDidChangeToTrue=this._register(new r.Q5(this._emitterOptions)),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new r.Q5(this._emitterOptions)),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(e){const t=e?2:1;this._value!==t&&(this._value=t,2===this._value?this._onDidChangeToTrue.fire():1===this._value&&this._onDidChangeToFalse.fire())}}class ke extends r.Q5{constructor(e,t){super({deliveryQueue:t}),this._contributions=e}fire(e){this._contributions.onBeforeInteractionEvent(),super.fire(e)}}class Ue extends d.JT{constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=me.u.editorSimpleInput.bindTo(t),this._editorFocus=me.u.focus.bindTo(t),this._textInputFocus=me.u.textInputFocus.bindTo(t),this._editorTextFocus=me.u.editorTextFocus.bindTo(t),this._tabMovesFocus=me.u.tabMovesFocus.bindTo(t),this._editorReadonly=me.u.readOnly.bindTo(t),this._inDiffEditor=me.u.inDiffEditor.bindTo(t),this._editorColumnSelection=me.u.columnSelection.bindTo(t),this._hasMultipleSelections=me.u.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=me.u.hasNonEmptySelection.bindTo(t),this._canUndo=me.u.canUndo.bindTo(t),this._canRedo=me.u.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromConfig()))),this._register(this._editor.onDidChangeCursorSelection((()=>this._updateFromSelection()))),this._register(this._editor.onDidFocusEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidFocusEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidChangeModel((()=>this._updateFromModel()))),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromModel()))),this._register(Ie.n.onDidChangeTabFocus((e=>this._tabMovesFocus.set(e)))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const e=this._editor.getOptions();this._tabMovesFocus.set(Ie.n.getTabFocusMode()),this._editorReadonly.set(e.get(90)),this._inDiffEditor.set(e.get(61)),this._editorColumnSelection.set(e.get(22))}_updateFromSelection(){const e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some((e=>!e.isEmpty())))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const e=this._editor.getModel();this._canUndo.set(Boolean(e&&e.canUndo())),this._canRedo.set(Boolean(e&&e.canRedo()))}}class Be extends d.JT{constructor(e,t,i){super(),this._editor=e,this._contextKeyService=t,this._languageFeaturesService=i,this._langId=me.u.languageId.bindTo(t),this._hasCompletionItemProvider=me.u.hasCompletionItemProvider.bindTo(t),this._hasCodeActionsProvider=me.u.hasCodeActionsProvider.bindTo(t),this._hasCodeLensProvider=me.u.hasCodeLensProvider.bindTo(t),this._hasDefinitionProvider=me.u.hasDefinitionProvider.bindTo(t),this._hasDeclarationProvider=me.u.hasDeclarationProvider.bindTo(t),this._hasImplementationProvider=me.u.hasImplementationProvider.bindTo(t),this._hasTypeDefinitionProvider=me.u.hasTypeDefinitionProvider.bindTo(t),this._hasHoverProvider=me.u.hasHoverProvider.bindTo(t),this._hasDocumentHighlightProvider=me.u.hasDocumentHighlightProvider.bindTo(t),this._hasDocumentSymbolProvider=me.u.hasDocumentSymbolProvider.bindTo(t),this._hasReferenceProvider=me.u.hasReferenceProvider.bindTo(t),this._hasRenameProvider=me.u.hasRenameProvider.bindTo(t),this._hasSignatureHelpProvider=me.u.hasSignatureHelpProvider.bindTo(t),this._hasInlayHintsProvider=me.u.hasInlayHintsProvider.bindTo(t),this._hasDocumentFormattingProvider=me.u.hasDocumentFormattingProvider.bindTo(t),this._hasDocumentSelectionFormattingProvider=me.u.hasDocumentSelectionFormattingProvider.bindTo(t),this._hasMultipleDocumentFormattingProvider=me.u.hasMultipleDocumentFormattingProvider.bindTo(t),this._hasMultipleDocumentSelectionFormattingProvider=me.u.hasMultipleDocumentSelectionFormattingProvider.bindTo(t),this._isInWalkThrough=me.u.isInWalkThroughSnippet.bindTo(t);const n=()=>this._update();this._register(e.onDidChangeModel(n)),this._register(e.onDidChangeModelLanguage(n)),this._register(i.completionProvider.onDidChange(n)),this._register(i.codeActionProvider.onDidChange(n)),this._register(i.codeLensProvider.onDidChange(n)),this._register(i.definitionProvider.onDidChange(n)),this._register(i.declarationProvider.onDidChange(n)),this._register(i.implementationProvider.onDidChange(n)),this._register(i.typeDefinitionProvider.onDidChange(n)),this._register(i.hoverProvider.onDidChange(n)),this._register(i.documentHighlightProvider.onDidChange(n)),this._register(i.documentSymbolProvider.onDidChange(n)),this._register(i.referenceProvider.onDidChange(n)),this._register(i.renameProvider.onDidChange(n)),this._register(i.documentFormattingEditProvider.onDidChange(n)),this._register(i.documentRangeFormattingEditProvider.onDidChange(n)),this._register(i.signatureHelpProvider.onDidChange(n)),this._register(i.inlayHintsProvider.onDidChange(n)),n()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents((()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInWalkThrough.reset()}))}_update(){const e=this._editor.getModel();e?this._contextKeyService.bufferChangeEvents((()=>{this._langId.set(e.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(e)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(e)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(e)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(e)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(e)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(e)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(e)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(e)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(e)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(e)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(e)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(e)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(e)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(e)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(e)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(e).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._isInWalkThrough.set(e.uri.scheme===a.lg.walkThroughSnippet)})):this.reset()}}class Ke extends d.JT{constructor(e){super(),this._onChange=this._register(new r.Q5),this.onChange=this._onChange.event,this._hasFocus=!1,this._domFocusTracker=this._register(o.go(e)),this._register(this._domFocusTracker.onDidFocus((()=>{this._hasFocus=!0,this._onChange.fire(void 0)}))),this._register(this._domFocusTracker.onDidBlur((()=>{this._hasFocus=!1,this._onChange.fire(void 0)})))}hasFocus(){return this._hasFocus}}class ze{get length(){return this._decorationIds.length}constructor(e,t){this._editor=e,this._decorationIds=[],this._isChangingDecorations=!1,Array.isArray(t)&&t.length>0&&this.set(t)}onDidChange(e,t,i){return this._editor.onDidChangeModelDecorations((i=>{this._isChangingDecorations||e.call(t,i)}),i)}getRange(e){return this._editor.hasModel()?e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e]):null}getRanges(){if(!this._editor.hasModel())return[];const e=this._editor.getModel(),t=[];for(const i of this._decorationIds){const n=e.getDecorationRange(i);n&&t.push(n)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){0!==this._decorationIds.length&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations((t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)}))}finally{this._isChangingDecorations=!1}return this._decorationIds}}const Ze=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),je=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function Qe(e){return Ze+encodeURIComponent(e.toString())+je}const $e=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),Ge=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function qe(e){return $e+encodeURIComponent(e.toString())+Ge}(0,Y.Ic)(((e,t)=>{const i=e.getColor(pe.lXJ);i&&t.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${Qe(i)}") repeat-x bottom left; }`);const n=e.getColor(pe.uoC);n&&t.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${Qe(n)}") repeat-x bottom left; }`);const o=e.getColor(pe.c63);o&&t.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${Qe(o)}") repeat-x bottom left; }`);const s=e.getColor(pe.Dut);s&&t.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${qe(s)}") no-repeat bottom left; }`);const r=e.getColor(fe.zu);r&&t.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${r.rgba.a}; }`)}))},8714:(e,t,i)=>{var n=i(2548),o=i(8419),s=i(48077),r=i(35195),d=i(29431),a=i(44950),l=i(25206),h=i(82693),c=i(46871),u=i(47596),g=i(37174);class m extends h.Ke{constructor(){super({id:"diffEditor.toggleCollapseUnchangedRegions",title:{value:(0,l.NC)("toggleCollapseUnchangedRegions","Toggle Collapse Unchanged Regions"),original:"Toggle Collapse Unchanged Regions"},icon:o.l.map,toggled:g.Ao.has("config.diffEditor.hideUnchangedRegions.enabled"),precondition:g.Ao.has("isInDiffEditor"),menu:{when:g.Ao.has("isInDiffEditor"),id:h.eH.EditorTitle,order:22,group:"navigation"}})}run(e,...t){const i=e.get(u.Ui),n=!i.getValue("diffEditor.hideUnchangedRegions.enabled");i.updateValue("diffEditor.hideUnchangedRegions.enabled",n)}}(0,h.r1)(m);class _ extends h.Ke{constructor(){super({id:"diffEditor.toggleShowMovedCodeBlocks",title:{value:(0,l.NC)("toggleShowMovedCodeBlocks","Toggle Show Moved Code Blocks"),original:"Toggle Show Moved Code Blocks"},precondition:g.Ao.has("isInDiffEditor")})}run(e,...t){const i=e.get(u.Ui),n=!i.getValue("diffEditor.experimental.showMoves");i.updateValue("diffEditor.experimental.showMoves",n)}}(0,h.r1)(_);class f extends h.Ke{constructor(){super({id:"diffEditor.toggleUseInlineViewWhenSpaceIsLimited",title:{value:(0,l.NC)("toggleUseInlineViewWhenSpaceIsLimited","Toggle Use Inline View When Space Is Limited"),original:"Toggle Use Inline View When Space Is Limited"},precondition:g.Ao.has("isInDiffEditor")})}run(e,...t){const i=e.get(u.Ui),n=!i.getValue("diffEditor.useInlineViewWhenSpaceIsLimited");i.updateValue("diffEditor.useInlineViewWhenSpaceIsLimited",n)}}(0,h.r1)(f),h.BH.appendMenuItem(h.eH.EditorTitle,{command:{id:(new f).desc.id,title:(0,l.NC)("useInlineViewWhenSpaceIsLimited","Use Inline View When Space Is Limited"),toggled:g.Ao.has("config.diffEditor.useInlineViewWhenSpaceIsLimited"),precondition:g.Ao.has("isInDiffEditor")},order:11,group:"1_diff",when:g.Ao.and(a.u.diffEditorRenderSideBySideInlineBreakpointReached,g.Ao.has("isInDiffEditor"))}),h.BH.appendMenuItem(h.eH.EditorTitle,{command:{id:(new _).desc.id,title:(0,l.NC)("showMoves","Show Moved Code Blocks"),icon:o.l.move,toggled:g.cP.create("config.diffEditor.experimental.showMoves",!0),precondition:g.Ao.has("isInDiffEditor")},order:10,group:"1_diff",when:g.Ao.has("isInDiffEditor")});const p={value:(0,l.NC)("diffEditor","Diff Editor"),original:"Diff Editor"};class v extends s.x1{constructor(){super({id:"diffEditor.switchSide",title:{value:(0,l.NC)("switchSide","Switch Side"),original:"Switch Side"},icon:o.l.arrowSwap,precondition:g.Ao.has("isInDiffEditor"),f1:!0,category:p})}runEditorCommand(e,t,i){const n=S(e);if(n instanceof d.p){if(i&&i.dryRun)return{destinationSelection:n.mapToOtherSide().destinationSelection};n.switchSide()}}}(0,h.r1)(v);class C extends s.x1{constructor(){super({id:"diffEditor.exitCompareMove",title:{value:(0,l.NC)("exitCompareMove","Exit Compare Move"),original:"Exit Compare Move"},icon:o.l.close,precondition:a.u.comparingMovedCode,f1:!1,category:p,keybinding:{weight:1e4,primary:9}})}runEditorCommand(e,t,...i){const n=S(e);n instanceof d.p&&n.exitCompareMove()}}(0,h.r1)(C);class w extends s.x1{constructor(){super({id:"diffEditor.collapseAllUnchangedRegions",title:{value:(0,l.NC)("collapseAllUnchangedRegions","Collapse All Unchanged Regions"),original:"Collapse All Unchanged Regions"},icon:o.l.fold,precondition:g.Ao.has("isInDiffEditor"),f1:!0,category:p})}runEditorCommand(e,t,...i){const n=S(e);n instanceof d.p&&n.collapseAllUnchangedRegions()}}(0,h.r1)(w);class b extends s.x1{constructor(){super({id:"diffEditor.showAllUnchangedRegions",title:{value:(0,l.NC)("showAllUnchangedRegions","Show All Unchanged Regions"),original:"Show All Unchanged Regions"},icon:o.l.unfold,precondition:g.Ao.has("isInDiffEditor"),f1:!0,category:p})}runEditorCommand(e,t,...i){const n=S(e);n instanceof d.p&&n.showAllUnchangedRegions()}}(0,h.r1)(b);const D={value:(0,l.NC)("accessibleDiffViewer","Accessible Diff Viewer"),original:"Accessible Diff Viewer"};class L extends h.Ke{constructor(){super({id:L.id,title:{value:(0,l.NC)("editor.action.accessibleDiffViewer.next","Go to Next Difference"),original:"Go to Next Difference"},category:D,precondition:g.Ao.has("isInDiffEditor"),keybinding:{primary:65,weight:100},f1:!0})}run(e){const t=S(e);null===t||void 0===t||t.accessibleDiffViewerNext()}}L.id="editor.action.accessibleDiffViewer.next",h.BH.appendMenuItem(h.eH.EditorTitle,{command:{id:L.id,title:(0,l.NC)("Open Accessible Diff Viewer","Open Accessible Diff Viewer"),precondition:g.Ao.has("isInDiffEditor")},order:10,group:"2_diff",when:g.Ao.and(a.u.accessibleDiffViewerVisible.negate(),g.Ao.has("isInDiffEditor"))});class y extends h.Ke{constructor(){super({id:y.id,title:{value:(0,l.NC)("editor.action.accessibleDiffViewer.prev","Go to Previous Difference"),original:"Go to Previous Difference"},category:D,precondition:g.Ao.has("isInDiffEditor"),keybinding:{primary:1089,weight:100},f1:!0})}run(e){const t=S(e);null===t||void 0===t||t.accessibleDiffViewerPrev()}}function S(e){var t;const i=e.get(r.$),o=i.listDiffEditors(),s=null!==(t=i.getFocusedCodeEditor())&&void 0!==t?t:i.getActiveCodeEditor();if(!s)return null;for(let n=0,r=o.length;n<r;n++){const e=o[n];if(e.getModifiedEditor().getId()===s.getId()||e.getOriginalEditor().getId()===s.getId())return e}const d=(0,n.vY)();if(d)for(const n of o){const e=n.getContainerDomNode();if(N(e,d))return n}return null}function N(e,t){let i=t;while(i){if(i===e)return!0;i=i.parentElement}return!1}y.id="editor.action.accessibleDiffViewer.prev",c.P.registerCommandAlias("editor.action.diffReview.next",L.id),(0,h.r1)(L),c.P.registerCommandAlias("editor.action.diffReview.prev",y.id),(0,h.r1)(y)},29431:(e,t,i)=>{i.d(t,{p:()=>mi});var n=i(2548),o=i(75912),s=i(98642),r=i(11271),d=i(70959),a=i(40164),l=i(48077),h=i(35195),c=i(97469),u=i(82168),g=i(78089),m=i(60841),_=i(10205),f=i(21921),p=i(8419),v=i(99588),C=i(6155),w=i(55191),b=i(3461),D=i(41971);function L(e,t,i,n){if(0===e.length)return t;if(0===t.length)return e;const o=[];let s=0,r=0;while(s<e.length&&r<t.length){const d=e[s],a=t[r],l=i(d),h=i(a);l<h?(o.push(d),s++):l>h?(o.push(a),r++):(o.push(n(d,a)),s++,r++)}while(s<e.length)o.push(e[s]),s++;while(r<t.length)o.push(t[r]),r++;return o}function y(e,t){const i=new d.SL,n=e.createDecorationsCollection();return i.add((0,a.UV)({debugName:()=>`Apply decorations from ${t.debugName}`},(e=>{const i=t.read(e);n.set(i)}))),i.add({dispose:()=>{n.clear()}}),i}function S(e,t){return e.appendChild(t),(0,d.OF)((()=>{e.removeChild(t)}))}class N extends d.JT{get width(){return this._width}get height(){return this._height}constructor(e,t){super(),this.elementSizeObserver=this._register(new D.I(e,t)),this._width=(0,a.uh)(this,this.elementSizeObserver.getWidth()),this._height=(0,a.uh)(this,this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange((e=>(0,a.PS)((e=>{this._width.set(this.elementSizeObserver.getWidth(),e),this._height.set(this.elementSizeObserver.getHeight(),e)})))))}observe(e){this.elementSizeObserver.observe(e)}setAutomaticLayout(e){e?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}}function M(e,t){let i=e.get(),n=i,o=i;const s=(0,a.uh)("animatedValue",i);let r=-1;const d=300;let l;function h(){const e=Date.now()-r;o=Math.floor(E(e,n,i-n,d)),e<d?l=requestAnimationFrame(h):o=i,s.set(o,void 0)}return t.add((0,a.nJ)({createEmptyChangeSummary:()=>({animate:!1}),handleChange:(t,i)=>(t.didChange(e)&&(i.animate=i.animate||t.change),!0)},((t,s)=>{void 0!==l&&(cancelAnimationFrame(l),l=void 0),n=o,i=e.read(t),r=Date.now()-(s.animate?0:d),h()}))),s}function E(e,t,i,n){return e===n?t+i:i*(1-Math.pow(2,-10*e/n))+t}class R extends d.JT{constructor(e,t,i){super(),this._register(new x(e,i)),this._register(I(i,{height:t.actualHeight,top:t.actualTop}))}}class T{get afterLineNumber(){return this._afterLineNumber.get()}constructor(e,t){this._afterLineNumber=e,this.heightInPx=t,this.domNode=document.createElement("div"),this._actualTop=(0,a.uh)(this,void 0),this._actualHeight=(0,a.uh)(this,void 0),this.actualTop=this._actualTop,this.actualHeight=this._actualHeight,this.showInHiddenAreas=!0,this.onChange=this._afterLineNumber,this.onDomNodeTop=e=>{this._actualTop.set(e,void 0)},this.onComputedHeight=e=>{this._actualHeight.set(e,void 0)}}}class x{constructor(e,t){this._editor=e,this._domElement=t,this._overlayWidgetId="managedOverlayWidget-"+x._counter++,this._overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null},this._editor.addOverlayWidget(this._overlayWidget)}dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}}function I(e,t){return(0,a.EH)((i=>{for(let[n,o]of Object.entries(t))o&&"object"===typeof o&&"read"in o&&(o=o.read(i)),"number"===typeof o&&(o=`${o}px`),n=n.replace(/[A-Z]/g,(e=>"-"+e.toLowerCase())),e.style[n]=o}))}function P(e,t){return O([e],t),e}function O(e,t){if((0,b.H)()){const i=(0,a.aq)("reload",(t=>(0,b.E)((i=>{if([...Object.values(i)].some((t=>e.includes(t))))return e=>(t(void 0),!0)}))));i.read(t)}}function V(e,t,i){const n=new d.SL,o=[];return n.add((0,a.EH)((s=>{const r=t.read(s),d=new Map,l=new Map;i&&i(!0),e.changeViewZones((e=>{for(const t of o)e.removeZone(t);o.length=0;for(const t of r){const i=e.addZone(t);o.push(i),d.set(t,i)}})),i&&i(!1),n.add((0,a.nJ)({createEmptyChangeSummary(){return[]},handleChange(e,t){const i=l.get(e.changedObservable);return void 0!==i&&t.push(i),!0}},((t,n)=>{for(const e of r)e.onChange&&(l.set(e.onChange,d.get(e)),e.onChange.read(t));i&&i(!0),e.changeViewZones((e=>{for(const t of n)e.layoutZone(t)})),i&&i(!1)})))}))),n.add({dispose(){i&&i(!0),e.changeViewZones((e=>{for(const t of o)e.removeZone(t)})),i&&i(!1)}}),n}x._counter=0;class A extends w.A{dispose(){super.dispose(!0)}}var W=i(93215),F=i(66676),H=i(12412),k=i(89999),U=i(33162),B=i(42590),K=i(61141),z=i(81083),Z=i(93489),j=i(70748),Q=i(25206),$=i(70936),G=i(21881),q=i(98158),J=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},Y=function(e,t){return function(i,n){t(i,n,e)}},X=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function d(e){try{a(n["throw"](e))}catch(t){s(t)}}function a(e){e.done?i(e.value):o(e.value).then(r,d)}a((n=n.apply(e,t||[])).next())}))};const ee=(0,q.q5)("diff-review-insert",p.l.add,(0,Q.NC)("accessibleDiffViewerInsertIcon","Icon for 'Insert' in accessible diff viewer.")),te=(0,q.q5)("diff-review-remove",p.l.remove,(0,Q.NC)("accessibleDiffViewerRemoveIcon","Icon for 'Remove' in accessible diff viewer.")),ie=(0,q.q5)("diff-review-close",p.l.close,(0,Q.NC)("accessibleDiffViewerCloseIcon","Icon for 'Close' in accessible diff viewer."));let ne=class extends d.JT{constructor(e,t,i,n,o,s,r,d,l){super(),this._parentNode=e,this._visible=t,this._setVisible=i,this._canClose=n,this._width=o,this._height=s,this._diffs=r,this._editors=d,this._instantiationService=l,this.model=(0,a.Be)(this,((e,t)=>{const i=this._visible.read(e);if(this._parentNode.style.visibility=i?"visible":"hidden",!i)return null;const n=t.add(this._instantiationService.createInstance(oe,this._diffs,this._editors,this._setVisible,this._canClose)),o=t.add(this._instantiationService.createInstance(ge,this._parentNode,n,this._width,this._height,this._editors));return{model:n,view:o}})),this._register((0,a.jx)(this.model))}next(){(0,a.PS)((e=>{const t=this._visible.get();this._setVisible(!0,e),t&&this.model.get().model.nextGroup(e)}))}prev(){(0,a.PS)((e=>{this._setVisible(!0,e),this.model.get().model.previousGroup(e)}))}close(){(0,a.PS)((e=>{this._setVisible(!1,e)}))}};ne._ttPolicy=(0,u.Z)("diffReview",{createHTML:e=>e}),ne=J([Y(8,G.TG)],ne);let oe=class extends d.JT{constructor(e,t,i,n,o){super(),this._diffs=e,this._editors=t,this._setVisible=i,this.canClose=n,this._audioCueService=o,this._groups=(0,a.uh)(this,[]),this._currentGroupIdx=(0,a.uh)(this,0),this._currentElementIdx=(0,a.uh)(this,0),this.groups=this._groups,this.currentGroup=this._currentGroupIdx.map(((e,t)=>this._groups.read(t)[e])),this.currentGroupIndex=this._currentGroupIdx,this.currentElement=this._currentElementIdx.map(((e,t)=>{var i;return null===(i=this.currentGroup.read(t))||void 0===i?void 0:i.lines[e]})),this._register((0,a.EH)((e=>{const t=this._diffs.read(e);if(!t)return void this._groups.set([],void 0);const i=re(t,this._editors.original.getModel().getLineCount(),this._editors.modified.getModel().getLineCount());(0,a.PS)((e=>{const t=this._editors.modified.getPosition();if(t){const n=i.findIndex((e=>(null===t||void 0===t?void 0:t.lineNumber)<e.range.modified.endLineNumberExclusive));-1!==n&&this._currentGroupIdx.set(n,e)}this._groups.set(i,e)}))}))),this._register((0,a.EH)((e=>{const t=this.currentElement.read(e);(null===t||void 0===t?void 0:t.type)===de.Deleted?this._audioCueService.playAudioCue($.y$.diffLineDeleted,{source:"accessibleDiffViewer.currentElementChanged"}):(null===t||void 0===t?void 0:t.type)===de.Added&&this._audioCueService.playAudioCue($.y$.diffLineInserted,{source:"accessibleDiffViewer.currentElementChanged"})}))),this._register((0,a.EH)((e=>{var t;const i=this.currentElement.read(e);if(i&&i.type!==de.Header){const e=null!==(t=i.modifiedLineNumber)&&void 0!==t?t:i.diff.modified.startLineNumber;this._editors.modified.setSelection(U.e.fromPositions(new k.L(e,1)))}})))}_goToGroupDelta(e,t){const i=this.groups.get();!i||i.length<=1||(0,a.c8)(t,(t=>{this._currentGroupIdx.set(H.q.ofLength(i.length).clipCyclic(this._currentGroupIdx.get()+e),t),this._currentElementIdx.set(0,t)}))}nextGroup(e){this._goToGroupDelta(1,e)}previousGroup(e){this._goToGroupDelta(-1,e)}_goToLineDelta(e){const t=this.currentGroup.get();!t||t.lines.length<=1||(0,a.PS)((i=>{this._currentElementIdx.set(H.q.ofLength(t.lines.length).clip(this._currentElementIdx.get()+e),i)}))}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(e){const t=this.currentGroup.get();if(!t)return;const i=t.lines.indexOf(e);-1!==i&&(0,a.PS)((e=>{this._currentElementIdx.set(i,e)}))}revealCurrentElementInEditor(){this._setVisible(!1,void 0);const e=this.currentElement.get();e&&(e.type===de.Deleted?(this._editors.original.setSelection(U.e.fromPositions(new k.L(e.originalLineNumber,1))),this._editors.original.revealLine(e.originalLineNumber),this._editors.original.focus()):(e.type!==de.Header&&(this._editors.modified.setSelection(U.e.fromPositions(new k.L(e.modifiedLineNumber,1))),this._editors.modified.revealLine(e.modifiedLineNumber)),this._editors.modified.focus()))}close(){this._setVisible(!1,void 0),this._editors.modified.focus()}};oe=J([Y(4,$.e7)],oe);const se=3;function re(e,t,i){const n=[];for(const o of(0,f.mw)(e,((e,t)=>t.modified.startLineNumber-e.modified.endLineNumberExclusive<2*se))){const e=[];e.push(new le);const s=new F.z(Math.max(1,o[0].original.startLineNumber-se),Math.min(o[o.length-1].original.endLineNumberExclusive+se,t+1)),r=new F.z(Math.max(1,o[0].modified.startLineNumber-se),Math.min(o[o.length-1].modified.endLineNumberExclusive+se,i+1));(0,f.zy)(o,((t,i)=>{const n=new F.z(t?t.original.endLineNumberExclusive:s.startLineNumber,i?i.original.startLineNumber:s.endLineNumberExclusive),o=new F.z(t?t.modified.endLineNumberExclusive:r.startLineNumber,i?i.modified.startLineNumber:r.endLineNumberExclusive);n.forEach((t=>{e.push(new ue(t,o.startLineNumber+(t-n.startLineNumber)))})),i&&(i.original.forEach((t=>{e.push(new he(i,t))})),i.modified.forEach((t=>{e.push(new ce(i,t))})))}));const d=o[0].modified.join(o[o.length-1].modified),a=o[0].original.join(o[o.length-1].original);n.push(new ae(new B.f0(d,a),e))}return n}var de;(function(e){e[e["Header"]=0]="Header",e[e["Unchanged"]=1]="Unchanged",e[e["Deleted"]=2]="Deleted",e[e["Added"]=3]="Added"})(de||(de={}));class ae{constructor(e,t){this.range=e,this.lines=t}}class le{constructor(){this.type=de.Header}}class he{constructor(e,t){this.diff=e,this.originalLineNumber=t,this.type=de.Deleted,this.modifiedLineNumber=void 0}}class ce{constructor(e,t){this.diff=e,this.modifiedLineNumber=t,this.type=de.Added,this.originalLineNumber=void 0}}class ue{constructor(e,t){this.originalLineNumber=e,this.modifiedLineNumber=t,this.type=de.Unchanged}}let ge=class extends d.JT{constructor(e,t,i,o,s,r){super(),this._element=e,this._model=t,this._width=i,this._height=o,this._editors=s,this._languageService=r,this.domNode=this._element,this.domNode.className="diff-review monaco-editor-background";const l=document.createElement("div");l.className="diff-review-actions",this._actionBar=this._register(new g.o(l)),this._register((0,a.EH)((e=>{this._actionBar.clear(),this._model.canClose.read(e)&&this._actionBar.push(new _.aU("diffreview.close",(0,Q.NC)("label.close","Close"),"close-diff-review "+v.k.asClassName(ie),!0,(()=>X(this,void 0,void 0,(function*(){return t.close()})))),{label:!1,icon:!0})}))),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new m.s$(this._content,{})),(0,n.mc)(this.domNode,this._scrollbar.getDomNode(),l),this._register((0,d.OF)((()=>{(0,n.mc)(this.domNode)}))),this._register(I(this.domNode,{width:this._width,height:this._height})),this._register(I(this._content,{width:this._width,height:this._height})),this._register((0,a.gp)(((e,t)=>{this._model.currentGroup.read(e),this._render(t)}))),this._register((0,n.mu)(this.domNode,"keydown",(e=>{(e.equals(18)||e.equals(2066)||e.equals(530))&&(e.preventDefault(),this._model.goToNextLine()),(e.equals(16)||e.equals(2064)||e.equals(528))&&(e.preventDefault(),this._model.goToPreviousLine()),(e.equals(9)||e.equals(2057)||e.equals(521)||e.equals(1033))&&(e.preventDefault(),this._model.close()),(e.equals(10)||e.equals(3))&&(e.preventDefault(),this._model.revealCurrentElementInEditor())})))}_render(e){const t=this._editors.original.getOptions(),i=this._editors.modified.getOptions(),o=document.createElement("div");o.className="diff-review-table",o.setAttribute("role","list"),o.setAttribute("aria-label",(0,Q.NC)("ariaLabel","Accessible Diff Viewer. Use arrow up and down to navigate.")),(0,C.N)(o,i.get(50)),(0,n.mc)(this._content,o);const s=this._editors.original.getModel(),r=this._editors.modified.getModel();if(!s||!r)return;const d=s.getOptions(),l=r.getOptions(),h=i.get(66),c=this._model.currentGroup.get();for(const u of(null===c||void 0===c?void 0:c.lines)||[]){if(!c)break;let g;if(u.type===de.Header){const e=document.createElement("div");e.className="diff-review-row",e.setAttribute("role","listitem");const t=c.range,i=this._model.currentGroupIndex.get(),n=this._model.groups.get().length,o=e=>0===e?(0,Q.NC)("no_lines_changed","no lines changed"):1===e?(0,Q.NC)("one_line_changed","1 line changed"):(0,Q.NC)("more_lines_changed","{0} lines changed",e),s=o(t.original.length),r=o(t.modified.length);e.setAttribute("aria-label",(0,Q.NC)({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",i+1,n,t.original.startLineNumber,s,t.modified.startLineNumber,r));const d=document.createElement("div");d.className="diff-review-cell diff-review-summary",d.appendChild(document.createTextNode(`${i+1}/${n}: @@ -${t.original.startLineNumber},${t.original.length} +${t.modified.startLineNumber},${t.modified.length} @@`)),e.appendChild(d),g=e}else g=this._createRow(u,h,this._width.get(),t,s,d,i,r,l);o.appendChild(g);const m=(0,a.nK)((e=>this._model.currentElement.read(e)===u));e.add((0,a.EH)((e=>{const t=m.read(e);g.tabIndex=t?0:-1,t&&g.focus()}))),e.add((0,n.nm)(g,"focus",(()=>{this._model.goToLine(u)})))}this._scrollbar.scanDomNode()}_createRow(e,t,i,n,o,s,r,d,a){const l=n.get(143),h=l.glyphMarginWidth+l.lineNumbersWidth,c=r.get(143),u=10+c.glyphMarginWidth+c.lineNumbersWidth;let g="diff-review-row",m="";const _="diff-review-spacer";let f=null;switch(e.type){case de.Added:g="diff-review-row line-insert",m=" char-insert",f=ee;break;case de.Deleted:g="diff-review-row line-delete",m=" char-delete",f=te;break}const p=document.createElement("div");p.style.minWidth=i+"px",p.className=g,p.setAttribute("role","listitem"),p.ariaLevel="";const C=document.createElement("div");C.className="diff-review-cell",C.style.height=`${t}px`,p.appendChild(C);const w=document.createElement("span");w.style.width=h+"px",w.style.minWidth=h+"px",w.className="diff-review-line-number"+m,void 0!==e.originalLineNumber?w.appendChild(document.createTextNode(String(e.originalLineNumber))):w.innerText=" ",C.appendChild(w);const b=document.createElement("span");b.style.width=u+"px",b.style.minWidth=u+"px",b.style.paddingRight="10px",b.className="diff-review-line-number"+m,void 0!==e.modifiedLineNumber?b.appendChild(document.createTextNode(String(e.modifiedLineNumber))):b.innerText=" ",C.appendChild(b);const D=document.createElement("span");if(D.className=_,f){const e=document.createElement("span");e.className=v.k.asClassName(f),e.innerText="  ",D.appendChild(e)}else D.innerText="  ";let L;if(C.appendChild(D),void 0!==e.modifiedLineNumber){let t=this._getLineHtml(d,r,a.tabSize,e.modifiedLineNumber,this._languageService.languageIdCodec);ne._ttPolicy&&(t=ne._ttPolicy.createHTML(t)),C.insertAdjacentHTML("beforeend",t),L=d.getLineContent(e.modifiedLineNumber)}else{let t=this._getLineHtml(o,n,s.tabSize,e.originalLineNumber,this._languageService.languageIdCodec);ne._ttPolicy&&(t=ne._ttPolicy.createHTML(t)),C.insertAdjacentHTML("beforeend",t),L=o.getLineContent(e.originalLineNumber)}0===L.length&&(L=(0,Q.NC)("blankLine","blank"));let y="";switch(e.type){case de.Unchanged:y=e.originalLineNumber===e.modifiedLineNumber?(0,Q.NC)({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",L,e.originalLineNumber):(0,Q.NC)("equalLine","{0} original line {1} modified line {2}",L,e.originalLineNumber,e.modifiedLineNumber);break;case de.Added:y=(0,Q.NC)("insertLine","+ {0} modified line {1}",L,e.modifiedLineNumber);break;case de.Deleted:y=(0,Q.NC)("deleteLine","- {0} original line {1}",L,e.originalLineNumber);break}return p.setAttribute("aria-label",y),p}_getLineHtml(e,t,i,n,o){const s=e.getLineContent(n),r=t.get(50),d=z.A.createEmpty(s,o),a=j.wA.isBasicASCII(s,e.mightContainNonBasicASCII()),l=j.wA.containsRTL(s,a,e.mightContainRTL()),h=(0,Z.tF)(new Z.IJ(r.isMonospace&&!t.get(33),r.canUseHalfwidthRightwardsArrow,s,!1,a,l,0,d,[],i,0,r.spaceWidth,r.middotWidth,r.wsmiddotWidth,t.get(116),t.get(98),t.get(93),t.get(51)!==W.n0.OFF,null));return h.html}};ge=J([Y(5,K.O)],ge);var me=i(81478),_e=i(16375);const fe=(0,q.q5)("diff-insert",p.l.add,(0,Q.NC)("diffInsertIcon","Line decoration for inserts in the diff editor.")),pe=(0,q.q5)("diff-remove",p.l.remove,(0,Q.NC)("diffRemoveIcon","Line decoration for removals in the diff editor.")),ve=_e.qx.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+v.k.asClassName(fe),marginClassName:"gutter-insert"}),Ce=_e.qx.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+v.k.asClassName(pe),marginClassName:"gutter-delete"}),we=_e.qx.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),be=_e.qx.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),De=_e.qx.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),Le=_e.qx.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),ye=_e.qx.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),Se=_e.qx.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),Ne=_e.qx.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),Me=_e.qx.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"}),Ee=_e.qx.register({description:"diff-editor-arrow-revert-change",glyphMarginHoverMessage:new me.W5(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown((0,Q.NC)("revertChangeHoverMessage","Click to revert change")),glyphMarginClassName:"arrow-revert-change "+v.k.asClassName(p.l.arrowRight),zIndex:10001});class Re extends d.JT{constructor(e,t,i,n,o){super(),this._rootElement=e,this._diffModel=t,this._originalEditorLayoutInfo=i,this._modifiedEditorLayoutInfo=n,this._editors=o,this._originalScrollTop=(0,a.rD)(this._editors.original.onDidScrollChange,(()=>this._editors.original.getScrollTop())),this._modifiedScrollTop=(0,a.rD)(this._editors.modified.onDidScrollChange,(()=>this._editors.modified.getScrollTop())),this._viewZonesChanged=(0,a.aq)("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this.width=(0,a.uh)(this,0),this._modifiedViewZonesChangedSignal=(0,a.aq)("modified.onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this._originalViewZonesChangedSignal=(0,a.aq)("original.onDidChangeViewZones",this._editors.original.onDidChangeViewZones),this._state=(0,a.Be)(((e,t)=>{var i;this._element.replaceChildren();const n=this._diffModel.read(e),o=null===(i=null===n||void 0===n?void 0:n.diff.read(e))||void 0===i?void 0:i.movedTexts;if(!o||0===o.length)return void this.width.set(0,void 0);this._viewZonesChanged.read(e);const s=this._originalEditorLayoutInfo.read(e),r=this._modifiedEditorLayoutInfo.read(e);if(!s||!r)return void this.width.set(0,void 0);this._modifiedViewZonesChangedSignal.read(e),this._originalViewZonesChangedSignal.read(e);const d=o.map((t=>{function i(e,t){const i=t.getTopForLineNumber(e.startLineNumber,!0),n=t.getTopForLineNumber(e.endLineNumberExclusive,!0);return(i+n)/2}const n=i(t.lineRangeMapping.original,this._editors.original),o=this._originalScrollTop.read(e),s=i(t.lineRangeMapping.modified,this._editors.modified),r=this._modifiedScrollTop.read(e),d=n-o,a=s-r,l=Math.min(n,s),h=Math.max(n,s);return{range:new H.q(l,h),from:d,to:a,fromWithoutScroll:n,toWithoutScroll:s,move:t}}));d.sort((0,f.f_)((0,f.tT)((e=>e.fromWithoutScroll>e.toWithoutScroll),f.nW),(0,f.tT)((e=>e.fromWithoutScroll>e.toWithoutScroll?e.fromWithoutScroll:-e.toWithoutScroll),f.fv)));const l=Te.compute(d.map((e=>e.range))),h=10,c=s.verticalScrollbarWidth,u=10*(l.getTrackCount()-1)+2*h,g=c+u+(r.contentLeft-Re.movedCodeBlockPadding);let m=0;for(const _ of d){const e=l.getTrack(m),i=c+h+10*e,o=15,s=15,d=g,u=r.glyphMarginWidth+r.lineNumbersWidth,f=18,p=document.createElementNS("http://www.w3.org/2000/svg","rect");p.classList.add("arrow-rectangle"),p.setAttribute("x",""+(d-u)),p.setAttribute("y",""+(_.to-f/2)),p.setAttribute("width",`${u}`),p.setAttribute("height",`${f}`),this._element.appendChild(p);const v=document.createElementNS("http://www.w3.org/2000/svg","g"),C=document.createElementNS("http://www.w3.org/2000/svg","path");C.setAttribute("d",`M 0 ${_.from} L ${i} ${_.from} L ${i} ${_.to} L ${d-s} ${_.to}`),C.setAttribute("fill","none"),v.appendChild(C);const w=document.createElementNS("http://www.w3.org/2000/svg","polygon");w.classList.add("arrow"),t.add((0,a.EH)((e=>{C.classList.toggle("currentMove",_.move===n.activeMovedText.read(e)),w.classList.toggle("currentMove",_.move===n.activeMovedText.read(e))}))),w.setAttribute("points",`${d-s},${_.to-o/2} ${d},${_.to} ${d-s},${_.to+o/2}`),v.appendChild(w),this._element.appendChild(v),m++}this.width.set(u,void 0)})),this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(this._element),this._register((0,d.OF)((()=>this._element.remove()))),this._register((0,a.EH)((e=>{const t=this._originalEditorLayoutInfo.read(e),i=this._modifiedEditorLayoutInfo.read(e);t&&i&&(this._element.style.left=t.width-t.verticalScrollbarWidth+"px",this._element.style.height=`${t.height}px`,this._element.style.width=`${t.verticalScrollbarWidth+t.contentLeft-Re.movedCodeBlockPadding+this.width.read(e)}px`)}))),this._register((0,a.jx)(this._state));const s=(0,a.nK)((e=>{const t=this._diffModel.read(e),i=null===t||void 0===t?void 0:t.diff.read(e);return i?i.movedTexts.map((e=>({move:e,original:new T((0,a.Dz)(e.lineRangeMapping.original.startLineNumber-1),18),modified:new T((0,a.Dz)(e.lineRangeMapping.modified.startLineNumber-1),18)}))):[]}));this._register(V(this._editors.original,s.map((e=>e.map((e=>e.original)))))),this._register(V(this._editors.modified,s.map((e=>e.map((e=>e.modified)))))),this._register((0,a.gp)(((e,t)=>{const i=s.read(e);for(const n of i)t.add(new xe(this._editors.original,n.original,n.move,"original",this._diffModel.get())),t.add(new xe(this._editors.modified,n.modified,n.move,"modified",this._diffModel.get()))})));const r=(0,a.rD)(this._editors.original.onDidChangeCursorPosition,(()=>this._editors.original.getPosition())),l=(0,a.rD)(this._editors.modified.onDidChangeCursorPosition,(()=>this._editors.modified.getPosition())),h=(0,a.aq)("original.onDidFocusEditorWidget",(e=>this._editors.original.onDidFocusEditorWidget((()=>setTimeout((()=>e(void 0)),0))))),c=(0,a.aq)("modified.onDidFocusEditorWidget",(e=>this._editors.modified.onDidFocusEditorWidget((()=>setTimeout((()=>e(void 0)),0)))));let u="modified";this._register((0,a.nJ)({createEmptyChangeSummary:()=>{},handleChange:(e,t)=>(e.didChange(h)&&(u="original"),e.didChange(c)&&(u="modified"),!0)},(e=>{h.read(e),c.read(e);const t=this._diffModel.read(e);if(!t)return;const i=t.diff.read(e);let n;if(i&&"original"===u){const t=r.read(e);t&&(n=i.movedTexts.find((e=>e.lineRangeMapping.original.contains(t.lineNumber))))}if(i&&"modified"===u){const t=l.read(e);t&&(n=i.movedTexts.find((e=>e.lineRangeMapping.modified.contains(t.lineNumber))))}n!==t.movedTextToCompare.get()&&t.movedTextToCompare.set(void 0,void 0),t.setActiveMovedText(n)})))}}Re.movedCodeBlockPadding=4;class Te{static compute(e){const t=[],i=[];for(const n of e){let e=t.findIndex((e=>!e.intersectsStrict(n)));if(-1===e){const i=6;t.length>=i?e=(0,o.tQ)(t,(0,f.tT)((e=>e.intersectWithRangeLength(n)),f.fv)):(e=t.length,t.push(new H.M))}t[e].addRange(n),i.push(e)}return new Te(t.length,i)}constructor(e,t){this._trackCount=e,this.trackPerLineIdx=t}getTrack(e){return this.trackPerLineIdx[e]}getTrackCount(){return this._trackCount}}class xe extends R{constructor(e,t,i,o,s){const r=(0,n.h)("div.diff-hidden-lines-widget");super(e,t,r.root),this._editor=e,this._move=i,this._kind=o,this._diffModel=s,this._nodes=(0,n.h)("div.diff-moved-code-block",{style:{marginRight:"4px"}},[(0,n.h)("div.text-content@textContent"),(0,n.h)("div.action-bar@actionBar")]),r.root.appendChild(this._nodes.root);const d=(0,a.rD)(this._editor.onDidLayoutChange,(()=>this._editor.getLayoutInfo()));let l;this._register(I(this._nodes.root,{paddingRight:d.map((e=>e.verticalScrollbarWidth))})),l=i.changes.length>0?"original"===this._kind?(0,Q.NC)("codeMovedToWithChanges","Code moved with changes to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):(0,Q.NC)("codeMovedFromWithChanges","Code moved with changes from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1):"original"===this._kind?(0,Q.NC)("codeMovedTo","Code moved to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):(0,Q.NC)("codeMovedFrom","Code moved from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1);const h=this._register(new g.o(this._nodes.actionBar,{highlightToggledItems:!0})),c=new _.aU("",l,"",!1);h.push(c,{icon:!1,label:!0});const u=new _.aU("","Compare",v.k.asClassName(p.l.compareChanges),!0,(()=>{this._editor.focus(),this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get()===i?void 0:this._move,void 0)}));this._register((0,a.EH)((e=>{const t=this._diffModel.movedTextToCompare.read(e)===i;u.checked=t}))),h.push(u,{icon:!1,label:!0})}}class Ie extends d.JT{constructor(e,t,i){super(),this._editors=e,this._diffModel=t,this._options=i,this._decorations=(0,a.nK)(this,(e=>{var t;const i=null===(t=this._diffModel.read(e))||void 0===t?void 0:t.diff.read(e);if(!i)return null;const n=this._diffModel.read(e).movedTextToCompare.read(e),o=this._options.renderIndicators.read(e),s=this._options.showEmptyDecorations.read(e),r=[],d=[];if(!n)for(const l of i.mappings){if(l.lineRangeMapping.original.isEmpty||r.push({range:l.lineRangeMapping.original.toInclusiveRange(),options:o?Ce:be}),l.lineRangeMapping.modified.isEmpty||d.push({range:l.lineRangeMapping.modified.toInclusiveRange(),options:o?ve:we}),l.lineRangeMapping.modified.isEmpty||l.lineRangeMapping.original.isEmpty)l.lineRangeMapping.original.isEmpty||r.push({range:l.lineRangeMapping.original.toInclusiveRange(),options:Ne}),l.lineRangeMapping.modified.isEmpty||d.push({range:l.lineRangeMapping.modified.toInclusiveRange(),options:Le});else for(const e of l.lineRangeMapping.innerChanges||[])l.lineRangeMapping.original.contains(e.originalRange.startLineNumber)&&r.push({range:e.originalRange,options:e.originalRange.isEmpty()&&s?Me:Se}),l.lineRangeMapping.modified.contains(e.modifiedRange.startLineNumber)&&d.push({range:e.modifiedRange,options:e.modifiedRange.isEmpty()&&s?ye:De});l.lineRangeMapping.modified.isEmpty||!this._options.shouldRenderRevertArrows.read(e)||n||d.push({range:U.e.fromPositions(new k.L(l.lineRangeMapping.modified.startLineNumber,1)),options:Ee})}if(n)for(const l of n.changes){const e=l.original.toInclusiveRange();e&&r.push({range:e,options:o?Ce:be});const t=l.modified.toInclusiveRange();t&&d.push({range:t,options:o?ve:we});for(const i of l.innerChanges||[])r.push({range:i.originalRange,options:Se}),d.push({range:i.modifiedRange,options:De})}const a=this._diffModel.read(e).activeMovedText.read(e);for(const l of i.movedTexts)r.push({range:l.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal"+(l===a?" currentMove":""),blockPadding:[Re.movedCodeBlockPadding,0,Re.movedCodeBlockPadding,Re.movedCodeBlockPadding]}}),d.push({range:l.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified"+(l===a?" currentMove":""),blockPadding:[4,0,4,4]}});return{originalDecorations:r,modifiedDecorations:d}})),this._register(y(this._editors.original,this._decorations.map((e=>(null===e||void 0===e?void 0:e.originalDecorations)||[])))),this._register(y(this._editors.modified,this._decorations.map((e=>(null===e||void 0===e?void 0:e.modifiedDecorations)||[]))))}}var Pe=i(18612);class Oe extends d.JT{constructor(e,t,i){super(),this._options=e,this._domNode=t,this._dimensions=i,this._sashRatio=(0,a.uh)(this,void 0),this.sashLeft=(0,a.nK)(this,(e=>{var t;const i=null!==(t=this._sashRatio.read(e))&&void 0!==t?t:this._options.splitViewDefaultRatio.read(e);return this._computeSashLeft(i,e)})),this._sash=this._register(new Pe.g(this._domNode,{getVerticalSashTop:e=>0,getVerticalSashLeft:e=>this.sashLeft.get(),getVerticalSashHeight:e=>this._dimensions.height.get()},{orientation:0})),this._startSashPosition=void 0,this._register(this._sash.onDidStart((()=>{this._startSashPosition=this.sashLeft.get()}))),this._register(this._sash.onDidChange((e=>{const t=this._dimensions.width.get(),i=this._computeSashLeft((this._startSashPosition+(e.currentX-e.startX))/t,void 0);this._sashRatio.set(i/t,void 0)}))),this._register(this._sash.onDidEnd((()=>this._sash.layout()))),this._register(this._sash.onDidReset((()=>this._sashRatio.set(void 0,void 0)))),this._register((0,a.EH)((e=>{const t=this._options.enableSplitViewResizing.read(e);this._sash.state=t?3:0,this.sashLeft.read(e),this._dimensions.height.read(e),this._sash.layout()})))}setBoundarySashes(e){this._sash.orthogonalEndSash=e.bottom}_computeSashLeft(e,t){const i=this._dimensions.width.read(t),n=Math.floor(this._options.splitViewDefaultRatio.read(t)*i),o=this._options.enableSplitViewResizing.read(t)?Math.floor(e*i):n,s=100;return i<=2*s?n:o<s?s:o>i-s?i-s:o}}var Ve=i(66426),Ae=i(55455),We=i(39595);class Fe{remove(){var e;null===(e=this.parent)||void 0===e||e.children.delete(this.id)}static findId(e,t){let i;"string"===typeof e?i=`${t.id}/${e}`:(i=`${t.id}/${e.name}`,void 0!==t.children.get(i)&&(i=`${t.id}/${e.name}_${e.range.startLineNumber}_${e.range.startColumn}`));let n=i;for(let o=0;void 0!==t.children.get(n);o++)n=`${i}_${o}`;return n}static empty(e){return 0===e.children.size}}class He extends Fe{constructor(e,t,i){super(),this.id=e,this.parent=t,this.symbol=i,this.children=new Map}}class ke extends Fe{constructor(e,t,i,n){super(),this.id=e,this.parent=t,this.label=i,this.order=n,this.children=new Map}}class Ue extends Fe{static create(e,t,i){const n=new w.A(i),o=new Ue(t.uri),r=e.ordered(t),d=r.map(((e,i)=>{var r;const d=Fe.findId(`provider_${i}`,o),a=new ke(d,o,null!==(r=e.displayName)&&void 0!==r?r:"Unknown Outline Provider",i);return Promise.resolve(e.provideDocumentSymbols(t,n.token)).then((e=>{for(const t of e||[])Ue._makeOutlineElement(t,a);return a}),(e=>((0,s.Cp)(e),a))).then((e=>{Fe.empty(e)?e.remove():o._groups.set(d,e)}))})),a=e.onDidChange((()=>{const i=e.ordered(t);(0,f.fS)(i,r)||n.cancel()}));return Promise.all(d).then((()=>n.token.isCancellationRequested&&!i.isCancellationRequested?Ue.create(e,t,i):o._compact())).finally((()=>{n.dispose(),a.dispose()}))}static _makeOutlineElement(e,t){const i=Fe.findId(e,t),n=new He(i,t,e);if(e.children)for(const o of e.children)Ue._makeOutlineElement(o,n);t.children.set(n.id,n)}constructor(e){super(),this.uri=e,this.id="root",this.parent=void 0,this._groups=new Map,this.children=new Map,this.id="root",this.parent=void 0}_compact(){let e=0;for(const[t,i]of this._groups)0===i.children.size?this._groups.delete(t):e+=1;if(1!==e)this.children=this._groups;else{const e=We.$.first(this._groups.values());for(const[,t]of e.children)t.parent=this,this.children.set(t.id,t)}return this}getTopLevelSymbols(){const e=[];for(const t of this.children.values())t instanceof He?e.push(t.symbol):e.push(...We.$.map(t.children.values(),(e=>e.symbol)));return e.sort(((e,t)=>U.e.compareRangesUsingStarts(e.range,t.range)))}asListOfDocumentSymbols(){const e=this.getTopLevelSymbols(),t=[];return Ue._flattenDocumentSymbols(t,e,""),t.sort(((e,t)=>k.L.compare(U.e.getStartPosition(e.range),U.e.getStartPosition(t.range))||k.L.compare(U.e.getEndPosition(t.range),U.e.getEndPosition(e.range))))}static _flattenDocumentSymbols(e,t,i){for(const n of t)e.push({kind:n.kind,tags:n.tags,name:n.name,detail:n.detail,containerName:n.containerName||i,range:n.range,selectionRange:n.selectionRange,children:void 0}),n.children&&Ue._flattenDocumentSymbols(e,n.children,n.name)}}var Be=i(67026),Ke=i(16458),ze=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},Ze=function(e,t){return function(i,n){t(i,n,e)}},je=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function d(e){try{a(n["throw"](e))}catch(t){s(t)}}function a(e){e.done?i(e.value):o(e.value).then(r,d)}a((n=n.apply(e,t||[])).next())}))};let Qe=class extends d.JT{get isUpdatingViewZones(){return this._isUpdatingViewZones}constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._languageFeaturesService=n,this._isUpdatingViewZones=!1,this._modifiedOutlineSource=(0,a.Be)(this,((e,t)=>{const i=this._editors.modifiedModel.read(e);if(i)return t.add(new $e(this._languageFeaturesService,i))})),this._register(this._editors.original.onDidChangeCursorPosition((e=>{if(3===e.reason){const e=this._diffModel.get();(0,a.PS)((t=>{for(const i of this._editors.original.getSelections()||[])null===e||void 0===e||e.ensureOriginalLineIsVisible(i.getStartPosition().lineNumber,t),null===e||void 0===e||e.ensureOriginalLineIsVisible(i.getEndPosition().lineNumber,t)}))}}))),this._register(this._editors.modified.onDidChangeCursorPosition((e=>{if(3===e.reason){const e=this._diffModel.get();(0,a.PS)((t=>{for(const i of this._editors.modified.getSelections()||[])null===e||void 0===e||e.ensureModifiedLineIsVisible(i.getStartPosition().lineNumber,t),null===e||void 0===e||e.ensureModifiedLineIsVisible(i.getEndPosition().lineNumber,t)}))}})));const o=this._diffModel.map(((e,t)=>{var i,n;return 0===(null===(i=null===e||void 0===e?void 0:e.diff.read(t))||void 0===i?void 0:i.mappings.length)?[]:null!==(n=null===e||void 0===e?void 0:e.unchangedRegions.read(t))&&void 0!==n?n:[]})),s=(0,a.Be)(this,((e,t)=>{const i=this._modifiedOutlineSource.read(e);if(!i)return{origViewZones:[],modViewZones:[]};const n=[],s=[],r=this._options.renderSideBySide.read(e),d=o.read(e);for(const o of d)if(!o.shouldHideControls(e)){{const e=(0,a.nK)((e=>o.getHiddenOriginalRange(e).startLineNumber-1)),s=new T(e,24);n.push(s),t.add(new Ge(this._editors.original,s,o,o.originalUnchangedRange,!r,i,(e=>this._diffModel.get().ensureModifiedLineIsVisible(e,void 0)),this._options))}{const e=(0,a.nK)((e=>o.getHiddenModifiedRange(e).startLineNumber-1)),n=new T(e,24);s.push(n),t.add(new Ge(this._editors.modified,n,o,o.modifiedUnchangedRange,!1,i,(e=>this._diffModel.get().ensureModifiedLineIsVisible(e,void 0)),this._options))}}return{origViewZones:n,modViewZones:s}})),r={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},d={description:"Fold Unchanged",glyphMarginHoverMessage:new me.W5(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown((0,Q.NC)("foldUnchanged","Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+v.k.asClassName(p.l.fold),zIndex:10001};this._register(y(this._editors.original,(0,a.nK)((e=>{const t=o.read(e),i=t.map((e=>({range:e.originalUnchangedRange.toInclusiveRange(),options:r})));for(const n of t)n.shouldHideControls(e)&&i.push({range:U.e.fromPositions(new k.L(n.originalLineNumber,1)),options:d});return i})))),this._register(y(this._editors.modified,(0,a.nK)((e=>{const t=o.read(e),i=t.map((e=>({range:e.modifiedUnchangedRange.toInclusiveRange(),options:r})));for(const n of t)n.shouldHideControls(e)&&i.push({range:F.z.ofLength(n.modifiedLineNumber,1).toInclusiveRange(),options:d});return i})))),this._register(V(this._editors.original,s.map((e=>e.origViewZones)),(e=>this._isUpdatingViewZones=e))),this._register(V(this._editors.modified,s.map((e=>e.modViewZones)),(e=>this._isUpdatingViewZones=e))),this._register((0,a.EH)((e=>{const t=o.read(e);this._editors.original.setHiddenAreas(t.map((t=>t.getHiddenOriginalRange(e).toInclusiveRange())).filter(Ae.$K)),this._editors.modified.setHiddenAreas(t.map((t=>t.getHiddenModifiedRange(e).toInclusiveRange())).filter(Ae.$K))}))),this._register(this._editors.modified.onMouseUp((e=>{var t;if(!e.event.rightButton&&e.target.position&&(null===(t=e.target.element)||void 0===t?void 0:t.className.includes("fold-unchanged"))){const t=e.target.position.lineNumber,i=this._diffModel.get();if(!i)return;const n=i.unchangedRegions.get().find((e=>e.modifiedUnchangedRange.includes(t)));if(!n)return;n.collapseAll(void 0),e.event.stopPropagation(),e.event.preventDefault()}}))),this._register(this._editors.original.onMouseUp((e=>{var t;if(!e.event.rightButton&&e.target.position&&(null===(t=e.target.element)||void 0===t?void 0:t.className.includes("fold-unchanged"))){const t=e.target.position.lineNumber,i=this._diffModel.get();if(!i)return;const n=i.unchangedRegions.get().find((e=>e.originalUnchangedRange.includes(t)));if(!n)return;n.collapseAll(void 0),e.event.stopPropagation(),e.event.preventDefault()}})))}};Qe=ze([Ze(3,Ke.p)],Qe);let $e=class extends d.JT{constructor(e,t){super(),this._languageFeaturesService=e,this._textModel=t,this._currentModel=(0,a.uh)(this,void 0);const i=(0,a.aq)("documentSymbolProvider.onDidChange",this._languageFeaturesService.documentSymbolProvider.onDidChange),n=(0,a.aq)("_textModel.onDidChangeContent",r.ju.debounce((e=>this._textModel.onDidChangeContent(e)),(()=>{}),100));this._register((0,a.gp)(((e,t)=>je(this,void 0,void 0,(function*(){i.read(e),n.read(e);const o=t.add(new A),s=yield Ue.create(this._languageFeaturesService.documentSymbolProvider,this._textModel,o.token);t.isDisposed||this._currentModel.set(s,void 0)})))))}getBreadcrumbItems(e,t){const i=this._currentModel.read(t);if(!i)return[];const n=i.asListOfDocumentSymbols().filter((t=>e.contains(t.range.startLineNumber)&&!e.contains(t.range.endLineNumber)));return n.sort((0,f.BV)((0,f.tT)((e=>e.range.endLineNumber-e.range.startLineNumber),f.fv))),n.map((e=>({name:e.name,kind:e.kind,startLineNumber:e.range.startLineNumber})))}};$e=ze([Ze(0,Ke.p)],$e);class Ge extends R{constructor(e,t,i,o,s,r,d,l){const h=(0,n.h)("div.diff-hidden-lines-widget");super(e,t,h.root),this._editor=e,this._unchangedRegion=i,this._unchangedRegionRange=o,this.hide=s,this._modifiedOutlineSource=r,this._revealModifiedHiddenLine=d,this._options=l,this._nodes=(0,n.h)("div.diff-hidden-lines",[(0,n.h)("div.top@top",{title:(0,Q.NC)("diff.hiddenLines.top","Click or drag to show more above")}),(0,n.h)("div.center@content",{style:{display:"flex"}},[(0,n.h)("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0"}},[(0,n.$)("a",{title:(0,Q.NC)("showAll","Show all"),role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...(0,Ve.T)("$(unfold)"))]),(0,n.h)("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),(0,n.h)("div.bottom@bottom",{title:(0,Q.NC)("diff.bottom","Click or drag to show more below"),role:"button"})]),h.root.appendChild(this._nodes.root);const c=(0,a.rD)(this._editor.onDidLayoutChange,(()=>this._editor.getLayoutInfo()));this.hide?(0,n.mc)(this._nodes.first):this._register(I(this._nodes.first,{width:c.map((e=>e.contentLeft))}));const u=this._editor;this._register((0,n.nm)(this._nodes.top,"mousedown",(e=>{if(0!==e.button)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),e.preventDefault();const t=e.clientY;let i=!1;const o=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set(!0,void 0);const s=(0,n.nm)(window,"mousemove",(e=>{const n=e.clientY,s=n-t;i=i||Math.abs(s)>2;const r=Math.round(s/u.getOption(66)),d=Math.max(0,Math.min(o+r,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(d,void 0)})),r=(0,n.nm)(window,"mouseup",(e=>{i||this._unchangedRegion.showMoreAbove(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(!1,void 0),s.dispose(),r.dispose()}))}))),this._register((0,n.nm)(this._nodes.bottom,"mousedown",(e=>{if(0!==e.button)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),e.preventDefault();const t=e.clientY;let i=!1;const o=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set(!0,void 0);const s=(0,n.nm)(window,"mousemove",(e=>{const n=e.clientY,s=n-t;i=i||Math.abs(s)>2;const r=Math.round(s/u.getOption(66)),d=Math.max(0,Math.min(o-r,this._unchangedRegion.getMaxVisibleLineCountBottom())),a=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(d,void 0);const l=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);u.setScrollTop(u.getScrollTop()+(l-a))})),r=(0,n.nm)(window,"mouseup",(e=>{if(this._unchangedRegion.isDragged.set(!1,void 0),!i){const e=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0);const t=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);u.setScrollTop(u.getScrollTop()+(t-e))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),s.dispose(),r.dispose()}))}))),this._register((0,a.EH)((e=>{const t=[];if(!this.hide){const o=i.getHiddenModifiedRange(e).length,s=(0,Q.NC)("hiddenLines","{0} hidden lines",o),r=(0,n.$)("span",{title:(0,Q.NC)("diff.hiddenLines.expandAll","Double click to unfold")},s);r.addEventListener("dblclick",(e=>{0===e.button&&(e.preventDefault(),this._unchangedRegion.showAll(void 0))})),t.push(r);const d=this._unchangedRegion.getHiddenModifiedRange(e),a=this._modifiedOutlineSource.getBreadcrumbItems(d,e);if(a.length>0){t.push((0,n.$)("span",void 0,"  |  "));for(let e=0;e<a.length;e++){const i=a[e],o=Be.uZ.toIcon(i.kind),s=(0,n.h)("div.breadcrumb-item",{style:{display:"flex",alignItems:"center"}},[(0,Ve.h)(o)," ",i.name,...e===a.length-1?[]:[(0,Ve.h)(p.l.chevronRight)]]).root;t.push(s),s.onclick=()=>{this._revealModifiedHiddenLine(i.startLineNumber)}}}}(0,n.mc)(this._nodes.others,...t)})))}}var qe,Je=i(85398),Ye=i(95402),Xe=i(96729),et=i(52473),tt=i(38857),it=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},nt=function(e,t){return function(i,n){t(i,n,e)}},ot=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function d(e){try{a(n["throw"](e))}catch(t){s(t)}}function a(e){e.done?i(e.value):o(e.value).then(r,d)}a((n=n.apply(e,t||[])).next())}))};let st=qe=class{constructor(e,t,i){this.editorWorkerService=t,this.telemetryService=i,this.onDidChangeEventEmitter=new r.Q5,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(e)}dispose(){var e;null===(e=this.diffAlgorithmOnDidChangeSubscription)||void 0===e||e.dispose()}computeDiff(e,t,i,n){var o,s;return ot(this,void 0,void 0,(function*(){if("string"!==typeof this.diffAlgorithm)return this.diffAlgorithm.computeDiff(e,t,i,n);if(1===e.getLineCount()&&1===e.getLineMaxColumn(1))return 1===t.getLineCount()&&1===t.getLineMaxColumn(1)?{changes:[],identical:!0,quitEarly:!1,moves:[]}:{changes:[new B.gB(new F.z(1,2),new F.z(1,t.getLineCount()+1),[new B.iy(e.getFullModelRange(),t.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};const r=JSON.stringify([e.uri.toString(),t.uri.toString()]),d=JSON.stringify([e.id,t.id,e.getAlternativeVersionId(),t.getAlternativeVersionId(),JSON.stringify(i)]),a=qe.diffCache.get(r);if(a&&a.context===d)return a.result;const l=Xe.G.create(),h=yield this.editorWorkerService.computeDiff(e.uri,t.uri,i,this.diffAlgorithm),c=l.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:c,timedOut:null===(o=null===h||void 0===h?void 0:h.quitEarly)||void 0===o||o,detectedMoves:i.computeMoves?null!==(s=null===h||void 0===h?void 0:h.moves.length)&&void 0!==s?s:0:-1}),n.isCancellationRequested)return{changes:[],identical:!1,quitEarly:!0,moves:[]};if(!h)throw new Error("no diff result available");return qe.diffCache.size>10&&qe.diffCache.delete(qe.diffCache.keys().next().value),qe.diffCache.set(r,{result:h,context:d}),h}))}setOptions(e){var t;let i=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&(null===(t=this.diffAlgorithmOnDidChangeSubscription)||void 0===t||t.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,"string"!==typeof e.diffAlgorithm&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange((()=>this.onDidChangeEventEmitter.fire()))),i=!0),i&&this.onDidChangeEventEmitter.fire()}};st.diffCache=new Map,st=qe=it([nt(1,et.p),nt(2,tt.b)],st);var rt=i(39326),dt=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},at=function(e,t){return function(i,n){t(i,n,e)}};const lt=(0,G.yh)("diffProviderFactoryService");let ht=class{constructor(e){this.instantiationService=e}createDiffProvider(e,t){return this.instantiationService.createInstance(st,t)}};ht=dt([at(0,G.TG)],ht),(0,rt.z)(lt,ht,1);var ct=i(17162),ut=i(2371),gt=i(81452),mt=i(33496),_t=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},ft=function(e,t){return function(i,n){t(i,n,e)}},pt=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function d(e){try{a(n["throw"](e))}catch(t){s(t)}}function a(e){e.done?i(e.value):o(e.value).then(r,d)}a((n=n.apply(e,t||[])).next())}))};let vt=class extends d.JT{setActiveMovedText(e){this._activeMovedText.set(e,void 0)}constructor(e,t,i,n){super(),this.model=e,this._options=t,this._editor=i,this._diffProviderFactoryService=n,this._isDiffUpToDate=(0,a.uh)(this,!1),this.isDiffUpToDate=this._isDiffUpToDate,this._diff=(0,a.uh)(this,void 0),this.diff=this._diff,this._unchangedRegions=(0,a.uh)(this,{regions:[],originalDecorationIds:[],modifiedDecorationIds:[]}),this.unchangedRegions=(0,a.nK)(this,(e=>this._options.hideUnchangedRegions.read(e)?this._unchangedRegions.read(e).regions:((0,a.PS)((e=>{for(const t of this._unchangedRegions.get().regions)t.collapseAll(e)})),[]))),this.movedTextToCompare=(0,a.uh)(this,void 0),this._activeMovedText=(0,a.uh)(this,void 0),this._hoveredMovedText=(0,a.uh)(this,void 0),this.activeMovedText=(0,a.nK)(this,(e=>{var t,i;return null!==(i=null!==(t=this.movedTextToCompare.read(e))&&void 0!==t?t:this._hoveredMovedText.read(e))&&void 0!==i?i:this._activeMovedText.read(e)})),this._cancellationTokenSource=new w.A,this._diffProvider=(0,a.nK)(this,(e=>{const t=this._diffProviderFactoryService.createDiffProvider(this._editor,{diffAlgorithm:this._options.diffAlgorithm.read(e)}),i=(0,a.aq)("onDidChange",t.onDidChange);return{diffProvider:t,onChangeSignal:i}})),this._register((0,d.OF)((()=>this._cancellationTokenSource.cancel())));const o=(0,a.GN)("contentChangedSignal"),s=this._register(new Je.pY((()=>o.trigger(void 0)),200)),r=(t,i,n)=>{const o=Lt.fromDiffs(t.changes,e.original.getLineCount(),e.modified.getLineCount(),this._options.hideUnchangedRegionsMinimumLineCount.read(n),this._options.hideUnchangedRegionsContextLineCount.read(n)),s=this._unchangedRegions.get(),r=s.originalDecorationIds.map((t=>e.original.getDecorationRange(t))).filter((e=>!!e)).map((e=>F.z.fromRange(e))),d=s.modifiedDecorationIds.map((t=>e.modified.getDecorationRange(t))).filter((e=>!!e)).map((e=>F.z.fromRange(e))),a=e.original.deltaDecorations(s.originalDecorationIds,o.map((e=>({range:e.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})))),l=e.modified.deltaDecorations(s.modifiedDecorationIds,o.map((e=>({range:e.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))));for(const e of o)for(let t=0;t<s.regions.length;t++)if(e.originalUnchangedRange.intersectsStrict(r[t])&&e.modifiedUnchangedRange.intersectsStrict(d[t])){e.setHiddenModifiedRange(s.regions[t].getHiddenModifiedRange(void 0),i);break}this._unchangedRegions.set({regions:o,originalDecorationIds:a,modifiedDecorationIds:l},i)};this._register(e.modified.onDidChangeContent((t=>{const i=this._diff.get();if(i){const i=ut.Q.fromModelContentChanges(t.changes),n=St(this._lastDiff,i,e.original,e.modified);n&&(this._lastDiff=n,(0,a.PS)((e=>{this._diff.set(bt.fromDiffResult(this._lastDiff),e),r(n,e);const t=this.movedTextToCompare.get();this.movedTextToCompare.set(t?this._lastDiff.moves.find((e=>e.lineRangeMapping.modified.intersect(t.lineRangeMapping.modified))):void 0,e)})))}s.schedule()}))),this._register(e.original.onDidChangeContent((t=>{const i=this._diff.get();if(i){const i=ut.Q.fromModelContentChanges(t.changes),n=yt(this._lastDiff,i,e.original,e.modified);n&&(this._lastDiff=n,(0,a.PS)((e=>{this._diff.set(bt.fromDiffResult(this._lastDiff),e),r(n,e);const t=this.movedTextToCompare.get();this.movedTextToCompare.set(t?this._lastDiff.moves.find((e=>e.lineRangeMapping.modified.intersect(t.lineRangeMapping.modified))):void 0,e)})))}s.schedule()}))),this._register((0,a.gp)(((t,i)=>pt(this,void 0,void 0,(function*(){var n,d;this._options.hideUnchangedRegionsMinimumLineCount.read(t),this._options.hideUnchangedRegionsContextLineCount.read(t),s.cancel(),o.read(t);const l=this._diffProvider.read(t);l.onChangeSignal.read(t),P(ct.DW,t),P(mt.xG,t),this._isDiffUpToDate.set(!1,void 0);let h=[];i.add(e.original.onDidChangeContent((e=>{const t=ut.Q.fromModelContentChanges(e.changes);h=(0,gt.o)(h,t)})));let c=[];i.add(e.modified.onDidChangeContent((e=>{const t=ut.Q.fromModelContentChanges(e.changes);c=(0,gt.o)(c,t)})));let u=yield l.diffProvider.computeDiff(e.original,e.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(t),maxComputationTimeMs:this._options.maxComputationTimeMs.read(t),computeMoves:this._options.showMoves.read(t)},this._cancellationTokenSource.token);this._cancellationTokenSource.token.isCancellationRequested||(u=Ct(u,e.original,e.modified),u=null!==(n=yt(u,h,e.original,e.modified))&&void 0!==n?n:u,u=null!==(d=St(u,c,e.original,e.modified))&&void 0!==d?d:u,(0,a.PS)((e=>{r(u,e),this._lastDiff=u;const t=bt.fromDiffResult(u);this._diff.set(t,e),this._isDiffUpToDate.set(!0,e);const i=this.movedTextToCompare.get();this.movedTextToCompare.set(i?this._lastDiff.moves.find((e=>e.lineRangeMapping.modified.intersect(i.lineRangeMapping.modified))):void 0,e)})))})))))}ensureModifiedLineIsVisible(e,t){var i;if(0===(null===(i=this.diff.get())||void 0===i?void 0:i.mappings.length))return;const n=this._unchangedRegions.get().regions;for(const o of n)if(o.getHiddenModifiedRange(void 0).contains(e))return void o.showModifiedLine(e,t)}ensureOriginalLineIsVisible(e,t){var i;if(0===(null===(i=this.diff.get())||void 0===i?void 0:i.mappings.length))return;const n=this._unchangedRegions.get().regions;for(const o of n)if(o.getHiddenOriginalRange(void 0).contains(e))return void o.showOriginalLine(e,t)}waitForDiff(){return pt(this,void 0,void 0,(function*(){yield(0,a.F_)(this.isDiffUpToDate,(e=>e))}))}serializeState(){const e=this._unchangedRegions.get();return{collapsedRegions:e.regions.map((e=>({range:e.getHiddenModifiedRange(void 0).serialize()})))}}restoreSerializedState(e){const t=e.collapsedRegions.map((e=>F.z.deserialize(e.range))),i=this._unchangedRegions.get();(0,a.PS)((e=>{for(const n of i.regions)for(const i of t)if(n.modifiedUnchangedRange.intersect(i)){n.setHiddenModifiedRange(i,e);break}}))}};function Ct(e,t,i){return{changes:e.changes.map((e=>new B.gB(e.original,e.modified,e.innerChanges?e.innerChanges.map((e=>wt(e,t,i))):void 0))),moves:e.moves,identical:e.identical,quitEarly:e.quitEarly}}function wt(e,t,i){let n=e.originalRange,o=e.modifiedRange;return(1!==n.endColumn||1!==o.endColumn)&&n.endColumn===t.getLineMaxColumn(n.endLineNumber)&&o.endColumn===i.getLineMaxColumn(o.endLineNumber)&&n.endLineNumber<t.getLineCount()&&o.endLineNumber<i.getLineCount()&&(n=n.setEndPosition(n.endLineNumber+1,1),o=o.setEndPosition(o.endLineNumber+1,1)),new B.iy(n,o)}vt=_t([ft(3,lt)],vt);class bt{static fromDiffResult(e){return new bt(e.changes.map((e=>new Dt(e))),e.moves||[],e.identical,e.quitEarly)}constructor(e,t,i,n){this.mappings=e,this.movedTexts=t,this.identical=i,this.quitEarly=n}}class Dt{constructor(e){this.lineRangeMapping=e}}class Lt{static fromDiffs(e,t,i,n,o){const s=B.gB.inverse(e,t,i),r=[];for(const d of s){let e=d.original.startLineNumber,s=d.modified.startLineNumber,a=d.original.length;const l=1===e&&1===s,h=e+a===t+1&&s+a===i+1;(l||h)&&a>=o+n?(l&&!h&&(a-=o),h&&!l&&(e+=o,s+=o,a-=o),r.push(new Lt(e,s,a,0,0))):a>=2*o+n&&(e+=o,s+=o,a-=2*o,r.push(new Lt(e,s,a,0,0)))}return r}get originalUnchangedRange(){return F.z.ofLength(this.originalLineNumber,this.lineCount)}get modifiedUnchangedRange(){return F.z.ofLength(this.modifiedLineNumber,this.lineCount)}constructor(e,t,i,n,o){this.originalLineNumber=e,this.modifiedLineNumber=t,this.lineCount=i,this._visibleLineCountTop=(0,a.uh)(this,0),this.visibleLineCountTop=this._visibleLineCountTop,this._visibleLineCountBottom=(0,a.uh)(this,0),this.visibleLineCountBottom=this._visibleLineCountBottom,this._shouldHideControls=(0,a.nK)(this,(e=>this.visibleLineCountTop.read(e)+this.visibleLineCountBottom.read(e)===this.lineCount&&!this.isDragged.read(e))),this.isDragged=(0,a.uh)(this,!1),this._visibleLineCountTop.set(n,void 0),this._visibleLineCountBottom.set(o,void 0)}shouldHideControls(e){return this._shouldHideControls.read(e)}getHiddenOriginalRange(e){return F.z.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}getHiddenModifiedRange(e){return F.z.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}setHiddenModifiedRange(e,t){const i=e.startLineNumber-this.modifiedLineNumber,n=this.modifiedLineNumber+this.lineCount-e.endLineNumberExclusive;this.setState(i,n,t)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(e=10,t){const i=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+e,i),t)}showMoreBelow(e=10,t){const i=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+e,i),t)}showAll(e){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),e)}showModifiedLine(e,t){const i=e+1-(this.modifiedLineNumber+this._visibleLineCountTop.get()),n=this.modifiedLineNumber-this._visibleLineCountBottom.get()+this.lineCount-e;i<n?this._visibleLineCountTop.set(this._visibleLineCountTop.get()+i,t):this._visibleLineCountBottom.set(this._visibleLineCountBottom.get()+n,t)}showOriginalLine(e,t){const i=e-this.originalLineNumber,n=this.originalLineNumber+this.lineCount-e;i<n?this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+n-i,this.getMaxVisibleLineCountTop()),t):this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+i-n,this.getMaxVisibleLineCountBottom()),t)}collapseAll(e){this._visibleLineCountTop.set(0,e),this._visibleLineCountBottom.set(0,e)}setState(e,t,i){e=Math.max(Math.min(e,this.lineCount),0),t=Math.max(Math.min(t,this.lineCount-e),0),this._visibleLineCountTop.set(e,i),this._visibleLineCountBottom.set(t,i)}}function yt(e,t,i,n){}function St(e,t,i,n){}var Nt=i(47606),Mt=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,s){function r(e){try{a(n.next(e))}catch(t){s(t)}}function d(e){try{a(n["throw"](e))}catch(t){s(t)}}function a(e){e.done?i(e.value):o(e.value).then(r,d)}a((n=n.apply(e,t||[])).next())}))};class Et extends d.JT{get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}constructor(e,t,i,o,s,r,d,a,l){super(),this._getViewZoneId=e,this._marginDomNode=t,this._modifiedEditor=i,this._diff=o,this._editor=s,this._viewLineCounts=r,this._originalTextModel=d,this._contextMenuService=a,this._clipboardService=l,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=v.k.asClassName(p.l.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const h=this._modifiedEditor.getOption(66);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${h}px`,this._diffActions.style.lineHeight=`${h}px`,this._marginDomNode.appendChild(this._diffActions);let c=0;const u=i.getOption(126)&&!Nt.gn,g=(e,t)=>{var n;this._contextMenuService.showContextMenu({domForShadowRoot:u&&null!==(n=i.getDomNode())&&void 0!==n?n:void 0,getAnchor:()=>({x:e,y:t}),getActions:()=>{const e=[],t=o.modified.isEmpty;e.push(new _.aU("diff.clipboard.copyDeletedContent",t?o.original.length>1?(0,Q.NC)("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):(0,Q.NC)("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):o.original.length>1?(0,Q.NC)("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):(0,Q.NC)("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,(()=>Mt(this,void 0,void 0,(function*(){const e=this._originalTextModel.getValueInRange(o.original.toExclusiveRange());yield this._clipboardService.writeText(e)}))))),o.original.length>1&&e.push(new _.aU("diff.clipboard.copyDeletedLineContent",t?(0,Q.NC)("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",o.original.startLineNumber+c):(0,Q.NC)("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",o.original.startLineNumber+c),void 0,!0,(()=>Mt(this,void 0,void 0,(function*(){let e=this._originalTextModel.getLineContent(o.original.startLineNumber+c);if(""===e){const t=this._originalTextModel.getEndOfLineSequence();e=0===t?"\n":"\r\n"}yield this._clipboardService.writeText(e)})))));const n=i.getOption(90);return n||e.push(new _.aU("diff.inline.revertChange",(0,Q.NC)("diff.inline.revertChange.label","Revert this change"),void 0,!0,(()=>Mt(this,void 0,void 0,(function*(){this._editor.revert(this._diff)}))))),e},autoSelectFirstItem:!0})};this._register((0,n.mu)(this._diffActions,"mousedown",(e=>{const{top:t,height:i}=(0,n.i)(this._diffActions),o=Math.floor(h/3);e.preventDefault(),g(e.posx,t+i+o)}))),this._register(i.onMouseMove((e=>{8!==e.target.type&&5!==e.target.type||e.target.detail.viewZoneId!==this._getViewZoneId()?this.visibility=!1:(c=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,h),this.visibility=!0)}))),this._register(i.onMouseDown((e=>{if(e.event.rightButton&&(8===e.target.type||5===e.target.type)){const t=e.target.detail.viewZoneId;t===this._getViewZoneId()&&(e.event.preventDefault(),c=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,h),g(e.event.posx,e.event.posy+h))}})))}_updateLightBulbPosition(e,t,i){const{top:o}=(0,n.i)(e),s=t-o,r=Math.floor(s/i),d=r*i;if(this._diffActions.style.top=`${d}px`,this._viewLineCounts){let e=0;for(let t=0;t<this._viewLineCounts.length;t++)if(e+=this._viewLineCounts[t],r<e)return t}return r}}var Rt=i(69427),Tt=i(56998);const xt=(0,u.Z)("diffEditorWidget",{createHTML:e=>e});function It(e,t,i,n){(0,C.N)(n,t.fontInfo);const o=i.length>0,s=new Rt.HT(1e4);let r=0,d=0;const a=[];for(let u=0;u<e.lineTokens.length;u++){const n=u+1,l=e.lineTokens[u],h=e.lineBreakData[u],c=Tt.Kp.filter(i,n,1,Number.MAX_SAFE_INTEGER);if(h){let i=0;for(const n of h.breakOffsets){const a=l.sliceAndInflate(i,n,0);r=Math.max(r,Vt(d,a,Tt.Kp.extractWrapped(c,i,n),o,e.mightContainNonBasicASCII,e.mightContainRTL,t,s)),d++,i=n}a.push(h.breakOffsets.length)}else a.push(1),r=Math.max(r,Vt(d,l,c,o,e.mightContainNonBasicASCII,e.mightContainRTL,t,s)),d++}r+=t.scrollBeyondLastColumn;const l=s.build(),h=xt?xt.createHTML(l):l;n.innerHTML=h;const c=r*t.typicalHalfwidthCharacterWidth;return{heightInLines:d,minWidthInPx:c,viewLineCounts:a}}class Pt{constructor(e,t,i,n){this.lineTokens=e,this.lineBreakData=t,this.mightContainNonBasicASCII=i,this.mightContainRTL=n}}class Ot{static fromEditor(e){var t;const i=e.getOptions(),n=i.get(50),o=i.get(143);return new Ot((null===(t=e.getModel())||void 0===t?void 0:t.getOptions().tabSize)||0,n,i.get(33),n.typicalHalfwidthCharacterWidth,i.get(103),i.get(66),o.decorationsWidth,i.get(116),i.get(98),i.get(93),i.get(51))}constructor(e,t,i,n,o,s,r,d,a,l,h){this.tabSize=e,this.fontInfo=t,this.disableMonospaceOptimizations=i,this.typicalHalfwidthCharacterWidth=n,this.scrollBeyondLastColumn=o,this.lineHeight=s,this.lineDecorationsWidth=r,this.stopRenderingLineAfter=d,this.renderWhitespace=a,this.renderControlCharacters=l,this.fontLigatures=h}}function Vt(e,t,i,n,o,s,r,d){d.appendString('<div class="view-line'),n||d.appendString(" char-delete"),d.appendString('" style="top:'),d.appendString(String(e*r.lineHeight)),d.appendString('px;width:1000000px;">');const a=t.getLineContent(),l=j.wA.isBasicASCII(a,o),h=j.wA.containsRTL(a,l,s),c=(0,Z.d1)(new Z.IJ(r.fontInfo.isMonospace&&!r.disableMonospaceOptimizations,r.fontInfo.canUseHalfwidthRightwardsArrow,a,!1,l,h,0,t,i,r.tabSize,0,r.fontInfo.spaceWidth,r.fontInfo.middotWidth,r.fontInfo.wsmiddotWidth,r.stopRenderingLineAfter,r.renderWhitespace,r.renderControlCharacters,r.fontLigatures!==W.n0.OFF,null),d);return d.appendString("</div>"),c.characterMapping.getHorizontalOffset(c.characterMapping.length)}var At=i(2827),Wt=i(93753),Ft=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},Ht=function(e,t){return function(i,n){t(i,n,e)}};let kt=class extends d.JT{constructor(e,t,i,o,s,r,l){super(),this._editors=e,this._diffModel=t,this._options=i,this._diffEditorWidget=o,this._canIgnoreViewZoneUpdateEvent=s,this._clipboardService=r,this._contextMenuService=l,this._originalTopPadding=(0,a.uh)(this,0),this._originalScrollOffset=(0,a.uh)(this,0),this._originalScrollOffsetAnimated=M(this._originalScrollOffset,this._store),this._modifiedTopPadding=(0,a.uh)(this,0),this._modifiedScrollOffset=(0,a.uh)(this,0),this._modifiedScrollOffsetAnimated=M(this._modifiedScrollOffset,this._store);let h=!1;const c=(0,a.uh)("state",0),u=this._register(new Je.pY((()=>{c.set(c.get()+1,void 0)}),0));this._register(this._editors.original.onDidChangeViewZones((e=>{h||this._canIgnoreViewZoneUpdateEvent()||u.schedule()}))),this._register(this._editors.modified.onDidChangeViewZones((e=>{h||this._canIgnoreViewZoneUpdateEvent()||u.schedule()}))),this._register(this._editors.original.onDidChangeConfiguration((e=>{(e.hasChanged(144)||e.hasChanged(66))&&u.schedule()}))),this._register(this._editors.modified.onDidChangeConfiguration((e=>{(e.hasChanged(144)||e.hasChanged(66))&&u.schedule()})));const g=this._diffModel.map((e=>e?(0,a.rD)(e.model.original.onDidChangeTokens,(()=>2===e.model.original.tokenization.backgroundTokenizationState)):void 0)).map(((e,t)=>null===e||void 0===e?void 0:e.read(t))),m=new Set,_=new Set,f=(0,a.nK)((e=>{const t=this._diffModel.read(e),i=null===t||void 0===t?void 0:t.diff.read(e);if(!t||!i)return null;c.read(e);const n=this._options.renderSideBySide.read(e),o=n;return Ut(this._editors.original,this._editors.modified,i.mappings,m,_,o)})),w=(0,a.nK)((e=>{var t;const i=null===(t=this._diffModel.read(e))||void 0===t?void 0:t.movedTextToCompare.read(e);if(!i)return null;c.read(e);const n=i.changes.map((e=>new Dt(e)));return Ut(this._editors.original,this._editors.modified,n,m,_,!0)}));function b(){const e=document.createElement("div");return e.className="diagonal-fill",e}const D=this._register(new d.SL),L=(0,a.nK)((e=>{var t,i,o,s,r,d,a,l;D.clear();const h=f.read(e)||[],c=[],u=[],m=this._modifiedTopPadding.read(e);m>0&&u.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:m,showInHiddenAreas:!0,suppressMouseDown:!0});const _=this._originalTopPadding.read(e);_>0&&c.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:_,showInHiddenAreas:!0,suppressMouseDown:!0});const L=this._options.renderSideBySide.read(e),y=L||null===(t=this._editors.modified._getViewModel())||void 0===t?void 0:t.createLineBreaksComputer();if(y)for(const I of h)if(I.diff)for(let P=I.originalRange.startLineNumber;P<I.originalRange.endLineNumberExclusive;P++)null===y||void 0===y||y.addRequest(this._editors.original.getModel().getLineContent(P),null,null);const S=null!==(i=null===y||void 0===y?void 0:y.finalize())&&void 0!==i?i:[];let N=0;const M=this._editors.modified.getOption(66),E=null===(o=this._diffModel.read(e))||void 0===o?void 0:o.movedTextToCompare.read(e),R=null!==(r=null===(s=this._editors.original.getModel())||void 0===s?void 0:s.mightContainNonBasicASCII())&&void 0!==r&&r,T=null!==(a=null===(d=this._editors.original.getModel())||void 0===d?void 0:d.mightContainRTL())&&void 0!==a&&a,x=Ot.fromEditor(this._editors.modified);for(const O of h)if(O.diff&&!L){if(!O.originalRange.isEmpty){g.read(e);const A=document.createElement("div");A.classList.add("view-lines","line-delete","monaco-mouse-cursor-text");const W=new Pt(O.originalRange.mapToLineArray((e=>this._editors.original.getModel().tokenization.getLineTokens(e))),O.originalRange.mapToLineArray((e=>S[N++])),R,T),F=[];for(const B of O.diff.innerChanges||[])F.push(new j.$t(B.originalRange.delta(-(O.diff.original.startLineNumber-1)),Se.className,0));const H=It(W,x,F,A),k=document.createElement("div");if(k.className="inline-deleted-margin-view-zone",(0,C.N)(k,x.fontInfo),this._options.renderIndicators.read(e))for(let K=0;K<H.heightInLines;K++){const z=document.createElement("div");z.className=`delete-sign ${v.k.asClassName(pe)}`,z.setAttribute("style",`position:absolute;top:${K*M}px;width:${x.lineDecorationsWidth}px;height:${M}px;right:0;`),k.appendChild(z)}let U;D.add(new Et((()=>(0,Ae.cW)(U)),k,this._editors.modified,O.diff,this._diffEditorWidget,H.viewLineCounts,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let Z=0;Z<H.viewLineCounts.length;Z++){const Q=H.viewLineCounts[Z];Q>1&&c.push({afterLineNumber:O.originalRange.startLineNumber+Z,domNode:b(),heightInPx:(Q-1)*M,showInHiddenAreas:!0,suppressMouseDown:!0})}u.push({afterLineNumber:O.modifiedRange.startLineNumber-1,domNode:A,heightInPx:H.heightInLines*M,minWidthInPx:H.minWidthInPx,marginDomNode:k,setZoneId(e){U=e},showInHiddenAreas:!0,suppressMouseDown:!0})}const V=document.createElement("div");V.className="gutter-delete",c.push({afterLineNumber:O.originalRange.endLineNumberExclusive-1,domNode:b(),heightInPx:O.modifiedHeightInPx,marginDomNode:V,showInHiddenAreas:!0,suppressMouseDown:!0})}else{const $=O.modifiedHeightInPx-O.originalHeightInPx;if($>0){if(null===E||void 0===E?void 0:E.lineRangeMapping.original.delta(-1).deltaLength(2).contains(O.originalRange.endLineNumberExclusive-1))continue;c.push({afterLineNumber:O.originalRange.endLineNumberExclusive-1,domNode:b(),heightInPx:$,showInHiddenAreas:!0,suppressMouseDown:!0})}else{if(null===E||void 0===E?void 0:E.lineRangeMapping.modified.delta(-1).deltaLength(2).contains(O.modifiedRange.endLineNumberExclusive-1))continue;function G(){const e=document.createElement("div");return e.className="arrow-revert-change "+v.k.asClassName(p.l.arrowRight),(0,n.$)("div",{},e)}let q;O.diff&&O.diff.modified.isEmpty&&this._options.shouldRenderRevertArrows.read(e)&&(q=G()),u.push({afterLineNumber:O.modifiedRange.endLineNumberExclusive-1,domNode:b(),heightInPx:-$,marginDomNode:q,showInHiddenAreas:!0,suppressMouseDown:!0})}}for(const J of null!==(l=w.read(e))&&void 0!==l?l:[]){if(!(null===E||void 0===E?void 0:E.lineRangeMapping.original.intersect(J.originalRange))||!(null===E||void 0===E?void 0:E.lineRangeMapping.modified.intersect(J.modifiedRange)))continue;const Y=J.modifiedHeightInPx-J.originalHeightInPx;Y>0?c.push({afterLineNumber:J.originalRange.endLineNumberExclusive-1,domNode:b(),heightInPx:Y,showInHiddenAreas:!0,suppressMouseDown:!0}):u.push({afterLineNumber:J.modifiedRange.endLineNumberExclusive-1,domNode:b(),heightInPx:-Y,showInHiddenAreas:!0,suppressMouseDown:!0})}return{orig:c,mod:u}}));this._register((0,a.gp)((e=>{const t=Ye.Z.capture(this._editors.modified),i=L.read(e);h=!0,this._editors.original.changeViewZones((e=>{for(const t of m)e.removeZone(t);m.clear();for(const t of i.orig){const i=e.addZone(t);t.setZoneId&&t.setZoneId(i),m.add(i)}})),this._editors.modified.changeViewZones((e=>{for(const t of _)e.removeZone(t);_.clear();for(const t of i.mod){const i=e.addZone(t);t.setZoneId&&t.setZoneId(i),_.add(i)}})),h=!1,t.restore(this._editors.modified)}))),this._register((0,d.OF)((()=>{this._editors.original.changeViewZones((e=>{for(const t of m)e.removeZone(t);m.clear()})),this._editors.modified.changeViewZones((e=>{for(const t of _)e.removeZone(t);_.clear()}))})));let y=!1;this._register(this._editors.original.onDidScrollChange((e=>{e.scrollLeftChanged&&!y&&(y=!0,this._editors.modified.setScrollLeft(e.scrollLeft),y=!1)}))),this._register(this._editors.modified.onDidScrollChange((e=>{e.scrollLeftChanged&&!y&&(y=!0,this._editors.original.setScrollLeft(e.scrollLeft),y=!1)}))),this._originalScrollTop=(0,a.rD)(this._editors.original.onDidScrollChange,(()=>this._editors.original.getScrollTop())),this._modifiedScrollTop=(0,a.rD)(this._editors.modified.onDidScrollChange,(()=>this._editors.modified.getScrollTop())),this._register((0,a.EH)((e=>{const t=this._originalScrollTop.read(e)-(this._originalScrollOffsetAnimated.get()-this._modifiedScrollOffsetAnimated.read(e))-(this._originalTopPadding.get()-this._modifiedTopPadding.read(e));t!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(t,1)}))),this._register((0,a.EH)((e=>{const t=this._modifiedScrollTop.read(e)-(this._modifiedScrollOffsetAnimated.get()-this._originalScrollOffsetAnimated.read(e))-(this._modifiedTopPadding.get()-this._originalTopPadding.read(e));t!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(t,1)}))),this._register((0,a.EH)((e=>{var t;const i=null===(t=this._diffModel.read(e))||void 0===t?void 0:t.movedTextToCompare.read(e);let n=0;if(i){const e=this._editors.original.getTopForLineNumber(i.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.get(),t=this._editors.modified.getTopForLineNumber(i.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.get();n=t-e}n>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(n,void 0)):n<0?(this._modifiedTopPadding.set(-n,void 0),this._originalTopPadding.set(0,void 0)):setTimeout((()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)}),400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.get()-n,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.get()+n,void 0,!0)})))}};function Ut(e,t,i,n,o,s){const r=new f.H9(Bt(e,n)),d=new f.H9(Bt(t,o)),a=e.getOption(66),l=t.getOption(66),h=[];let c=0,u=0;function g(e,t){while(1){let i=r.peek(),n=d.peek();if(i&&i.lineNumber>=e&&(i=void 0),n&&n.lineNumber>=t&&(n=void 0),!i&&!n)break;const o=i?i.lineNumber-c:Number.MAX_VALUE,s=n?n.lineNumber-u:Number.MAX_VALUE;o<s?(r.dequeue(),n={lineNumber:i.lineNumber-c+u,heightInPx:0}):o>s?(d.dequeue(),i={lineNumber:n.lineNumber-u+c,heightInPx:0}):(r.dequeue(),d.dequeue()),h.push({originalRange:F.z.ofLength(i.lineNumber,1),modifiedRange:F.z.ofLength(n.lineNumber,1),originalHeightInPx:a+i.heightInPx,modifiedHeightInPx:l+n.heightInPx,diff:void 0})}}for(const m of i){const _=m.lineRangeMapping;g(_.original.startLineNumber,_.modified.startLineNumber);let p=!0,v=_.modified.startLineNumber,C=_.original.startLineNumber;function w(e,t){var i,n,o,s;if(e<C||t<v)return;if(p)p=!1;else if(e===C||t===v)return;const c=new F.z(C,e),u=new F.z(v,t);if(c.isEmpty&&u.isEmpty)return;const g=null!==(n=null===(i=r.takeWhile((t=>t.lineNumber<e)))||void 0===i?void 0:i.reduce(((e,t)=>e+t.heightInPx),0))&&void 0!==n?n:0,_=null!==(s=null===(o=d.takeWhile((e=>e.lineNumber<t)))||void 0===o?void 0:o.reduce(((e,t)=>e+t.heightInPx),0))&&void 0!==s?s:0;h.push({originalRange:c,modifiedRange:u,originalHeightInPx:c.length*a+g,modifiedHeightInPx:u.length*l+_,diff:m.lineRangeMapping}),C=e,v=t}if(s)for(const b of _.innerChanges||[])b.originalRange.startColumn>1&&b.modifiedRange.startColumn>1&&w(b.originalRange.startLineNumber,b.modifiedRange.startLineNumber),b.originalRange.endColumn<e.getModel().getLineMaxColumn(b.originalRange.endLineNumber)&&w(b.originalRange.endLineNumber,b.modifiedRange.endLineNumber);w(_.original.endLineNumberExclusive,_.modified.endLineNumberExclusive),c=_.original.endLineNumberExclusive,u=_.modified.endLineNumberExclusive}return g(Number.MAX_VALUE,Number.MAX_VALUE),h}function Bt(e,t){const i=[],n=[],o=-1!==e.getOption(144).wrappingColumn,s=e._getViewModel().coordinatesConverter,r=e.getOption(66);if(o)for(let a=1;a<=e.getModel().getLineCount();a++){const e=s.getModelLineViewLineCount(a);e>1&&n.push({lineNumber:a,heightInPx:r*(e-1)})}for(const a of e.getWhitespaces()){if(t.has(a.id))continue;const e=0===a.afterLineNumber?0:s.convertViewPositionToModelPosition(new k.L(a.afterLineNumber,1)).lineNumber;i.push({lineNumber:e,heightInPx:a.height})}const d=L(i,n,(e=>e.lineNumber),((e,t)=>({lineNumber:e.lineNumber,heightInPx:e.heightInPx+t.heightInPx})));return d}kt=Ft([Ht(5,At.p),Ht(6,Wt.i)],kt);var Kt,zt=i(26090),Zt=i(69758),jt=i(69479),Qt=i(47277),$t=i(32656),Gt=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},qt=function(e,t){return function(i,n){t(i,n,e)}};let Jt=Kt=class extends d.JT{constructor(e,t,i,o,s,r,d,l){super(),this._editors=e,this._rootElement=t,this._diffModel=i,this._rootWidth=o,this._rootHeight=s,this._modifiedEditorLayoutInfo=r,this._options=d,this._themeService=l;const h=(0,a.rD)(this._themeService.onDidColorThemeChange,(()=>this._themeService.getColorTheme())),c=(0,a.nK)((e=>{const t=h.read(e),i=t.getColor(Qt.P6Y)||(t.getColor(Qt.ypS)||Qt.CzK).transparent(2),n=t.getColor(Qt.F9q)||(t.getColor(Qt.P4M)||Qt.keg).transparent(2);return{insertColor:i,removeColor:n}})),u=(0,a.rD)(this._editors.modified.onDidScrollChange,(()=>this._editors.modified.getScrollTop())),g=(0,a.rD)(this._editors.modified.onDidScrollChange,(()=>this._editors.modified.getScrollHeight()));this._register((0,a.gp)(((e,t)=>{if(!this._options.renderOverviewRuler.read(e))return;const i=(0,zt.X)(document.createElement("div"));i.setClassName("diffViewport"),i.setPosition("absolute");const o=(0,n.h)("div.diffOverview",{style:{position:"absolute",top:"0px",width:Kt.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;t.add(S(o,i.domNode)),t.add((0,n.mu)(o,n.tw.POINTER_DOWN,(e=>{this._editors.modified.delegateVerticalScrollbarPointerDown(e)}))),t.add((0,n.nm)(o,n.tw.MOUSE_WHEEL,(e=>{this._editors.modified.delegateScrollFromMouseWheelEvent(e)}),{passive:!1})),t.add(S(this._rootElement,o)),t.add((0,a.gp)(((e,t)=>{const n=this._diffModel.read(e),s=this._editors.original.createOverviewRuler("original diffOverviewRuler");s&&(t.add(s),t.add(S(o,s.getDomNode())));const r=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(r&&(t.add(r),t.add(S(o,r.getDomNode()))),!s||!r)return;const d=(0,a.aq)("viewZoneChanged",this._editors.original.onDidChangeViewZones),l=(0,a.aq)("viewZoneChanged",this._editors.modified.onDidChangeViewZones),h=(0,a.aq)("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),m=(0,a.aq)("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);t.add((0,a.EH)((e=>{var t;d.read(e),l.read(e),h.read(e),m.read(e);const i=c.read(e),o=null===(t=null===n||void 0===n?void 0:n.diff.read(e))||void 0===t?void 0:t.mappings;function a(e,t,i){const n=i._getViewModel();return n?e.filter((e=>e.length>0)).map((e=>{const i=n.coordinatesConverter.convertModelPositionToViewPosition(new k.L(e.startLineNumber,1)),o=n.coordinatesConverter.convertModelPositionToViewPosition(new k.L(e.endLineNumberExclusive,1)),s=o.lineNumber-i.lineNumber;return new jt.EY(i.lineNumber,o.lineNumber,s,t.toString())})):[]}const u=a((o||[]).map((e=>e.lineRangeMapping.original)),i.removeColor,this._editors.original),g=a((o||[]).map((e=>e.lineRangeMapping.modified)),i.insertColor,this._editors.modified);null===s||void 0===s||s.setZones(u),null===r||void 0===r||r.setZones(g)}))),t.add((0,a.EH)((e=>{const t=this._rootHeight.read(e),n=this._rootWidth.read(e),d=this._modifiedEditorLayoutInfo.read(e);if(d){const n=Kt.ENTIRE_DIFF_OVERVIEW_WIDTH-2*Kt.ONE_OVERVIEW_WIDTH;s.setLayout({top:0,height:t,right:n+Kt.ONE_OVERVIEW_WIDTH,width:Kt.ONE_OVERVIEW_WIDTH}),r.setLayout({top:0,height:t,right:0,width:Kt.ONE_OVERVIEW_WIDTH});const o=u.read(e),a=g.read(e),l=this._editors.modified.getOption(102),h=new Zt.M(l.verticalHasArrows?l.arrowSize:0,l.verticalScrollbarSize,0,d.height,a,o);i.setTop(h.getSliderPosition()),i.setHeight(h.getSliderSize())}else i.setTop(0),i.setHeight(0);o.style.height=t+"px",o.style.left=n-Kt.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",i.setWidth(Kt.ENTIRE_DIFF_OVERVIEW_WIDTH)})))})))})))}};Jt.ONE_OVERVIEW_WIDTH=15,Jt.ENTIRE_DIFF_OVERVIEW_WIDTH=2*Kt.ONE_OVERVIEW_WIDTH,Jt=Kt=Gt([qt(7,$t.XE)],Jt);var Yt=i(22668),Xt=i(44950),ei=i(25624),ti=i(37174),ii=i(39159),ni=i(34679);(0,Qt.P6G)("diffEditor.move.border",{dark:"#8b8b8b9c",light:"#8b8b8b9c",hcDark:"#8b8b8b9c",hcLight:"#8b8b8b9c"},(0,Q.NC)("diffEditor.move.border","The border color for text that got moved in the diff editor.")),(0,Qt.P6G)("diffEditor.moveActive.border",{dark:"#FFA500",light:"#FFA500",hcDark:"#FFA500",hcLight:"#FFA500"},(0,Q.NC)("diffEditor.moveActive.border","The active border color for text that got moved in the diff editor."));class oi extends d.JT{constructor(){super(...arguments),this._id=++oi.idCounter,this._onDidDispose=this._register(new r.Q5),this.onDidDispose=this._onDidDispose.event}getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(e){return this._targetEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._targetEditor.getPosition()}setPosition(e,t="api"){this._targetEditor.setPosition(e,t)}revealLine(e,t=0){this._targetEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._targetEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._targetEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._targetEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._targetEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._targetEditor.revealPositionNearTop(e,t)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(e,t="api"){this._targetEditor.setSelection(e,t)}setSelections(e,t="api"){this._targetEditor.setSelections(e,t)}revealLines(e,t,i=0){this._targetEditor.revealLines(e,t,i)}revealLinesInCenter(e,t,i=0){this._targetEditor.revealLinesInCenter(e,t,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(e,t,i)}revealLinesNearTop(e,t,i=0){this._targetEditor.revealLinesNearTop(e,t,i)}revealRange(e,t=0,i=!1,n=!0){this._targetEditor.revealRange(e,t,i,n)}revealRangeInCenter(e,t=0){this._targetEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._targetEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._targetEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(e,t,i){this._targetEditor.trigger(e,t,i)}createDecorationsCollection(e){return this._targetEditor.createDecorationsCollection(e)}changeDecorations(e){return this._targetEditor.changeDecorations(e)}}oi.idCounter=0;var si=i(15285),ri=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},di=function(e,t){return function(i,n){t(i,n,e)}};let ai=class extends d.JT{constructor(e,t,i,n,o,s,d){super(),this.originalEditorElement=e,this.modifiedEditorElement=t,this._options=i,this._createInnerEditor=o,this._instantiationService=s,this._keybindingService=d,this._onDidContentSizeChange=this._register(new r.Q5),this.original=this._register(this._createLeftHandSideEditor(i.editorOptions.get(),n.originalEditor||{})),this.modified=this._register(this._createRightHandSideEditor(i.editorOptions.get(),n.modifiedEditor||{})),this.modifiedModel=(0,a.rD)(this.modified.onDidChangeModel,(()=>this.modified.getModel())),this._register((0,a.nJ)({createEmptyChangeSummary:()=>({}),handleChange:(e,t)=>(e.didChange(i.editorOptions)&&Object.assign(t,e.change.changedOptions),!0)},((e,t)=>{i.editorOptions.read(e),this._options.renderSideBySide.read(e),this.modified.updateOptions(this._adjustOptionsForRightHandSide(e,t)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(e,t))})))}_createLeftHandSideEditor(e,t){const i=this._adjustOptionsForLeftHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,i,t);return n.setContextValue("isInDiffLeftEditor",!0),n}_createRightHandSideEditor(e,t){const i=this._adjustOptionsForRightHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,i,t);return n.setContextValue("isInDiffRightEditor",!0),n}_constructInnerEditor(e,t,i,n){const o=this._createInnerEditor(e,t,i,n);return this._register(o.onDidContentSizeChange((e=>{const t=this.original.getContentWidth()+this.modified.getContentWidth()+Jt.ENTIRE_DIFF_OVERVIEW_WIDTH,i=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:i,contentWidth:t,contentHeightChanged:e.contentHeightChanged,contentWidthChanged:e.contentWidthChanged})}))),o}_adjustOptionsForLeftHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return this._options.renderSideBySide.get()?(i.unicodeHighlight=this._options.editorOptions.get().unicodeHighlight||{},i.wordWrapOverride1=this._options.diffWordWrap.get()):(i.wordWrapOverride1="off",i.wordWrapOverride2="off",i.stickyScroll={enabled:!1},i.unicodeHighlight={nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}),t.originalAriaLabel&&(i.ariaLabel=t.originalAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.readOnly=!this._options.originalEditable.get(),i.dropIntoEditor={enabled:!i.readOnly},i.extraEditorClassName="original-in-monaco-diff-editor",i}_adjustOptionsForRightHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return t.modifiedAriaLabel&&(i.ariaLabel=t.modifiedAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.wordWrapOverride1=this._options.diffWordWrap.get(),i.revealHorizontalRightPadding=W.BH.revealHorizontalRightPadding.defaultValue+Jt.ENTIRE_DIFF_OVERVIEW_WIDTH,i.scrollbar.verticalHasArrows=!1,i.extraEditorClassName="modified-in-monaco-diff-editor",i}_adjustOptionsForSubEditor(e){const t=Object.assign(Object.assign({},e),{dimension:{height:0,width:0}});return t.inDiffEditor=!0,t.automaticLayout=!1,t.scrollbar=Object.assign({},t.scrollbar||{}),t.scrollbar.vertical="visible",t.folding=!1,t.codeLens=this._options.diffCodeLens.get(),t.fixedOverflowWidgets=!0,t.minimap=Object.assign({},t.minimap||{}),t.minimap.enabled=!1,this._options.hideUnchangedRegions.get()?t.stickyScroll={enabled:!1}:t.stickyScroll=this._options.editorOptions.get().stickyScroll,t}_updateAriaLabel(e){var t;e||(e="");const i=(0,Q.NC)("diff-aria-navigation-tip"," use {0} to open the accessibility help.",null===(t=this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp"))||void 0===t?void 0:t.getAriaLabel());return this._options.accessibilityVerbose.get()?e+i:e?e.replaceAll(i,""):""}};ai=ri([di(5,G.TG),di(6,si.d)],ai);var li=i(59883);class hi{get editorOptions(){return this._options}constructor(e,t){this.diffEditorWidth=t,this.couldShowInlineViewBecauseOfSize=(0,a.nK)(this,(e=>this._options.read(e).renderSideBySide&&this.diffEditorWidth.read(e)<=this._options.read(e).renderSideBySideInlineBreakpoint)),this.renderOverviewRuler=(0,a.nK)(this,(e=>this._options.read(e).renderOverviewRuler)),this.renderSideBySide=(0,a.nK)(this,(e=>this._options.read(e).renderSideBySide&&!(this._options.read(e).useInlineViewWhenSpaceIsLimited&&this.couldShowInlineViewBecauseOfSize.read(e)))),this.readOnly=(0,a.nK)(this,(e=>this._options.read(e).readOnly)),this.shouldRenderRevertArrows=(0,a.nK)(this,(e=>!!this._options.read(e).renderMarginRevertIcon&&(!!this.renderSideBySide.read(e)&&!this.readOnly.read(e)))),this.renderIndicators=(0,a.nK)(this,(e=>this._options.read(e).renderIndicators)),this.enableSplitViewResizing=(0,a.nK)(this,(e=>this._options.read(e).enableSplitViewResizing)),this.splitViewDefaultRatio=(0,a.nK)(this,(e=>this._options.read(e).splitViewDefaultRatio)),this.ignoreTrimWhitespace=(0,a.nK)(this,(e=>this._options.read(e).ignoreTrimWhitespace)),this.maxComputationTimeMs=(0,a.nK)(this,(e=>this._options.read(e).maxComputationTime)),this.showMoves=(0,a.nK)(this,(e=>this._options.read(e).experimental.showMoves&&this.renderSideBySide.read(e))),this.isInEmbeddedEditor=(0,a.nK)(this,(e=>this._options.read(e).isInEmbeddedEditor)),this.diffWordWrap=(0,a.nK)(this,(e=>this._options.read(e).diffWordWrap)),this.originalEditable=(0,a.nK)(this,(e=>this._options.read(e).originalEditable)),this.diffCodeLens=(0,a.nK)(this,(e=>this._options.read(e).diffCodeLens)),this.accessibilityVerbose=(0,a.nK)(this,(e=>this._options.read(e).accessibilityVerbose)),this.diffAlgorithm=(0,a.nK)(this,(e=>this._options.read(e).diffAlgorithm)),this.showEmptyDecorations=(0,a.nK)(this,(e=>this._options.read(e).experimental.showEmptyDecorations)),this.onlyShowAccessibleDiffViewer=(0,a.nK)(this,(e=>this._options.read(e).onlyShowAccessibleDiffViewer)),this.hideUnchangedRegions=(0,a.nK)(this,(e=>this._options.read(e).hideUnchangedRegions.enabled)),this.hideUnchangedRegionsRevealLineCount=(0,a.nK)(this,(e=>this._options.read(e).hideUnchangedRegions.revealLineCount)),this.hideUnchangedRegionsContextLineCount=(0,a.nK)(this,(e=>this._options.read(e).hideUnchangedRegions.contextLineCount)),this.hideUnchangedRegionsMinimumLineCount=(0,a.nK)(this,(e=>this._options.read(e).hideUnchangedRegions.minimumLineCount));const i=Object.assign(Object.assign({},e),ci(e,li.k));this._options=(0,a.uh)(this,i)}updateOptions(e){const t=ci(e,this._options.get()),i=Object.assign(Object.assign(Object.assign({},this._options.get()),e),t);this._options.set(i,void 0,{changedOptions:e})}}function ci(e,t){var i,n,o,s,r,d,a,l;return{enableSplitViewResizing:(0,W.O7)(e.enableSplitViewResizing,t.enableSplitViewResizing),splitViewDefaultRatio:(0,W.L_)(e.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:(0,W.O7)(e.renderSideBySide,t.renderSideBySide),renderMarginRevertIcon:(0,W.O7)(e.renderMarginRevertIcon,t.renderMarginRevertIcon),maxComputationTime:(0,W.Zc)(e.maxComputationTime,t.maxComputationTime,0,1073741824),maxFileSize:(0,W.Zc)(e.maxFileSize,t.maxFileSize,0,1073741824),ignoreTrimWhitespace:(0,W.O7)(e.ignoreTrimWhitespace,t.ignoreTrimWhitespace),renderIndicators:(0,W.O7)(e.renderIndicators,t.renderIndicators),originalEditable:(0,W.O7)(e.originalEditable,t.originalEditable),diffCodeLens:(0,W.O7)(e.diffCodeLens,t.diffCodeLens),renderOverviewRuler:(0,W.O7)(e.renderOverviewRuler,t.renderOverviewRuler),diffWordWrap:(0,W.NY)(e.diffWordWrap,t.diffWordWrap,["off","on","inherit"]),diffAlgorithm:(0,W.NY)(e.diffAlgorithm,t.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:(0,W.O7)(e.accessibilityVerbose,t.accessibilityVerbose),experimental:{showMoves:(0,W.O7)(null===(i=e.experimental)||void 0===i?void 0:i.showMoves,t.experimental.showMoves),showEmptyDecorations:(0,W.O7)(null===(n=e.experimental)||void 0===n?void 0:n.showEmptyDecorations,t.experimental.showEmptyDecorations)},hideUnchangedRegions:{enabled:(0,W.O7)(null!==(s=null===(o=e.hideUnchangedRegions)||void 0===o?void 0:o.enabled)&&void 0!==s?s:null===(r=e.experimental)||void 0===r?void 0:r.collapseUnchangedRegions,t.hideUnchangedRegions.enabled),contextLineCount:(0,W.Zc)(null===(d=e.hideUnchangedRegions)||void 0===d?void 0:d.contextLineCount,t.hideUnchangedRegions.contextLineCount,0,1073741824),minimumLineCount:(0,W.Zc)(null===(a=e.hideUnchangedRegions)||void 0===a?void 0:a.minimumLineCount,t.hideUnchangedRegions.minimumLineCount,0,1073741824),revealLineCount:(0,W.Zc)(null===(l=e.hideUnchangedRegions)||void 0===l?void 0:l.revealLineCount,t.hideUnchangedRegions.revealLineCount,0,1073741824)},isInEmbeddedEditor:(0,W.O7)(e.isInEmbeddedEditor,t.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:(0,W.O7)(e.onlyShowAccessibleDiffViewer,t.onlyShowAccessibleDiffViewer),renderSideBySideInlineBreakpoint:(0,W.Zc)(e.renderSideBySideInlineBreakpoint,t.renderSideBySideInlineBreakpoint,0,1073741824),useInlineViewWhenSpaceIsLimited:(0,W.O7)(e.useInlineViewWhenSpaceIsLimited,t.useInlineViewWhenSpaceIsLimited)}}var ui=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},gi=function(e,t){return function(i,n){t(i,n,e)}};let mi=class extends oi{constructor(e,t,i,o,s,l,h,c){var u;super(),this._domElement=e,this._parentContextKeyService=o,this._parentInstantiationService=s,this._audioCueService=h,this._editorProgressService=c,this.elements=(0,n.h)("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[(0,n.h)("div.noModificationsOverlay@overlay",{style:{position:"absolute",height:"100%",visibility:"hidden"}},[(0,n.$)("span",{},"No Changes")]),(0,n.h)("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),(0,n.h)("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),(0,n.h)("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]),this._diffModel=this._register((0,a.DN)("diffModel",void 0)),this.onDidChangeModel=r.ju.fromObservableLight(this._diffModel),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement)),this._instantiationService=this._parentInstantiationService.createChild(new ii.y([ti.i6,this._contextKeyService])),this._boundarySashes=(0,a.uh)(this,void 0),this._accessibleDiffViewerShouldBeVisible=(0,a.uh)(this,!1),this._accessibleDiffViewerVisible=(0,a.nK)(this,(e=>!!this._options.onlyShowAccessibleDiffViewer.read(e)||this._accessibleDiffViewerShouldBeVisible.read(e))),this.movedBlocksLinesPart=(0,a.uh)(this,void 0),this._layoutInfo=(0,a.nK)(this,(e=>{var t,i,n;const o=this._rootSizeObserver.width.read(e),s=this._rootSizeObserver.height.read(e),r=null===(t=this._sash.read(e))||void 0===t?void 0:t.sashLeft.read(e),d=null!==r&&void 0!==r?r:Math.max(5,this._editors.original.getLayoutInfo().decorationsLeft),a=o-d-(this._options.renderOverviewRuler.read(e)?Jt.ENTIRE_DIFF_OVERVIEW_WIDTH:0),l=null!==(n=null===(i=this.movedBlocksLinesPart.read(e))||void 0===i?void 0:i.width.read(e))&&void 0!==n?n:0,h=d-l;return this.elements.original.style.width=h+"px",this.elements.original.style.left="0px",this.elements.modified.style.width=a+"px",this.elements.modified.style.left=d+"px",this._editors.original.layout({width:h,height:s}),this._editors.modified.layout({width:a,height:s}),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}})),this._diffValue=this._diffModel.map(((e,t)=>null===e||void 0===e?void 0:e.diff.read(t))),this.onDidUpdateDiff=r.ju.fromObservableLight(this._diffValue),l.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._domElement.appendChild(this.elements.root),this._register((0,d.OF)((()=>this._domElement.removeChild(this.elements.root)))),this._rootSizeObserver=this._register(new N(this.elements.root,t.dimension)),this._rootSizeObserver.setAutomaticLayout(null!==(u=t.automaticLayout)&&void 0!==u&&u),this._options=new hi(t,this._rootSizeObserver.width),this._contextKeyService.createKey(Xt.u.isEmbeddedDiffEditor.key,!1);const g=Xt.u.isEmbeddedDiffEditor.bindTo(this._contextKeyService);this._register((0,a.EH)((e=>{g.set(this._options.isInEmbeddedEditor.read(e))})));const m=Xt.u.comparingMovedCode.bindTo(this._contextKeyService);this._register((0,a.EH)((e=>{var t;m.set(!!(null===(t=this._diffModel.read(e))||void 0===t?void 0:t.movedTextToCompare.read(e)))})));const _=Xt.u.diffEditorRenderSideBySideInlineBreakpointReached.bindTo(this._contextKeyService);this._register((0,a.EH)((e=>{_.set(this._options.couldShowInlineViewBecauseOfSize.read(e))}))),this._editors=this._register(this._instantiationService.createInstance(ai,this.elements.original,this.elements.modified,this._options,i,((e,t,i,n)=>this._createInnerEditor(e,t,i,n)))),this._sash=(0,a.Be)(this,((e,t)=>{const i=this._options.renderSideBySide.read(e);if(this.elements.root.classList.toggle("side-by-side",i),!i)return;const n=t.add(new Oe(this._options,this.elements.root,{height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map(((e,t)=>e-(this._options.renderOverviewRuler.read(t)?Jt.ENTIRE_DIFF_OVERVIEW_WIDTH:0)))}));return t.add((0,a.EH)((e=>{const t=this._boundarySashes.read(e);t&&n.setBoundarySashes(t)}))),n})),this._register((0,a.jx)(this._sash)),this._register((0,a.gp)(((e,t)=>{this.unchangedRangesFeature=t.add(this._instantiationService.createInstance(P(Qe,e),this._editors,this._diffModel,this._options))}))),this._register((0,a.gp)(((e,t)=>{t.add(new(P(Ie,e))(this._editors,this._diffModel,this._options))}))),this._register((0,a.gp)(((e,t)=>{t.add(this._instantiationService.createInstance(P(kt,e),this._editors,this._diffModel,this._options,this,(()=>this.unchangedRangesFeature.isUpdatingViewZones)))}))),this._register((0,a.gp)(((e,t)=>{t.add(this._instantiationService.createInstance(P(Jt,e),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map((e=>e.modifiedEditor)),this._options))}))),this._register((0,a.gp)(((e,t)=>{this._accessibleDiffViewer=t.add(this._register(this._instantiationService.createInstance(P(ne,e),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,((e,t)=>this._accessibleDiffViewerShouldBeVisible.set(e,t)),this._options.onlyShowAccessibleDiffViewer.map((e=>!e)),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map(((e,t)=>{var i;return null===(i=null===e||void 0===e?void 0:e.diff.read(t))||void 0===i?void 0:i.mappings.map((e=>e.lineRangeMapping))})),this._editors)))})));const f=this._accessibleDiffViewerVisible.map((e=>e?"hidden":"visible"));this._register(I(this.elements.modified,{visibility:f})),this._register(I(this.elements.original,{visibility:f})),this._createDiffEditorContributions(),l.addDiffEditor(this),this._register((0,a.jx)(this._layoutInfo)),this._register((0,a.gp)(((e,t)=>{this.movedBlocksLinesPart.set(t.add(new(P(Re,e))(this.elements.root,this._diffModel,this._layoutInfo.map((e=>e.originalEditor)),this._layoutInfo.map((e=>e.modifiedEditor)),this._editors)),void 0)}))),this._register(I(this.elements.overlay,{width:this._layoutInfo.map(((e,t)=>e.originalEditor.width+(this._options.renderSideBySide.read(t)?0:e.modifiedEditor.width))),visibility:(0,a.nK)((e=>{var t,i;return this._options.hideUnchangedRegions.read(e)&&0===(null===(i=null===(t=this._diffModel.read(e))||void 0===t?void 0:t.diff.read(e))||void 0===i?void 0:i.mappings.length)?"visible":"hidden"}))})),this._register(this._editors.modified.onMouseDown((e=>{var t,i;if(!e.event.rightButton&&e.target.position&&(null===(t=e.target.element)||void 0===t?void 0:t.className.includes("arrow-revert-change"))){const t=e.target.position.lineNumber,n=e.target,o=this._diffModel.get();if(!o)return;const s=null===(i=o.diff.get())||void 0===i?void 0:i.mappings;if(!s)return;const r=s.find((e=>(null===n||void 0===n?void 0:n.detail.afterLineNumber)===e.lineRangeMapping.modified.startLineNumber-1||e.lineRangeMapping.modified.startLineNumber===t));if(!r)return;this.revert(r.lineRangeMapping),e.event.stopPropagation()}}))),this._register(r.ju.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,(e=>{var t,i;if(3===(null===e||void 0===e?void 0:e.reason)){const n=null===(i=null===(t=this._diffModel.get())||void 0===t?void 0:t.diff.get())||void 0===i?void 0:i.mappings.find((t=>t.lineRangeMapping.modified.contains(e.position.lineNumber)));(null===n||void 0===n?void 0:n.lineRangeMapping.modified.isEmpty)?this._audioCueService.playAudioCue($.y$.diffLineDeleted,{source:"diffEditor.cursorPositionChanged"}):(null===n||void 0===n?void 0:n.lineRangeMapping.original.isEmpty)?this._audioCueService.playAudioCue($.y$.diffLineInserted,{source:"diffEditor.cursorPositionChanged"}):n&&this._audioCueService.playAudioCue($.y$.diffLineModified,{source:"diffEditor.cursorPositionChanged"})}})));const p=this._diffModel.map(((e,t)=>null===e||void 0===e?void 0:e.isDiffUpToDate.read(t)));this._register((0,a.gp)(((e,t)=>{if(!1===p.read(e)){const e=this._editorProgressService.show(!0,1e3);t.add((0,d.OF)((()=>e.done())))}})))}_createInnerEditor(e,t,i,n){const o=e.createInstance(c.Gm,t,i,n);return o}_createDiffEditorContributions(){const e=l.Uc.getDiffEditorContributions();for(const i of e)try{this._register(this._instantiationService.createInstance(i.ctor,this))}catch(t){(0,s.dL)(t)}}get _targetEditor(){return this._editors.modified}getEditorType(){return Yt.g.IDiffEditor}layout(e){this._rootSizeObserver.observe(e)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){var e;const t=this._editors.original.saveViewState(),i=this._editors.modified.saveViewState();return{original:t,modified:i,modelState:null===(e=this._diffModel.get())||void 0===e?void 0:e.serializeState()}}restoreViewState(e){var t;if(e&&e.original&&e.modified){const i=e;this._editors.original.restoreViewState(i.original),this._editors.modified.restoreViewState(i.modified),i.modelState&&(null===(t=this._diffModel.get())||void 0===t||t.restoreSerializedState(i.modelState))}}createViewModel(e){return this._instantiationService.createInstance(vt,e,this._options,this)}getModel(){var e,t;return null!==(t=null===(e=this._diffModel.get())||void 0===e?void 0:e.model)&&void 0!==t?t:null}setModel(e){!e&&this._diffModel.get()&&this._accessibleDiffViewer.close();const t=e?"model"in e?e:this.createViewModel(e):void 0;this._editors.original.setModel(t?t.model.original:null),this._editors.modified.setModel(t?t.model.modified:null),(0,a.PS)((e=>{this._diffModel.set(t,e)}))}updateOptions(e){this._options.updateOptions(e)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}getLineChanges(){var e;const t=null===(e=this._diffModel.get())||void 0===e?void 0:e.diff.get();return t?vi(t):null}revert(e){var t;const i=null===(t=this._diffModel.get())||void 0===t?void 0:t.model;if(!i)return;const n=e.innerChanges?e.innerChanges.map((e=>({range:e.modifiedRange,text:i.original.getValueInRange(e.originalRange)}))):[{range:e.modified.toExclusiveRange(),text:i.original.getValueInRange(e.original.toExclusiveRange())}];this._editors.modified.executeEdits("diffEditor",n)}accessibleDiffViewerNext(){this._accessibleDiffViewer.next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.prev()}mapToOtherSide(){var e,t;const i=this._editors.modified.hasWidgetFocus(),n=i?this._editors.modified:this._editors.original,o=i?this._editors.original:this._editors.modified;let s;const r=n.getSelection();if(r){const n=null===(t=null===(e=this._diffModel.get())||void 0===e?void 0:e.diff.get())||void 0===t?void 0:t.mappings.map((e=>i?e.lineRangeMapping.flip():e.lineRangeMapping));if(n){const e=_i(r.getStartPosition(),n),t=_i(r.getEndPosition(),n);s=U.e.plusRange(e,t)}}return{destination:o,destinationSelection:s}}switchSide(){const{destination:e,destinationSelection:t}=this.mapToOtherSide();e.focus(),t&&e.setSelection(t)}exitCompareMove(){const e=this._diffModel.get();e&&e.movedTextToCompare.set(void 0,void 0)}collapseAllUnchangedRegions(){var e;const t=null===(e=this._diffModel.get())||void 0===e?void 0:e.unchangedRegions.get();t&&(0,a.PS)((e=>{for(const i of t)i.collapseAll(e)}))}showAllUnchangedRegions(){var e;const t=null===(e=this._diffModel.get())||void 0===e?void 0:e.unchangedRegions.get();t&&(0,a.PS)((e=>{for(const i of t)i.showAll(e)}))}};function _i(e,t){const i=(0,o.dF)(t,(t=>t.original.startLineNumber<=e.lineNumber));if(!i)return U.e.fromPositions(e);if(i.original.endLineNumberExclusive<=e.lineNumber){const t=e.lineNumber-i.original.endLineNumberExclusive+i.modified.endLineNumberExclusive;return U.e.fromPositions(new k.L(t,e.column))}if(!i.innerChanges)return U.e.fromPositions(new k.L(i.modified.startLineNumber,1));const n=(0,o.dF)(i.innerChanges,(t=>t.originalRange.getStartPosition().isBeforeOrEqual(e)));if(!n){const t=e.lineNumber-i.original.startLineNumber+i.modified.startLineNumber;return U.e.fromPositions(new k.L(t,e.column))}if(n.originalRange.containsPosition(e))return n.modifiedRange;{const t=fi(n.originalRange.getEndPosition(),e);return U.e.fromPositions(pi(n.modifiedRange.getEndPosition(),t))}}function fi(e,t){return e.lineNumber===t.lineNumber?new ei.OE(0,t.column-e.column):new ei.OE(t.lineNumber-e.lineNumber,t.column-1)}function pi(e,t){return 0===t.lineCount?new k.L(e.lineNumber,e.column+t.columnCount):new k.L(e.lineNumber+t.lineCount,t.columnCount+1)}function vi(e){return e.mappings.map((e=>{const t=e.lineRangeMapping;let i,n,o,s,r=t.innerChanges;return t.original.isEmpty?(i=t.original.startLineNumber-1,n=0,r=void 0):(i=t.original.startLineNumber,n=t.original.endLineNumberExclusive-1),t.modified.isEmpty?(o=t.modified.startLineNumber-1,s=0,r=void 0):(o=t.modified.startLineNumber,s=t.modified.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:n,modifiedStartLineNumber:o,modifiedEndLineNumber:s,charChanges:null===r||void 0===r?void 0:r.map((e=>({originalStartLineNumber:e.originalRange.startLineNumber,originalStartColumn:e.originalRange.startColumn,originalEndLineNumber:e.originalRange.endLineNumber,originalEndColumn:e.originalRange.endColumn,modifiedStartLineNumber:e.modifiedRange.startLineNumber,modifiedStartColumn:e.modifiedRange.startColumn,modifiedEndLineNumber:e.modifiedRange.endLineNumber,modifiedEndColumn:e.modifiedRange.endColumn})))}}))}mi=ui([gi(3,ti.i6),gi(4,G.TG),gi(5,h.$),gi(6,$.e7),gi(7,ni.ek)],mi)},24788:(e,t,i)=>{i.d(t,{H:()=>f});var n=i(2179),o=i(35195),s=i(97469),r=i(97297),d=i(16458),a=i(55907),l=i(46871),h=i(37174),c=i(21881),u=i(18736),g=i(32656),m=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},_=function(e,t){return function(i,n){t(i,n,e)}};let f=class extends s.Gm{constructor(e,t,i,n,o,s,r,d,a,l,h,c,u){super(e,Object.assign(Object.assign({},n.getRawOptions()),{overflowWidgetsDomNode:n.getOverflowWidgetsDomNode()}),i,o,s,r,d,a,l,h,c,u),this._parentEditor=n,this._overwriteOptions=t,super.updateOptions(this._overwriteOptions),this._register(n.onDidChangeConfiguration((e=>this._onParentConfigurationChanged(e))))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){n.jB(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};f=m([_(4,c.TG),_(5,o.$),_(6,l.H),_(7,h.i6),_(8,g.XE),_(9,u.lT),_(10,a.F),_(11,r.c_),_(12,d.p)],f)},74816:(e,t,i)=>{i.d(t,{OY:()=>s,Sj:()=>r,T4:()=>o,Uo:()=>d,hP:()=>a});var n=i(54644);class o{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const i=t.getInverseEditOperations(),o=i[0].range;return n.Y.fromPositions(o.getEndPosition())}}class s{constructor(e,t){this._range=e,this._text=t}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const i=t.getInverseEditOperations(),o=i[0].range;return n.Y.fromRange(o,0)}}class r{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const i=t.getInverseEditOperations(),o=i[0].range;return n.Y.fromPositions(o.getStartPosition())}}class d{constructor(e,t,i,n,o=!1){this._range=e,this._text=t,this._columnDeltaOffset=n,this._lineNumberDeltaOffset=i,this.insertsAutoWhitespace=o}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const i=t.getInverseEditOperations(),o=i[0].range;return n.Y.fromPositions(o.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}}class a{constructor(e,t,i,n=!1){this._range=e,this._text=t,this._initialSelection=i,this._forceMoveMarkers=n,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}},85175:(e,t,i)=>{i.d(t,{U:()=>m});var n,o=i(61720),s=i(16779),r=i(33162),d=i(54644),a=i(74177),l=i(97297),h=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},c=function(e,t){return function(i,n){t(i,n,e)}};const u=Object.create(null);function g(e,t){if(t<=0)return"";u[e]||(u[e]=["",e]);const i=u[e];for(let n=i.length;n<=t;n++)i[n]=i[n-1]+e;return i[t]}let m=n=class{static unshiftIndent(e,t,i,n,o){const r=s.i.visibleColumnFromColumn(e,t,i);if(o){const e=g(" ",n),t=s.i.prevIndentTabStop(r,n),i=t/n;return g(e,i)}{const e="\t",t=s.i.prevRenderTabStop(r,i),n=t/i;return g(e,n)}}static shiftIndent(e,t,i,n,o){const r=s.i.visibleColumnFromColumn(e,t,i);if(o){const e=g(" ",n),t=s.i.nextIndentTabStop(r,n),i=t/n;return g(e,i)}{const e="\t",t=s.i.nextRenderTabStop(r,i),n=t/i;return g(e,n)}}constructor(e,t,i){this._languageConfigurationService=i,this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}_addEditOperation(e,t,i){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,i):e.addEditOperation(t,i)}getEditOperations(e,t){const i=this._selection.startLineNumber;let d=this._selection.endLineNumber;1===this._selection.endColumn&&i!==d&&(d-=1);const{tabSize:l,indentSize:h,insertSpaces:c}=this._opts,u=i===d;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(i))&&(this._useLastEditRangeForCursorEndPosition=!0);let g=0,m=0;for(let _=i;_<=d;_++,g=m){m=0;const d=e.getLineContent(_);let f,p=o.LC(d);if((!this._opts.isUnshift||0!==d.length&&0!==p)&&(u||this._opts.isUnshift||0!==d.length)){if(-1===p&&(p=d.length),_>1){const t=s.i.visibleColumnFromColumn(d,p+1,l);if(t%h!==0&&e.tokenization.isCheapToTokenize(_-1)){const t=(0,a.A)(this._opts.autoIndent,e,new r.e(_-1,e.getLineMaxColumn(_-1),_-1,e.getLineMaxColumn(_-1)),this._languageConfigurationService);if(t){if(m=g,t.appendText)for(let e=0,i=t.appendText.length;e<i&&m<h;e++){if(32!==t.appendText.charCodeAt(e))break;m++}t.removeText&&(m=Math.max(0,m-t.removeText));for(let e=0;e<m;e++){if(0===p||32!==d.charCodeAt(p-1))break;p--}}}}this._opts.isUnshift&&0===p||(f=this._opts.isUnshift?n.unshiftIndent(d,p+1,l,h,c):n.shiftIndent(d,p+1,l,h,c),this._addEditOperation(t,new r.e(_,1,_,p+1),f),_!==i||this._selection.isEmpty()||(this._selectionStartColumnStaysPut=this._selection.startColumn<=p+1))}}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&0===e.getLineLength(i)&&(this._useLastEditRangeForCursorEndPosition=!0);const n=c?g(" ",h):"\t";for(let s=i;s<=d;s++){const d=e.getLineContent(s);let a=o.LC(d);if((!this._opts.isUnshift||0!==d.length&&0!==a)&&((u||this._opts.isUnshift||0!==d.length)&&(-1===a&&(a=d.length),!this._opts.isUnshift||0!==a)))if(this._opts.isUnshift){a=Math.min(a,h);for(let e=0;e<a;e++){const t=d.charCodeAt(e);if(9===t){a=e+1;break}}this._addEditOperation(t,new r.e(s,1,s,a+1),"")}else this._addEditOperation(t,new r.e(s,1,s,1),n),s!==i||this._selection.isEmpty()||(this._selectionStartColumnStaysPut=1===this._selection.startColumn)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){const e=t.getInverseEditOperations()[0];return new d.Y(e.range.endLineNumber,e.range.endColumn,e.range.endLineNumber,e.range.endColumn)}const i=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){const e=this._selection.startColumn,t=i.startColumn;return t<=e?i:0===i.getDirection()?new d.Y(i.startLineNumber,e,i.endLineNumber,i.endColumn):new d.Y(i.endLineNumber,i.endColumn,i.startLineNumber,e)}return i}};m=n=h([c(2,l.c_)],m)},777:(e,t,i)=>{i.d(t,{F:()=>s,K:()=>r});var n=i(33162),o=i(54644);class s{constructor(e,t,i){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=i}getEditOperations(e,t){t.addTrackedEditOperation(new n.e(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new n.e(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){const i=t.getInverseEditOperations(),n=i[0].range,s=i[1].range;return new o.Y(n.endLineNumber,n.endColumn,s.endLineNumber,s.endColumn-this._charAfterSelection.length)}}class r{constructor(e,t,i){this._position=e,this._text=t,this._charAfter=i}getEditOperations(e,t){t.addTrackedEditOperation(new n.e(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(e,t){const i=t.getInverseEditOperations(),n=i[0].range;return new o.Y(n.endLineNumber,n.startColumn,n.endLineNumber,n.endColumn-this._charAfter.length)}}},38159:(e,t,i)=>{i.d(t,{V:()=>r});var n=i(61720),o=i(90970),s=i(33162);class r{constructor(e,t){this._selection=e,this._cursors=t,this._selectionId=null}getEditOperations(e,t){const i=d(e,this._cursors);for(let n=0,o=i.length;n<o;n++){const e=i[n];t.addEditOperation(e.range,e.text)}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}function d(e,t){t.sort(((e,t)=>e.lineNumber===t.lineNumber?e.column-t.column:e.lineNumber-t.lineNumber));for(let n=t.length-2;n>=0;n--)t[n].lineNumber===t[n+1].lineNumber&&t.splice(n,1);const i=[];let r=0,d=0;const a=t.length;for(let l=1,h=e.getLineCount();l<=h;l++){const h=e.getLineContent(l),c=h.length+1;let u=0;if(d<a&&t[d].lineNumber===l&&(u=t[d].column,d++,u===c))continue;if(0===h.length)continue;const g=n.ow(h);let m=0;if(-1===g)m=1;else{if(g===h.length-1)continue;m=g+2}m=Math.max(u,m),i[r++]=o.h.delete(new s.e(l,m,l,c))}return i}}}]);