"use strict";(globalThis["webpackChunkfrontend"]=globalThis["webpackChunkfrontend"]||[]).push([[688],{36875:(e,t,i)=>{i.d(t,{CH:()=>l,CR:()=>a,D4:()=>d,u7:()=>s,xh:()=>n,yu:()=>r});class o{constructor(e,t){this._restrictedRenderingContextBrand=void 0,this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const i=this._viewLayout.getCurrentViewport();this.scrollTop=i.top,this.scrollLeft=i.left,this.viewportWidth=i.width,this.viewportHeight=i.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class n extends o{constructor(e,t,i){super(e,t),this._renderingContextBrand=void 0,this._viewLines=i}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}}class s{constructor(e,t,i,o){this.outsideRenderedLine=e,this.lineNumber=t,this.ranges=i,this.continuesOnNextLine=o}}class r{static from(e){const t=new Array(e.length);for(let i=0,o=e.length;i<o;i++){const o=e[i];t[i]=new r(o.left,o.width)}return t}constructor(e,t){this._horizontalRangeBrand=void 0,this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}}class a{constructor(e,t){this._floatHorizontalRangeBrand=void 0,this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}}class d{constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}}class l{constructor(e,t){this.outsideRenderedLine=e,this.ranges=t}}},64778:(e,t,i)=>{i.d(t,{F:()=>a,G:()=>d});var o=i(26090),n=i(82168),s=i(98642),r=i(69427);class a{constructor(e){this._createLine=e,this._set(1,[])}flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){const t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new s.he("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(0===this.getCount())return null;const i=this.getStartLineNumber(),o=this.getEndLineNumber();if(t<i){const i=t-e+1;return this._rendLineNumberStart-=i,null}if(e>o)return null;let n=0,s=0;for(let a=i;a<=o;a++){const i=a-this._rendLineNumberStart;e<=a&&a<=t&&(0===s?(n=i,s=1):s++)}if(e<i){let o=0;o=t<i?t-e+1:i-e,this._rendLineNumberStart-=o}const r=this._lines.splice(n,s);return r}onLinesChanged(e,t){const i=e+t-1;if(0===this.getCount())return!1;const o=this.getStartLineNumber(),n=this.getEndLineNumber();let s=!1;for(let r=e;r<=i;r++)r>=o&&r<=n&&(this._lines[r-this._rendLineNumberStart].onContentChanged(),s=!0);return s}onLinesInserted(e,t){if(0===this.getCount())return null;const i=t-e+1,o=this.getStartLineNumber(),n=this.getEndLineNumber();if(e<=o)return this._rendLineNumberStart+=i,null;if(e>n)return null;if(i+e>n){const t=this._lines.splice(e-this._rendLineNumberStart,n-e+1);return t}const s=[];for(let h=0;h<i;h++)s[h]=this._createLine();const r=e-this._rendLineNumberStart,a=this._lines.slice(0,r),d=this._lines.slice(r,this._lines.length-i),l=this._lines.slice(this._lines.length-i,this._lines.length);return this._lines=a.concat(s).concat(d),l}onTokensChanged(e){if(0===this.getCount())return!1;const t=this.getStartLineNumber(),i=this.getEndLineNumber();let o=!1;for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.toLineNumber<t||s.fromLineNumber>i)continue;const r=Math.max(t,s.fromLineNumber),a=Math.min(i,s.toLineNumber);for(let e=r;e<=a;e++){const t=e-this._rendLineNumberStart;this._lines[t].onTokensChanged(),o=!0}}return o}}class d{constructor(e){this._host=e,this.domNode=this._createDomNode(),this._linesCollection=new a((()=>this._host.createVisibleLine()))}_createDomNode(){const e=(0,o.X)(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(142)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){const t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,o=t.length;i<o;i++){const e=t[i].getDomNode();e&&this.domNode.domNode.removeChild(e)}return!0}onLinesInserted(e){const t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,o=t.length;i<o;i++){const e=t[i].getDomNode();e&&this.domNode.domNode.removeChild(e)}return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){const t=this._linesCollection._get(),i=new l(this.domNode.domNode,this._host,e),o={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},n=i.render(o,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(n.rendLineNumberStart,n.lines)}}class l{constructor(e,t,i){this.domNode=e,this.host=t,this.viewportData=i}render(e,t,i,o){const n={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(n.rendLineNumberStart+n.linesLength-1<t||i<n.rendLineNumberStart){n.rendLineNumberStart=t,n.linesLength=i-t+1,n.lines=[];for(let e=t;e<=i;e++)n.lines[e-t]=this.host.createVisibleLine();return this._finishRendering(n,!0,o),n}if(this._renderUntouchedLines(n,Math.max(t-n.rendLineNumberStart,0),Math.min(i-n.rendLineNumberStart,n.linesLength-1),o,t),n.rendLineNumberStart>t){const e=t,s=Math.min(i,n.rendLineNumberStart-1);e<=s&&(this._insertLinesBefore(n,e,s,o,t),n.linesLength+=s-e+1)}else if(n.rendLineNumberStart<t){const e=Math.min(n.linesLength,t-n.rendLineNumberStart);e>0&&(this._removeLinesBefore(n,e),n.linesLength-=e)}if(n.rendLineNumberStart=t,n.rendLineNumberStart+n.linesLength-1<i){const e=n.rendLineNumberStart+n.linesLength,s=i;e<=s&&(this._insertLinesAfter(n,e,s,o,t),n.linesLength+=s-e+1)}else if(n.rendLineNumberStart+n.linesLength-1>i){const e=Math.max(0,i-n.rendLineNumberStart+1),t=n.linesLength-1,o=t-e+1;o>0&&(this._removeLinesAfter(n,o),n.linesLength-=o)}return this._finishRendering(n,!1,o),n}_renderUntouchedLines(e,t,i,o,n){const s=e.rendLineNumberStart,r=e.lines;for(let a=t;a<=i;a++){const e=s+a;r[a].layoutLine(e,o[e-n])}}_insertLinesBefore(e,t,i,o,n){const s=[];let r=0;for(let a=t;a<=i;a++)s[r++]=this.host.createVisibleLine();e.lines=s.concat(e.lines)}_removeLinesBefore(e,t){for(let i=0;i<t;i++){const t=e.lines[i].getDomNode();t&&this.domNode.removeChild(t)}e.lines.splice(0,t)}_insertLinesAfter(e,t,i,o,n){const s=[];let r=0;for(let a=t;a<=i;a++)s[r++]=this.host.createVisibleLine();e.lines=e.lines.concat(s)}_removeLinesAfter(e,t){const i=e.linesLength-t;for(let o=0;o<t;o++){const t=e.lines[i+o].getDomNode();t&&this.domNode.removeChild(t)}e.lines.splice(i,t)}_finishRenderingNewLines(e,t,i,o){l._ttPolicy&&(i=l._ttPolicy.createHTML(i));const n=this.domNode.lastChild;t||!n?this.domNode.innerHTML=i:n.insertAdjacentHTML("afterend",i);let s=this.domNode.lastChild;for(let r=e.linesLength-1;r>=0;r--){const t=e.lines[r];o[r]&&(t.setDomNode(s),s=s.previousSibling)}}_finishRenderingInvalidLines(e,t,i){const o=document.createElement("div");l._ttPolicy&&(t=l._ttPolicy.createHTML(t)),o.innerHTML=t;for(let n=0;n<e.linesLength;n++){const t=e.lines[n];if(i[n]){const e=o.firstChild,i=t.getDomNode();i.parentNode.replaceChild(e,i),t.setDomNode(e)}}}_finishRendering(e,t,i){const o=l._sb,n=e.linesLength,s=e.lines,r=e.rendLineNumberStart,a=[];{o.reset();let d=!1;for(let e=0;e<n;e++){const t=s[e];a[e]=!1;const n=t.getDomNode();if(n)continue;const l=t.renderLine(e+r,i[e],this.viewportData,o);l&&(a[e]=!0,d=!0)}d&&this._finishRenderingNewLines(e,t,o.build(),a)}{o.reset();let t=!1;const d=[];for(let e=0;e<n;e++){const n=s[e];if(d[e]=!1,a[e])continue;const l=n.renderLine(e+r,i[e],this.viewportData,o);l&&(d[e]=!0,t=!0)}t&&this._finishRenderingInvalidLines(e,o.build(),d)}}}l._ttPolicy=(0,n.Z)("editorViewLayer",{createHTML:e=>e}),l._sb=new r.HT(1e5)},69114:(e,t,i)=>{i.d(t,{E:()=>n,K:()=>s});var o=i(1300);class n extends o.O{constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class s{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){const t=e.getAttribute("data-mprt");return null===t?0:parseInt(t,10)}static collect(e,t){const i=[];let o=0;while(e&&e!==document.body){if(e===t)break;e.nodeType===e.ELEMENT_NODE&&(i[o++]=this.read(e)),e=e.parentElement}const n=new Uint8Array(o);for(let s=0;s<o;s++)n[s]=i[o-s-1];return n}}},97469:(e,t,i)=>{i.d(t,{Gm:()=>Ae});i(52950);var o=i(25206),n=i(2548),s=i(98642),r=i(11271),a=i(70959),d=i(50200),l=i(35273),h=i(48077),c=i(35195),u=i(54644),g=i(33162),_=i(26090),m=i(19030),v=i(22229),f=i(25109),p=i(89999),w=i(47606);class C{constructor(e,t,i,o){this.configuration=e,this.viewModel=t,this.userInputEvents=i,this.commandDelegate=o}paste(e,t,i,o){this.commandDelegate.paste(e,t,i,o)}type(e){this.commandDelegate.type(e)}compositionType(e,t,i,o){this.commandDelegate.compositionType(e,t,i,o)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){f.Ox.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){const t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new p.L(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(76)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(76)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){const t=this.configuration.options,i=w.IJ&&t.get(105),o=t.get(21);e.middleButton&&!i?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():3===e.mouseDownCount?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):2===e.mouseDownCount?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey||o?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){f.Ox.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){f.Ox.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,i){e=this._validateViewColumn(e),f.Ox.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:i})}_createCursor(e,t){e=this._validateViewColumn(e),f.Ox.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){f.Ox.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){f.Ox.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){f.Ox.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){f.Ox.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){f.Ox.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){f.Ox.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){f.Ox.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){f.Ox.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){f.Ox.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}}class D{constructor(e){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=e}emitKeyDown(e){var t;null===(t=this.onKeyDown)||void 0===t||t.call(this,e)}emitKeyUp(e){var t;null===(t=this.onKeyUp)||void 0===t||t.call(this,e)}emitContextMenu(e){var t;null===(t=this.onContextMenu)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseMove(e){var t;null===(t=this.onMouseMove)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){var t;null===(t=this.onMouseLeave)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDown(e){var t;null===(t=this.onMouseDown)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseUp(e){var t;null===(t=this.onMouseUp)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){var t;null===(t=this.onMouseDrag)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){var t;null===(t=this.onMouseDrop)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){var e;null===(e=this.onMouseDropCanceled)||void 0===e||e.call(this)}emitMouseWheel(e){var t;null===(t=this.onMouseWheel)||void 0===t||t.call(this,e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return D.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){const i=Object.assign({},e);return i.position&&(i.position=t.convertViewPositionToModelPosition(i.position)),i.range&&(i.range=t.convertViewRangeToModelRange(i.range)),5!==i.type&&8!==i.type||(i.detail=this.convertViewToModelViewZoneData(i.detail,t)),i}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new p.L(e.afterLineNumber,1)).lineNumber}}}var b=i(6155),y=i(64778),L=i(69114);class S extends L.E{constructor(e){super(e),this._visibleLines=new y.G(this),this.domNode=this._visibleLines.domNode;const t=this._context.configuration.options,i=t.get(49);(0,b.N)(this.domNode,i),this._dynamicOverlays=[],this._isFocused=!1,this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++){const t=this._dynamicOverlays[e];if(t.shouldRender())return!0}return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++){const t=this._dynamicOverlays[e];t.dispose()}this._dynamicOverlays=[]}getDomNode(){return this.domNode}createVisibleLine(){return new M(this._context.configuration,this._dynamicOverlays)}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let s=t;s<=i;s++){const t=this._visibleLines.getVisibleLine(s);t.onConfigurationChanged(e)}const o=this._context.configuration.options,n=o.get(49);return(0,b.N)(this.domNode,n),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){const t=this._dynamicOverlays.filter((e=>e.shouldRender()));for(let i=0,o=t.length;i<o;i++){const o=t[i];o.prepareRender(e),o.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}}class M{constructor(e,t){this._configuration=e,this._lineHeight=this._configuration.options.get(65),this._dynamicOverlays=t,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=(0,_.X)(e)}onContentChanged(){}onTokensChanged(){}onConfigurationChanged(e){this._lineHeight=this._configuration.options.get(65)}renderLine(e,t,i,o){let n="";for(let s=0,r=this._dynamicOverlays.length;s<r;s++){const t=this._dynamicOverlays[s];n+=t.render(i.startLineNumber,e)}return this._renderedContent!==n&&(this._renderedContent=n,o.appendString('<div style="position:absolute;top:'),o.appendString(String(t)),o.appendString("px;width:100%;height:"),o.appendString(String(this._lineHeight)),o.appendString('px;">'),o.appendString(n),o.appendString("</div>"),!0)}layoutLine(e,t){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(this._lineHeight))}}class N extends S{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(142);this._contentWidth=i.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(142);return this._contentWidth=i.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}}class R extends S{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(142);this._contentLeft=i.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),(0,b.N)(this.domNode,t.get(49))}onConfigurationChanged(e){const t=this._context.configuration.options;(0,b.N)(this.domNode,t.get(49));const i=t.get(142);return this._contentLeft=i.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);const t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}}var E=i(66066),T=i(42652),x=i(27909),P=i(33832),I=i(7844),V=i(73840),O=i(51935),W=i(76304),F=i(96577),A=i(85852),H=i(55693),k=i(84306),K=i(21665),B=i(71946),Q=i(4586),U=i(47643),z=i(17547),G=i(4915),j=i(16287),q=i(36875),$=i(2200),Z=i(6117),J=i(1300),X=i(32656),Y=i(52817),ee=i(26025),te=i(53007),ie=i(42594),oe=i(58865),ne=i(79857),se=i(21881),re=function(e,t,i,o){var n,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(s<3?n(r):s>3?n(t,i,r):n(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},ae=function(e,t){return function(i,o){t(i,o,e)}};let de=class extends J.O{constructor(e,t,i,o,n,s,r){super(),this._instantiationService=r,this._shouldRecomputeGlyphMarginLanes=!1,this._selections=[new u.Y(1,1,1,1)],this._renderAnimationFrame=null;const a=new C(t,o,n,e);this._context=new $.A(t,i,o),this._context.addEventHandler(this),this._viewParts=[],this._textAreaHandler=this._instantiationService.createInstance(v.H,this._context,a,this._createTextAreaHandlerHelper()),this._viewParts.push(this._textAreaHandler),this._linesContent=(0,_.X)(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=(0,_.X)(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=(0,_.X)(document.createElement("div")),L.K.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new P.E(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new O.U(this._context,this._linesContent),this._viewZones=new j.q(this._context),this._viewParts.push(this._viewZones);const d=new K.p(this._context);this._viewParts.push(d);const l=new U.X(this._context);this._viewParts.push(l);const h=new N(this._context);this._viewParts.push(h),h.addDynamicOverlay(new T.BX(this._context)),h.addDynamicOverlay(new z.K(this._context)),h.addDynamicOverlay(new I.R(this._context)),h.addDynamicOverlay(new x.r(this._context)),h.addDynamicOverlay(new ie.K(this._context));const c=new R(this._context);this._viewParts.push(c),c.addDynamicOverlay(new T.gM(this._context)),c.addDynamicOverlay(new A.X(this._context)),c.addDynamicOverlay(new W.U(this._context)),c.addDynamicOverlay(new V.x(this._context)),this._glyphMarginWidgets=new oe.Iz(this._context),this._viewParts.push(this._glyphMarginWidgets);const g=new F.Z(this._context);g.getDomNode().appendChild(this._viewZones.marginDomNode),g.getDomNode().appendChild(c.getDomNode()),g.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(g),this._contentWidgets=new E.Y(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new G.o(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new k.c(this._context),this._viewParts.push(this._overlayWidgets);const f=new Q.b(this._context);this._viewParts.push(f);const p=new ee.z(this._context);this._viewParts.push(p);const w=new H.N(this._context);if(this._viewParts.push(w),d){const e=this._scrollbar.getOverviewRulerLayoutInfo();e.parent.insertBefore(d.getDomNode(),e.insertBefore)}this._linesContent.appendChild(h.getDomNode()),this._linesContent.appendChild(f.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(g.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(l.getDomNode()),this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea),this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(w.getDomNode()),this._overflowGuardContainer.appendChild(p.domNode),this.domNode.appendChild(this._overflowGuardContainer),s?s.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode):this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this._applyLayout(),this._pointerHandler=this._register(new m.a(this._context,a,this._createPointerHandlerHelper()))}_flushAccumulatedAndRenderNow(){this._shouldRecomputeGlyphMarginLanes&&(this._shouldRecomputeGlyphMarginLanes=!1,this._context.configuration.setGlyphMarginDecorationLaneCount(this._computeGlyphMarginLaneCount())),te.B.onRenderStart(),this._renderNow()}_computeGlyphMarginLaneCount(){const e=this._context.viewModel.model;let t=[];t=t.concat(e.getAllMarginDecorations().map((e=>{var t,i;const o=null!==(i=null===(t=e.options.glyphMargin)||void 0===t?void 0:t.position)&&void 0!==i?i:ne.U.Left;return{range:e.range,lane:o}}))),t=t.concat(this._glyphMarginWidgets.getWidgets().map((t=>{const i=e.validateRange(t.preference.range);return{range:i,lane:t.preference.lane}}))),t.sort(((e,t)=>g.e.compareRangesUsingStarts(e.range,t.range)));let i=null,o=null;for(const n of t)if(n.lane===ne.U.Left&&(!i||g.e.compareRangesUsingEnds(i,n.range)<0)&&(i=n.range),n.lane===ne.U.Right&&(!o||g.e.compareRangesUsingEnds(o,n.range)<0)&&(o=n.range),i&&o){if(i.endLineNumber<o.startLineNumber){i=null;continue}if(o.endLineNumber<i.startLineNumber){o=null;continue}return 2}return 1}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:e=>{this._textAreaHandler.textArea.domNode.dispatchEvent(e)},getLastRenderData:()=>{const e=this._viewCursors.getLastRenderData()||[],t=this._textAreaHandler.getLastRenderData();return new Y.sB(e,t)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:e=>this._viewZones.shouldSuppressMouseDownOnViewZone(e),shouldSuppressMouseDownOnWidget:e=>this._contentWidgets.shouldSuppressMouseDownOnWidget(e),getPositionFromDOMInfo:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(e,t)),visibleRangeForPosition:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new p.L(e,t))),getLineWidth:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(e))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(e))}}_applyLayout(){const e=this._context.configuration.options,t=e.get(142);this.domNode.setWidth(t.width),this.domNode.setHeight(t.height),this._overflowGuardContainer.setWidth(t.width),this._overflowGuardContainer.setHeight(t.height),this._linesContent.setWidth(1e6),this._linesContent.setHeight(1e6)}_getEditorClassName(){const e=this._textAreaHandler.isFocused()?" focused":"";return this._context.configuration.options.get(139)+" "+(0,X.m6)(this._context.theme.type)+e}handleEvents(e){super.handleEvents(e),this._scheduleRender()}onConfigurationChanged(e){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(e){return this._selections=e.selections,!1}onDecorationsChanged(e){return e.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(e){return this._context.theme.update(e.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){null!==this._renderAnimationFrame&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(const e of this._viewParts)e.dispose();super.dispose()}_scheduleRender(){null===this._renderAnimationFrame&&(this._renderAnimationFrame=n.lI(this._onRenderScheduled.bind(this),100))}_onRenderScheduled(){this._renderAnimationFrame=null,this._flushAccumulatedAndRenderNow()}_renderNow(){le((()=>this._actualRender()))}_getViewPartsToRender(){const e=[];let t=0;for(const i of this._viewParts)i.shouldRender()&&(e[t++]=i);return e}_actualRender(){if(!n.Uw(this.domNode.domNode))return;let e=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&0===e.length)return;const t=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(t.startLineNumber,t.endLineNumber,t.centeredLineNumber);const i=new Z.x(this._selections,t,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),e=this._getViewPartsToRender());const o=new q.xh(this._context.viewLayout,i,this._viewLines);for(const n of e)n.prepareRender(o);for(const n of e)n.render(o),n.onDidRender()}delegateVerticalScrollbarPointerDown(e){this._scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._scrollbar.delegateScrollFromMouseWheelEvent(e)}restoreState(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(e,t){const i=this._context.viewModel.model.validatePosition({lineNumber:e,column:t}),o=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();const n=this._viewLines.visibleRangeForPosition(new p.L(o.lineNumber,o.column));return n?n.left:-1}getTargetAtClientPoint(e,t){const i=this._pointerHandler.getTargetAtClientPoint(e,t);return i?D.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(e){return new B.V(this._context,e)}change(e){this._viewZones.changeViewZones(e),this._scheduleRender()}render(e,t){if(t){this._viewLines.forceShouldRender();for(const e of this._viewParts)e.forceShouldRender()}e?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(e){this._textAreaHandler.writeScreenReaderContent(e)}focus(){this._textAreaHandler.focusTextArea()}isFocused(){return this._textAreaHandler.isFocused()}setAriaOptions(e){this._textAreaHandler.setAriaOptions(e)}addContentWidget(e){this._contentWidgets.addWidget(e.widget),this.layoutContentWidget(e),this._scheduleRender()}layoutContentWidget(e){var t,i,o,n,s,r,a,d;this._contentWidgets.setWidgetPosition(e.widget,null!==(i=null===(t=e.position)||void 0===t?void 0:t.position)&&void 0!==i?i:null,null!==(n=null===(o=e.position)||void 0===o?void 0:o.secondaryPosition)&&void 0!==n?n:null,null!==(r=null===(s=e.position)||void 0===s?void 0:s.preference)&&void 0!==r?r:null,null!==(d=null===(a=e.position)||void 0===a?void 0:a.positionAffinity)&&void 0!==d?d:null),this._scheduleRender()}removeContentWidget(e){this._contentWidgets.removeWidget(e.widget),this._scheduleRender()}addOverlayWidget(e){this._overlayWidgets.addWidget(e.widget),this.layoutOverlayWidget(e),this._scheduleRender()}layoutOverlayWidget(e){const t=e.position?e.position.preference:null,i=this._overlayWidgets.setWidgetPosition(e.widget,t);i&&this._scheduleRender()}removeOverlayWidget(e){this._overlayWidgets.removeWidget(e.widget),this._scheduleRender()}addGlyphMarginWidget(e){this._glyphMarginWidgets.addWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(e){const t=e.position,i=this._glyphMarginWidgets.setWidgetPosition(e.widget,t);i&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(e){this._glyphMarginWidgets.removeWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};function le(e){try{return e()}catch(t){(0,s.dL)(t)}}de=re([ae(6,se.TG)],de);var he=i(93215),ce=i(16779),ue=i(51177),ge=i(22668),_e=i(44950),me=i(16375),ve=i(27193),fe=i(47277),pe=i(62362),we=i(46871),Ce=i(37174),De=i(39159),be=i(18736),ye=i(55907),Le=i(55455),Se=i(41675),Me=i(75662),Ne=i(69256),Re=i(97297),Ee=i(16458),Te=i(85398);i(20005);class xe extends a.JT{constructor(){super(),this._editor=null,this._instantiationService=null,this._instances=this._register(new a.b2),this._pending=new Map,this._finishedInstantiation=[],this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,i){this._editor=e,this._instantiationService=i;for(const o of t)this._pending.has(o.id)?(0,s.dL)(new Error(`Cannot have two contributions with the same id ${o.id}`)):this._pending.set(o.id,o);this._instantiateSome(0),this._register((0,Te.To)((()=>{this._instantiateSome(1)}))),this._register((0,Te.To)((()=>{this._instantiateSome(2)}))),this._register((0,Te.To)((()=>{this._instantiateSome(3)}),5e3))}saveViewState(){const e={};for(const[t,i]of this._instances)"function"===typeof i.saveViewState&&(e[t]=i.saveViewState());return e}restoreViewState(e){for(const[t,i]of this._instances)"function"===typeof i.restoreViewState&&i.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){this._register((0,Te.To)((()=>{this._instantiateSome(1)}),50))}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;const t=this._findPendingContributionsByInstantiation(e);for(const i of t)this._instantiateById(i.id)}_findPendingContributionsByInstantiation(e){const t=[];for(const[,i]of this._pending)i.instantiation===e&&t.push(i);return t}_instantiateById(e){const t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{const e=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,e),"function"===typeof e.restoreViewState&&0!==t.instantiation&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(i){(0,s.dL)(i)}}}}var Pe=i(61817),Ie=function(e,t,i,o){var n,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(s<3?n(r):s>3?n(t,i,r):n(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},Ve=function(e,t){return function(i,o){t(i,o,e)}},Oe=function(e,t,i,o){function n(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,s){function r(e){try{d(o.next(e))}catch(t){s(t)}}function a(e){try{d(o["throw"](e))}catch(t){s(t)}}function d(e){e.done?i(e.value):n(e.value).then(r,a)}d((o=o.apply(e,t||[])).next())}))};let We=0;class Fe{constructor(e,t,i,o,n,s){this.model=e,this.viewModel=t,this.view=i,this.hasRealView=o,this.listenersToRemove=n,this.attachedView=s}dispose(){(0,a.B9)(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}}let Ae=class e extends a.JT{get isSimpleWidget(){return this._configuration.isSimpleWidget}constructor(e,t,i,o,a,d,l,c,u,g,_,m){super(),this.languageConfigurationService=_,this._deliveryQueue=(0,r.Sp)(),this._contributions=this._register(new xe),this._onDidDispose=this._register(new r.Q5),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeModelTokens=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelTokens=this._onDidChangeModelTokens.event,this._onDidChangeConfiguration=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onDidChangeModel=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new ke(this._contributions,this._deliveryQueue)),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new He({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new He({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new ke(this._contributions,this._deliveryQueue)),this.onWillType=this._onWillType.event,this._onDidType=this._register(new ke(this._contributions,this._deliveryQueue)),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new ke(this._contributions,this._deliveryQueue)),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new ke(this._contributions,this._deliveryQueue)),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new ke(this._contributions,this._deliveryQueue)),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new ke(this._contributions,this._deliveryQueue)),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new ke(this._contributions,this._deliveryQueue)),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new ke(this._contributions,this._deliveryQueue)),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new ke(this._contributions,this._deliveryQueue)),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new ke(this._contributions,this._deliveryQueue)),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onDropIntoEditor=this._register(new ke(this._contributions,this._deliveryQueue)),this.onDropIntoEditor=this._onDropIntoEditor.event,this._onContextMenu=this._register(new ke(this._contributions,this._deliveryQueue)),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new ke(this._contributions,this._deliveryQueue)),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new ke(this._contributions,this._deliveryQueue)),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new ke(this._contributions,this._deliveryQueue)),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new ke(this._contributions,this._deliveryQueue)),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new ke(this._contributions,this._deliveryQueue)),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._actions=new Map,this._bannerDomNode=null,this._dropIntoEditorDecorations=this.createDecorationsCollection(),a.willCreateCodeEditor();const v=Object.assign({},t);let f;this._domElement=e,this._overflowWidgetsDomNode=v.overflowWidgetsDomNode,delete v.overflowWidgetsDomNode,this._id=++We,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,v,g)),this._register(this._configuration.onDidChange((e=>{this._onDidChangeConfiguration.fire(e);const t=this._configuration.options;if(e.hasChanged(142)){const e=t.get(142);this._onDidLayoutChange.fire(e)}}))),this._contextKeyService=this._register(l.createScoped(this._domElement)),this._notificationService=u,this._codeEditorService=a,this._commandService=d,this._themeService=c,this._register(new Ke(this,this._contextKeyService)),this._register(new Be(this,this._contextKeyService,m)),this._instantiationService=o.createChild(new De.y([Ce.i6,this._contextKeyService])),this._modelData=null,this._focusTracker=new Qe(e),this._register(this._focusTracker.onChange((()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())}))),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={},f=Array.isArray(i.contributions)?i.contributions:h.Uc.getEditorContributions(),this._contributions.initialize(this,f,this._instantiationService);for(const n of h.Uc.getEditorActions()){if(this._actions.has(n.id)){(0,s.dL)(new Error(`Cannot have two actions with the same id ${n.id}`));continue}const e=new ue.p(n.id,n.label,n.alias,(0,Le.f6)(n.precondition),(()=>this._instantiationService.invokeFunction((e=>Promise.resolve(n.runEditorCommand(e,this,null))))),this._contextKeyService);this._actions.set(e.id,e)}const p=()=>!this._configuration.options.get(89)&&this._configuration.options.get(35).enabled;this._register(new n.eg(this._domElement,{onDragEnter:()=>{},onDragOver:e=>{if(!p())return;const t=this.getTargetAtClientPoint(e.clientX,e.clientY);(null===t||void 0===t?void 0:t.position)&&this.showDropIndicatorAt(t.position)},onDrop:e=>Oe(this,void 0,void 0,(function*(){if(!p())return;if(this.removeDropIndicator(),!e.dataTransfer)return;const t=this.getTargetAtClientPoint(e.clientX,e.clientY);(null===t||void 0===t?void 0:t.position)&&this._onDropIntoEditor.fire({position:t.position,event:e})})),onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}writeScreenReaderContent(e){var t;null===(t=this._modelData)||void 0===t||t.view.writeScreenReaderContent(e)}_createConfiguration(e,t,i){return new l.z(e,t,this._domElement,i)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return ge.g.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e||{})}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?Ne.w.getWordAtPosition(this._modelData.model,this._configuration.options.get(128),e):null}getValue(e=null){if(!this._modelData)return"";const t=!(!e||!e.preserveBOM);let i=0;return e&&e.lineEnding&&"\n"===e.lineEnding?i=1:e&&e.lineEnding&&"\r\n"===e.lineEnding&&(i=2),this._modelData.model.getValue(i,t)}setValue(e){this._modelData&&this._modelData.model.setValue(e)}getModel(){return this._modelData?this._modelData.model:null}setModel(e=null){const t=e;if(null===this._modelData&&null===t)return;if(this._modelData&&this._modelData.model===t)return;const i=this.hasTextFocus(),o=this._detachModel();this._attachModel(t),i&&this.hasModel()&&this.focus();const n={oldModelUrl:o?o.uri:null,newModelUrl:t?t.uri:null};this._removeDecorationTypes(),this._onDidChangeModel.fire(n),this._postDetachModelCleanup(o),this._contributions.onAfterModelAttached()}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(const e in this._decorationTypeSubtypes){const t=this._decorationTypeSubtypes[e];for(const i in t)this._removeDecorationType(e+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(e,t,i,o){const n=e.model.validatePosition({lineNumber:t,column:i}),s=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n);return e.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(s.lineNumber,o)}getTopForLineNumber(t,i=!1){return this._modelData?e._getVerticalOffsetForPosition(this._modelData,t,1,i):-1}getTopForPosition(t,i){return this._modelData?e._getVerticalOffsetForPosition(this._modelData,t,i,!1):-1}static _getVerticalOffsetForPosition(e,t,i,o=!1){const n=e.model.validatePosition({lineNumber:t,column:i}),s=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(s.lineNumber,o)}getBottomForLineNumber(t,i=!1){return this._modelData?e._getVerticalOffsetAfterPosition(this._modelData,t,1,i):-1}setHiddenAreas(e,t){var i;null===(i=this._modelData)||void 0===i||i.viewModel.setHiddenAreas(e.map((e=>g.e.lift(e))),t)}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;const t=this._modelData.model.validatePosition(e),i=this._modelData.model.getOptions().tabSize;return ce.i.visibleColumnFromColumn(this._modelData.model.getLineContent(t.lineNumber),t.column,i)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e,t="api"){if(this._modelData){if(!p.L.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,t,i,o){if(!this._modelData)return;if(!g.e.isIRange(e))throw new Error("Invalid arguments");const n=this._modelData.model.validateRange(e),s=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(n);this._modelData.viewModel.revealRange("api",i,s,t,o)}revealLine(e,t=0){this._revealLine(e,0,t)}revealLineInCenter(e,t=0){this._revealLine(e,1,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._revealLine(e,2,t)}revealLineNearTop(e,t=0){this._revealLine(e,5,t)}_revealLine(e,t,i){if("number"!==typeof e)throw new Error("Invalid arguments");this._sendRevealRange(new g.e(e,1,e,1),t,!1,i)}revealPosition(e,t=0){this._revealPosition(e,0,!0,t)}revealPositionInCenter(e,t=0){this._revealPosition(e,1,!0,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._revealPosition(e,2,!0,t)}revealPositionNearTop(e,t=0){this._revealPosition(e,5,!0,t)}_revealPosition(e,t,i,o){if(!p.L.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new g.e(e.lineNumber,e.column,e.lineNumber,e.column),t,i,o)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e,t="api"){const i=u.Y.isISelection(e),o=g.e.isIRange(e);if(!i&&!o)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(e,t);else if(o){const i={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(i,t)}}_setSelectionImpl(e,t){if(!this._modelData)return;const i=new u.Y(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections(t,[i])}revealLines(e,t,i=0){this._revealLines(e,t,0,i)}revealLinesInCenter(e,t,i=0){this._revealLines(e,t,1,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._revealLines(e,t,2,i)}revealLinesNearTop(e,t,i=0){this._revealLines(e,t,5,i)}_revealLines(e,t,i,o){if("number"!==typeof e||"number"!==typeof t)throw new Error("Invalid arguments");this._sendRevealRange(new g.e(e,1,t,1),i,!1,o)}revealRange(e,t=0,i=!1,o=!0){this._revealRange(e,i?1:0,o,t)}revealRangeInCenter(e,t=0){this._revealRange(e,1,!0,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._revealRange(e,2,!0,t)}revealRangeNearTop(e,t=0){this._revealRange(e,5,!0,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._revealRange(e,6,!0,t)}revealRangeAtTop(e,t=0){this._revealRange(e,3,!0,t)}_revealRange(e,t,i,o){if(!g.e.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(g.e.lift(e),t,i,o)}setSelections(e,t="api",i=0){if(this._modelData){if(!e||0===e.length)throw new Error("Invalid arguments");for(let t=0,i=e.length;t<i;t++)if(!u.Y.isISelection(e[t]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,e,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e,t=1){if(this._modelData){if("number"!==typeof e)throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:e},t)}}setScrollTop(e,t=1){if(this._modelData){if("number"!==typeof e)throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:e},t)}}setScrollPosition(e,t=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(e,t)}hasPendingScrollAnimation(){return!!this._modelData&&this._modelData.viewModel.viewLayout.hasPendingScrollAnimation()}saveViewState(){if(!this._modelData)return null;const e=this._contributions.saveViewState(),t=this._modelData.viewModel.saveCursorState(),i=this._modelData.viewModel.saveState();return{cursorState:t,viewState:i,contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;const t=e;if(t&&t.cursorState&&t.viewState){const e=t.cursorState;Array.isArray(e)?e.length>0&&this._modelData.viewModel.restoreCursorState(e):this._modelData.viewModel.restoreCursorState([e]),this._contributions.restoreViewState(t.contributionsState||{});const i=this._modelData.viewModel.reduceRestoreState(t.viewState);this._modelData.view.restoreState(i)}}handleInitialized(){var e;null===(e=this._getViewModel())||void 0===e||e.visibleLinesStabilized()}getContribution(e){return this._contributions.get(e)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let e=this.getActions();return e=e.filter((e=>e.isSupported())),e}getAction(e){return this._actions.get(e)||null}trigger(e,t,i){switch(i=i||{},t){case"compositionStart":return void this._startComposition();case"compositionEnd":return void this._endComposition(e);case"type":{const t=i;return void this._type(e,t.text||"")}case"replacePreviousChar":{const t=i;return void this._compositionType(e,t.text||"",t.replaceCharCnt||0,0,0)}case"compositionType":{const t=i;return void this._compositionType(e,t.text||"",t.replacePrevCharCnt||0,t.replaceNextCharCnt||0,t.positionDelta||0)}case"paste":{const t=i;return void this._paste(e,t.text||"",t.pasteOnNewLine||!1,t.multicursorText||null,t.mode||null)}case"cut":return void this._cut(e)}const o=this.getAction(t);o?Promise.resolve(o.run(i)).then(void 0,s.dL):this._modelData&&(this._triggerEditorCommand(e,t,i)||this._triggerCommand(t,i))}_triggerCommand(e,t){this._commandService.executeCommand(e,t)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,t){this._modelData&&0!==t.length&&("keyboard"===e&&this._onWillType.fire(t),this._modelData.viewModel.type(t,e),"keyboard"===e&&this._onDidType.fire(t))}_compositionType(e,t,i,o,n){this._modelData&&this._modelData.viewModel.compositionType(t,i,o,n,e)}_paste(e,t,i,o,n){if(!this._modelData||0===t.length)return;const s=this._modelData.viewModel,r=s.getSelection().getStartPosition();s.paste(t,i,o,e);const a=s.getSelection().getStartPosition();"keyboard"===e&&this._onDidPaste.fire({range:new g.e(r.lineNumber,r.column,a.lineNumber,a.column),languageId:n})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,t,i){const o=h.Uc.getEditorCommand(t);return!!o&&(i=i||{},i.source=e,this._instantiationService.invokeFunction((e=>{Promise.resolve(o.runEditorCommand(e,this,i)).then(void 0,s.dL)})),!0)}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!!this._modelData&&(!this._configuration.options.get(89)&&(this._modelData.model.pushStackElement(),!0))}popUndoStop(){return!!this._modelData&&(!this._configuration.options.get(89)&&(this._modelData.model.popStackElement(),!0))}executeEdits(e,t,i){if(!this._modelData)return!1;if(this._configuration.options.get(89))return!1;let o;return o=i?Array.isArray(i)?()=>i:i:()=>null,this._modelData.viewModel.executeEdits(e,t,o),!0}executeCommand(e,t){this._modelData&&this._modelData.viewModel.executeCommand(t,e)}executeCommands(e,t){this._modelData&&this._modelData.viewModel.executeCommands(t,e)}createDecorationsCollection(e){return new Ue(this,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){return this._modelData?this._modelData.model.getLineDecorations(e,this._id,(0,he.$J)(this._configuration.options)):null}getDecorationsInRange(e){return this._modelData?this._modelData.model.getDecorationsInRange(e,this._id,(0,he.$J)(this._configuration.options)):null}deltaDecorations(e,t){return this._modelData?0===e.length&&0===t.length?e:this._modelData.model.deltaDecorations(e,t,this._id):[]}removeDecorations(e){this._modelData&&0!==e.length&&this._modelData.model.changeDecorations((t=>{t.deltaDecorations(e,[])}))}removeDecorationsByType(e){const t=this._decorationTypeKeysToIds[e];t&&this.deltaDecorations(t,[]),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){const e=this._configuration.options,t=e.get(142);return t}createOverviewRuler(e){return this._modelData&&this._modelData.hasRealView?this._modelData.view.createOverviewRuler(e):null}getContainerDomNode(){return this._domElement}getDomNode(){return this._modelData&&this._modelData.hasRealView?this._modelData.view.domNode.domNode:null}delegateVerticalScrollbarPointerDown(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.delegateScrollFromMouseWheelEvent(e)}layout(e){this._configuration.observeContainer(e),this.render()}focus(){this._modelData&&this._modelData.hasRealView&&this._modelData.view.focus()}hasTextFocus(){return!(!this._modelData||!this._modelData.hasRealView)&&this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(e){const t={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id."),this._contentWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(t)}layoutContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const e=this._contentWidgets[t];delete this._contentWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(e)}}addOverlayWidget(e){const t={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(t)}layoutOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const e=this._overlayWidgets[t];delete this._overlayWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(e)}}addGlyphMarginWidget(e){const t={widget:e,position:e.getPosition()};this._glyphMarginWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(t)}layoutGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(i)}}removeGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const e=this._glyphMarginWidgets[t];delete this._glyphMarginWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(e)}}changeViewZones(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.change(e)}getTargetAtClientPoint(e,t){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getTargetAtClientPoint(e,t):null}getScrolledVisiblePosition(t){if(!this._modelData||!this._modelData.hasRealView)return null;const i=this._modelData.model.validatePosition(t),o=this._configuration.options,n=o.get(142),s=e._getVerticalOffsetForPosition(this._modelData,i.lineNumber,i.column)-this.getScrollTop(),r=this._modelData.view.getOffsetForColumn(i.lineNumber,i.column)+n.glyphMarginWidth+n.lineNumbersWidth+n.decorationsWidth-this.getScrollLeft();return{top:s,left:r,height:o.get(65)}}getOffsetForColumn(e,t){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getOffsetForColumn(e,t):-1}render(e=!1){this._modelData&&this._modelData.hasRealView&&this._modelData.view.render(!0,e)}setAriaOptions(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.setAriaOptions(e)}applyFontInfo(e){(0,b.N)(e,this._configuration.options.get(49))}setBanner(e,t){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),this._bannerDomNode=e,this._configuration.setReservedHeight(e?t:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(e){if(!e)return void(this._modelData=null);const t=[];this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setModelLineCount(e.getLineCount());const i=e.onBeforeAttached(),s=new pe.j(this._id,this._configuration,e,Me.C.create(),Se.p.create(this._configuration.options),(e=>n.jL(e)),this.languageConfigurationService,this._themeService,i);t.push(e.onWillDispose((()=>this.setModel(null)))),t.push(s.onEvent((t=>{switch(t.kind){case 0:this._onDidContentSizeChange.fire(t);break;case 1:this._editorTextFocus.setValue(t.hasFocus);break;case 2:this._onDidScrollChange.fire(t);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(t.reachedMaxCursorCount){const e=this.getOption(78),t=o.NC("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",e);this._notificationService.prompt(be.zb.Warning,t,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:o.NC("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}const e=[];for(let o=0,s=t.selections.length;o<s;o++)e[o]=t.selections[o].getPosition();const i={position:e[0],secondaryPositions:e.slice(1),reason:t.reason,source:t.source};this._onDidChangeCursorPosition.fire(i);const n={selection:t.selections[0],secondarySelections:t.selections.slice(1),modelVersionId:t.modelVersionId,oldSelections:t.oldSelections,oldModelVersionId:t.oldModelVersionId,source:t.source,reason:t.reason};this._onDidChangeCursorSelection.fire(n);break}case 7:this._onDidChangeModelDecorations.fire(t.event);break;case 8:this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._onDidChangeModelLanguage.fire(t.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(t.event);break;case 10:this._onDidChangeModelContent.fire(t.event);break;case 11:this._onDidChangeModelOptions.fire(t.event);break;case 12:this._onDidChangeModelTokens.fire(t.event);break}})));const[r,a]=this._createView(s);if(a){this._domElement.appendChild(r.domNode.domNode);let t=Object.keys(this._contentWidgets);for(let e=0,i=t.length;e<i;e++){const i=t[e];r.addContentWidget(this._contentWidgets[i])}t=Object.keys(this._overlayWidgets);for(let e=0,i=t.length;e<i;e++){const i=t[e];r.addOverlayWidget(this._overlayWidgets[i])}t=Object.keys(this._glyphMarginWidgets);for(let e=0,i=t.length;e<i;e++){const i=t[e];r.addGlyphMarginWidget(this._glyphMarginWidgets[i])}r.render(!1,!0),r.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new Fe(e,s,r,a,t,i)}_createView(e){let t;t=this.isSimpleWidget?{paste:(e,t,i,o)=>{this._paste("keyboard",e,t,i,o)},type:e=>{this._type("keyboard",e)},compositionType:(e,t,i,o)=>{this._compositionType("keyboard",e,t,i,o)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:{paste:(e,t,i,o)=>{const n={text:e,pasteOnNewLine:t,multicursorText:i,mode:o};this._commandService.executeCommand("paste",n)},type:e=>{const t={text:e};this._commandService.executeCommand("type",t)},compositionType:(e,t,i,o)=>{if(i||o){const n={text:e,replacePrevCharCnt:t,replaceNextCharCnt:i,positionDelta:o};this._commandService.executeCommand("compositionType",n)}else{const i={text:e,replaceCharCnt:t};this._commandService.executeCommand("replacePreviousChar",i)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const i=new D(e.coordinatesConverter);i.onKeyDown=e=>this._onKeyDown.fire(e),i.onKeyUp=e=>this._onKeyUp.fire(e),i.onContextMenu=e=>this._onContextMenu.fire(e),i.onMouseMove=e=>this._onMouseMove.fire(e),i.onMouseLeave=e=>this._onMouseLeave.fire(e),i.onMouseDown=e=>this._onMouseDown.fire(e),i.onMouseUp=e=>this._onMouseUp.fire(e),i.onMouseDrag=e=>this._onMouseDrag.fire(e),i.onMouseDrop=e=>this._onMouseDrop.fire(e),i.onMouseDropCanceled=e=>this._onMouseDropCanceled.fire(e),i.onMouseWheel=e=>this._onMouseWheel.fire(e);const o=new de(t,this._configuration,this._themeService.getColorTheme(),e,i,this._overflowWidgetsDomNode,this._instantiationService);return[o,!0]}_postDetachModelCleanup(e){null===e||void 0===e||e.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(!this._modelData)return null;const e=this._modelData.model,t=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),t&&this._domElement.contains(t)&&this._domElement.removeChild(t),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),e}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}hasModel(){return null!==this._modelData}showDropIndicatorAt(t){const i=[{range:new g.e(t.lineNumber,t.column,t.lineNumber,t.column),options:e.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(i),this.revealPosition(t,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(e,t){this._contextKeyService.createKey(e,t)}};Ae.dropIntoEditorDecorationOptions=me.qx.register({description:"workbench-dnd-target",className:"dnd-target"}),Ae=Ie([Ve(3,se.TG),Ve(4,c.$),Ve(5,we.H),Ve(6,Ce.i6),Ve(7,X.XE),Ve(8,be.lT),Ve(9,ye.F),Ve(10,Re.c_),Ve(11,Ee.p)],Ae);class He extends a.JT{constructor(e){super(),this._emitterOptions=e,this._onDidChangeToTrue=this._register(new r.Q5(this._emitterOptions)),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new r.Q5(this._emitterOptions)),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(e){const t=e?2:1;this._value!==t&&(this._value=t,2===this._value?this._onDidChangeToTrue.fire():1===this._value&&this._onDidChangeToFalse.fire())}}class ke extends r.Q5{constructor(e,t){super({deliveryQueue:t}),this._contributions=e}fire(e){this._contributions.onBeforeInteractionEvent(),super.fire(e)}}class Ke extends a.JT{constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=_e.u.editorSimpleInput.bindTo(t),this._editorFocus=_e.u.focus.bindTo(t),this._textInputFocus=_e.u.textInputFocus.bindTo(t),this._editorTextFocus=_e.u.editorTextFocus.bindTo(t),this._editorTabMovesFocus=_e.u.tabMovesFocus.bindTo(t),this._editorReadonly=_e.u.readOnly.bindTo(t),this._inDiffEditor=_e.u.inDiffEditor.bindTo(t),this._editorColumnSelection=_e.u.columnSelection.bindTo(t),this._hasMultipleSelections=_e.u.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=_e.u.hasNonEmptySelection.bindTo(t),this._canUndo=_e.u.canUndo.bindTo(t),this._canRedo=_e.u.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromConfig()))),this._register(this._editor.onDidChangeCursorSelection((()=>this._updateFromSelection()))),this._register(this._editor.onDidFocusEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidFocusEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidChangeModel((()=>this._updateFromModel()))),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromModel()))),this._register(Pe.n.onDidChangeTabFocus((()=>this._editorTabMovesFocus.set(Pe.n.getTabFocusMode("editorFocus"))))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const e=this._editor.getOptions();this._editorTabMovesFocus.set(Pe.n.getTabFocusMode("editorFocus")),this._editorReadonly.set(e.get(89)),this._inDiffEditor.set(e.get(60)),this._editorColumnSelection.set(e.get(21))}_updateFromSelection(){const e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some((e=>!e.isEmpty())))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const e=this._editor.getModel();this._canUndo.set(Boolean(e&&e.canUndo())),this._canRedo.set(Boolean(e&&e.canRedo()))}}class Be extends a.JT{constructor(e,t,i){super(),this._editor=e,this._contextKeyService=t,this._languageFeaturesService=i,this._langId=_e.u.languageId.bindTo(t),this._hasCompletionItemProvider=_e.u.hasCompletionItemProvider.bindTo(t),this._hasCodeActionsProvider=_e.u.hasCodeActionsProvider.bindTo(t),this._hasCodeLensProvider=_e.u.hasCodeLensProvider.bindTo(t),this._hasDefinitionProvider=_e.u.hasDefinitionProvider.bindTo(t),this._hasDeclarationProvider=_e.u.hasDeclarationProvider.bindTo(t),this._hasImplementationProvider=_e.u.hasImplementationProvider.bindTo(t),this._hasTypeDefinitionProvider=_e.u.hasTypeDefinitionProvider.bindTo(t),this._hasHoverProvider=_e.u.hasHoverProvider.bindTo(t),this._hasDocumentHighlightProvider=_e.u.hasDocumentHighlightProvider.bindTo(t),this._hasDocumentSymbolProvider=_e.u.hasDocumentSymbolProvider.bindTo(t),this._hasReferenceProvider=_e.u.hasReferenceProvider.bindTo(t),this._hasRenameProvider=_e.u.hasRenameProvider.bindTo(t),this._hasSignatureHelpProvider=_e.u.hasSignatureHelpProvider.bindTo(t),this._hasInlayHintsProvider=_e.u.hasInlayHintsProvider.bindTo(t),this._hasDocumentFormattingProvider=_e.u.hasDocumentFormattingProvider.bindTo(t),this._hasDocumentSelectionFormattingProvider=_e.u.hasDocumentSelectionFormattingProvider.bindTo(t),this._hasMultipleDocumentFormattingProvider=_e.u.hasMultipleDocumentFormattingProvider.bindTo(t),this._hasMultipleDocumentSelectionFormattingProvider=_e.u.hasMultipleDocumentSelectionFormattingProvider.bindTo(t),this._isInWalkThrough=_e.u.isInWalkThroughSnippet.bindTo(t);const o=()=>this._update();this._register(e.onDidChangeModel(o)),this._register(e.onDidChangeModelLanguage(o)),this._register(i.completionProvider.onDidChange(o)),this._register(i.codeActionProvider.onDidChange(o)),this._register(i.codeLensProvider.onDidChange(o)),this._register(i.definitionProvider.onDidChange(o)),this._register(i.declarationProvider.onDidChange(o)),this._register(i.implementationProvider.onDidChange(o)),this._register(i.typeDefinitionProvider.onDidChange(o)),this._register(i.hoverProvider.onDidChange(o)),this._register(i.documentHighlightProvider.onDidChange(o)),this._register(i.documentSymbolProvider.onDidChange(o)),this._register(i.referenceProvider.onDidChange(o)),this._register(i.renameProvider.onDidChange(o)),this._register(i.documentFormattingEditProvider.onDidChange(o)),this._register(i.documentRangeFormattingEditProvider.onDidChange(o)),this._register(i.signatureHelpProvider.onDidChange(o)),this._register(i.inlayHintsProvider.onDidChange(o)),o()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents((()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInWalkThrough.reset()}))}_update(){const e=this._editor.getModel();e?this._contextKeyService.bufferChangeEvents((()=>{this._langId.set(e.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(e)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(e)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(e)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(e)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(e)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(e)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(e)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(e)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(e)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(e)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(e)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(e)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(e)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(e)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(e)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(e).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._isInWalkThrough.set(e.uri.scheme===d.lg.walkThroughSnippet)})):this.reset()}}class Qe extends a.JT{constructor(e){super(),this._onChange=this._register(new r.Q5),this.onChange=this._onChange.event,this._hasFocus=!1,this._domFocusTracker=this._register(n.go(e)),this._register(this._domFocusTracker.onDidFocus((()=>{this._hasFocus=!0,this._onChange.fire(void 0)}))),this._register(this._domFocusTracker.onDidBlur((()=>{this._hasFocus=!1,this._onChange.fire(void 0)})))}hasFocus(){return this._hasFocus}}class Ue{get length(){return this._decorationIds.length}constructor(e,t){this._editor=e,this._decorationIds=[],this._isChangingDecorations=!1,Array.isArray(t)&&t.length>0&&this.set(t)}onDidChange(e,t,i){return this._editor.onDidChangeModelDecorations((i=>{this._isChangingDecorations||e.call(t,i)}),i)}getRange(e){return this._editor.hasModel()?e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e]):null}getRanges(){if(!this._editor.hasModel())return[];const e=this._editor.getModel(),t=[];for(const i of this._decorationIds){const o=e.getDecorationRange(i);o&&t.push(o)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){0!==this._decorationIds.length&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations((t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)}))}finally{this._isChangingDecorations=!1}return this._decorationIds}}const ze=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),Ge=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function je(e){return ze+encodeURIComponent(e.toString())+Ge}const qe=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),$e=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function Ze(e){return qe+encodeURIComponent(e.toString())+$e}(0,X.Ic)(((e,t)=>{const i=e.getColor(fe.lXJ);i&&t.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${je(i)}") repeat-x bottom left; }`);const o=e.getColor(fe.uoC);o&&t.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${je(o)}") repeat-x bottom left; }`);const n=e.getColor(fe.c63);n&&t.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${je(n)}") repeat-x bottom left; }`);const s=e.getColor(fe.Dut);s&&t.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${Ze(s)}") no-repeat bottom left; }`);const r=e.getColor(ve.zu);r&&t.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${r.rgba.a}; }`)}))},30039:(e,t,i)=>{i.d(t,{$F:()=>C,Cm:()=>D,Jv:()=>v,LE:()=>m,W3:()=>w,fO:()=>h,i_:()=>_,iq:()=>u,n_:()=>f,rd:()=>g,rq:()=>p,vv:()=>c});var o=i(8419),n=i(81478),s=i(99588),r=i(16375),a=i(25206),d=i(98158);const l=(0,d.q5)("diff-insert",o.l.add,(0,a.NC)("diffInsertIcon","Line decoration for inserts in the diff editor.")),h=(0,d.q5)("diff-remove",o.l.remove,(0,a.NC)("diffRemoveIcon","Line decoration for removals in the diff editor.")),c=r.qx.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+s.k.asClassName(l),marginClassName:"gutter-insert"}),u=r.qx.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+s.k.asClassName(h),marginClassName:"gutter-delete"}),g=r.qx.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),_=r.qx.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),m=r.qx.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),v=r.qx.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),f=r.qx.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),p=r.qx.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),w=r.qx.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),C=r.qx.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"}),D=r.qx.register({description:"diff-editor-arrow-revert-change",glyphMarginHoverMessage:new n.W5(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown((0,a.NC)("revertChangeHoverMessage","Click to revert change")),glyphMarginClassName:"arrow-revert-change "+s.k.asClassName(o.l.arrowRight),zIndex:10001})},44811:(e,t,i)=>{i.d(t,{Z$:()=>v,hM:()=>p});var o=i(85398),n=i(70959),s=i(90168),r=i(61818),a=i(55455),d=i(66676),l=i(33162),h=i(60309),c=i(54179),u=i(2371),g=i(81452),_=i(25624),m=function(e,t,i,o){function n(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,s){function r(e){try{d(o.next(e))}catch(t){s(t)}}function a(e){try{d(o["throw"](e))}catch(t){s(t)}}function d(e){e.done?i(e.value):n(e.value).then(r,a)}d((o=o.apply(e,t||[])).next())}))};class v extends n.JT{constructor(e,t,i){super(),this.model=e,this._options=t,this._isDiffUpToDate=(0,s.uh)("isDiffUpToDate",!1),this.isDiffUpToDate=this._isDiffUpToDate,this._diff=(0,s.uh)("diff",void 0),this.diff=this._diff,this._unchangedRegions=(0,s.uh)("unchangedRegion",{regions:[],originalDecorationIds:[],modifiedDecorationIds:[]}),this.unchangedRegions=(0,s.nK)("unchangedRegions",(e=>this._options.collapseUnchangedRegions.read(e)?this._unchangedRegions.read(e).regions:((0,s.PS)((e=>{for(const t of this._unchangedRegions.get().regions)t.setState(0,0,e)})),[]))),this.syncedMovedTexts=(0,s.uh)("syncedMovedText",void 0);const n=(0,s.GN)("contentChangedSignal"),a=this._register(new o.pY((()=>n.trigger(void 0)),200)),l=(t,i)=>{const o=w.fromDiffs(t.changes,e.original.getLineCount(),e.modified.getLineCount()),n=this._unchangedRegions.get(),s=n.originalDecorationIds.map((t=>e.original.getDecorationRange(t))).filter((e=>!!e)).map((e=>d.z.fromRange(e))),r=n.modifiedDecorationIds.map((t=>e.modified.getDecorationRange(t))).filter((e=>!!e)).map((e=>d.z.fromRange(e))),a=e.original.deltaDecorations(n.originalDecorationIds,o.map((e=>({range:e.originalRange.toInclusiveRange(),options:{description:"unchanged"}})))),l=e.modified.deltaDecorations(n.modifiedDecorationIds,o.map((e=>({range:e.modifiedRange.toInclusiveRange(),options:{description:"unchanged"}}))));for(const e of o)for(let t=0;t<n.regions.length;t++)if(e.originalRange.intersectsStrict(s[t])&&e.modifiedRange.intersectsStrict(r[t])){e.setHiddenModifiedRange(n.regions[t].getHiddenModifiedRange(void 0),i);break}this._unchangedRegions.set({regions:o,originalDecorationIds:a,modifiedDecorationIds:l},i)};this._register(e.modified.onDidChangeContent((t=>{const i=this._diff.get();if(!i)return;const o=u.Q.fromModelContentChanges(t.changes),n=b(this._lastDiff,o,e.original,e.modified);n&&(this._lastDiff=n,(0,s.PS)((e=>{this._diff.set(f.fromDiffResult(this._lastDiff),e),l(n,e);const t=this.syncedMovedTexts.get();this.syncedMovedTexts.set(t?this._lastDiff.moves.find((e=>e.lineRangeMapping.modified.intersect(t.lineRangeMapping.modified))):void 0,e)}))),a.schedule()}))),this._register(e.original.onDidChangeContent((t=>{const i=this._diff.get();if(!i)return;const o=u.Q.fromModelContentChanges(t.changes),n=C(this._lastDiff,o,e.original,e.modified);n&&(this._lastDiff=n,(0,s.PS)((e=>{this._diff.set(f.fromDiffResult(this._lastDiff),e),l(n,e);const t=this.syncedMovedTexts.get();this.syncedMovedTexts.set(t?this._lastDiff.moves.find((e=>e.lineRangeMapping.modified.intersect(t.lineRangeMapping.modified))):void 0,e)}))),a.schedule()})));const h=(0,s.aq)("documentDiffProviderOptionChanged",i.onDidChange);this._register((0,r.b2)("compute diff",((t,o)=>m(this,void 0,void 0,(function*(){var r,d;a.cancel(),n.read(t),h.read(t),this._isDiffUpToDate.set(!1,void 0);let c=[];o.add(e.original.onDidChangeContent((e=>{const t=u.Q.fromModelContentChanges(e.changes);c=(0,g.o)(c,t)})));let _=[];o.add(e.modified.onDidChangeContent((e=>{const t=u.Q.fromModelContentChanges(e.changes);_=(0,g.o)(_,t)})));let m=yield i.computeDiff(e.original,e.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(t),maxComputationTimeMs:this._options.maxComputationTimeMs.read(t),computeMoves:this._options.showMoves.read(t)});m=null!==(r=C(m,c,e.original,e.modified))&&void 0!==r?r:m,m=null!==(d=b(m,_,e.original,e.modified))&&void 0!==d?d:m,(0,s.PS)((e=>{l(m,e),this._lastDiff=m;const t=f.fromDiffResult(m);this._diff.set(t,e),this._isDiffUpToDate.set(!0,e);const i=this.syncedMovedTexts.get();this.syncedMovedTexts.set(i?this._lastDiff.moves.find((e=>e.lineRangeMapping.modified.intersect(i.lineRangeMapping.modified))):void 0,e)}))})))))}ensureModifiedLineIsVisible(e,t){var i;if(0===(null===(i=this.diff.get())||void 0===i?void 0:i.mappings.length))return;const o=this._unchangedRegions.get().regions;for(const n of o)if(n.getHiddenModifiedRange(void 0).contains(e))return void n.showAll(t)}ensureOriginalLineIsVisible(e,t){var i;if(0===(null===(i=this.diff.get())||void 0===i?void 0:i.mappings.length))return;const o=this._unchangedRegions.get().regions;for(const n of o)if(n.getHiddenOriginalRange(void 0).contains(e))return void n.showAll(t)}waitForDiff(){return m(this,void 0,void 0,(function*(){yield(0,s.F_)(this.isDiffUpToDate,(e=>e))}))}serializeState(){const e=this._unchangedRegions.get();return{collapsedRegions:e.regions.map((e=>({range:e.getHiddenModifiedRange(void 0).serialize()})))}}restoreSerializedState(e){const t=e.collapsedRegions.map((e=>d.z.deserialize(e.range))),i=this._unchangedRegions.get();(0,s.PS)((e=>{for(const o of i.regions)for(const i of t)if(o.modifiedRange.intersect(i)){o.setHiddenModifiedRange(i,e);break}}))}}class f{static fromDiffResult(e){return new f(e.changes.map((e=>new p(e))),e.moves||[],e.identical,e.quitEarly)}constructor(e,t,i,o){this.mappings=e,this.movedTexts=t,this.identical=i,this.quitEarly=o}}class p{constructor(e){this.lineRangeMapping=e}}class w{static fromDiffs(e,t,i){const o=h.f0.inverse(e,t,i),n=[],s=3,r=3;for(const a of o){let e=a.originalRange.startLineNumber,o=a.modifiedRange.startLineNumber,d=a.originalRange.length;const l=1===e&&1===o,h=e+d===t+1&&o+d===i+1;(l||h)&&d>r+s?(l&&!h&&(d-=r),h&&!l&&(e+=r,o+=r,d-=r),n.push(new w(e,o,d,0,0))):d>2*r+s&&(e+=r,o+=r,d-=2*r,n.push(new w(e,o,d,0,0)))}return n}get originalRange(){return d.z.ofLength(this.originalLineNumber,this.lineCount)}get modifiedRange(){return d.z.ofLength(this.modifiedLineNumber,this.lineCount)}constructor(e,t,i,o,n){this.originalLineNumber=e,this.modifiedLineNumber=t,this.lineCount=i,this._visibleLineCountTop=(0,s.uh)("visibleLineCountTop",0),this.visibleLineCountTop=this._visibleLineCountTop,this._visibleLineCountBottom=(0,s.uh)("visibleLineCountBottom",0),this.visibleLineCountBottom=this._visibleLineCountBottom,this._shouldHideControls=(0,s.nK)("isVisible",(e=>this.visibleLineCountTop.read(e)+this.visibleLineCountBottom.read(e)===this.lineCount&&!this.isDragged.read(e))),this.isDragged=(0,s.uh)("isDragged",!1),this._visibleLineCountTop.set(o,void 0),this._visibleLineCountBottom.set(n,void 0)}shouldHideControls(e){return this._shouldHideControls.read(e)}getHiddenOriginalRange(e){return d.z.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}getHiddenModifiedRange(e){return d.z.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}setHiddenModifiedRange(e,t){const i=e.startLineNumber-this.modifiedLineNumber,o=this.modifiedLineNumber+this.lineCount-e.endLineNumberExclusive;this.setState(i,o,t)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(e=10,t){const i=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+e,i),t)}showMoreBelow(e=10,t){const i=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+e,i),t)}showAll(e){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),e)}setState(e,t,i){e=Math.max(Math.min(e,this.lineCount),0),t=Math.max(Math.min(t,this.lineCount-e),0),this._visibleLineCountTop.set(e,i),this._visibleLineCountBottom.set(t,i)}}function C(e,t,i,o){if(0===t.length)return e;const n=D(e),s=b(n,t,o,i);return s?D(s):void 0}function D(e){return{changes:e.changes.map((e=>e.flip())),moves:e.moves.map((e=>e.flip())),identical:e.identical,quitEarly:e.quitEarly}}function b(e,t,i,o){if(0===t.length)return e;if(e.changes.some((e=>!e.innerChanges))||e.moves.length>0)return;const n=L(e.changes,t,i,o),s=e.moves.map((e=>{const n=y(e.lineRangeMapping.modified,t);return n?new h.y0(new h.Qy(e.lineRangeMapping.original,n),L(e.changes,t,i,o)):void 0})).filter(a.$K);return{identical:!1,quitEarly:!1,changes:n,moves:s}}function y(e,t){let i=e.startLineNumber,o=e.endLineNumberExclusive;for(let n=t.length-1;n>=0;n--){const e=t[n],s=(0,_.W9)(e.startOffset)+1,r=(0,_.W9)(e.endOffset)+1,a=(0,_.W9)(e.newLength),d=a-(r-s);if(r<i)i+=d,o+=d;else if(s>o);else{if(s<i&&o<r)return;s<i&&r<=o?(i=r+1,i+=d,o+=d):i<=s&&r<i?o=s:o+=d}}return new d.z(i,o)}function L(e,t,i,o){const n=e.flatMap((e=>e.innerChanges.map((e=>new u.Q((0,_.PZ)(e.originalRange.getStartPosition()),(0,_.PZ)(e.originalRange.getEndPosition()),(0,_.Uv)(e.modifiedRange).toLength()))))),s=(0,g.o)(n,t);let r=_.xl,a=_.xl;const d=s.map((e=>{const t=(0,_.Ii)(a,(0,_.BE)(r,e.startOffset));return r=e.endOffset,a=(0,_.Ii)(t,e.newLength),new h.iy(l.e.fromPositions((0,_.bP)(e.startOffset),(0,_.bP)(e.endOffset)),l.e.fromPositions((0,_.bP)(t),(0,_.bP)(a)))})),m=(0,c.v)(d,i.getLinesContent(),o.getLinesContent());return m}},25688:(e,t,i)=>{i.d(t,{z:()=>Me});var o=i(2548),n=i(98642),s=i(11271),r=i(90168),a=i(61818),d=i(33125),l=i(82861),h=i(48077),c=i(35195),u=i(97469),g=i(70959),_=i(55455),m=i(30039),v=i(1360),f=i(18513),p=i(66676),w=i(89999),C=i(33162);class D extends g.JT{constructor(e,t,i){super(),this._editors=e,this._diffModel=t,this._options=i,this._decorations=(0,r.nK)("decorations",(e=>{var t;const i=null===(t=this._diffModel.read(e))||void 0===t?void 0:t.diff.read(e);if(!i)return null;const o=this._diffModel.read(e).syncedMovedTexts.read(e),n=this._options.renderIndicators.read(e),s=this._options.showEmptyDecorations.read(e),r=[],a=[];for(const d of i.mappings){const t=p.z.subtract(d.lineRangeMapping.originalRange,null===o||void 0===o?void 0:o.lineRangeMapping.original).map((e=>e.toInclusiveRange())).filter(_.$K);for(const e of t)r.push({range:e,options:n?m.iq:m.i_});const i=p.z.subtract(d.lineRangeMapping.modifiedRange,null===o||void 0===o?void 0:o.lineRangeMapping.modified).map((e=>e.toInclusiveRange())).filter(_.$K);for(const e of i)a.push({range:e,options:n?m.vv:m.rd});if(d.lineRangeMapping.modifiedRange.isEmpty||d.lineRangeMapping.originalRange.isEmpty){for(const e of t)r.push({range:e,options:m.W3});for(const e of i)a.push({range:e,options:m.Jv})}else for(const e of d.lineRangeMapping.innerChanges||[])o&&(o.lineRangeMapping.original.intersect(new p.z(e.originalRange.startLineNumber,e.originalRange.endLineNumber))||o.lineRangeMapping.modified.intersect(new p.z(e.modifiedRange.startLineNumber,e.modifiedRange.endLineNumber)))||(d.lineRangeMapping.originalRange.contains(e.originalRange.startLineNumber)&&r.push({range:e.originalRange,options:e.originalRange.isEmpty()&&s?m.$F:m.rq}),d.lineRangeMapping.modifiedRange.contains(e.modifiedRange.startLineNumber)&&a.push({range:e.modifiedRange,options:e.modifiedRange.isEmpty()&&s?m.n_:m.LE}));d.lineRangeMapping.modifiedRange.isEmpty||!this._options.shouldRenderRevertArrows.read(e)||o||a.push({range:C.e.fromPositions(new w.L(d.lineRangeMapping.modifiedRange.startLineNumber,1)),options:m.Cm})}if(o)for(const d of o.changes){const e=d.originalRange.toInclusiveRange();e&&r.push({range:e,options:n?m.iq:m.i_});const t=d.modifiedRange.toInclusiveRange();t&&a.push({range:t,options:n?m.vv:m.rd});for(const i of d.innerChanges||[])r.push({range:i.originalRange,options:m.rq}),a.push({range:i.modifiedRange,options:m.LE})}for(const d of i.movedTexts)r.push({range:d.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal",blockPadding:[v.o.movedCodeBlockPadding,0,v.o.movedCodeBlockPadding,v.o.movedCodeBlockPadding]}}),a.push({range:d.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified",blockPadding:[4,0,4,4]}});return{originalDecorations:r,modifiedDecorations:a}})),this._register((0,f.RP)(this._editors.original,this._decorations.map((e=>(null===e||void 0===e?void 0:e.originalDecorations)||[])))),this._register((0,f.RP)(this._editors.modified,this._decorations.map((e=>(null===e||void 0===e?void 0:e.modifiedDecorations)||[]))))}}var b=i(18612);class y extends g.JT{constructor(e,t,i){super(),this._options=e,this._domNode=t,this._dimensions=i,this._sashRatio=(0,r.uh)("sashRatio",void 0),this.sashLeft=(0,r.nK)("sashLeft",(e=>{var t;const i=null!==(t=this._sashRatio.read(e))&&void 0!==t?t:this._options.splitViewDefaultRatio.read(e);return this._computeSashLeft(i,e)})),this._sash=this._register(new b.g(this._domNode,{getVerticalSashTop:e=>0,getVerticalSashLeft:e=>this.sashLeft.get(),getVerticalSashHeight:e=>this._dimensions.height.get()},{orientation:0})),this._startSashPosition=void 0,this._register(this._sash.onDidStart((()=>{this._startSashPosition=this.sashLeft.get()}))),this._register(this._sash.onDidChange((e=>{const t=this._dimensions.width.get(),i=this._computeSashLeft((this._startSashPosition+(e.currentX-e.startX))/t,void 0);this._sashRatio.set(i/t,void 0)}))),this._register(this._sash.onDidEnd((()=>this._sash.layout()))),this._register(this._sash.onDidReset((()=>this._sashRatio.set(void 0,void 0)))),this._register((0,r.EH)("update sash layout",(e=>{const t=this._options.enableSplitViewResizing.read(e);this._sash.state=t?3:0,this.sashLeft.read(e),this._sash.layout()})))}setBoundarySashes(e){this._sash.orthogonalEndSash=e.bottom}_computeSashLeft(e,t){const i=this._dimensions.width.read(t),o=Math.floor(this._options.splitViewDefaultRatio.read(t)*i),n=this._options.enableSplitViewResizing.read(t)?Math.floor(e*i):o,s=100;return i<=2*s?o:n<s?s:n>i-s?i-s:n}}var L=i(20801),S=i(62941),M=i(23365),N=i(3685),R=i(22668),E=i(44950),T=i(37174),x=i(21881),P=i(39159);class I extends g.JT{constructor(){super(...arguments),this._id=++I.idCounter,this._onDidDispose=this._register(new s.Q5),this.onDidDispose=this._onDidDispose.event}getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(e){return this._targetEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._targetEditor.getPosition()}setPosition(e,t="api"){this._targetEditor.setPosition(e,t)}revealLine(e,t=0){this._targetEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._targetEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._targetEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._targetEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._targetEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._targetEditor.revealPositionNearTop(e,t)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(e,t="api"){this._targetEditor.setSelection(e,t)}setSelections(e,t="api"){this._targetEditor.setSelections(e,t)}revealLines(e,t,i=0){this._targetEditor.revealLines(e,t,i)}revealLinesInCenter(e,t,i=0){this._targetEditor.revealLinesInCenter(e,t,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(e,t,i)}revealLinesNearTop(e,t,i=0){this._targetEditor.revealLinesNearTop(e,t,i)}revealRange(e,t=0,i=!1,o=!0){this._targetEditor.revealRange(e,t,i,o)}revealRangeInCenter(e,t=0){this._targetEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._targetEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._targetEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(e,t,i){this._targetEditor.trigger(e,t,i)}createDecorationsCollection(e){return this._targetEditor.createDecorationsCollection(e)}changeDecorations(e){return this._targetEditor.changeDecorations(e)}}I.idCounter=0;var V=i(93215),O=i(25206),W=i(15285),F=function(e,t,i,o){var n,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(s<3?n(r):s>3?n(t,i,r):n(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},A=function(e,t){return function(i,o){t(i,o,e)}};let H=class extends g.JT{constructor(e,t,i,o,n,r,d){super(),this.originalEditorElement=e,this.modifiedEditorElement=t,this._options=i,this._createInnerEditor=n,this._instantiationService=r,this._keybindingService=d,this._onDidContentSizeChange=this._register(new s.Q5),this.original=this._createLeftHandSideEditor(i.editorOptions.get(),o.originalEditor||{}),this.modified=this._createRightHandSideEditor(i.editorOptions.get(),o.modifiedEditor||{}),this._register((0,a.nJ)("update editor options",{createEmptyChangeSummary:()=>({}),handleChange:(e,t)=>(e.didChange(i.editorOptions)&&Object.assign(t,e.change.changedOptions),!0)},((e,t)=>{i.editorOptions.read(e),this.modified.updateOptions(this._adjustOptionsForRightHandSide(e,t)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(e,t))})))}_createLeftHandSideEditor(e,t){const i=this._adjustOptionsForLeftHandSide(void 0,e),o=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,i,t);return o.setContextValue("isInDiffLeftEditor",!0),o}_createRightHandSideEditor(e,t){const i=this._adjustOptionsForRightHandSide(void 0,e),o=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,i,t);return o.setContextValue("isInDiffRightEditor",!0),o}_constructInnerEditor(e,t,i,o){const n=this._createInnerEditor(e,t,i,o);return this._register(n.onDidContentSizeChange((e=>{const t=this.original.getContentWidth()+this.modified.getContentWidth()+S.e.ENTIRE_DIFF_OVERVIEW_WIDTH,i=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:i,contentWidth:t,contentHeightChanged:e.contentHeightChanged,contentWidthChanged:e.contentWidthChanged})}))),n}_adjustOptionsForLeftHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return this._options.renderSideBySide.get()?i.wordWrapOverride1=this._options.diffWordWrap.get():(i.wordWrapOverride1="off",i.wordWrapOverride2="off",i.stickyScroll={enabled:!1}),t.originalAriaLabel&&(i.ariaLabel=t.originalAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.readOnly=!this._options.originalEditable.get(),i.dropIntoEditor={enabled:!i.readOnly},i.extraEditorClassName="original-in-monaco-diff-editor",i}_adjustOptionsForRightHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return t.modifiedAriaLabel&&(i.ariaLabel=t.modifiedAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.wordWrapOverride1=this._options.diffWordWrap.get(),i.revealHorizontalRightPadding=V.BH.revealHorizontalRightPadding.defaultValue+S.e.ENTIRE_DIFF_OVERVIEW_WIDTH,i.scrollbar.verticalHasArrows=!1,i.extraEditorClassName="modified-in-monaco-diff-editor",i}_adjustOptionsForSubEditor(e){const t=Object.assign(Object.assign({},e),{dimension:{height:0,width:0}});return t.inDiffEditor=!0,t.automaticLayout=!1,t.scrollbar=Object.assign({},t.scrollbar||{}),t.scrollbar.vertical="visible",t.folding=!1,t.codeLens=this._options.diffCodeLens.get(),t.fixedOverflowWidgets=!0,t.minimap=Object.assign({},t.minimap||{}),t.minimap.enabled=!1,this._options.collapseUnchangedRegions.get()?t.stickyScroll={enabled:!1}:t.stickyScroll=this._options.editorOptions.get().stickyScroll,t}_updateAriaLabel(e){var t;e||(e="");const i=(0,O.NC)("diff-aria-navigation-tip"," use {0} to open the accessibility help.",null===(t=this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp"))||void 0===t?void 0:t.getAriaLabel());return this._options.accessibilityVerbose.get()?e+i:e?e.replaceAll(i,""):""}};H=F([A(5,x.TG),A(6,W.d)],H);class k{get editorOptions(){return this._options}constructor(e){this.renderOverviewRuler=(0,r.nK)("renderOverviewRuler",(e=>this._options.read(e).renderOverviewRuler)),this.renderSideBySide=(0,r.nK)("renderSideBySide",(e=>this._options.read(e).renderSideBySide)),this.readOnly=(0,r.nK)("readOnly",(e=>this._options.read(e).readOnly)),this.shouldRenderRevertArrows=(0,r.nK)("shouldRenderRevertArrows",(e=>!!this._options.read(e).renderMarginRevertIcon&&(!!this.renderSideBySide.read(e)&&!this.readOnly.read(e)))),this.renderIndicators=(0,r.nK)("renderIndicators",(e=>this._options.read(e).renderIndicators)),this.enableSplitViewResizing=(0,r.nK)("enableSplitViewResizing",(e=>this._options.read(e).enableSplitViewResizing)),this.collapseUnchangedRegions=(0,r.nK)("hideUnchangedRegions",(e=>this._options.read(e).experimental.collapseUnchangedRegions)),this.splitViewDefaultRatio=(0,r.nK)("splitViewDefaultRatio",(e=>this._options.read(e).splitViewDefaultRatio)),this.ignoreTrimWhitespace=(0,r.nK)("ignoreTrimWhitespace",(e=>this._options.read(e).ignoreTrimWhitespace)),this.maxComputationTimeMs=(0,r.nK)("maxComputationTime",(e=>this._options.read(e).maxComputationTime)),this.showMoves=(0,r.nK)("showMoves",(e=>{const t=this._options.read(e);return t.experimental.showMoves&&t.renderSideBySide})),this.isInEmbeddedEditor=(0,r.nK)("isInEmbeddedEditor",(e=>this._options.read(e).isInEmbeddedEditor)),this.diffWordWrap=(0,r.nK)("diffWordWrap",(e=>this._options.read(e).diffWordWrap)),this.originalEditable=(0,r.nK)("originalEditable",(e=>this._options.read(e).originalEditable)),this.diffCodeLens=(0,r.nK)("diffCodeLens",(e=>this._options.read(e).diffCodeLens)),this.accessibilityVerbose=(0,r.nK)("accessibilityVerbose",(e=>this._options.read(e).accessibilityVerbose)),this.diffAlgorithm=(0,r.nK)("diffAlgorithm",(e=>this._options.read(e).diffAlgorithm)),this.showEmptyDecorations=(0,r.nK)("showEmptyDecorations",(e=>this._options.read(e).experimental.showEmptyDecorations)),this.onlyShowAccessibleDiffViewer=(0,r.nK)("onlyShowAccessibleDiffViewer",(e=>this._options.read(e).onlyShowAccessibleDiffViewer));const t=Object.assign(Object.assign({},e),B(e,K));this._options=(0,r.uh)("options",t)}updateOptions(e){const t=B(e,this._options.get()),i=Object.assign(Object.assign(Object.assign({},this._options.get()),e),t);this._options.set(i,void 0,{changedOptions:e})}}const K={enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{collapseUnchangedRegions:!1,showMoves:!1,showEmptyDecorations:!0},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1};function B(e,t){var i,o,n;return{enableSplitViewResizing:(0,V.O7)(e.enableSplitViewResizing,t.enableSplitViewResizing),splitViewDefaultRatio:(0,V.L_)(e.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:(0,V.O7)(e.renderSideBySide,t.renderSideBySide),renderMarginRevertIcon:(0,V.O7)(e.renderMarginRevertIcon,t.renderMarginRevertIcon),maxComputationTime:(0,V.Zc)(e.maxComputationTime,t.maxComputationTime,0,1073741824),maxFileSize:(0,V.Zc)(e.maxFileSize,t.maxFileSize,0,1073741824),ignoreTrimWhitespace:(0,V.O7)(e.ignoreTrimWhitespace,t.ignoreTrimWhitespace),renderIndicators:(0,V.O7)(e.renderIndicators,t.renderIndicators),originalEditable:(0,V.O7)(e.originalEditable,t.originalEditable),diffCodeLens:(0,V.O7)(e.diffCodeLens,t.diffCodeLens),renderOverviewRuler:(0,V.O7)(e.renderOverviewRuler,t.renderOverviewRuler),diffWordWrap:(0,V.NY)(e.diffWordWrap,t.diffWordWrap,["off","on","inherit"]),diffAlgorithm:(0,V.NY)(e.diffAlgorithm,t.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:(0,V.O7)(e.accessibilityVerbose,t.accessibilityVerbose),experimental:{collapseUnchangedRegions:(0,V.O7)(null===(i=e.experimental)||void 0===i?void 0:i.collapseUnchangedRegions,t.experimental.collapseUnchangedRegions),showMoves:(0,V.O7)(null===(o=e.experimental)||void 0===o?void 0:o.showMoves,t.experimental.showMoves),showEmptyDecorations:(0,V.O7)(null===(n=e.experimental)||void 0===n?void 0:n.showEmptyDecorations,t.experimental.showEmptyDecorations)},isInEmbeddedEditor:(0,V.O7)(e.isInEmbeddedEditor,t.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:(0,V.O7)(e.onlyShowAccessibleDiffViewer,t.onlyShowAccessibleDiffViewer)}}var Q=i(44811),U=i(78089),z=i(60841),G=i(10205),j=i(8419),q=i(99588),$=i(6155),Z=i(15203),J=i(60309),X=i(61141),Y=i(81083),ee=i(93489),te=i(70748),ie=i(70936),oe=i(98158),ne=function(e,t,i,o){var n,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(s<3?n(r):s>3?n(t,i,r):n(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},se=function(e,t){return function(i,o){t(i,o,e)}},re=function(e,t,i,o){function n(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,s){function r(e){try{d(o.next(e))}catch(t){s(t)}}function a(e){try{d(o["throw"](e))}catch(t){s(t)}}function d(e){e.done?i(e.value):n(e.value).then(r,a)}d((o=o.apply(e,t||[])).next())}))};const ae=(0,oe.q5)("diff-review-insert",j.l.add,(0,O.NC)("accessibleDiffViewerInsertIcon","Icon for 'Insert' in accessible diff viewer.")),de=(0,oe.q5)("diff-review-remove",j.l.remove,(0,O.NC)("accessibleDiffViewerRemoveIcon","Icon for 'Remove' in accessible diff viewer.")),le=(0,oe.q5)("diff-review-close",j.l.close,(0,O.NC)("accessibleDiffViewerCloseIcon","Icon for 'Close' in accessible diff viewer."));let he=class extends g.JT{constructor(e,t,i,o,n,s,a,d,h){super(),this._parentNode=e,this._visible=t,this._setVisible=i,this._canClose=o,this._width=n,this._height=s,this._diffs=a,this._editors=d,this._instantiationService=h,this.model=(0,l.Be)("model",((e,t)=>{const i=this._visible.read(e);if(this._parentNode.style.visibility=i?"visible":"hidden",!i)return null;const o=t.add(this._instantiationService.createInstance(ce,this._diffs,this._editors,this._setVisible,this._canClose)),n=t.add(this._instantiationService.createInstance(Ce,this._parentNode,o,this._width,this._height,this._editors));return{model:o,view:n}})),this._register((0,r.$g)(this.model,!0))}next(){(0,r.PS)((e=>{const t=this._visible.get();this._setVisible(!0,e),t&&this.model.get().model.nextGroup(e)}))}prev(){(0,r.PS)((e=>{this._setVisible(!0,e),this.model.get().model.previousGroup(e)}))}close(){(0,r.PS)((e=>{this._setVisible(!1,e)}))}};he=ne([se(8,x.TG)],he);let ce=class extends g.JT{constructor(e,t,i,o,n){super(),this._diffs=e,this._editors=t,this._setVisible=i,this.canClose=o,this._audioCueService=n,this._groups=(0,r.uh)("groups",[]),this._currentGroupIdx=(0,r.uh)("currentGroupIdx",0),this._currentElementIdx=(0,r.uh)("currentElementIdx",0),this.groups=this._groups,this.currentGroup=this._currentGroupIdx.map(((e,t)=>this._groups.read(t)[e])),this.currentGroupIndex=this._currentGroupIdx,this.currentElement=this._currentElementIdx.map(((e,t)=>{var i;return null===(i=this.currentGroup.read(t))||void 0===i?void 0:i.lines[e]})),this._register((0,r.EH)("update groups",(e=>{const t=this._diffs.read(e);if(!t)return void this._groups.set([],void 0);const i=ge(t,this._editors.original.getModel().getLineCount(),this._editors.modified.getModel().getLineCount());(0,r.PS)((e=>{const t=this._editors.modified.getPosition();if(t){const o=i.findIndex((e=>(null===t||void 0===t?void 0:t.lineNumber)<e.range.modified.endLineNumberExclusive));-1!==o&&this._currentGroupIdx.set(o,e)}this._groups.set(i,e)}))}))),this._register((0,r.EH)("play audio-cue for diff",(e=>{const t=this.currentElement.read(e);(null===t||void 0===t?void 0:t.type)===_e.Deleted?this._audioCueService.playAudioCue(ie.y$.diffLineDeleted):(null===t||void 0===t?void 0:t.type)===_e.Added&&this._audioCueService.playAudioCue(ie.y$.diffLineInserted)}))),this._register((0,r.EH)("select lines in editor",(e=>{var t;const i=this.currentElement.read(e);if(i&&i.type!==_e.Header){const e=null!==(t=i.modifiedLineNumber)&&void 0!==t?t:i.diff.modifiedRange.startLineNumber;this._editors.modified.setSelection(C.e.fromPositions(new w.L(e,1)))}})))}_goToGroupDelta(e,t){const i=this.groups.get();!i||i.length<=1||(0,d.c8)(t,(t=>{this._currentGroupIdx.set((this._currentGroupIdx.get()+i.length+e)%i.length,t),this._currentElementIdx.set(0,t)}))}nextGroup(e){this._goToGroupDelta(1,e)}previousGroup(e){this._goToGroupDelta(-1,e)}_goToLineDelta(e){const t=this.currentGroup.get();!t||t.lines.length<=1||(0,r.PS)((i=>{this._currentElementIdx.set((this._currentElementIdx.get()+t.lines.length+e)%t.lines.length,i)}))}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(e){const t=this.currentGroup.get();if(!t)return;const i=t.lines.indexOf(e);-1!==i&&(0,r.PS)((e=>{this._currentElementIdx.set(i,e)}))}revealCurrentElementInEditor(){this._setVisible(!1,void 0);const e=this.currentElement.get();e&&(e.type===_e.Deleted?(this._editors.original.setSelection(C.e.fromPositions(new w.L(e.originalLineNumber,1))),this._editors.original.revealLine(e.originalLineNumber),this._editors.original.focus()):(e.type!==_e.Header&&(this._editors.modified.setSelection(C.e.fromPositions(new w.L(e.modifiedLineNumber,1))),this._editors.modified.revealLine(e.modifiedLineNumber)),this._editors.modified.focus()))}close(){this._setVisible(!1,void 0),this._editors.modified.focus()}};ce=ne([se(4,ie.e7)],ce);const ue=3;function ge(e,t,i){const o=[];for(const n of be(e,((e,t)=>t.modifiedRange.startLineNumber-e.modifiedRange.endLineNumberExclusive<2*ue))){const e=[];e.push(new ve);const s=new p.z(Math.max(1,n[0].originalRange.startLineNumber-ue),Math.min(n[n.length-1].originalRange.endLineNumberExclusive+ue,t+1)),r=new p.z(Math.max(1,n[0].modifiedRange.startLineNumber-ue),Math.min(n[n.length-1].modifiedRange.endLineNumberExclusive+ue,i+1));De(n,((t,i)=>{const o=new p.z(t?t.originalRange.endLineNumberExclusive:s.startLineNumber,i?i.originalRange.startLineNumber:s.endLineNumberExclusive),n=new p.z(t?t.modifiedRange.endLineNumberExclusive:r.startLineNumber,i?i.modifiedRange.startLineNumber:r.endLineNumberExclusive);o.forEach((t=>{e.push(new we(t,n.startLineNumber+(t-o.startLineNumber)))})),i&&(i.originalRange.forEach((t=>{e.push(new fe(i,t))})),i.modifiedRange.forEach((t=>{e.push(new pe(i,t))})))}));const a=n[0].modifiedRange.join(n[n.length-1].modifiedRange),d=n[0].originalRange.join(n[n.length-1].originalRange);o.push(new me(new J.Qy(a,d),e))}return o}var _e;(function(e){e[e["Header"]=0]="Header",e[e["Unchanged"]=1]="Unchanged",e[e["Deleted"]=2]="Deleted",e[e["Added"]=3]="Added"})(_e||(_e={}));class me{constructor(e,t){this.range=e,this.lines=t}}class ve{constructor(){this.type=_e.Header}}class fe{constructor(e,t){this.diff=e,this.originalLineNumber=t,this.type=_e.Deleted,this.modifiedLineNumber=void 0}}class pe{constructor(e,t){this.diff=e,this.modifiedLineNumber=t,this.type=_e.Added,this.originalLineNumber=void 0}}class we{constructor(e,t){this.originalLineNumber=e,this.modifiedLineNumber=t,this.type=_e.Unchanged}}let Ce=class extends g.JT{constructor(e,t,i,n,s,d){super(),this._element=e,this._model=t,this._width=i,this._height=n,this._editors=s,this._languageService=d,this.domNode=this._element,this.domNode.className="diff-review monaco-editor-background";const l=document.createElement("div");l.className="diff-review-actions",this._actionBar=this._register(new U.o(l)),this._register((0,r.EH)("update actions",(e=>{this._actionBar.clear(),this._model.canClose.read(e)&&this._actionBar.push(new G.aU("diffreview.close",(0,O.NC)("label.close","Close"),"close-diff-review "+q.k.asClassName(le),!0,(()=>re(this,void 0,void 0,(function*(){return t.close()})))),{label:!1,icon:!0})}))),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new z.s$(this._content,{})),(0,o.mc)(this.domNode,this._scrollbar.getDomNode(),l),this._register((0,g.OF)((()=>{(0,o.mc)(this.domNode)}))),this._register((0,f.bg)(this.domNode,{width:this._width,height:this._height})),this._register((0,f.bg)(this._content,{width:this._width,height:this._height})),this._register((0,a.b2)("render",((e,t)=>{this._model.currentGroup.read(e),this._render(t)}))),this._register((0,o.mu)(this.domNode,"keydown",(e=>{(e.equals(18)||e.equals(2066)||e.equals(530))&&(e.preventDefault(),this._model.goToNextLine()),(e.equals(16)||e.equals(2064)||e.equals(528))&&(e.preventDefault(),this._model.goToPreviousLine()),(e.equals(9)||e.equals(2057)||e.equals(521)||e.equals(1033))&&(e.preventDefault(),this._model.close()),(e.equals(10)||e.equals(3))&&(e.preventDefault(),this._model.revealCurrentElementInEditor())})))}_render(e){const t=this._editors.original.getOptions(),i=this._editors.modified.getOptions(),n=document.createElement("div");n.className="diff-review-table",n.setAttribute("role","list"),n.setAttribute("aria-label",(0,O.NC)("ariaLabel","Accessible Diff Viewer. Use arrow up and down to navigate.")),(0,$.N)(n,i.get(49)),(0,o.mc)(this._content,n);const s=this._editors.original.getModel(),a=this._editors.modified.getModel();if(!s||!a)return;const d=s.getOptions(),l=a.getOptions(),h=i.get(65),c=this._model.currentGroup.get();for(const u of(null===c||void 0===c?void 0:c.lines)||[]){if(!c)break;let g;if(u.type===_e.Header){const e=document.createElement("div");e.className="diff-review-row",e.setAttribute("role","listitem");const t=c.range,i=this._model.currentGroupIndex.get(),o=this._model.groups.get().length,n=e=>0===e?(0,O.NC)("no_lines_changed","no lines changed"):1===e?(0,O.NC)("one_line_changed","1 line changed"):(0,O.NC)("more_lines_changed","{0} lines changed",e),s=n(t.original.length),r=n(t.modified.length);e.setAttribute("aria-label",(0,O.NC)({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",i+1,o,t.original.startLineNumber,s,t.modified.startLineNumber,r));const a=document.createElement("div");a.className="diff-review-cell diff-review-summary",a.appendChild(document.createTextNode(`${i+1}/${o}: @@ -${t.original.startLineNumber},${t.original.length} +${t.modified.startLineNumber},${t.modified.length} @@`)),e.appendChild(a),g=e}else g=this._createRow(u,h,this._width.get(),t,s,d,i,a,l);n.appendChild(g);const _=(0,r.nK)("isSelected",(e=>this._model.currentElement.read(e)===u));e.add((0,r.EH)("update tab index",(e=>{const t=_.read(e);g.tabIndex=t?0:-1,t&&g.focus()}))),e.add((0,o.nm)(g,"focus",(()=>{this._model.goToLine(u)})))}this._scrollbar.scanDomNode()}_createRow(e,t,i,o,n,s,r,a,d){const l=o.get(142),h=l.glyphMarginWidth+l.lineNumbersWidth,c=r.get(142),u=10+c.glyphMarginWidth+c.lineNumbersWidth;let g="diff-review-row",_="";const m="diff-review-spacer";let v=null;switch(e.type){case _e.Added:g="diff-review-row line-insert",_=" char-insert",v=ae;break;case _e.Deleted:g="diff-review-row line-delete",_=" char-delete",v=de;break}const f=document.createElement("div");f.style.minWidth=i+"px",f.className=g,f.setAttribute("role","listitem"),f.ariaLevel="";const p=document.createElement("div");p.className="diff-review-cell",p.style.height=`${t}px`,f.appendChild(p);const w=document.createElement("span");w.style.width=h+"px",w.style.minWidth=h+"px",w.className="diff-review-line-number"+_,void 0!==e.originalLineNumber?w.appendChild(document.createTextNode(String(e.originalLineNumber))):w.innerText="",p.appendChild(w);const C=document.createElement("span");C.style.width=u+"px",C.style.minWidth=u+"px",C.style.paddingRight="10px",C.className="diff-review-line-number"+_,void 0!==e.modifiedLineNumber?C.appendChild(document.createTextNode(String(e.modifiedLineNumber))):C.innerText="",p.appendChild(C);const D=document.createElement("span");if(D.className=m,v){const e=document.createElement("span");e.className=q.k.asClassName(v),e.innerText="",D.appendChild(e)}else D.innerText="";let b;if(p.appendChild(D),void 0!==e.modifiedLineNumber){let t=this._getLineHtml(a,r,d.tabSize,e.modifiedLineNumber,this._languageService.languageIdCodec);Z.j._ttPolicy&&(t=Z.j._ttPolicy.createHTML(t)),p.insertAdjacentHTML("beforeend",t),b=a.getLineContent(e.modifiedLineNumber)}else{let t=this._getLineHtml(n,o,s.tabSize,e.originalLineNumber,this._languageService.languageIdCodec);Z.j._ttPolicy&&(t=Z.j._ttPolicy.createHTML(t)),p.insertAdjacentHTML("beforeend",t),b=n.getLineContent(e.originalLineNumber)}0===b.length&&(b=(0,O.NC)("blankLine","blank"));let y="";switch(e.type){case _e.Unchanged:y=e.originalLineNumber===e.modifiedLineNumber?(0,O.NC)({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",b,e.originalLineNumber):(0,O.NC)("equalLine","{0} original line {1} modified line {2}",b,e.originalLineNumber,e.modifiedLineNumber);break;case _e.Added:y=(0,O.NC)("insertLine","+ {0} modified line {1}",b,e.modifiedLineNumber);break;case _e.Deleted:y=(0,O.NC)("deleteLine","- {0} original line {1}",b,e.originalLineNumber);break}return f.setAttribute("aria-label",y),f}_getLineHtml(e,t,i,o,n){const s=e.getLineContent(o),r=t.get(49),a=Y.A.createEmpty(s,n),d=te.wA.isBasicASCII(s,e.mightContainNonBasicASCII()),l=te.wA.containsRTL(s,d,e.mightContainRTL()),h=(0,ee.tF)(new ee.IJ(r.isMonospace&&!t.get(32),r.canUseHalfwidthRightwardsArrow,s,!1,d,l,0,a,[],i,0,r.spaceWidth,r.middotWidth,r.wsmiddotWidth,t.get(115),t.get(97),t.get(92),t.get(50)!==V.n0.OFF,null));return h.html}};function De(e,t){let i;for(const o of e)t(i,o),i=o;t(i,void 0)}function*be(e,t){let i,o;for(const n of e)void 0!==o&&t(o,n)?i.push(n):(i&&(yield i),i=[n]),o=n;i&&(yield i)}Ce=ne([se(5,X.O)],Ce);var ye=i(47277);(0,ye.P6G)("diffEditor.move.border",{dark:"#8b8b8b9c",light:"#8b8b8b9c",hcDark:"#8b8b8b9c",hcLight:"#8b8b8b9c"},(0,O.NC)("diffEditor.move.border","The border color for text that got moved in the diff editor."));var Le=function(e,t,i,o){var n,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(s<3?n(r):s>3?n(t,i,r):n(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},Se=function(e,t){return function(i,o){t(i,o,e)}};let Me=class extends I{constructor(e,t,i,n,h,c,u){var g;super(),this._domElement=e,this._parentContextKeyService=n,this._parentInstantiationService=h,this._audioCueService=u,this.elements=(0,o.h)("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[(0,o.h)("div.noModificationsOverlay@overlay",{style:{position:"absolute",height:"100%",visibility:"hidden"}},[(0,o.$)("span",{},"No Changes")]),(0,o.h)("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),(0,o.h)("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),(0,o.h)("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]),this._diffModel=this._register((0,d.DN)("diffModel",void 0)),this.onDidChangeModel=s.ju.fromObservableLight(this._diffModel),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement)),this._instantiationService=this._parentInstantiationService.createChild(new P.y([T.i6,this._contextKeyService])),this._boundarySashes=(0,r.uh)("boundarySashes",void 0),this._accessibleDiffViewerShouldBeVisible=(0,r.uh)("accessibleDiffViewerShouldBeVisible",!1),this._accessibleDiffViewerVisible=(0,r.nK)("accessibleDiffViewerVisible",(e=>!!this._options.onlyShowAccessibleDiffViewer.read(e)||this._accessibleDiffViewerShouldBeVisible.read(e))),this._layoutInfo=(0,r.nK)("modifiedEditorLayoutInfo",(e=>{var t;const i=this._rootSizeObserver.width.read(e),o=this._rootSizeObserver.height.read(e),n=null===(t=this._sash.read(e))||void 0===t?void 0:t.sashLeft.read(e),s=null!==n&&void 0!==n?n:Math.max(5,this._editors.original.getLayoutInfo().decorationsLeft),r=i-s-(this._options.renderOverviewRuler.read(e)?S.e.ENTIRE_DIFF_OVERVIEW_WIDTH:0);return this.elements.original.style.width=s+"px",this.elements.original.style.left="0px",this.elements.modified.style.width=r+"px",this.elements.modified.style.left=s+"px",this._editors.original.layout({width:s,height:o}),this._editors.modified.layout({width:r,height:o}),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}})),this._diffValue=this._diffModel.map(((e,t)=>null===e||void 0===e?void 0:e.diff.read(t))),this.onDidUpdateDiff=s.ju.fromObservableLight(this._diffValue),c.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._contextKeyService.createKey("diffEditorVersion",2),this._options=new k(t),this._contextKeyService.createKey(E.u.isEmbeddedDiffEditor.key,!1);const _=E.u.isEmbeddedDiffEditor.bindTo(this._contextKeyService);this._register((0,r.EH)("update isEmbeddedDiffEditorKey",(e=>{_.set(this._options.isInEmbeddedEditor.read(e))})));const m=E.u.accessibleDiffViewerVisible.bindTo(this._contextKeyService);this._register((0,r.EH)("update accessibleDiffViewerVisible context key",(e=>{m.set(this._accessibleDiffViewerVisible.read(e))}))),this._domElement.appendChild(this.elements.root),this._rootSizeObserver=this._register(new f.DU(this.elements.root,t.dimension)),this._rootSizeObserver.setAutomaticLayout(null!==(g=t.automaticLayout)&&void 0!==g&&g),this._editors=this._register(this._instantiationService.createInstance(H,this.elements.original,this.elements.modified,this._options,i,((e,t,i,o)=>this._createInnerEditor(e,t,i,o)))),this._sash=(0,l.Be)("sash",((e,t)=>{const i=this._options.renderSideBySide.read(e);if(this.elements.root.classList.toggle("side-by-side",i),!i)return;const o=t.add(new y(this._options,this.elements.root,{height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map(((e,t)=>e-(this._options.renderOverviewRuler.read(t)?S.e.ENTIRE_DIFF_OVERVIEW_WIDTH:0)))}));return t.add((0,r.EH)("setBoundarySashes",(e=>{const t=this._boundarySashes.read(e);t&&o.setBoundarySashes(t)}))),o})),this._register((0,r.$g)(this._sash,!0)),this._register((0,a.b2)("UnchangedRangesFeature",((e,t)=>{this.unchangedRangesFeature=t.add(new((0,f.NW)(M.V,e))(this._editors,this._diffModel,this._options))}))),this._register((0,a.b2)("DiffEditorDecorations",((e,t)=>{t.add(new((0,f.NW)(D,e))(this._editors,this._diffModel,this._options))}))),this._register((0,a.b2)("ViewZoneManager",((e,t)=>{t.add(this._instantiationService.createInstance((0,f.NW)(L.K,e),this._editors,this._diffModel,this._options,this,(()=>this.unchangedRangesFeature.isUpdatingViewZones)))}))),this._register((0,a.b2)("OverviewRulerPart",((e,t)=>{t.add(this._instantiationService.createInstance((0,f.NW)(S.e,e),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map((e=>e.modifiedEditor)),this._options))}))),this._register((0,a.b2)("_accessibleDiffViewer",((e,t)=>{this._accessibleDiffViewer=t.add(this._register(this._instantiationService.createInstance((0,f.NW)(he,e),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,((e,t)=>this._accessibleDiffViewerShouldBeVisible.set(e,t)),this._options.onlyShowAccessibleDiffViewer.map((e=>!e)),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map(((e,t)=>{var i;return null===(i=null===e||void 0===e?void 0:e.diff.read(t))||void 0===i?void 0:i.mappings.map((e=>e.lineRangeMapping))})),this._editors)))})));const p=this._accessibleDiffViewerVisible.map((e=>e?"hidden":"visible"));this._register((0,f.bg)(this.elements.modified,{visibility:p})),this._register((0,f.bg)(this.elements.original,{visibility:p})),this._createDiffEditorContributions(),c.addDiffEditor(this),this._register((0,r.$g)(this._layoutInfo,!0)),this._register(new v.o(this.elements.root,this._diffModel,this._layoutInfo.map((e=>e.originalEditor)),this._layoutInfo.map((e=>e.modifiedEditor)),this._editors)),this._register((0,f.bg)(this.elements.overlay,{width:this._layoutInfo.map(((e,t)=>e.originalEditor.width+(this._options.renderSideBySide.read(t)?0:e.modifiedEditor.width))),visibility:(0,r.nK)("visibility",(e=>{var t,i;return this._options.collapseUnchangedRegions.read(e)&&0===(null===(i=null===(t=this._diffModel.read(e))||void 0===t?void 0:t.diff.read(e))||void 0===i?void 0:i.mappings.length)?"visible":"hidden"}))})),this._register(this._editors.original.onDidChangeCursorPosition((e=>{const t=this._diffModel.get();if(!t)return;const i=t.diff.get().movedTexts.find((t=>t.lineRangeMapping.original.contains(e.position.lineNumber)));t.syncedMovedTexts.set(i,void 0)}))),this._register(this._editors.modified.onDidChangeCursorPosition((e=>{const t=this._diffModel.get();if(!t)return;const i=t.diff.get().movedTexts.find((t=>t.lineRangeMapping.modified.contains(e.position.lineNumber)));t.syncedMovedTexts.set(i,void 0)}))),this._register(this._editors.modified.onMouseDown((e=>{var t,i;if(!e.event.rightButton&&e.target.position&&(null===(t=e.target.element)||void 0===t?void 0:t.className.includes("arrow-revert-change"))){const t=e.target.position.lineNumber,o=e.target,n=this._diffModel.get();if(!n)return;const s=null===(i=n.diff.get())||void 0===i?void 0:i.mappings;if(!s)return;const r=s.find((e=>(null===o||void 0===o?void 0:o.detail.afterLineNumber)===e.lineRangeMapping.modifiedRange.startLineNumber-1||e.lineRangeMapping.modifiedRange.startLineNumber===t));if(!r)return;this.revert(r.lineRangeMapping),e.event.stopPropagation()}}))),this._register(s.ju.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,(e=>{var t,i;if(3===(null===e||void 0===e?void 0:e.reason)){const o=null===(i=null===(t=this._diffModel.get())||void 0===t?void 0:t.diff.get())||void 0===i?void 0:i.mappings.find((t=>t.lineRangeMapping.modifiedRange.contains(e.position.lineNumber)));(null===o||void 0===o?void 0:o.lineRangeMapping.modifiedRange.isEmpty)?this._audioCueService.playAudioCue(ie.y$.diffLineDeleted):(null===o||void 0===o?void 0:o.lineRangeMapping.originalRange.isEmpty)?this._audioCueService.playAudioCue(ie.y$.diffLineInserted):o&&this._audioCueService.playAudioCue(ie.y$.diffLineModified)}})))}_createInnerEditor(e,t,i,o){const n=e.createInstance(u.Gm,t,i,o);return n}_createDiffEditorContributions(){const e=h.Uc.getDiffEditorContributions();for(const i of e)try{this._register(this._instantiationService.createInstance(i.ctor,this))}catch(t){(0,n.dL)(t)}}get _targetEditor(){return this._editors.modified}getEditorType(){return R.g.IDiffEditor}layout(e){this._rootSizeObserver.observe(e)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){var e;const t=this._editors.original.saveViewState(),i=this._editors.modified.saveViewState();return{original:t,modified:i,modelState:null===(e=this._diffModel.get())||void 0===e?void 0:e.serializeState()}}restoreViewState(e){var t;if(e&&e.original&&e.modified){const i=e;this._editors.original.restoreViewState(i.original),this._editors.modified.restoreViewState(i.modified),i.modelState&&(null===(t=this._diffModel.get())||void 0===t||t.restoreSerializedState(i.modelState))}}createViewModel(e){return new Q.Z$(e,this._options,this._instantiationService.createInstance(N.Q,{diffAlgorithm:this._options.diffAlgorithm.get()}))}getModel(){var e,t;return null!==(t=null===(e=this._diffModel.get())||void 0===e?void 0:e.model)&&void 0!==t?t:null}setModel(e){!e&&this._diffModel.get()&&this._accessibleDiffViewer.close();const t=e?"model"in e?e:this.createViewModel(e):void 0;this._editors.original.setModel(t?t.model.original:null),this._editors.modified.setModel(t?t.model.modified:null),(0,d.PS)((e=>{this._diffModel.set(t,e)}))}updateOptions(e){this._options.updateOptions(e)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}getLineChanges(){var e;const t=null===(e=this._diffModel.get())||void 0===e?void 0:e.diff.get();return t?Ne(t):null}revert(e){var t;const i=null===(t=this._diffModel.get())||void 0===t?void 0:t.model;if(!i)return;const o=e.innerChanges?e.innerChanges.map((e=>({range:e.modifiedRange,text:i.original.getValueInRange(e.originalRange)}))):[{range:e.modifiedRange.toExclusiveRange(),text:i.original.getValueInRange(e.originalRange.toExclusiveRange())}];this._editors.modified.executeEdits("diffEditor",o)}accessibleDiffViewerNext(){this._accessibleDiffViewer.next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.prev()}};function Ne(e){return e.mappings.map((e=>{const t=e.lineRangeMapping;let i,o,n,s,r=t.innerChanges;return t.originalRange.isEmpty?(i=t.originalRange.startLineNumber-1,o=0,r=void 0):(i=t.originalRange.startLineNumber,o=t.originalRange.endLineNumberExclusive-1),t.modifiedRange.isEmpty?(n=t.modifiedRange.startLineNumber-1,s=0,r=void 0):(n=t.modifiedRange.startLineNumber,s=t.modifiedRange.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:o,modifiedStartLineNumber:n,modifiedEndLineNumber:s,charChanges:null===r||void 0===r?void 0:r.map((e=>({originalStartLineNumber:e.originalRange.startLineNumber,originalStartColumn:e.originalRange.startColumn,originalEndLineNumber:e.originalRange.endLineNumber,originalEndColumn:e.originalRange.endColumn,modifiedStartLineNumber:e.modifiedRange.startLineNumber,modifiedStartColumn:e.modifiedRange.startColumn,modifiedEndLineNumber:e.modifiedRange.endLineNumber,modifiedEndColumn:e.modifiedRange.endColumn})))}}))}Me=Le([Se(3,T.i6),Se(4,x.TG),Se(5,c.$),Se(6,ie.e7)],Me)}}]);