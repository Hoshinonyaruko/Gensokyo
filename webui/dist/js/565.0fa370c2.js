"use strict";(globalThis["webpackChunkfrontend"]=globalThis["webpackChunkfrontend"]||[]).push([[565],{74303:(e,t,i)=>{var n=i(70959),s=i(47606),o=i(48077),r=i(89999),a=i(33162),d=i(54644),l=i(16375);class h{constructor(e,t,i){this.selection=e,this.targetPosition=t,this.copy=i,this.targetSelection=null}getEditOperations(e,t){const i=e.getValueInRange(this.selection);this.copy||t.addEditOperation(this.selection,null),t.addEditOperation(new a.e(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column),i),!this.selection.containsPosition(this.targetPosition)||this.copy&&(this.selection.getEndPosition().equals(this.targetPosition)||this.selection.getStartPosition().equals(this.targetPosition))?this.copy?this.targetSelection=new d.Y(this.targetPosition.lineNumber,this.targetPosition.column,this.selection.endLineNumber-this.selection.startLineNumber+this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.targetPosition.lineNumber>this.selection.endLineNumber?this.targetSelection=new d.Y(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.targetPosition.lineNumber<this.selection.endLineNumber?this.targetSelection=new d.Y(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber+this.selection.endLineNumber-this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.selection.endColumn<=this.targetPosition.column?this.targetSelection=new d.Y(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,(this.selection.startLineNumber,this.selection.endLineNumber,this.targetPosition.column-this.selection.endColumn+this.selection.startColumn),this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column:this.selection.endColumn):this.targetSelection=new d.Y(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column+this.selection.endColumn-this.selection.startColumn):this.targetSelection=this.selection}computeCursorState(e,t){return this.targetSelection}}function c(e){return s.dz?e.altKey:e.ctrlKey}class u extends n.JT{constructor(e){super(),this._editor=e,this._dndDecorationIds=this._editor.createDecorationsCollection(),this._register(this._editor.onMouseDown((e=>this._onEditorMouseDown(e)))),this._register(this._editor.onMouseUp((e=>this._onEditorMouseUp(e)))),this._register(this._editor.onMouseDrag((e=>this._onEditorMouseDrag(e)))),this._register(this._editor.onMouseDrop((e=>this._onEditorMouseDrop(e)))),this._register(this._editor.onMouseDropCanceled((()=>this._onEditorMouseDropCanceled()))),this._register(this._editor.onKeyDown((e=>this.onEditorKeyDown(e)))),this._register(this._editor.onKeyUp((e=>this.onEditorKeyUp(e)))),this._register(this._editor.onDidBlurEditorWidget((()=>this.onEditorBlur()))),this._register(this._editor.onDidBlurEditorText((()=>this.onEditorBlur()))),this._mouseDown=!1,this._modifierPressed=!1,this._dragSelection=null}onEditorBlur(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1}onEditorKeyDown(e){this._editor.getOption(35)&&!this._editor.getOption(22)&&(c(e)&&(this._modifierPressed=!0),this._mouseDown&&c(e)&&this._editor.updateOptions({mouseStyle:"copy"}))}onEditorKeyUp(e){this._editor.getOption(35)&&!this._editor.getOption(22)&&(c(e)&&(this._modifierPressed=!1),this._mouseDown&&e.keyCode===u.TRIGGER_KEY_VALUE&&this._editor.updateOptions({mouseStyle:"default"}))}_onEditorMouseDown(e){this._mouseDown=!0}_onEditorMouseUp(e){this._mouseDown=!1,this._editor.updateOptions({mouseStyle:"text"})}_onEditorMouseDrag(e){const t=e.target;if(null===this._dragSelection){const e=this._editor.getSelections()||[],i=e.filter((e=>t.position&&e.containsPosition(t.position)));if(1!==i.length)return;this._dragSelection=i[0]}c(e.event)?this._editor.updateOptions({mouseStyle:"copy"}):this._editor.updateOptions({mouseStyle:"default"}),t.position&&(this._dragSelection.containsPosition(t.position)?this._removeDecoration():this.showAt(t.position))}_onEditorMouseDropCanceled(){this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}_onEditorMouseDrop(e){if(e.target&&(this._hitContent(e.target)||this._hitMargin(e.target))&&e.target.position){const t=new r.L(e.target.position.lineNumber,e.target.position.column);if(null===this._dragSelection){let i=null;if(e.event.shiftKey){const e=this._editor.getSelection();if(e){const{selectionStartLineNumber:n,selectionStartColumn:s}=e;i=[new d.Y(n,s,t.lineNumber,t.column)]}}else i=(this._editor.getSelections()||[]).map((e=>e.containsPosition(t)?new d.Y(t.lineNumber,t.column,t.lineNumber,t.column):e));this._editor.setSelections(i||[],"mouse",3)}else(!this._dragSelection.containsPosition(t)||(c(e.event)||this._modifierPressed)&&(this._dragSelection.getEndPosition().equals(t)||this._dragSelection.getStartPosition().equals(t)))&&(this._editor.pushUndoStop(),this._editor.executeCommand(u.ID,new h(this._dragSelection,t,c(e.event)||this._modifierPressed)),this._editor.pushUndoStop())}this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}showAt(e){this._dndDecorationIds.set([{range:new a.e(e.lineNumber,e.column,e.lineNumber,e.column),options:u._DECORATION_OPTIONS}]),this._editor.revealPosition(e,1)}_removeDecoration(){this._dndDecorationIds.clear()}_hitContent(e){return 6===e.type||7===e.type}_hitMargin(e){return 2===e.type||3===e.type||4===e.type}dispose(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1,super.dispose()}}u.ID="editor.contrib.dragAndDrop",u.TRIGGER_KEY_VALUE=s.dz?6:5,u._DECORATION_OPTIONS=l.qx.register({description:"dnd-target",className:"dnd-target"}),(0,o._K)(u.ID,u,2)},61539:(e,t,i)=>{var n=i(55191),s=i(55455),o=i(95896),r=i(15498),a=i(41649),d=i(46871),l=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function r(e){try{d(n.next(e))}catch(t){o(t)}}function a(e){try{d(n["throw"](e))}catch(t){o(t)}}function d(e){e.done?i(e.value):s(e.value).then(r,a)}d((n=n.apply(e,t||[])).next())}))};d.P.registerCommand("_executeDocumentSymbolProvider",(function(e,...t){return l(this,void 0,void 0,(function*(){const[i]=t;(0,s.p_)(o.o.isUri(i));const d=e.get(a.Je),l=e.get(r.S),h=yield l.createModelReference(i);try{return(yield d.getOrCreate(h.object.textEditorModel,n.T.None)).getTopLevelSymbols()}finally{h.dispose()}}))}))},41649:(e,t,i)=>{i.d(t,{C3:()=>N,H3:()=>S,Je:()=>y,sT:()=>b});var n=i(21921),s=i(55191),o=i(98642),r=i(39595),a=i(71400),d=i(89999),l=i(33162),h=i(54732),c=i(21881),u=i(39326),g=i(74016),p=i(70959),_=i(16458),m=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},f=function(e,t){return function(i,n){t(i,n,e)}},v=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function r(e){try{d(n.next(e))}catch(t){o(t)}}function a(e){try{d(n["throw"](e))}catch(t){o(t)}}function d(e){e.done?i(e.value):s(e.value).then(r,a)}d((n=n.apply(e,t||[])).next())}))};class C{remove(){var e;null===(e=this.parent)||void 0===e||e.children.delete(this.id)}static findId(e,t){let i;"string"===typeof e?i=`${t.id}/${e}`:(i=`${t.id}/${e.name}`,void 0!==t.children.get(i)&&(i=`${t.id}/${e.name}_${e.range.startLineNumber}_${e.range.startColumn}`));let n=i;for(let s=0;void 0!==t.children.get(n);s++)n=`${i}_${s}`;return n}static empty(e){return 0===e.children.size}}class b extends C{constructor(e,t,i){super(),this.id=e,this.parent=t,this.symbol=i,this.children=new Map}}class S extends C{constructor(e,t,i,n){super(),this.id=e,this.parent=t,this.label=i,this.order=n,this.children=new Map}}class N extends C{static create(e,t,i){const r=new s.A(i),a=new N(t.uri),d=e.ordered(t),l=d.map(((e,i)=>{var n;const s=C.findId(`provider_${i}`,a),d=new S(s,a,null!==(n=e.displayName)&&void 0!==n?n:"Unknown Outline Provider",i);return Promise.resolve(e.provideDocumentSymbols(t,r.token)).then((e=>{for(const t of e||[])N._makeOutlineElement(t,d);return d}),(e=>((0,o.Cp)(e),d))).then((e=>{C.empty(e)?e.remove():a._groups.set(s,e)}))})),h=e.onDidChange((()=>{const i=e.ordered(t);(0,n.fS)(i,d)||r.cancel()}));return Promise.all(l).then((()=>r.token.isCancellationRequested&&!i.isCancellationRequested?N.create(e,t,i):a._compact())).finally((()=>{r.dispose(),h.dispose(),r.dispose()}))}static _makeOutlineElement(e,t){const i=C.findId(e,t),n=new b(i,t,e);if(e.children)for(const s of e.children)N._makeOutlineElement(s,n);t.children.set(n.id,n)}constructor(e){super(),this.uri=e,this.id="root",this.parent=void 0,this._groups=new Map,this.children=new Map,this.id="root",this.parent=void 0}_compact(){let e=0;for(const[t,i]of this._groups)0===i.children.size?this._groups.delete(t):e+=1;if(1!==e)this.children=this._groups;else{const e=r.$.first(this._groups.values());for(const[,t]of e.children)t.parent=this,this.children.set(t.id,t)}return this}getTopLevelSymbols(){const e=[];for(const t of this.children.values())t instanceof b?e.push(t.symbol):e.push(...r.$.map(t.children.values(),(e=>e.symbol)));return e.sort(((e,t)=>l.e.compareRangesUsingStarts(e.range,t.range)))}asListOfDocumentSymbols(){const e=this.getTopLevelSymbols(),t=[];return N._flattenDocumentSymbols(t,e,""),t.sort(((e,t)=>d.L.compare(l.e.getStartPosition(e.range),l.e.getStartPosition(t.range))||d.L.compare(l.e.getEndPosition(t.range),l.e.getEndPosition(e.range))))}static _flattenDocumentSymbols(e,t,i){for(const n of t)e.push({kind:n.kind,tags:n.tags,name:n.name,detail:n.detail,containerName:n.containerName||i,range:n.range,selectionRange:n.selectionRange,children:void 0}),n.children&&N._flattenDocumentSymbols(e,n.children,n.name)}}const y=(0,c.yh)("IOutlineModelService");let x=class{constructor(e,t,i){this._languageFeaturesService=e,this._disposables=new p.SL,this._cache=new a.z6(10,.7),this._debounceInformation=t.for(e.documentSymbolProvider,"DocumentSymbols",{min:350}),this._disposables.add(i.onModelRemoved((e=>{this._cache.delete(e.id)})))}dispose(){this._disposables.dispose()}getOrCreate(e,t){return v(this,void 0,void 0,(function*(){const i=this._languageFeaturesService.documentSymbolProvider,o=i.ordered(e);let r=this._cache.get(e.id);if(!r||r.versionId!==e.getVersionId()||!(0,n.fS)(r.provider,o)){const t=new s.A;r={versionId:e.getVersionId(),provider:o,promiseCnt:0,source:t,promise:N.create(i,e,t.token),model:void 0},this._cache.set(e.id,r);const n=Date.now();r.promise.then((t=>{r.model=t,this._debounceInformation.update(e,Date.now()-n)})).catch((t=>{this._cache.delete(e.id)}))}if(r.model)return r.model;r.promiseCnt+=1;const a=t.onCancellationRequested((()=>{0===--r.promiseCnt&&(r.source.cancel(),this._cache.delete(e.id))}));try{return yield r.promise}finally{a.dispose()}}))}};x=m([f(0,_.p),f(1,h.A),f(2,g.q)],x),(0,u.z)(y,x,1)},74044:(e,t,i)=>{var n,s=i(48077),o=i(64559),r=i(2548),a=i(21921),d=i(85398),l=i(66383),h=i(70959),c=i(96358),u=i(47606),g=i(7091),p=i(67500),_=i(80542),m=i(22047),f=i(33162),v=i(16458),C=i(24201),b=i(39363),S=i(44737),N=i(25206),y=i(2827),x=i(37174),R=i(21881),w=i(34679),I=i(45726),L=i(30704),D=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},E=function(e,t){return function(i,n){t(i,n,e)}},M=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function r(e){try{d(n.next(e))}catch(t){o(t)}}function a(e){try{d(n["throw"](e))}catch(t){o(t)}}function d(e){e.done?i(e.value):s(e.value).then(r,a)}d((n=n.apply(e,t||[])).next())}))};const P="editor.changePasteType",A=new x.uy("pasteWidgetVisible",!1,(0,N.NC)("pasteWidgetVisible","Whether the paste widget is showing")),O="application/vnd.code.copyMetadata";let F=n=class extends h.JT{static get(e){return e.getContribution(n.ID)}constructor(e,t,i,n,s,o,a){super(),this._bulkEditService=i,this._clipboardService=n,this._languageFeaturesService=s,this._quickInputService=o,this._progressService=a,this._editor=e;const d=e.getContainerDomNode();this._register((0,r.nm)(d,"copy",(e=>this.handleCopy(e)))),this._register((0,r.nm)(d,"cut",(e=>this.handleCopy(e)))),this._register((0,r.nm)(d,"paste",(e=>this.handlePaste(e)),!0)),this._pasteProgressManager=this._register(new S.r("pasteIntoEditor",e,t)),this._postPasteWidgetManager=this._register(t.createInstance(L.p,"pasteIntoEditor",e,A,{id:P,label:(0,N.NC)("postPasteWidgetTitle","Show paste options...")}))}changePasteType(){this._postPasteWidgetManager.tryShowSelector()}pasteAs(e){this._editor.focus();try{this._pasteAsActionContext={preferredId:e},(0,r.uP)().execCommand("paste")}finally{this._pasteAsActionContext=void 0}}isPasteAsEnabled(){return this._editor.getOption(84).enabled&&!this._editor.getOption(90)}handleCopy(e){var t,i;if(!this._editor.hasTextFocus())return;if(u.$L&&this._clipboardService.writeResources([]),!e.clipboardData||!this.isPasteAsEnabled())return;const n=this._editor.getModel(),s=this._editor.getSelections();if(!n||!(null===s||void 0===s?void 0:s.length))return;const o=this._editor.getOption(37);let r=s;const l=1===s.length&&s[0].isEmpty();if(l){if(!o)return;r=[new f.e(r[0].startLineNumber,1,r[0].startLineNumber,1+n.getLineLength(r[0].startLineNumber))]}const h=null===(t=this._editor._getViewModel())||void 0===t?void 0:t.getPlainTextToCopy(s,o,u.ED),c=Array.isArray(h)?h:null,p={multicursorText:c,pasteOnNewLine:l,mode:null},m=this._languageFeaturesService.documentPasteEditProvider.ordered(n).filter((e=>!!e.prepareDocumentPaste));if(!m.length)return void this.setCopyMetadata(e.clipboardData,{defaultPastePayload:p});const v=(0,_.B)(e.clipboardData),C=m.flatMap((e=>{var t;return null!==(t=e.copyMimeTypes)&&void 0!==t?t:[]})),b=(0,g.R)();this.setCopyMetadata(e.clipboardData,{id:b,providerCopyMimeTypes:C,defaultPastePayload:p});const S=(0,d.PG)((e=>M(this,void 0,void 0,(function*(){const t=(0,a.kX)(yield Promise.all(m.map((t=>M(this,void 0,void 0,(function*(){try{return yield t.prepareDocumentPaste(n,r,v,e)}catch(i){return void console.error(i)}}))))));t.reverse();for(const e of t)for(const[t,i]of e)v.replace(t,i);return v}))));null===(i=this._currentCopyOperation)||void 0===i||i.dataTransferPromise.cancel(),this._currentCopyOperation={handle:b,dataTransferPromise:S}}handlePaste(e){var t,i;return M(this,void 0,void 0,(function*(){if(!e.clipboardData||!this._editor.hasTextFocus())return;null===(t=this._currentPasteOperation)||void 0===t||t.cancel(),this._currentPasteOperation=void 0;const n=this._editor.getModel(),s=this._editor.getSelections();if(!(null===s||void 0===s?void 0:s.length)||!n)return;if(!this.isPasteAsEnabled())return;const o=this.fetchCopyMetadata(e),r=(0,_.L)(e.clipboardData);r.delete(O);const a=[...e.clipboardData.types,...null!==(i=null===o||void 0===o?void 0:o.providerCopyMimeTypes)&&void 0!==i?i:[],c.v.uriList],d=this._languageFeaturesService.documentPasteEditProvider.ordered(n).filter((e=>{var t;return null===(t=e.pasteMimeTypes)||void 0===t?void 0:t.some((e=>(0,l.SN)(e,a)))}));d.length&&(e.preventDefault(),e.stopImmediatePropagation(),this._pasteAsActionContext?this.showPasteAsPick(this._pasteAsActionContext.preferredId,d,s,r,o):this.doPasteInline(d,s,r,o))}))}doPasteInline(e,t,i,n){const s=(0,d.PG)((o=>M(this,void 0,void 0,(function*(){const r=this._editor;if(!r.hasModel())return;const a=r.getModel(),d=new b.Dl(r,3,void 0,o);try{if(yield this.mergeInDataFromCopy(i,n,d.token),d.token.isCancellationRequested)return;const s=e.filter((e=>T(e,i)));if(!s.length||1===s.length&&"text"===s[0].id)return void(yield this.applyDefaultPasteHandler(i,n,d.token));const o=yield this.getPasteEdits(s,i,a,t,d.token);if(d.token.isCancellationRequested)return;if(1===o.length&&"text"===o[0].providerId)return void(yield this.applyDefaultPasteHandler(i,n,d.token));if(o.length){const e="afterPaste"===r.getOption(84).showPasteSelector;return this._postPasteWidgetManager.applyEditAndShowIfNeeded(t,{activeEditIndex:0,allEdits:o},e,d.token)}yield this.applyDefaultPasteHandler(i,n,d.token)}finally{d.dispose(),this._currentPasteOperation===s&&(this._currentPasteOperation=void 0)}}))));this._pasteProgressManager.showWhile(t[0].getEndPosition(),(0,N.NC)("pasteIntoEditorProgress","Running paste handlers. Click to cancel"),s),this._currentPasteOperation=s}showPasteAsPick(e,t,i,n,s){const o=(0,d.PG)((r=>M(this,void 0,void 0,(function*(){const a=this._editor;if(!a.hasModel())return;const d=a.getModel(),l=new b.Dl(a,3,void 0,r);try{if(yield this.mergeInDataFromCopy(n,s,l.token),l.token.isCancellationRequested)return;let o=t.filter((e=>T(e,n)));e&&(o=o.filter((t=>t.id===e)));const r=yield this.getPasteEdits(o,n,d,i,l.token);if(l.token.isCancellationRequested)return;if(!r.length)return;let a;if(e)a=r.at(0);else{const e=yield this._quickInputService.pick(r.map((e=>({label:e.label,description:e.providerId,detail:e.detail,edit:e}))),{placeHolder:(0,N.NC)("pasteAsPickerPlaceholder","Select Paste Action")});a=null===e||void 0===e?void 0:e.edit}if(!a)return;const h=(0,C.n)(d.uri,i,a);yield this._bulkEditService.apply(h,{editor:this._editor})}finally{l.dispose(),this._currentPasteOperation===o&&(this._currentPasteOperation=void 0)}}))));this._progressService.withProgress({location:10,title:(0,N.NC)("pasteAsProgress","Running paste handlers")},(()=>o))}setCopyMetadata(e,t){e.setData(O,JSON.stringify(t))}fetchCopyMetadata(e){var t;if(!e.clipboardData)return;const i=e.clipboardData.getData(O);if(i)try{return JSON.parse(i)}catch(o){return}const[n,s]=p.b6.getTextData(e.clipboardData);return s?{defaultPastePayload:{mode:s.mode,multicursorText:null!==(t=s.multicursorText)&&void 0!==t?t:null,pasteOnNewLine:!!s.isFromEmptySelection}}:void 0}mergeInDataFromCopy(e,t,i){var n;return M(this,void 0,void 0,(function*(){if((null===t||void 0===t?void 0:t.id)&&(null===(n=this._currentCopyOperation)||void 0===n?void 0:n.handle)===t.id){const t=yield this._currentCopyOperation.dataTransferPromise;if(i.isCancellationRequested)return;for(const[i,n]of t)e.replace(i,n)}if(!e.has(c.v.uriList)){const t=yield this._clipboardService.readResources();if(i.isCancellationRequested)return;t.length&&e.append(c.v.uriList,(0,l.ZO)(l.Z0.create(t)))}}))}getPasteEdits(e,t,i,n,s){return M(this,void 0,void 0,(function*(){const o=yield(0,d.eP)(Promise.all(e.map((e=>M(this,void 0,void 0,(function*(){var o;try{const r=yield null===(o=e.provideDocumentPasteEdits)||void 0===o?void 0:o.call(e,i,n,t,s);if(r)return Object.assign(Object.assign({},r),{providerId:e.id})}catch(r){console.error(r)}}))))),s),r=(0,a.kX)(null!==o&&void 0!==o?o:[]);return(0,C.C)(r)}))}applyDefaultPasteHandler(e,t,i){var n,s,o;return M(this,void 0,void 0,(function*(){const r=null!==(n=e.get(c.v.text))&&void 0!==n?n:e.get("text");if(!r)return;const a=yield r.asString();if(i.isCancellationRequested)return;const d={text:a,pasteOnNewLine:null!==(s=null===t||void 0===t?void 0:t.defaultPastePayload.pasteOnNewLine)&&void 0!==s&&s,multicursorText:null!==(o=null===t||void 0===t?void 0:t.defaultPastePayload.multicursorText)&&void 0!==o?o:null,mode:null};this._editor.trigger("keyboard","paste",d)}))}};function T(e,t){var i;return Boolean(null===(i=e.pasteMimeTypes)||void 0===i?void 0:i.some((e=>t.matches(e))))}F.ID="editor.contrib.copyPasteActionController",F=n=D([E(1,R.TG),E(2,m.vu),E(3,y.p),E(4,v.p),E(5,I.eJ),E(6,w.R9)],F);var k=i(60180);(0,s._K)(F.ID,F,0),(0,o.y)(k.v),(0,s.fK)(new class extends s._l{constructor(){super({id:P,precondition:A,kbOpts:{weight:100,primary:2137}})}runEditorCommand(e,t,i){var n;return null===(n=F.get(t))||void 0===n?void 0:n.changePasteType()}}),(0,s.Qr)(class extends s.R6{constructor(){super({id:"editor.action.pasteAs",label:N.NC("pasteAs","Paste As..."),alias:"Paste As...",precondition:void 0,description:{description:"Paste as",args:[{name:"args",schema:{type:"object",properties:{id:{type:"string",description:N.NC("pasteAs.id","The id of the paste edit to try applying. If not provided, the editor will show a picker.")}}}}]}})}run(e,t,i){var n;const s="string"===typeof(null===i||void 0===i?void 0:i.id)?i.id:void 0;return null===(n=F.get(t))||void 0===n?void 0:n.pasteAs(s)}})},60180:(e,t,i)=>{i.d(t,{P:()=>N,v:()=>y});var n=i(21921),s=i(66383),o=i(70959),r=i(96358),a=i(50200),d=i(21230),l=i(95896),h=i(16458),c=i(25206),u=i(15086),g=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},p=function(e,t){return function(i,n){t(i,n,e)}},_=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function r(e){try{d(n.next(e))}catch(t){o(t)}}function a(e){try{d(n["throw"](e))}catch(t){o(t)}}function d(e){e.done?i(e.value):s(e.value).then(r,a)}d((n=n.apply(e,t||[])).next())}))};const m=(0,c.NC)("builtIn","Built-in");class f{provideDocumentPasteEdits(e,t,i,n){return _(this,void 0,void 0,(function*(){const e=yield this.getEdit(i,n);return e?{insertText:e.insertText,label:e.label,detail:e.detail,handledMimeType:e.handledMimeType,yieldTo:e.yieldTo}:void 0}))}provideDocumentOnDropEdits(e,t,i,n){return _(this,void 0,void 0,(function*(){const e=yield this.getEdit(i,n);return e?{insertText:e.insertText,label:e.label,handledMimeType:e.handledMimeType,yieldTo:e.yieldTo}:void 0}))}}class v extends f{constructor(){super(...arguments),this.id="text",this.dropMimeTypes=[r.v.text],this.pasteMimeTypes=[r.v.text]}getEdit(e,t){return _(this,void 0,void 0,(function*(){const t=e.get(r.v.text);if(!t)return;if(e.has(r.v.uriList))return;const i=yield t.asString();return{handledMimeType:r.v.text,label:(0,c.NC)("text.label","Insert Plain Text"),detail:m,insertText:i}}))}}class C extends f{constructor(){super(...arguments),this.id="uri",this.dropMimeTypes=[r.v.uriList],this.pasteMimeTypes=[r.v.uriList]}getEdit(e,t){return _(this,void 0,void 0,(function*(){const i=yield S(e);if(!i.length||t.isCancellationRequested)return;let n=0;const s=i.map((({uri:e,originalText:t})=>e.scheme===a.lg.file?e.fsPath:(n++,t))).join(" ");let o;return o=n>0?i.length>1?(0,c.NC)("defaultDropProvider.uriList.uris","Insert Uris"):(0,c.NC)("defaultDropProvider.uriList.uri","Insert Uri"):i.length>1?(0,c.NC)("defaultDropProvider.uriList.paths","Insert Paths"):(0,c.NC)("defaultDropProvider.uriList.path","Insert Path"),{handledMimeType:r.v.uriList,insertText:s,label:o,detail:m}}))}}let b=class extends f{constructor(e){super(),this._workspaceContextService=e,this.id="relativePath",this.dropMimeTypes=[r.v.uriList],this.pasteMimeTypes=[r.v.uriList]}getEdit(e,t){return _(this,void 0,void 0,(function*(){const i=yield S(e);if(!i.length||t.isCancellationRequested)return;const s=(0,n.kX)(i.map((({uri:e})=>{const t=this._workspaceContextService.getWorkspaceFolder(e);return t?(0,d.lX)(t.uri,e):void 0})));return s.length?{handledMimeType:r.v.uriList,insertText:s.join(" "),label:i.length>1?(0,c.NC)("defaultDropProvider.uriList.relativePaths","Insert Relative Paths"):(0,c.NC)("defaultDropProvider.uriList.relativePath","Insert Relative Path"),detail:m}:void 0}))}};function S(e){return _(this,void 0,void 0,(function*(){const t=e.get(r.v.uriList);if(!t)return[];const i=yield t.asString(),n=[];for(const e of s.Z0.parse(i))try{n.push({uri:l.o.parse(e),originalText:e})}catch(o){}return n}))}b=g([p(0,u.ec)],b);let N=class extends o.JT{constructor(e,t){super(),this._register(e.documentOnDropEditProvider.register("*",new v)),this._register(e.documentOnDropEditProvider.register("*",new C)),this._register(e.documentOnDropEditProvider.register("*",new b(t)))}};N=g([p(0,h.p),p(1,u.ec)],N);let y=class extends o.JT{constructor(e,t){super(),this._register(e.documentPasteEditProvider.register("*",new v)),this._register(e.documentPasteEditProvider.register("*",new C)),this._register(e.documentPasteEditProvider.register("*",new b(t)))}};y=g([p(0,h.p),p(1,u.ec)],y)},13301:(e,t,i)=>{var n,s=i(48077),o=i(83064),r=i(64559),a=i(60180),d=i(25206),l=i(46853),h=i(39672),c=i(21921),u=i(85398),g=i(66383),p=i(70959),_=i(80542),m=i(33162),f=i(16458),v=i(94346),C=i(51774),b=i(39363),S=i(44737),N=i(47596),y=i(37174),x=i(60808),R=i(21881),w=i(24201),I=i(30704),L=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},D=function(e,t){return function(i,n){t(i,n,e)}},E=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function r(e){try{d(n.next(e))}catch(t){o(t)}}function a(e){try{d(n["throw"](e))}catch(t){o(t)}}function d(e){e.done?i(e.value):s(e.value).then(r,a)}d((n=n.apply(e,t||[])).next())}))};const M="editor.experimental.dropIntoEditor.defaultProvider",P="editor.changeDropType",A=new y.uy("dropWidgetVisible",!1,(0,d.NC)("dropWidgetVisible","Whether the drop widget is showing"));let O=n=class extends p.JT{static get(e){return e.getContribution(n.ID)}constructor(e,t,i,n,s){super(),this._configService=i,this._languageFeaturesService=n,this._treeViewsDragAndDropService=s,this.treeItemsTransfer=x.Ej.getInstance(),this._dropProgressManager=this._register(t.createInstance(S.r,"dropIntoEditor",e)),this._postDropWidgetManager=this._register(t.createInstance(I.p,"dropIntoEditor",e,A,{id:P,label:(0,d.NC)("postDropWidgetTitle","Show drop options...")})),this._register(e.onDropIntoEditor((t=>this.onDropIntoEditor(e,t.position,t.event))))}changeDropType(){this._postDropWidgetManager.tryShowSelector()}onDropIntoEditor(e,t,i){var n;return E(this,void 0,void 0,(function*(){if(!i.dataTransfer||!e.hasModel())return;null===(n=this._currentOperation)||void 0===n||n.cancel(),e.focus(),e.setPosition(t);const s=(0,u.PG)((n=>E(this,void 0,void 0,(function*(){const o=new b.Dl(e,1,void 0,n);try{const s=yield this.extractDataTransferData(i);if(0===s.size||o.token.isCancellationRequested)return;const r=e.getModel();if(!r)return;const a=this._languageFeaturesService.documentOnDropEditProvider.ordered(r).filter((e=>!e.dropMimeTypes||e.dropMimeTypes.some((e=>s.matches(e))))),d=yield this.getDropEdits(a,r,t,s,o);if(o.token.isCancellationRequested)return;if(d.length){const i=this.getInitialActiveEditIndex(r,d),s="afterDrop"===e.getOption(36).showDropSelector;yield this._postDropWidgetManager.applyEditAndShowIfNeeded([m.e.fromPositions(t)],{activeEditIndex:i,allEdits:d},s,n)}}finally{o.dispose(),this._currentOperation===s&&(this._currentOperation=void 0)}}))));this._dropProgressManager.showWhile(t,(0,d.NC)("dropIntoEditorProgress","Running drop handlers. Click to cancel"),s),this._currentOperation=s}))}getDropEdits(e,t,i,n,s){return E(this,void 0,void 0,(function*(){const o=yield(0,u.eP)(Promise.all(e.map((e=>E(this,void 0,void 0,(function*(){try{const o=yield e.provideDocumentOnDropEdits(t,i,n,s.token);if(o)return Object.assign(Object.assign({},o),{providerId:e.id})}catch(o){console.error(o)}}))))),s.token),r=(0,c.kX)(null!==o&&void 0!==o?o:[]);return(0,w.C)(r)}))}getInitialActiveEditIndex(e,t){const i=this._configService.getValue(M,{resource:e.uri});for(const[n,s]of Object.entries(i)){const e=t.findIndex((e=>s===e.providerId&&e.handledMimeType&&(0,g.SN)(n,[e.handledMimeType])));if(e>=0)return e}return 0}extractDataTransferData(e){return E(this,void 0,void 0,(function*(){if(!e.dataTransfer)return new g.Hl;const t=(0,_.L)(e.dataTransfer);if(this.treeItemsTransfer.hasData(v.f.prototype)){const e=this.treeItemsTransfer.getData(v.f.prototype);if(Array.isArray(e))for(const i of e){const e=yield this._treeViewsDragAndDropService.removeDragOperationTransfer(i.identifier);if(e)for(const[i,n]of e)t.replace(i,n)}}return t}))}};O.ID="editor.contrib.dropIntoEditorController",O=n=L([D(1,R.TG),D(2,N.Ui),D(3,f.p),D(4,C.m)],O),(0,s._K)(O.ID,O,2),(0,s.fK)(new class extends s._l{constructor(){super({id:P,precondition:A,kbOpts:{weight:100,primary:2137}})}runEditorCommand(e,t,i){var n;null===(n=O.get(t))||void 0===n||n.changeDropType()}}),(0,r.y)(a.P),h.B.as(l.IP.Configuration).registerConfiguration(Object.assign(Object.assign({},o.wk),{properties:{[M]:{type:"object",scope:5,description:d.NC("defaultProviderDescription","Configures the default drop provider to use for content of a given mime type."),default:{},additionalProperties:{type:"string"}}}}))},24201:(e,t,i)=>{i.d(t,{C:()=>o,n:()=>s});var n=i(22047);function s(e,t,i){var s,o;return{edits:[...t.map((t=>new n.Gl(e,"string"===typeof i.insertText?{range:t,text:i.insertText,insertAsSnippet:!1}:{range:t,text:i.insertText.snippet,insertAsSnippet:!0}))),...null!==(o=null===(s=i.additionalEdit)||void 0===s?void 0:s.edits)&&void 0!==o?o:[]]}}function o(e){var t;function i(e,t){return"providerId"in e&&e.providerId===t.providerId||"mimeType"in e&&e.mimeType===t.handledMimeType}const n=new Map;for(const a of e)for(const s of null!==(t=a.yieldTo)&&void 0!==t?t:[])for(const t of e)if(t!==a&&i(s,t)){let e=n.get(a);e||(e=[],n.set(a,e)),e.push(t)}if(!n.size)return Array.from(e);const s=new Set,o=[];function r(e){if(!e.length)return[];const t=e[0];if(o.includes(t))return console.warn(`Yield to cycle detected for ${t.providerId}`),e;if(s.has(t))return r(e.slice(1));let i=[];const a=n.get(t);return a&&(o.push(t),i=r(a),o.pop()),s.add(t),[...i,t,...r(e.slice(1))]}return r(Array.from(e))}},30704:(e,t,i)=>{i.d(t,{p:()=>v});var n,s=i(2548),o=i(24511),r=i(10205),a=i(11271),d=i(70959),l=i(22047),h=i(37174),c=i(93753),u=i(21881),g=i(15285),p=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},_=function(e,t){return function(i,n){t(i,n,e)}},m=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function r(e){try{d(n.next(e))}catch(t){o(t)}}function a(e){try{d(n["throw"](e))}catch(t){o(t)}}function d(e){e.done?i(e.value):s(e.value).then(r,a)}d((n=n.apply(e,t||[])).next())}))};let f=n=class extends d.JT{constructor(e,t,i,n,s,o,r,l,h,c){super(),this.typeId=e,this.editor=t,this.showCommand=n,this.range=s,this.edits=o,this.onSelectNewEdit=r,this._contextMenuService=l,this._keybindingService=c,this.allowEditorOverflow=!0,this.suppressMouseDown=!0,this.create(),this.visibleContext=i.bindTo(h),this.visibleContext.set(!0),this._register((0,d.OF)((()=>this.visibleContext.reset()))),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this),this._register((0,d.OF)((()=>this.editor.removeContentWidget(this)))),this._register(this.editor.onDidChangeCursorPosition((e=>{s.containsPosition(e.position)||this.dispose()}))),this._register(a.ju.runAndSubscribe(c.onDidUpdateKeybindings,(()=>{this._updateButtonTitle()})))}_updateButtonTitle(){var e;const t=null===(e=this._keybindingService.lookupKeybinding(this.showCommand.id))||void 0===e?void 0:e.getLabel();this.button.element.title=this.showCommand.label+(t?` (${t})`:"")}create(){this.domNode=s.$(".post-edit-widget"),this.button=this._register(new o.z(this.domNode,{supportIcons:!0})),this.button.label="$(insert)",this._register(s.nm(this.domNode,s.tw.CLICK,(()=>this.showSelector())))}getId(){return n.baseId+"."+this.typeId}getDomNode(){return this.domNode}getPosition(){return{position:this.range.getEndPosition(),preference:[2]}}showSelector(){this._contextMenuService.showContextMenu({getAnchor:()=>{const e=s.i(this.button.element);return{x:e.left+e.width,y:e.top+e.height}},getActions:()=>this.edits.allEdits.map(((e,t)=>(0,r.xw)({id:"",label:e.label,checked:t===this.edits.activeEditIndex,run:()=>{if(t!==this.edits.activeEditIndex)return this.onSelectNewEdit(t)}})))})}};f.baseId="editor.widget.postEditWidget",f=n=p([_(7,c.i),_(8,h.i6),_(9,g.d)],f);let v=class extends d.JT{constructor(e,t,i,n,s,o){super(),this._id=e,this._editor=t,this._visibleContext=i,this._showCommand=n,this._instantiationService=s,this._bulkEditService=o,this._currentWidget=this._register(new d.XK),this._register(a.ju.any(t.onDidChangeModel,t.onDidChangeModelContent)((()=>this.clear())))}applyEditAndShowIfNeeded(e,t,i,n){var s,o;return m(this,void 0,void 0,(function*(){const r=this._editor.getModel();if(!r||!e.length)return;const a=t.allEdits[t.activeEditIndex];if(!a)return;let d=[];d=("string"===typeof a.insertText?""===a.insertText:""===a.insertText.snippet)?[]:e.map((e=>new l.Gl(r.uri,"string"===typeof a.insertText?{range:e,text:a.insertText,insertAsSnippet:!1}:{range:e,text:a.insertText.snippet,insertAsSnippet:!0})));const h=[...d,...null!==(o=null===(s=a.additionalEdit)||void 0===s?void 0:s.edits)&&void 0!==o?o:[]],c={edits:h},u=e[0],g=r.deltaDecorations([],[{range:u,options:{description:"paste-line-suffix",stickiness:0}}]);let p,_;try{p=yield this._bulkEditService.apply(c,{editor:this._editor,token:n}),_=r.getDecorationRange(g[0])}finally{r.deltaDecorations(g,[])}i&&p.isApplied&&t.allEdits.length>1&&this.show(null!==_&&void 0!==_?_:u,t,(s=>m(this,void 0,void 0,(function*(){const o=this._editor.getModel();o&&(yield o.undo(),this.applyEditAndShowIfNeeded(e,{activeEditIndex:s,allEdits:t.allEdits},i,n))}))))}))}show(e,t,i){this.clear(),this._editor.hasModel()&&(this._currentWidget.value=this._instantiationService.createInstance(f,this._id,this._editor,this._visibleContext,this._showCommand,e,t,i))}clear(){this._currentWidget.clear()}tryShowSelector(){var e;null===(e=this._currentWidget.value)||void 0===e||e.showSelector()}};v=p([_(4,u.TG),_(5,l.vu)],v)},39363:(e,t,i)=>{i.d(t,{yy:()=>m,Dl:()=>f,YQ:()=>v});var n=i(61720),s=i(33162),o=i(55191),r=i(70959),a=i(48077),d=i(37174),l=i(33010),h=i(21881),c=i(39326),u=i(25206);const g=(0,h.yh)("IEditorCancelService"),p=new d.uy("cancellableOperation",!1,(0,u.NC)("cancellableOperation","Whether the editor runs a cancellable operation, e.g. like 'Peek References'"));(0,c.z)(g,class{constructor(){this._tokens=new WeakMap}add(e,t){let i,n=this._tokens.get(e);return n||(n=e.invokeWithinContext((e=>{const t=p.bindTo(e.get(d.i6)),i=new l.S;return{key:t,tokens:i}})),this._tokens.set(e,n)),n.key.set(!0),i=n.tokens.push(t),()=>{i&&(i(),n.key.set(!n.tokens.isEmpty()),i=void 0)}}cancel(e){const t=this._tokens.get(e);if(!t)return;const i=t.tokens.pop();i&&(i.cancel(),t.key.set(!t.tokens.isEmpty()))}},1);class _ extends o.A{constructor(e,t){super(t),this.editor=e,this._unregister=e.invokeWithinContext((t=>t.get(g).add(e,this)))}dispose(){this._unregister(),super.dispose()}}(0,a.fK)(new class extends a._l{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:p})}runEditorCommand(e,t){e.get(g).cancel(t)}});class m{constructor(e,t){if(this.flags=t,0!==(1&this.flags)){const t=e.getModel();this.modelVersionId=t?n.WU("{0}#{1}",t.uri.toString(),t.getVersionId()):null}else this.modelVersionId=null;0!==(4&this.flags)?this.position=e.getPosition():this.position=null,0!==(2&this.flags)?this.selection=e.getSelection():this.selection=null,0!==(8&this.flags)?(this.scrollLeft=e.getScrollLeft(),this.scrollTop=e.getScrollTop()):(this.scrollLeft=-1,this.scrollTop=-1)}_equals(e){if(!(e instanceof m))return!1;const t=e;return this.modelVersionId===t.modelVersionId&&(this.scrollLeft===t.scrollLeft&&this.scrollTop===t.scrollTop&&(!(!this.position&&t.position||this.position&&!t.position||this.position&&t.position&&!this.position.equals(t.position))&&!(!this.selection&&t.selection||this.selection&&!t.selection||this.selection&&t.selection&&!this.selection.equalsRange(t.selection))))}validate(e){return this._equals(new m(e,this.flags))}}class f extends _{constructor(e,t,i,n){super(e,n),this._listener=new r.SL,4&t&&this._listener.add(e.onDidChangeCursorPosition((e=>{i&&s.e.containsPosition(i,e.position)||this.cancel()}))),2&t&&this._listener.add(e.onDidChangeCursorSelection((e=>{i&&s.e.containsRange(i,e.selection)||this.cancel()}))),8&t&&this._listener.add(e.onDidScrollChange((e=>this.cancel()))),1&t&&(this._listener.add(e.onDidChangeModel((e=>this.cancel()))),this._listener.add(e.onDidChangeModelContent((e=>this.cancel()))))}dispose(){this._listener.dispose(),super.dispose()}}class v extends o.A{constructor(e,t){super(t),this._listener=e.onDidChangeContent((()=>this.cancel()))}dispose(){this._listener.dispose(),super.dispose()}}},36691:(e,t,i)=>{i.d(t,{pR:()=>it});var n=i(85398),s=i(70959),o=i(61720),r=i(48077),a=i(27193),d=i(44950),l=i(79857),h=i(75912),c=i(74816),u=i(89999),g=i(33162),p=i(54644),_=i(21298),m=i(16375),f=i(47277),v=i(32656);class C{constructor(e){this._editor=e,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=this._editor.getPosition()}dispose(){this._editor.removeDecorations(this._allDecorations()),this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}reset(){this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}getCount(){return this._decorations.length}getFindScope(){return this._findScopeDecorationIds[0]?this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]):null}getFindScopes(){if(this._findScopeDecorationIds.length){const e=this._findScopeDecorationIds.map((e=>this._editor.getModel().getDecorationRange(e))).filter((e=>!!e));if(e.length)return e}return null}getStartPosition(){return this._startPosition}setStartPosition(e){this._startPosition=e,this.setCurrentFindMatch(null)}_getDecorationIndex(e){const t=this._decorations.indexOf(e);return t>=0?t+1:1}getDecorationRangeAt(e){const t=e<this._decorations.length?this._decorations[e]:null;return t?this._editor.getModel().getDecorationRange(t):null}getCurrentMatchesPosition(e){const t=this._editor.getModel().getDecorationsInRange(e);for(const i of t){const e=i.options;if(e===C._FIND_MATCH_DECORATION||e===C._CURRENT_FIND_MATCH_DECORATION)return this._getDecorationIndex(i.id)}return 0}setCurrentFindMatch(e){let t=null,i=0;if(e)for(let n=0,s=this._decorations.length;n<s;n++){const s=this._editor.getModel().getDecorationRange(this._decorations[n]);if(e.equalsRange(s)){t=this._decorations[n],i=n+1;break}}return null===this._highlightedDecorationId&&null===t||this._editor.changeDecorations((e=>{if(null!==this._highlightedDecorationId&&(e.changeDecorationOptions(this._highlightedDecorationId,C._FIND_MATCH_DECORATION),this._highlightedDecorationId=null),null!==t&&(this._highlightedDecorationId=t,e.changeDecorationOptions(this._highlightedDecorationId,C._CURRENT_FIND_MATCH_DECORATION)),null!==this._rangeHighlightDecorationId&&(e.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),null!==t){let i=this._editor.getModel().getDecorationRange(t);if(i.startLineNumber!==i.endLineNumber&&1===i.endColumn){const e=i.endLineNumber-1,t=this._editor.getModel().getLineMaxColumn(e);i=new g.e(i.startLineNumber,i.startColumn,e,t)}this._rangeHighlightDecorationId=e.addDecoration(i,C._RANGE_HIGHLIGHT_DECORATION)}})),i}set(e,t){this._editor.changeDecorations((i=>{let n=C._FIND_MATCH_DECORATION;const s=[];if(e.length>1e3){n=C._FIND_MATCH_NO_OVERVIEW_DECORATION;const t=this._editor.getModel().getLineCount(),i=this._editor.getLayoutInfo().height,o=i/t,r=Math.max(2,Math.ceil(3/o));let a=e[0].range.startLineNumber,d=e[0].range.endLineNumber;for(let n=1,l=e.length;n<l;n++){const t=e[n].range;d+r>=t.startLineNumber?t.endLineNumber>d&&(d=t.endLineNumber):(s.push({range:new g.e(a,1,d,1),options:C._FIND_MATCH_ONLY_OVERVIEW_DECORATION}),a=t.startLineNumber,d=t.endLineNumber)}s.push({range:new g.e(a,1,d,1),options:C._FIND_MATCH_ONLY_OVERVIEW_DECORATION})}const o=new Array(e.length);for(let t=0,r=e.length;t<r;t++)o[t]={range:e[t].range,options:n};this._decorations=i.deltaDecorations(this._decorations,o),this._overviewRulerApproximateDecorations=i.deltaDecorations(this._overviewRulerApproximateDecorations,s),this._rangeHighlightDecorationId&&(i.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),this._findScopeDecorationIds.length&&(this._findScopeDecorationIds.forEach((e=>i.removeDecoration(e))),this._findScopeDecorationIds=[]),(null===t||void 0===t?void 0:t.length)&&(this._findScopeDecorationIds=t.map((e=>i.addDecoration(e,C._FIND_SCOPE_DECORATION))))}))}matchBeforePosition(e){if(0===this._decorations.length)return null;for(let t=this._decorations.length-1;t>=0;t--){const i=this._decorations[t],n=this._editor.getModel().getDecorationRange(i);if(n&&!(n.endLineNumber>e.lineNumber)){if(n.endLineNumber<e.lineNumber)return n;if(!(n.endColumn>e.column))return n}}return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length-1])}matchAfterPosition(e){if(0===this._decorations.length)return null;for(let t=0,i=this._decorations.length;t<i;t++){const i=this._decorations[t],n=this._editor.getModel().getDecorationRange(i);if(n&&!(n.startLineNumber<e.lineNumber)){if(n.startLineNumber>e.lineNumber)return n;if(!(n.startColumn<e.column))return n}}return this._editor.getModel().getDecorationRange(this._decorations[0])}_allDecorations(){let e=[];return e=e.concat(this._decorations),e=e.concat(this._overviewRulerApproximateDecorations),this._findScopeDecorationIds.length&&e.push(...this._findScopeDecorationIds),this._rangeHighlightDecorationId&&e.push(this._rangeHighlightDecorationId),e}}C._CURRENT_FIND_MATCH_DECORATION=m.qx.register({description:"current-find-match",stickiness:1,zIndex:13,className:"currentFindMatch",showIfCollapsed:!0,overviewRuler:{color:(0,v.EN)(f.Fm_),position:l.sh.Center},minimap:{color:(0,v.EN)(f.SUY),position:l.F5.Inline}}),C._FIND_MATCH_DECORATION=m.qx.register({description:"find-match",stickiness:1,zIndex:10,className:"findMatch",showIfCollapsed:!0,overviewRuler:{color:(0,v.EN)(f.Fm_),position:l.sh.Center},minimap:{color:(0,v.EN)(f.SUY),position:l.F5.Inline}}),C._FIND_MATCH_NO_OVERVIEW_DECORATION=m.qx.register({description:"find-match-no-overview",stickiness:1,className:"findMatch",showIfCollapsed:!0}),C._FIND_MATCH_ONLY_OVERVIEW_DECORATION=m.qx.register({description:"find-match-only-overview",stickiness:1,overviewRuler:{color:(0,v.EN)(f.Fm_),position:l.sh.Center}}),C._RANGE_HIGHLIGHT_DECORATION=m.qx.register({description:"find-range-highlight",stickiness:1,className:"rangeHighlight",isWholeLine:!0}),C._FIND_SCOPE_DECORATION=m.qx.register({description:"find-scope",className:"findScope",isWholeLine:!0});class b{constructor(e,t,i){this._editorSelection=e,this._ranges=t,this._replaceStrings=i,this._trackedEditorSelectionId=null}getEditOperations(e,t){if(this._ranges.length>0){const e=[];for(let t=0;t<this._ranges.length;t++)e.push({range:this._ranges[t],text:this._replaceStrings[t]});e.sort(((e,t)=>g.e.compareRangesUsingStarts(e.range,t.range)));const i=[];let n=e[0];for(let t=1;t<e.length;t++)n.range.endLineNumber===e[t].range.startLineNumber&&n.range.endColumn===e[t].range.startColumn?(n.range=n.range.plusRange(e[t].range),n.text=n.text+e[t].text):(i.push(n),n=e[t]);i.push(n);for(const s of i)t.addEditOperation(s.range,s.text)}this._trackedEditorSelectionId=t.trackSelection(this._editorSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._trackedEditorSelectionId)}}var S=i(87865);class N{constructor(e){this.staticValue=e,this.kind=0}}class y{constructor(e){this.pieces=e,this.kind=1}}class x{static fromStaticValue(e){return new x([R.staticValue(e)])}get hasReplacementPatterns(){return 1===this._state.kind}constructor(e){e&&0!==e.length?1===e.length&&null!==e[0].staticValue?this._state=new N(e[0].staticValue):this._state=new y(e):this._state=new N("")}buildReplaceString(e,t){if(0===this._state.kind)return t?(0,S.o)(e,this._state.staticValue):this._state.staticValue;let i="";for(let n=0,s=this._state.pieces.length;n<s;n++){const t=this._state.pieces[n];if(null!==t.staticValue){i+=t.staticValue;continue}let s=x._substitute(t.matchIndex,e);if(null!==t.caseOps&&t.caseOps.length>0){const e=[],i=t.caseOps.length;let n=0;for(let o=0,r=s.length;o<r;o++){if(n>=i){e.push(s.slice(o));break}switch(t.caseOps[n]){case"U":e.push(s[o].toUpperCase());break;case"u":e.push(s[o].toUpperCase()),n++;break;case"L":e.push(s[o].toLowerCase());break;case"l":e.push(s[o].toLowerCase()),n++;break;default:e.push(s[o])}}s=e.join("")}i+=s}return i}static _substitute(e,t){if(null===t)return"";if(0===e)return t[0];let i="";while(e>0){if(e<t.length){const n=t[e]||"";return n+i}i=String(e%10)+i,e=Math.floor(e/10)}return"$"+i}}class R{static staticValue(e){return new R(e,-1,null)}static caseOps(e,t){return new R(null,e,t)}constructor(e,t,i){this.staticValue=e,this.matchIndex=t,i&&0!==i.length?this.caseOps=i.slice(0):this.caseOps=null}}class w{constructor(e){this._source=e,this._lastCharIndex=0,this._result=[],this._resultLen=0,this._currentStaticPiece=""}emitUnchanged(e){this._emitStatic(this._source.substring(this._lastCharIndex,e)),this._lastCharIndex=e}emitStatic(e,t){this._emitStatic(e),this._lastCharIndex=t}_emitStatic(e){0!==e.length&&(this._currentStaticPiece+=e)}emitMatchIndex(e,t,i){0!==this._currentStaticPiece.length&&(this._result[this._resultLen++]=R.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),this._result[this._resultLen++]=R.caseOps(e,i),this._lastCharIndex=t}finalize(){return this.emitUnchanged(this._source.length),0!==this._currentStaticPiece.length&&(this._result[this._resultLen++]=R.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),new x(this._result)}}function I(e){if(!e||0===e.length)return new x(null);const t=[],i=new w(e);for(let n=0,s=e.length;n<s;n++){const o=e.charCodeAt(n);if(92!==o){if(36===o){if(n++,n>=s)break;const o=e.charCodeAt(n);if(36===o){i.emitUnchanged(n-1),i.emitStatic("$",n+1);continue}if(48===o||38===o){i.emitUnchanged(n-1),i.emitMatchIndex(0,n+1,t),t.length=0;continue}if(49<=o&&o<=57){let r=o-48;if(n+1<s){const s=e.charCodeAt(n+1);if(48<=s&&s<=57){n++,r=10*r+(s-48),i.emitUnchanged(n-2),i.emitMatchIndex(r,n+1,t),t.length=0;continue}}i.emitUnchanged(n-1),i.emitMatchIndex(r,n+1,t),t.length=0;continue}}}else{if(n++,n>=s)break;const o=e.charCodeAt(n);switch(o){case 92:i.emitUnchanged(n-1),i.emitStatic("\\",n+1);break;case 110:i.emitUnchanged(n-1),i.emitStatic("\n",n+1);break;case 116:i.emitUnchanged(n-1),i.emitStatic("\t",n+1);break;case 117:case 85:case 108:case 76:i.emitUnchanged(n-1),i.emitStatic("",n+1),t.push(String.fromCharCode(o));break}}}return i.finalize()}var L=i(37174);const D=new L.uy("findWidgetVisible",!1),E=(D.toNegated(),new L.uy("findInputFocussed",!1)),M=new L.uy("replaceInputFocussed",!1),P={primary:545,mac:{primary:2593}},A={primary:565,mac:{primary:2613}},O={primary:560,mac:{primary:2608}},F={primary:554,mac:{primary:2602}},T={primary:558,mac:{primary:2606}},k={StartFindAction:"actions.find",StartFindWithSelection:"actions.findWithSelection",StartFindWithArgs:"editor.actions.findWithArgs",NextMatchFindAction:"editor.action.nextMatchFindAction",PreviousMatchFindAction:"editor.action.previousMatchFindAction",GoToMatchFindAction:"editor.action.goToMatchFindAction",NextSelectionMatchFindAction:"editor.action.nextSelectionMatchFindAction",PreviousSelectionMatchFindAction:"editor.action.previousSelectionMatchFindAction",StartFindReplaceAction:"editor.action.startFindReplaceAction",CloseFindWidgetCommand:"closeFindWidget",ToggleCaseSensitiveCommand:"toggleFindCaseSensitive",ToggleWholeWordCommand:"toggleFindWholeWord",ToggleRegexCommand:"toggleFindRegex",ToggleSearchScopeCommand:"toggleFindInSelection",TogglePreserveCaseCommand:"togglePreserveCase",ReplaceOneAction:"editor.action.replaceOne",ReplaceAllAction:"editor.action.replaceAll",SelectAllMatchesAction:"editor.action.selectAllMatches"},W=19999,V=240;class B{constructor(e,t){this._toDispose=new s.SL,this._editor=e,this._state=t,this._isDisposed=!1,this._startSearchingTimer=new n._F,this._decorations=new C(e),this._toDispose.add(this._decorations),this._updateDecorationsScheduler=new n.pY((()=>this.research(!1)),100),this._toDispose.add(this._updateDecorationsScheduler),this._toDispose.add(this._editor.onDidChangeCursorPosition((e=>{3!==e.reason&&5!==e.reason&&6!==e.reason||this._decorations.setStartPosition(this._editor.getPosition())}))),this._ignoreModelContentChanged=!1,this._toDispose.add(this._editor.onDidChangeModelContent((e=>{this._ignoreModelContentChanged||(e.isFlush&&this._decorations.reset(),this._decorations.setStartPosition(this._editor.getPosition()),this._updateDecorationsScheduler.schedule())}))),this._toDispose.add(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this.research(!1,this._state.searchScope)}dispose(){this._isDisposed=!0,(0,s.B9)(this._startSearchingTimer),this._toDispose.dispose()}_onStateChanged(e){if(!this._isDisposed&&this._editor.hasModel()&&(e.searchString||e.isReplaceRevealed||e.isRegex||e.wholeWord||e.matchCase||e.searchScope)){const t=this._editor.getModel();t.isTooLargeForSyncing()?(this._startSearchingTimer.cancel(),this._startSearchingTimer.setIfNotSet((()=>{e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)}),V)):e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)}}static _getSearchRange(e,t){return t||e.getFullModelRange()}research(e,t){let i=null;"undefined"!==typeof t?null!==t&&(i=Array.isArray(t)?t:[t]):i=this._decorations.getFindScopes(),null!==i&&(i=i.map((e=>{if(e.startLineNumber!==e.endLineNumber){let t=e.endLineNumber;return 1===e.endColumn&&(t-=1),new g.e(e.startLineNumber,1,t,this._editor.getModel().getLineMaxColumn(t))}return e})));const n=this._findMatches(i,!1,W);this._decorations.set(n,i);const s=this._editor.getSelection();let o=this._decorations.getCurrentMatchesPosition(s);if(0===o&&n.length>0){const e=(0,h.J_)(n.map((e=>e.range)),(e=>g.e.compareRangesUsingStarts(e,s)>=0));o=e>0?e-1+1:o}this._state.changeMatchInfo(o,this._decorations.getCount(),void 0),e&&this._editor.getOption(41).cursorMoveOnType&&this._moveToNextMatch(this._decorations.getStartPosition())}_hasMatches(){return this._state.matchesCount>0}_cannotFind(){if(!this._hasMatches()){const e=this._decorations.getFindScope();return e&&this._editor.revealRangeInCenterIfOutsideViewport(e,0),!0}return!1}_setCurrentFindMatch(e){const t=this._decorations.setCurrentFindMatch(e);this._state.changeMatchInfo(t,this._decorations.getCount(),e),this._editor.setSelection(e),this._editor.revealRangeInCenterIfOutsideViewport(e,0)}_prevSearchPosition(e){const t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:i,column:n}=e;const s=this._editor.getModel();return t||1===n?(1===i?i=s.getLineCount():i--,n=s.getLineMaxColumn(i)):n--,new u.L(i,n)}_moveToPrevMatch(e,t=!1){if(!this._state.canNavigateBack()){const t=this._decorations.matchAfterPosition(e);return void(t&&this._setCurrentFindMatch(t))}if(this._decorations.getCount()<W){let t=this._decorations.matchBeforePosition(e);return t&&t.isEmpty()&&t.getStartPosition().equals(e)&&(e=this._prevSearchPosition(e),t=this._decorations.matchBeforePosition(e)),void(t&&this._setCurrentFindMatch(t))}if(this._cannotFind())return;const i=this._decorations.getFindScope(),n=B._getSearchRange(this._editor.getModel(),i);n.getEndPosition().isBefore(e)&&(e=n.getEndPosition()),e.isBefore(n.getStartPosition())&&(e=n.getEndPosition());const{lineNumber:s,column:o}=e,r=this._editor.getModel();let a=new u.L(s,o),d=r.findPreviousMatch(this._state.searchString,a,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null,!1);return d&&d.range.isEmpty()&&d.range.getStartPosition().equals(a)&&(a=this._prevSearchPosition(a),d=r.findPreviousMatch(this._state.searchString,a,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null,!1)),d?t||n.containsRange(d.range)?void this._setCurrentFindMatch(d.range):this._moveToPrevMatch(d.range.getStartPosition(),!0):void 0}moveToPrevMatch(){this._moveToPrevMatch(this._editor.getSelection().getStartPosition())}_nextSearchPosition(e){const t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:i,column:n}=e;const s=this._editor.getModel();return t||n===s.getLineMaxColumn(i)?(i===s.getLineCount()?i=1:i++,n=1):n++,new u.L(i,n)}_moveToNextMatch(e){if(!this._state.canNavigateForward()){const t=this._decorations.matchBeforePosition(e);return void(t&&this._setCurrentFindMatch(t))}if(this._decorations.getCount()<W){let t=this._decorations.matchAfterPosition(e);return t&&t.isEmpty()&&t.getStartPosition().equals(e)&&(e=this._nextSearchPosition(e),t=this._decorations.matchAfterPosition(e)),void(t&&this._setCurrentFindMatch(t))}const t=this._getNextMatch(e,!1,!0);t&&this._setCurrentFindMatch(t.range)}_getNextMatch(e,t,i,n=!1){if(this._cannotFind())return null;const s=this._decorations.getFindScope(),o=B._getSearchRange(this._editor.getModel(),s);o.getEndPosition().isBefore(e)&&(e=o.getStartPosition()),e.isBefore(o.getStartPosition())&&(e=o.getStartPosition());const{lineNumber:r,column:a}=e,d=this._editor.getModel();let l=new u.L(r,a),h=d.findNextMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null,t);return i&&h&&h.range.isEmpty()&&h.range.getStartPosition().equals(l)&&(l=this._nextSearchPosition(l),h=d.findNextMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null,t)),h?n||o.containsRange(h.range)?h:this._getNextMatch(h.range.getEndPosition(),t,i,!0):null}moveToNextMatch(){this._moveToNextMatch(this._editor.getSelection().getEndPosition())}_moveToMatch(e){const t=this._decorations.getDecorationRangeAt(e);t&&this._setCurrentFindMatch(t)}moveToMatch(e){this._moveToMatch(e)}_getReplacePattern(){return this._state.isRegex?I(this._state.replaceString):x.fromStaticValue(this._state.replaceString)}replace(){if(!this._hasMatches())return;const e=this._getReplacePattern(),t=this._editor.getSelection(),i=this._getNextMatch(t.getStartPosition(),!0,!1);if(i)if(t.equalsRange(i.range)){const n=e.buildReplaceString(i.matches,this._state.preserveCase),s=new c.T4(t,n);this._executeEditorCommand("replace",s),this._decorations.setStartPosition(new u.L(t.startLineNumber,t.startColumn+n.length)),this.research(!0)}else this._decorations.setStartPosition(this._editor.getPosition()),this._setCurrentFindMatch(i.range)}_findMatches(e,t,i){const n=(e||[null]).map((e=>B._getSearchRange(this._editor.getModel(),e)));return this._editor.getModel().findMatches(this._state.searchString,n,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null,t,i)}replaceAll(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();null===e&&this._state.matchesCount>=W?this._largeReplaceAll():this._regularReplaceAll(e),this.research(!1)}_largeReplaceAll(){const e=new _.bc(this._state.searchString,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null),t=e.parseSearchRequest();if(!t)return;let i=t.regex;if(!i.multiline){let e="mu";i.ignoreCase&&(e+="i"),i.global&&(e+="g"),i=new RegExp(i.source,e)}const n=this._editor.getModel(),s=n.getValue(1),o=n.getFullModelRange(),r=this._getReplacePattern();let a;const d=this._state.preserveCase;a=r.hasReplacementPatterns||d?s.replace(i,(function(){return r.buildReplaceString(arguments,d)})):s.replace(i,r.buildReplaceString(null,d));const l=new c.hP(o,a,this._editor.getSelection());this._executeEditorCommand("replaceAll",l)}_regularReplaceAll(e){const t=this._getReplacePattern(),i=this._findMatches(e,t.hasReplacementPatterns||this._state.preserveCase,1073741824),n=[];for(let o=0,r=i.length;o<r;o++)n[o]=t.buildReplaceString(i[o].matches,this._state.preserveCase);const s=new b(this._editor.getSelection(),i.map((e=>e.range)),n);this._executeEditorCommand("replaceAll",s)}selectAllMatches(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes(),t=this._findMatches(e,!1,1073741824);let i=t.map((e=>new p.Y(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn)));const n=this._editor.getSelection();for(let s=0,o=i.length;s<o;s++){const e=i[s];if(e.equalsRange(n)){i=[n].concat(i.slice(0,s)).concat(i.slice(s+1));break}}this._editor.setSelections(i)}_executeEditorCommand(e,t){try{this._ignoreModelContentChanged=!0,this._editor.pushUndoStop(),this._editor.executeCommand(e,t),this._editor.pushUndoStop()}finally{this._ignoreModelContentChanged=!1}}}var H=i(2548),U=i(21691),q=i(9194);class G extends q.${constructor(e,t,i){super(),this._hideSoon=this._register(new n.pY((()=>this._hide()),2e3)),this._isVisible=!1,this._editor=e,this._state=t,this._keybindingService=i,this._domNode=document.createElement("div"),this._domNode.className="findOptionsWidget",this._domNode.style.display="none",this._domNode.style.top="10px",this._domNode.style.zIndex="12",this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true");const s={inputActiveOptionBorder:(0,f.n_1)(f.PRb),inputActiveOptionForeground:(0,f.n_1)(f.Pvw),inputActiveOptionBackground:(0,f.n_1)(f.XEs)};this.caseSensitive=this._register(new U.rk(Object.assign({appendTitle:this._keybindingLabelFor(k.ToggleCaseSensitiveCommand),isChecked:this._state.matchCase},s))),this._domNode.appendChild(this.caseSensitive.domNode),this._register(this.caseSensitive.onChange((()=>{this._state.change({matchCase:this.caseSensitive.checked},!1)}))),this.wholeWords=this._register(new U.Qx(Object.assign({appendTitle:this._keybindingLabelFor(k.ToggleWholeWordCommand),isChecked:this._state.wholeWord},s))),this._domNode.appendChild(this.wholeWords.domNode),this._register(this.wholeWords.onChange((()=>{this._state.change({wholeWord:this.wholeWords.checked},!1)}))),this.regex=this._register(new U.eH(Object.assign({appendTitle:this._keybindingLabelFor(k.ToggleRegexCommand),isChecked:this._state.isRegex},s))),this._domNode.appendChild(this.regex.domNode),this._register(this.regex.onChange((()=>{this._state.change({isRegex:this.regex.checked},!1)}))),this._editor.addOverlayWidget(this),this._register(this._state.onFindReplaceStateChange((e=>{let t=!1;e.isRegex&&(this.regex.checked=this._state.isRegex,t=!0),e.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,t=!0),e.matchCase&&(this.caseSensitive.checked=this._state.matchCase,t=!0),!this._state.isRevealed&&t&&this._revealTemporarily()}))),this._register(H.nm(this._domNode,H.tw.MOUSE_LEAVE,(e=>this._onMouseLeave()))),this._register(H.nm(this._domNode,"mouseover",(e=>this._onMouseOver())))}_keybindingLabelFor(e){const t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return G.ID}getDomNode(){return this._domNode}getPosition(){return{preference:0}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseLeave(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display="block")}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display="none")}}G.ID="editor.contrib.findOptionsWidget";var $=i(11271);function K(e,t){return 1===e||2!==e&&t}class Z extends s.JT{get searchString(){return this._searchString}get replaceString(){return this._replaceString}get isRevealed(){return this._isRevealed}get isReplaceRevealed(){return this._isReplaceRevealed}get isRegex(){return K(this._isRegexOverride,this._isRegex)}get wholeWord(){return K(this._wholeWordOverride,this._wholeWord)}get matchCase(){return K(this._matchCaseOverride,this._matchCase)}get preserveCase(){return K(this._preserveCaseOverride,this._preserveCase)}get actualIsRegex(){return this._isRegex}get actualWholeWord(){return this._wholeWord}get actualMatchCase(){return this._matchCase}get actualPreserveCase(){return this._preserveCase}get searchScope(){return this._searchScope}get matchesPosition(){return this._matchesPosition}get matchesCount(){return this._matchesCount}get currentMatch(){return this._currentMatch}constructor(){super(),this._onFindReplaceStateChange=this._register(new $.Q5),this.onFindReplaceStateChange=this._onFindReplaceStateChange.event,this._searchString="",this._replaceString="",this._isRevealed=!1,this._isReplaceRevealed=!1,this._isRegex=!1,this._isRegexOverride=0,this._wholeWord=!1,this._wholeWordOverride=0,this._matchCase=!1,this._matchCaseOverride=0,this._preserveCase=!1,this._preserveCaseOverride=0,this._searchScope=null,this._matchesPosition=0,this._matchesCount=0,this._currentMatch=null,this._loop=!0,this._isSearching=!1,this._filters=null}changeMatchInfo(e,t,i){const n={moveCursor:!1,updateHistory:!1,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let s=!1;0===t&&(e=0),e>t&&(e=t),this._matchesPosition!==e&&(this._matchesPosition=e,n.matchesPosition=!0,s=!0),this._matchesCount!==t&&(this._matchesCount=t,n.matchesCount=!0,s=!0),"undefined"!==typeof i&&(g.e.equalsRange(this._currentMatch,i)||(this._currentMatch=i,n.currentMatch=!0,s=!0)),s&&this._onFindReplaceStateChange.fire(n)}change(e,t,i=!0){var n;const s={moveCursor:t,updateHistory:i,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let o=!1;const r=this.isRegex,a=this.wholeWord,d=this.matchCase,l=this.preserveCase;"undefined"!==typeof e.searchString&&this._searchString!==e.searchString&&(this._searchString=e.searchString,s.searchString=!0,o=!0),"undefined"!==typeof e.replaceString&&this._replaceString!==e.replaceString&&(this._replaceString=e.replaceString,s.replaceString=!0,o=!0),"undefined"!==typeof e.isRevealed&&this._isRevealed!==e.isRevealed&&(this._isRevealed=e.isRevealed,s.isRevealed=!0,o=!0),"undefined"!==typeof e.isReplaceRevealed&&this._isReplaceRevealed!==e.isReplaceRevealed&&(this._isReplaceRevealed=e.isReplaceRevealed,s.isReplaceRevealed=!0,o=!0),"undefined"!==typeof e.isRegex&&(this._isRegex=e.isRegex),"undefined"!==typeof e.wholeWord&&(this._wholeWord=e.wholeWord),"undefined"!==typeof e.matchCase&&(this._matchCase=e.matchCase),"undefined"!==typeof e.preserveCase&&(this._preserveCase=e.preserveCase),"undefined"!==typeof e.searchScope&&((null===(n=e.searchScope)||void 0===n?void 0:n.every((e=>{var t;return null===(t=this._searchScope)||void 0===t?void 0:t.some((t=>!g.e.equalsRange(t,e)))})))||(this._searchScope=e.searchScope,s.searchScope=!0,o=!0)),"undefined"!==typeof e.loop&&this._loop!==e.loop&&(this._loop=e.loop,s.loop=!0,o=!0),"undefined"!==typeof e.isSearching&&this._isSearching!==e.isSearching&&(this._isSearching=e.isSearching,s.isSearching=!0,o=!0),"undefined"!==typeof e.filters&&(this._filters?this._filters.update(e.filters):this._filters=e.filters,s.filters=!0,o=!0),this._isRegexOverride="undefined"!==typeof e.isRegexOverride?e.isRegexOverride:0,this._wholeWordOverride="undefined"!==typeof e.wholeWordOverride?e.wholeWordOverride:0,this._matchCaseOverride="undefined"!==typeof e.matchCaseOverride?e.matchCaseOverride:0,this._preserveCaseOverride="undefined"!==typeof e.preserveCaseOverride?e.preserveCaseOverride:0,r!==this.isRegex&&(o=!0,s.isRegex=!0),a!==this.wholeWord&&(o=!0,s.wholeWord=!0),d!==this.matchCase&&(o=!0,s.matchCase=!0),l!==this.preserveCase&&(o=!0,s.preserveCase=!0),o&&this._onFindReplaceStateChange.fire(s)}canNavigateBack(){return this.canNavigateInLoop()||1!==this.matchesPosition}canNavigateForward(){return this.canNavigateInLoop()||this.matchesPosition<this.matchesCount}canNavigateInLoop(){return this._loop||this.matchesCount>=W}}var j=i(69332),X=i(5506),z=i(18612),Q=i(8419),Y=i(98642),J=i(47606),ee=i(25206),te=i(97795),ie=i(20760),ne=i(98158),se=i(99588),oe=i(71976),re=i(55455),ae=i(22454),de=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function r(e){try{d(n.next(e))}catch(t){o(t)}}function a(e){try{d(n["throw"](e))}catch(t){o(t)}}function d(e){e.done?i(e.value):s(e.value).then(r,a)}d((n=n.apply(e,t||[])).next())}))};const le=(0,ne.q5)("find-selection",Q.l.selection,ee.NC("findSelectionIcon","Icon for 'Find in Selection' in the editor find widget.")),he=(0,ne.q5)("find-collapsed",Q.l.chevronRight,ee.NC("findCollapsedIcon","Icon to indicate that the editor find widget is collapsed.")),ce=(0,ne.q5)("find-expanded",Q.l.chevronDown,ee.NC("findExpandedIcon","Icon to indicate that the editor find widget is expanded.")),ue=(0,ne.q5)("find-replace",Q.l.replace,ee.NC("findReplaceIcon","Icon for 'Replace' in the editor find widget.")),ge=(0,ne.q5)("find-replace-all",Q.l.replaceAll,ee.NC("findReplaceAllIcon","Icon for 'Replace All' in the editor find widget.")),pe=(0,ne.q5)("find-previous-match",Q.l.arrowUp,ee.NC("findPreviousMatchIcon","Icon for 'Find Previous' in the editor find widget.")),_e=(0,ne.q5)("find-next-match",Q.l.arrowDown,ee.NC("findNextMatchIcon","Icon for 'Find Next' in the editor find widget.")),me=ee.NC("label.findDialog","Find / Replace"),fe=ee.NC("label.find","Find"),ve=ee.NC("placeholder.find","Find"),Ce=ee.NC("label.previousMatchButton","Previous Match"),be=ee.NC("label.nextMatchButton","Next Match"),Se=ee.NC("label.toggleSelectionFind","Find in Selection"),Ne=ee.NC("label.closeButton","Close"),ye=ee.NC("label.replace","Replace"),xe=ee.NC("placeholder.replace","Replace"),Re=ee.NC("label.replaceButton","Replace"),we=ee.NC("label.replaceAllButton","Replace All"),Ie=ee.NC("label.toggleReplaceButton","Toggle Replace"),Le=ee.NC("title.matchesCountLimit","Only the first {0} results are highlighted, but all find operations work on the entire text.",W),De=ee.NC("label.matchesLocation","{0} of {1}"),Ee=ee.NC("label.noResults","No results"),Me=419,Pe=275,Ae=Pe-54;let Oe=69;const Fe=33,Te="ctrlEnterReplaceAll.windows.donotask",ke=J.dz?256:2048;class We{constructor(e){this.afterLineNumber=e,this.heightInPx=Fe,this.suppressMouseDown=!1,this.domNode=document.createElement("div"),this.domNode.className="dock-find-viewzone"}}function Ve(e,t,i){const n=!!t.match(/\n/);i&&n&&i.selectionStart>0&&e.stopPropagation()}function Be(e,t,i){const n=!!t.match(/\n/);i&&n&&i.selectionEnd<i.value.length&&e.stopPropagation()}class He extends q.${constructor(e,t,i,o,r,a,d,l,h){super(),this._cachedHeight=null,this._revealTimeouts=[],this._codeEditor=e,this._controller=t,this._state=i,this._contextViewProvider=o,this._keybindingService=r,this._contextKeyService=a,this._storageService=l,this._notificationService=h,this._ctrlEnterReplaceAllWarningPrompted=!!l.getBoolean(Te,0),this._isVisible=!1,this._isReplaceVisible=!1,this._ignoreChangeEvent=!1,this._updateHistoryDelayer=new n.vp(500),this._register((0,s.OF)((()=>this._updateHistoryDelayer.cancel()))),this._register(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this._buildDomNode(),this._updateButtons(),this._tryUpdateWidgetWidth(),this._findInput.inputBox.layout(),this._register(this._codeEditor.onDidChangeConfiguration((e=>{if(e.hasChanged(90)&&(this._codeEditor.getOption(90)&&this._state.change({isReplaceRevealed:!1},!1),this._updateButtons()),e.hasChanged(143)&&this._tryUpdateWidgetWidth(),e.hasChanged(2)&&this.updateAccessibilitySupport(),e.hasChanged(41)){const e=this._codeEditor.getOption(41).loop;this._state.change({loop:e},!1);const t=this._codeEditor.getOption(41).addExtraSpaceOnTop;t&&!this._viewZone&&(this._viewZone=new We(0),this._showViewZone()),!t&&this._viewZone&&this._removeViewZone()}}))),this.updateAccessibilitySupport(),this._register(this._codeEditor.onDidChangeCursorSelection((()=>{this._isVisible&&this._updateToggleSelectionFindButton()}))),this._register(this._codeEditor.onDidFocusEditorWidget((()=>de(this,void 0,void 0,(function*(){if(this._isVisible){const e=yield this._controller.getGlobalBufferTerm();e&&e!==this._state.searchString&&(this._state.change({searchString:e},!1),this._findInput.select())}}))))),this._findInputFocused=E.bindTo(a),this._findFocusTracker=this._register(H.go(this._findInput.inputBox.inputElement)),this._register(this._findFocusTracker.onDidFocus((()=>{this._findInputFocused.set(!0),this._updateSearchScope()}))),this._register(this._findFocusTracker.onDidBlur((()=>{this._findInputFocused.set(!1)}))),this._replaceInputFocused=M.bindTo(a),this._replaceFocusTracker=this._register(H.go(this._replaceInput.inputBox.inputElement)),this._register(this._replaceFocusTracker.onDidFocus((()=>{this._replaceInputFocused.set(!0),this._updateSearchScope()}))),this._register(this._replaceFocusTracker.onDidBlur((()=>{this._replaceInputFocused.set(!1)}))),this._codeEditor.addOverlayWidget(this),this._codeEditor.getOption(41).addExtraSpaceOnTop&&(this._viewZone=new We(0)),this._register(this._codeEditor.onDidChangeModel((()=>{this._isVisible&&(this._viewZoneId=void 0)}))),this._register(this._codeEditor.onDidScrollChange((e=>{e.scrollTopChanged?this._layoutViewZone():setTimeout((()=>{this._layoutViewZone()}),0)})))}getId(){return He.ID}getDomNode(){return this._domNode}getPosition(){return this._isVisible?{preference:0}:null}_onStateChanged(e){if(e.searchString){try{this._ignoreChangeEvent=!0,this._findInput.setValue(this._state.searchString)}finally{this._ignoreChangeEvent=!1}this._updateButtons()}if(e.replaceString&&(this._replaceInput.inputBox.value=this._state.replaceString),e.isRevealed&&(this._state.isRevealed?this._reveal():this._hide(!0)),e.isReplaceRevealed&&(this._state.isReplaceRevealed?this._codeEditor.getOption(90)||this._isReplaceVisible||(this._isReplaceVisible=!0,this._replaceInput.width=H.w(this._findInput.domNode),this._updateButtons(),this._replaceInput.inputBox.layout()):this._isReplaceVisible&&(this._isReplaceVisible=!1,this._updateButtons())),(e.isRevealed||e.isReplaceRevealed)&&(this._state.isRevealed||this._state.isReplaceRevealed)&&this._tryUpdateHeight()&&this._showViewZone(),e.isRegex&&this._findInput.setRegex(this._state.isRegex),e.wholeWord&&this._findInput.setWholeWords(this._state.wholeWord),e.matchCase&&this._findInput.setCaseSensitive(this._state.matchCase),e.preserveCase&&this._replaceInput.setPreserveCase(this._state.preserveCase),e.searchScope&&(this._state.searchScope?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateToggleSelectionFindButton()),e.searchString||e.matchesCount||e.matchesPosition){const e=this._state.searchString.length>0&&0===this._state.matchesCount;this._domNode.classList.toggle("no-results",e),this._updateMatchesCount(),this._updateButtons()}(e.searchString||e.currentMatch)&&this._layoutViewZone(),e.updateHistory&&this._delayedUpdateHistory(),e.loop&&this._updateButtons()}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(void 0,Y.dL)}_updateHistory(){this._state.searchString&&this._findInput.inputBox.addToHistory(),this._state.replaceString&&this._replaceInput.inputBox.addToHistory()}_updateMatchesCount(){let e;if(this._matchesCount.style.minWidth=Oe+"px",this._state.matchesCount>=W?this._matchesCount.title=Le:this._matchesCount.title="",this._matchesCount.firstChild&&this._matchesCount.removeChild(this._matchesCount.firstChild),this._state.matchesCount>0){let t=String(this._state.matchesCount);this._state.matchesCount>=W&&(t+="+");let i=String(this._state.matchesPosition);"0"===i&&(i="?"),e=o.WU(De,i,t)}else e=Ee;this._matchesCount.appendChild(document.createTextNode(e)),(0,j.Z9)(this._getAriaLabel(e,this._state.currentMatch,this._state.searchString)),Oe=Math.max(Oe,this._matchesCount.clientWidth)}_getAriaLabel(e,t,i){if(e===Ee)return""===i?ee.NC("ariaSearchNoResultEmpty","{0} found",e):ee.NC("ariaSearchNoResult","{0} found for '{1}'",e,i);if(t){const n=ee.NC("ariaSearchNoResultWithLineNum","{0} found for '{1}', at {2}",e,i,t.startLineNumber+":"+t.startColumn),s=this._codeEditor.getModel();if(s&&t.startLineNumber<=s.getLineCount()&&t.startLineNumber>=1){const e=s.getLineContent(t.startLineNumber);return`${e}, ${n}`}return n}return ee.NC("ariaSearchNoResultWithLineNumNoCurrentMatch","{0} found for '{1}'",e,i)}_updateToggleSelectionFindButton(){const e=this._codeEditor.getSelection(),t=!!e&&(e.startLineNumber!==e.endLineNumber||e.startColumn!==e.endColumn),i=this._toggleSelectionFind.checked;this._isVisible&&(i||t)?this._toggleSelectionFind.enable():this._toggleSelectionFind.disable()}_updateButtons(){this._findInput.setEnabled(this._isVisible),this._replaceInput.setEnabled(this._isVisible&&this._isReplaceVisible),this._updateToggleSelectionFindButton(),this._closeBtn.setEnabled(this._isVisible);const e=this._state.searchString.length>0,t=!!this._state.matchesCount;this._prevBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateBack()),this._nextBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateForward()),this._replaceBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._replaceAllBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._domNode.classList.toggle("replaceToggled",this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);const i=!this._codeEditor.getOption(90);this._toggleReplaceBtn.setEnabled(this._isVisible&&i)}_reveal(){if(this._revealTimeouts.forEach((e=>{clearTimeout(e)})),this._revealTimeouts=[],!this._isVisible){this._isVisible=!0;const e=this._codeEditor.getSelection();switch(this._codeEditor.getOption(41).autoFindInSelection){case"always":this._toggleSelectionFind.checked=!0;break;case"never":this._toggleSelectionFind.checked=!1;break;case"multiline":{const t=!!e&&e.startLineNumber!==e.endLineNumber;this._toggleSelectionFind.checked=t;break}default:break}this._tryUpdateWidgetWidth(),this._updateButtons(),this._revealTimeouts.push(setTimeout((()=>{this._domNode.classList.add("visible"),this._domNode.setAttribute("aria-hidden","false")}),0)),this._revealTimeouts.push(setTimeout((()=>{this._findInput.validate()}),200)),this._codeEditor.layoutOverlayWidget(this);let t=!0;if(this._codeEditor.getOption(41).seedSearchStringFromSelection&&e){const i=this._codeEditor.getDomNode();if(i){const n=H.i(i),s=this._codeEditor.getScrolledVisiblePosition(e.getStartPosition()),o=n.left+(s?s.left:0),r=s?s.top:0;if(this._viewZone&&r<this._viewZone.heightInPx){e.endLineNumber>e.startLineNumber&&(t=!1);const i=H.xQ(this._domNode).left;o>i&&(t=!1);const s=this._codeEditor.getScrolledVisiblePosition(e.getEndPosition()),r=n.left+(s?s.left:0);r>i&&(t=!1)}}}this._showViewZone(t)}}_hide(e){this._revealTimeouts.forEach((e=>{clearTimeout(e)})),this._revealTimeouts=[],this._isVisible&&(this._isVisible=!1,this._updateButtons(),this._domNode.classList.remove("visible"),this._domNode.setAttribute("aria-hidden","true"),this._findInput.clearMessage(),e&&this._codeEditor.focus(),this._codeEditor.layoutOverlayWidget(this),this._removeViewZone())}_layoutViewZone(e){const t=this._codeEditor.getOption(41).addExtraSpaceOnTop;if(!t)return void this._removeViewZone();if(!this._isVisible)return;const i=this._viewZone;void 0===this._viewZoneId&&i&&this._codeEditor.changeViewZones((t=>{i.heightInPx=this._getHeight(),this._viewZoneId=t.addZone(i),this._codeEditor.setScrollTop(e||this._codeEditor.getScrollTop()+i.heightInPx)}))}_showViewZone(e=!0){if(!this._isVisible)return;const t=this._codeEditor.getOption(41).addExtraSpaceOnTop;if(!t)return;void 0===this._viewZone&&(this._viewZone=new We(0));const i=this._viewZone;this._codeEditor.changeViewZones((t=>{if(void 0!==this._viewZoneId){const n=this._getHeight();if(n===i.heightInPx)return;const s=n-i.heightInPx;return i.heightInPx=n,t.layoutZone(this._viewZoneId),void(e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+s))}{let n=this._getHeight();if(n-=this._codeEditor.getOption(83).top,n<=0)return;i.heightInPx=n,this._viewZoneId=t.addZone(i),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+n)}}))}_removeViewZone(){this._codeEditor.changeViewZones((e=>{void 0!==this._viewZoneId&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0,this._viewZone&&(this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()-this._viewZone.heightInPx),this._viewZone=void 0))}))}_tryUpdateWidgetWidth(){if(!this._isVisible)return;if(!H.Uw(this._domNode))return;const e=this._codeEditor.getLayoutInfo(),t=e.contentWidth;if(t<=0)return void this._domNode.classList.add("hiddenEditor");this._domNode.classList.contains("hiddenEditor")&&this._domNode.classList.remove("hiddenEditor");const i=e.width,n=e.minimap.minimapWidth;let s=!1,o=!1,r=!1;if(this._resized){const e=H.w(this._domNode);if(e>Me)return this._domNode.style.maxWidth=i-28-n-15+"px",void(this._replaceInput.width=H.w(this._findInput.domNode))}if(Me+28+n>=i&&(o=!0),Me+28+n-Oe>=i&&(r=!0),Me+28+n-Oe>=i+50&&(s=!0),this._domNode.classList.toggle("collapsed-find-widget",s),this._domNode.classList.toggle("narrow-find-widget",r),this._domNode.classList.toggle("reduced-find-widget",o),r||s||(this._domNode.style.maxWidth=i-28-n-15+"px"),this._findInput.layout({collapsedFindWidget:s,narrowFindWidget:r,reducedFindWidget:o}),this._resized){const e=this._findInput.inputBox.element.clientWidth;e>0&&(this._replaceInput.width=e)}else this._isReplaceVisible&&(this._replaceInput.width=H.w(this._findInput.domNode))}_getHeight(){let e=0;return e+=4,e+=this._findInput.inputBox.height+2,this._isReplaceVisible&&(e+=4,e+=this._replaceInput.inputBox.height+2),e+=4,e}_tryUpdateHeight(){const e=this._getHeight();return(null===this._cachedHeight||this._cachedHeight!==e)&&(this._cachedHeight=e,this._domNode.style.height=`${e}px`,!0)}focusFindInput(){this._findInput.select(),this._findInput.focus()}focusReplaceInput(){this._replaceInput.select(),this._replaceInput.focus()}highlightFindOptions(){this._findInput.highlightFindOptions()}_updateSearchScope(){if(this._codeEditor.hasModel()&&this._toggleSelectionFind.checked){const e=this._codeEditor.getSelections();e.map((e=>{1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(e.endLineNumber-1)));const t=this._state.currentMatch;return e.startLineNumber===e.endLineNumber||g.e.equalsRange(e,t)?null:e})).filter((e=>!!e)),e.length&&this._state.change({searchScope:e},!0)}}_onFindInputMouseDown(e){e.middleButton&&e.stopPropagation()}_onFindInputKeyDown(e){return e.equals(3|ke)?(this._keybindingService.dispatchEvent(e,e.target)||this._findInput.inputBox.insertAtCursor("\n"),void e.preventDefault()):e.equals(2)?(this._isReplaceVisible?this._replaceInput.focus():this._findInput.focusOnCaseSensitive(),void e.preventDefault()):e.equals(2066)?(this._codeEditor.focus(),void e.preventDefault()):e.equals(16)?Ve(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea")):e.equals(18)?Be(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea")):void 0}_onReplaceInputKeyDown(e){return e.equals(3|ke)?(this._keybindingService.dispatchEvent(e,e.target)||(J.ED&&J.tY&&!this._ctrlEnterReplaceAllWarningPrompted&&(this._notificationService.info(ee.NC("ctrlEnter.keybindingChanged","Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.")),this._ctrlEnterReplaceAllWarningPrompted=!0,this._storageService.store(Te,!0,0,0)),this._replaceInput.inputBox.insertAtCursor("\n")),void e.preventDefault()):e.equals(2)?(this._findInput.focusOnCaseSensitive(),void e.preventDefault()):e.equals(1026)?(this._findInput.focus(),void e.preventDefault()):e.equals(2066)?(this._codeEditor.focus(),void e.preventDefault()):e.equals(16)?Ve(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea")):e.equals(18)?Be(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea")):void 0}getVerticalSashLeft(e){return 0}_keybindingLabelFor(e){const t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}_buildDomNode(){const e=!0,t=!0;this._findInput=this._register(new te.Yb(null,this._contextViewProvider,{width:Ae,label:fe,placeholder:ve,appendCaseSensitiveLabel:this._keybindingLabelFor(k.ToggleCaseSensitiveCommand),appendWholeWordsLabel:this._keybindingLabelFor(k.ToggleWholeWordCommand),appendRegexLabel:this._keybindingLabelFor(k.ToggleRegexCommand),validation:e=>{if(0===e.length||!this._findInput.getRegex())return null;try{return new RegExp(e,"gu"),null}catch(t){return{content:t.message}}},flexibleHeight:e,flexibleWidth:t,flexibleMaxHeight:118,showCommonFindToggles:!0,showHistoryHint:()=>(0,ie.u)(this._keybindingService),inputBoxStyles:ae.Hc,toggleStyles:ae.pl},this._contextKeyService)),this._findInput.setRegex(!!this._state.isRegex),this._findInput.setCaseSensitive(!!this._state.matchCase),this._findInput.setWholeWords(!!this._state.wholeWord),this._register(this._findInput.onKeyDown((e=>this._onFindInputKeyDown(e)))),this._register(this._findInput.inputBox.onDidChange((()=>{this._ignoreChangeEvent||this._state.change({searchString:this._findInput.getValue()},!0)}))),this._register(this._findInput.onDidOptionChange((()=>{this._state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)}))),this._register(this._findInput.onCaseSensitiveKeyDown((e=>{e.equals(1026)&&this._isReplaceVisible&&(this._replaceInput.focus(),e.preventDefault())}))),this._register(this._findInput.onRegexKeyDown((e=>{e.equals(2)&&this._isReplaceVisible&&(this._replaceInput.focusOnPreserve(),e.preventDefault())}))),this._register(this._findInput.inputBox.onDidHeightChange((e=>{this._tryUpdateHeight()&&this._showViewZone()}))),J.IJ&&this._register(this._findInput.onMouseDown((e=>this._onFindInputMouseDown(e)))),this._matchesCount=document.createElement("div"),this._matchesCount.className="matchesCount",this._updateMatchesCount(),this._prevBtn=this._register(new Ue({label:Ce+this._keybindingLabelFor(k.PreviousMatchFindAction),icon:pe,onTrigger:()=>{(0,re.cW)(this._codeEditor.getAction(k.PreviousMatchFindAction)).run().then(void 0,Y.dL)}})),this._nextBtn=this._register(new Ue({label:be+this._keybindingLabelFor(k.NextMatchFindAction),icon:_e,onTrigger:()=>{(0,re.cW)(this._codeEditor.getAction(k.NextMatchFindAction)).run().then(void 0,Y.dL)}}));const i=document.createElement("div");i.className="find-part",i.appendChild(this._findInput.domNode);const n=document.createElement("div");n.className="find-actions",i.appendChild(n),n.appendChild(this._matchesCount),n.appendChild(this._prevBtn.domNode),n.appendChild(this._nextBtn.domNode),this._toggleSelectionFind=this._register(new X.Z({icon:le,title:Se+this._keybindingLabelFor(k.ToggleSearchScopeCommand),isChecked:!1,inputActiveOptionBackground:(0,f.n_1)(f.XEs),inputActiveOptionBorder:(0,f.n_1)(f.PRb),inputActiveOptionForeground:(0,f.n_1)(f.Pvw)})),this._register(this._toggleSelectionFind.onChange((()=>{if(this._toggleSelectionFind.checked){if(this._codeEditor.hasModel()){const e=this._codeEditor.getSelections();e.map((e=>(1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(e.endLineNumber-1))),e.isEmpty()?null:e))).filter((e=>!!e)),e.length&&this._state.change({searchScope:e},!0)}}else this._state.change({searchScope:null},!0)}))),n.appendChild(this._toggleSelectionFind.domNode),this._closeBtn=this._register(new Ue({label:Ne+this._keybindingLabelFor(k.CloseFindWidgetCommand),icon:ne.s_,onTrigger:()=>{this._state.change({isRevealed:!1,searchScope:null},!1)},onKeyDown:e=>{e.equals(2)&&this._isReplaceVisible&&(this._replaceBtn.isEnabled()?this._replaceBtn.focus():this._codeEditor.focus(),e.preventDefault())}})),this._replaceInput=this._register(new te.Nq(null,void 0,{label:ye,placeholder:xe,appendPreserveCaseLabel:this._keybindingLabelFor(k.TogglePreserveCaseCommand),history:[],flexibleHeight:e,flexibleWidth:t,flexibleMaxHeight:118,showHistoryHint:()=>(0,ie.u)(this._keybindingService),inputBoxStyles:ae.Hc,toggleStyles:ae.pl},this._contextKeyService,!0)),this._replaceInput.setPreserveCase(!!this._state.preserveCase),this._register(this._replaceInput.onKeyDown((e=>this._onReplaceInputKeyDown(e)))),this._register(this._replaceInput.inputBox.onDidChange((()=>{this._state.change({replaceString:this._replaceInput.inputBox.value},!1)}))),this._register(this._replaceInput.inputBox.onDidHeightChange((e=>{this._isReplaceVisible&&this._tryUpdateHeight()&&this._showViewZone()}))),this._register(this._replaceInput.onDidOptionChange((()=>{this._state.change({preserveCase:this._replaceInput.getPreserveCase()},!0)}))),this._register(this._replaceInput.onPreserveCaseKeyDown((e=>{e.equals(2)&&(this._prevBtn.isEnabled()?this._prevBtn.focus():this._nextBtn.isEnabled()?this._nextBtn.focus():this._toggleSelectionFind.enabled?this._toggleSelectionFind.focus():this._closeBtn.isEnabled()&&this._closeBtn.focus(),e.preventDefault())}))),this._replaceBtn=this._register(new Ue({label:Re+this._keybindingLabelFor(k.ReplaceOneAction),icon:ue,onTrigger:()=>{this._controller.replace()},onKeyDown:e=>{e.equals(1026)&&(this._closeBtn.focus(),e.preventDefault())}})),this._replaceAllBtn=this._register(new Ue({label:we+this._keybindingLabelFor(k.ReplaceAllAction),icon:ge,onTrigger:()=>{this._controller.replaceAll()}}));const s=document.createElement("div");s.className="replace-part",s.appendChild(this._replaceInput.domNode);const o=document.createElement("div");o.className="replace-actions",s.appendChild(o),o.appendChild(this._replaceBtn.domNode),o.appendChild(this._replaceAllBtn.domNode),this._toggleReplaceBtn=this._register(new Ue({label:Ie,className:"codicon toggle left",onTrigger:()=>{this._state.change({isReplaceRevealed:!this._isReplaceVisible},!1),this._isReplaceVisible&&(this._replaceInput.width=H.w(this._findInput.domNode),this._replaceInput.inputBox.layout()),this._showViewZone()}})),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible),this._domNode=document.createElement("div"),this._domNode.className="editor-widget find-widget",this._domNode.setAttribute("aria-hidden","true"),this._domNode.ariaLabel=me,this._domNode.role="dialog",this._domNode.style.width=`${Me}px`,this._domNode.appendChild(this._toggleReplaceBtn.domNode),this._domNode.appendChild(i),this._domNode.appendChild(this._closeBtn.domNode),this._domNode.appendChild(s),this._resizeSash=new z.g(this._domNode,this,{orientation:0,size:2}),this._resized=!1;let r=Me;this._register(this._resizeSash.onDidStart((()=>{r=H.w(this._domNode)}))),this._register(this._resizeSash.onDidChange((e=>{this._resized=!0;const t=r+e.startX-e.currentX;if(t<Me)return;const i=parseFloat(H.Dx(this._domNode).maxWidth)||0;t>i||(this._domNode.style.width=`${t}px`,this._isReplaceVisible&&(this._replaceInput.width=H.w(this._findInput.domNode)),this._findInput.inputBox.layout(),this._tryUpdateHeight())}))),this._register(this._resizeSash.onDidReset((()=>{const e=H.w(this._domNode);if(e<Me)return;let t=Me;if(!this._resized||e===Me){const e=this._codeEditor.getLayoutInfo();t=e.width-28-e.minimap.minimapWidth-15,this._resized=!0}this._domNode.style.width=`${t}px`,this._isReplaceVisible&&(this._replaceInput.width=H.w(this._findInput.domNode)),this._findInput.inputBox.layout()})))}updateAccessibilitySupport(){const e=this._codeEditor.getOption(2);this._findInput.setFocusInputOnOptionClick(2!==e)}}He.ID="editor.contrib.findWidget";class Ue extends q.${constructor(e){super(),this._opts=e;let t="button";this._opts.className&&(t=t+" "+this._opts.className),this._opts.icon&&(t=t+" "+se.k.asClassName(this._opts.icon)),this._domNode=document.createElement("div"),this._domNode.title=this._opts.label,this._domNode.tabIndex=0,this._domNode.className=t,this._domNode.setAttribute("role","button"),this._domNode.setAttribute("aria-label",this._opts.label),this.onclick(this._domNode,(e=>{this._opts.onTrigger(),e.preventDefault()})),this.onkeydown(this._domNode,(e=>{var t,i;if(e.equals(10)||e.equals(3))return this._opts.onTrigger(),void e.preventDefault();null===(i=(t=this._opts).onKeyDown)||void 0===i||i.call(t,e)}))}get domNode(){return this._domNode}isEnabled(){return this._domNode.tabIndex>=0}focus(){this._domNode.focus()}setEnabled(e){this._domNode.classList.toggle("disabled",!e),this._domNode.setAttribute("aria-disabled",String(!e)),this._domNode.tabIndex=e?0:-1}setExpanded(e){this._domNode.setAttribute("aria-expanded",String(!!e)),e?(this._domNode.classList.remove(...se.k.asClassNameArray(he)),this._domNode.classList.add(...se.k.asClassNameArray(ce))):(this._domNode.classList.remove(...se.k.asClassNameArray(ce)),this._domNode.classList.add(...se.k.asClassNameArray(he)))}}(0,v.Ic)(((e,t)=>{const i=(e,i)=>{i&&t.addRule(`.monaco-editor ${e} { background-color: ${i}; }`)};i(".findMatch",e.getColor(f.MUv)),i(".currentFindMatch",e.getColor(f.nyM)),i(".findScope",e.getColor(f.jUe));const n=e.getColor(f.D0T);i(".find-widget",n);const s=e.getColor(f.rh);s&&t.addRule(`.monaco-editor .find-widget { box-shadow: 0 0 8px 2px ${s}; }`);const o=e.getColor(f.A42);o&&t.addRule(`.monaco-editor .find-widget { border-left: 1px solid ${o}; border-right: 1px solid ${o}; border-bottom: 1px solid ${o}; }`);const r=e.getColor(f.EiJ);r&&t.addRule(`.monaco-editor .findMatch { border: 1px ${(0,oe.c3)(e.type)?"dotted":"solid"} ${r}; box-sizing: border-box; }`);const a=e.getColor(f.pnM);a&&t.addRule(`.monaco-editor .currentFindMatch { border: 2px solid ${a}; padding: 1px; box-sizing: border-box; }`);const d=e.getColor(f.gkn);d&&t.addRule(`.monaco-editor .findScope { border: 1px ${(0,oe.c3)(e.type)?"dashed":"solid"} ${d}; }`);const l=e.getColor(f.lRK);l&&t.addRule(`.monaco-editor .find-widget { border: 1px solid ${l}; }`);const h=e.getColor(f.Hfx);h&&t.addRule(`.monaco-editor .find-widget { color: ${h}; }`);const c=e.getColor(f.Ido);c&&t.addRule(`.monaco-editor .find-widget.no-results .matchesCount { color: ${c}; }`);const u=e.getColor(f.Ng6);if(u)t.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${u}; }`);else{const i=e.getColor(f.D1_);i&&t.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${i}; }`)}const g=e.getColor(f.lUq);g&&t.addRule(`\n\t\t.monaco-editor .find-widget .button:not(.disabled):hover,\n\t\t.monaco-editor .find-widget .codicon-find-selection:hover {\n\t\t\tbackground-color: ${g} !important;\n\t\t}\n\t`);const p=e.getColor(f.R80);p&&t.addRule(`.monaco-editor .find-widget .monaco-inputbox.synthetic-focus { outline-color: ${p}; }`)}));var qe,Ge=i(82693),$e=i(2827),Ke=i(93753),Ze=i(15285),je=i(18736),Xe=i(45726),ze=i(51906),Qe=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},Ye=function(e,t){return function(i,n){t(i,n,e)}},Je=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function r(e){try{d(n.next(e))}catch(t){o(t)}}function a(e){try{d(n["throw"](e))}catch(t){o(t)}}function d(e){e.done?i(e.value):s(e.value).then(r,a)}d((n=n.apply(e,t||[])).next())}))};const et=524288;function tt(e,t="single",i=!1){if(!e.hasModel())return null;const n=e.getSelection();if("single"===t&&n.startLineNumber===n.endLineNumber||"multiple"===t)if(n.isEmpty()){const t=e.getConfiguredWordAtPosition(n.getStartPosition());if(t&&!1===i)return t.word}else if(e.getModel().getValueLengthInRange(n)<et)return e.getModel().getValueInRange(n);return null}let it=qe=class extends s.JT{get editor(){return this._editor}static get(e){return e.getContribution(qe.ID)}constructor(e,t,i,s,o){super(),this._editor=e,this._findWidgetVisible=D.bindTo(t),this._contextKeyService=t,this._storageService=i,this._clipboardService=s,this._notificationService=o,this._updateHistoryDelayer=new n.vp(500),this._state=this._register(new Z),this.loadQueryState(),this._register(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this._model=null,this._register(this._editor.onDidChangeModel((()=>{const e=this._editor.getModel()&&this._state.isRevealed;this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean("editor.matchCase",1,!1),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,!1),isRegex:this._storageService.getBoolean("editor.isRegex",1,!1),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,!1)},!1),e&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!1,updateSearchScope:!1,loop:this._editor.getOption(41).loop})})))}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&(this._model.dispose(),this._model=null)}_onStateChanged(e){this.saveQueryState(e),e.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel())),e.searchString&&this.setGlobalBufferTerm(this._state.searchString)}saveQueryState(e){e.isRegex&&this._storageService.store("editor.isRegex",this._state.actualIsRegex,1,1),e.wholeWord&&this._storageService.store("editor.wholeWord",this._state.actualWholeWord,1,1),e.matchCase&&this._storageService.store("editor.matchCase",this._state.actualMatchCase,1,1),e.preserveCase&&this._storageService.store("editor.preserveCase",this._state.actualPreserveCase,1,1)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean("editor.matchCase",1,this._state.matchCase),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,this._state.wholeWord),isRegex:this._storageService.getBoolean("editor.isRegex",1,this._state.isRegex),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,this._state.preserveCase)},!1)}isFindInputFocused(){return!!E.getValue(this._contextKeyService)}getState(){return this._state}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1),this._state.isRevealed||this.highlightFindOptions()}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1),this._state.isRevealed||this.highlightFindOptions()}togglePreserveCase(){this._state.change({preserveCase:!this._state.preserveCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0);else if(this._editor.hasModel()){const e=this._editor.getSelections();e.map((e=>(1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._editor.getModel().getLineMaxColumn(e.endLineNumber-1))),e.isEmpty()?null:e))).filter((e=>!!e)),e.length&&this._state.change({searchScope:e},!0)}}setSearchString(e){this._state.isRegex&&(e=o.ec(e)),this._state.change({searchString:e},!1)}highlightFindOptions(e=!1){}_start(e,t){return Je(this,void 0,void 0,(function*(){if(this.disposeModel(),!this._editor.hasModel())return;const i=Object.assign(Object.assign({},t),{isRevealed:!0});if("single"===e.seedSearchStringFromSelection){const t=tt(this._editor,e.seedSearchStringFromSelection,e.seedSearchStringFromNonEmptySelection);t&&(this._state.isRegex?i.searchString=o.ec(t):i.searchString=t)}else if("multiple"===e.seedSearchStringFromSelection&&!e.updateSearchScope){const t=tt(this._editor,e.seedSearchStringFromSelection);t&&(i.searchString=t)}if(!i.searchString&&e.seedSearchStringFromGlobalClipboard){const e=yield this.getGlobalBufferTerm();if(!this._editor.hasModel())return;e&&(i.searchString=e)}if(e.forceRevealReplace||i.isReplaceRevealed?i.isReplaceRevealed=!0:this._findWidgetVisible.get()||(i.isReplaceRevealed=!1),e.updateSearchScope){const e=this._editor.getSelections();e.some((e=>!e.isEmpty()))&&(i.searchScope=e)}i.loop=e.loop,this._state.change(i,!1),this._model||(this._model=new B(this._editor,this._state))}))}start(e,t){return this._start(e,t)}moveToNextMatch(){return!!this._model&&(this._model.moveToNextMatch(),!0)}moveToPrevMatch(){return!!this._model&&(this._model.moveToPrevMatch(),!0)}goToMatch(e){return!!this._model&&(this._model.moveToMatch(e),!0)}replace(){return!!this._model&&(this._model.replace(),!0)}replaceAll(){var e;return!!this._model&&((null===(e=this._editor.getModel())||void 0===e?void 0:e.isTooLargeForHeapOperation())?(this._notificationService.warn(ee.NC("too.large.for.replaceall","The file is too large to perform a replace all operation.")),!1):(this._model.replaceAll(),!0))}selectAllMatches(){return!!this._model&&(this._model.selectAllMatches(),this._editor.focus(),!0)}getGlobalBufferTerm(){return Je(this,void 0,void 0,(function*(){return this._editor.getOption(41).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()?this._clipboardService.readFindText():""}))}setGlobalBufferTerm(e){this._editor.getOption(41).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()&&this._clipboardService.writeFindText(e)}};it.ID="editor.contrib.findController",it=qe=Qe([Ye(1,L.i6),Ye(2,ze.Uy),Ye(3,$e.p),Ye(4,je.lT)],it);let nt=class extends it{constructor(e,t,i,n,s,o,r,a){super(e,i,r,a,o),this._contextViewService=t,this._keybindingService=n,this._themeService=s,this._widget=null,this._findOptionsWidget=null}_start(e,t){const i=Object.create(null,{_start:{get:()=>super._start}});return Je(this,void 0,void 0,(function*(){this._widget||this._createFindWidget();const n=this._editor.getSelection();let s=!1;switch(this._editor.getOption(41).autoFindInSelection){case"always":s=!0;break;case"never":s=!1;break;case"multiline":{const e=!!n&&n.startLineNumber!==n.endLineNumber;s=e;break}default:break}e.updateSearchScope=e.updateSearchScope||s,yield i._start.call(this,e,t),this._widget&&(2===e.shouldFocus?this._widget.focusReplaceInput():1===e.shouldFocus&&this._widget.focusFindInput())}))}highlightFindOptions(e=!1){this._widget||this._createFindWidget(),this._state.isRevealed&&!e?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}_createFindWidget(){this._widget=this._register(new He(this._editor,this,this._state,this._contextViewService,this._keybindingService,this._contextKeyService,this._themeService,this._storageService,this._notificationService)),this._findOptionsWidget=this._register(new G(this._editor,this._state,this._keybindingService))}};nt=Qe([Ye(1,Ke.u),Ye(2,L.i6),Ye(3,Ze.d),Ye(4,v.XE),Ye(5,je.lT),Ye(6,ze.Uy),Ye(7,$e.p)],nt);const st=(0,r.rn)(new r.jY({id:k.StartFindAction,label:ee.NC("startFindAction","Find"),alias:"Find",precondition:L.Ao.or(d.u.focus,L.Ao.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2084,weight:100},menuOpts:{menuId:Ge.eH.MenubarEditMenu,group:"3_find",title:ee.NC({key:"miFind",comment:["&& denotes a mnemonic"]},"&&Find"),order:1}}));st.addImplementation(0,((e,t,i)=>{const n=it.get(t);return!!n&&n.start({forceRevealReplace:!1,seedSearchStringFromSelection:"never"!==t.getOption(41).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(41).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:t.getOption(41).globalFindClipboard,shouldFocus:1,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop})}));const ot={description:"Open a new In-Editor Find Widget.",args:[{name:"Open a new In-Editor Find Widget args",schema:{properties:{searchString:{type:"string"},replaceString:{type:"string"},regex:{type:"boolean"},regexOverride:{type:"number",description:ee.NC("actions.find.isRegexOverride",'Overrides "Use Regular Expression" flag.\nThe flag will not be saved for the future.\n0: Do Nothing\n1: True\n2: False')},wholeWord:{type:"boolean"},wholeWordOverride:{type:"number",description:ee.NC("actions.find.wholeWordOverride",'Overrides "Match Whole Word" flag.\nThe flag will not be saved for the future.\n0: Do Nothing\n1: True\n2: False')},matchCase:{type:"boolean"},matchCaseOverride:{type:"number",description:ee.NC("actions.find.matchCaseOverride",'Overrides "Math Case" flag.\nThe flag will not be saved for the future.\n0: Do Nothing\n1: True\n2: False')},preserveCase:{type:"boolean"},preserveCaseOverride:{type:"number",description:ee.NC("actions.find.preserveCaseOverride",'Overrides "Preserve Case" flag.\nThe flag will not be saved for the future.\n0: Do Nothing\n1: True\n2: False')},findInSelection:{type:"boolean"}}}}]};class rt extends r.R6{constructor(){super({id:k.StartFindWithArgs,label:ee.NC("startFindWithArgsAction","Find With Arguments"),alias:"Find With Arguments",precondition:void 0,kbOpts:{kbExpr:null,primary:0,weight:100},description:ot})}run(e,t,i){return Je(this,void 0,void 0,(function*(){const e=it.get(t);if(e){const n=i?{searchString:i.searchString,replaceString:i.replaceString,isReplaceRevealed:void 0!==i.replaceString,isRegex:i.isRegex,wholeWord:i.matchWholeWord,matchCase:i.isCaseSensitive,preserveCase:i.preserveCase}:{};yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:0===e.getState().searchString.length&&"never"!==t.getOption(41).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(41).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:!0,shouldFocus:1,shouldAnimate:!0,updateSearchScope:(null===i||void 0===i?void 0:i.findInSelection)||!1,loop:t.getOption(41).loop},n),e.setGlobalBufferTerm(e.getState().searchString)}}))}}class at extends r.R6{constructor(){super({id:k.StartFindWithSelection,label:ee.NC("startFindWithSelectionAction","Find With Selection"),alias:"Find With Selection",precondition:void 0,kbOpts:{kbExpr:null,primary:0,mac:{primary:2083},weight:100}})}run(e,t){return Je(this,void 0,void 0,(function*(){const e=it.get(t);e&&(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:"multiple",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),e.setGlobalBufferTerm(e.getState().searchString))}))}}class dt extends r.R6{run(e,t){return Je(this,void 0,void 0,(function*(){const e=it.get(t);e&&!this._run(e)&&(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:0===e.getState().searchString.length&&"never"!==t.getOption(41).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(41).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:!0,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),this._run(e))}))}}class lt extends dt{constructor(){super({id:k.NextMatchFindAction,label:ee.NC("findNextMatchAction","Find Next"),alias:"Find Next",precondition:void 0,kbOpts:[{kbExpr:d.u.focus,primary:61,mac:{primary:2085,secondary:[61]},weight:100},{kbExpr:L.Ao.and(d.u.focus,E),primary:3,weight:100}]})}_run(e){const t=e.moveToNextMatch();return!!t&&(e.editor.pushUndoStop(),!0)}}class ht extends dt{constructor(){super({id:k.PreviousMatchFindAction,label:ee.NC("findPreviousMatchAction","Find Previous"),alias:"Find Previous",precondition:void 0,kbOpts:[{kbExpr:d.u.focus,primary:1085,mac:{primary:3109,secondary:[1085]},weight:100},{kbExpr:L.Ao.and(d.u.focus,E),primary:1027,weight:100}]})}_run(e){return e.moveToPrevMatch()}}class ct extends r.R6{constructor(){super({id:k.GoToMatchFindAction,label:ee.NC("findMatchAction.goToMatch","Go to Match..."),alias:"Go to Match...",precondition:D}),this._highlightDecorations=[]}run(e,t,i){const n=it.get(t);if(!n)return;const s=n.getState().matchesCount;if(s<1){const t=e.get(je.lT);return void t.notify({severity:je.zb.Warning,message:ee.NC("findMatchAction.noResults","No matches. Try searching for something else.")})}const o=e.get(Xe.eJ),r=o.createInputBox();r.placeholder=ee.NC("findMatchAction.inputPlaceHolder","Type a number to go to a specific match (between 1 and {0})",s);const a=e=>{const t=parseInt(e);if(isNaN(t))return;const i=n.getState().matchesCount;return t>0&&t<=i?t-1:t<0&&t>=-i?i+t:void 0},d=e=>{const i=a(e);if("number"===typeof i){r.validationMessage=void 0,n.goToMatch(i);const e=n.getState().currentMatch;e&&this.addDecorations(t,e)}else r.validationMessage=ee.NC("findMatchAction.inputValidationMessage","Please type a number between 1 and {0}",n.getState().matchesCount),this.clearDecorations(t)};r.onDidChangeValue((e=>{d(e)})),r.onDidAccept((()=>{const e=a(r.value);"number"===typeof e?(n.goToMatch(e),r.hide()):r.validationMessage=ee.NC("findMatchAction.inputValidationMessage","Please type a number between 1 and {0}",n.getState().matchesCount)})),r.onDidHide((()=>{this.clearDecorations(t),r.dispose()})),r.show()}clearDecorations(e){e.changeDecorations((e=>{this._highlightDecorations=e.deltaDecorations(this._highlightDecorations,[])}))}addDecorations(e,t){e.changeDecorations((e=>{this._highlightDecorations=e.deltaDecorations(this._highlightDecorations,[{range:t,options:{description:"find-match-quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range:t,options:{description:"find-match-quick-access-range-highlight-overview",overviewRuler:{color:(0,v.EN)(a.m9),position:l.sh.Full}}}])}))}}class ut extends r.R6{run(e,t){return Je(this,void 0,void 0,(function*(){const e=it.get(t);if(!e)return;const i=tt(t,"single",!1);i&&e.setSearchString(i),this._run(e)||(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),this._run(e))}))}}class gt extends ut{constructor(){super({id:k.NextSelectionMatchFindAction,label:ee.NC("nextSelectionMatchFindAction","Find Next Selection"),alias:"Find Next Selection",precondition:void 0,kbOpts:{kbExpr:d.u.focus,primary:2109,weight:100}})}_run(e){return e.moveToNextMatch()}}class pt extends ut{constructor(){super({id:k.PreviousSelectionMatchFindAction,label:ee.NC("previousSelectionMatchFindAction","Find Previous Selection"),alias:"Find Previous Selection",precondition:void 0,kbOpts:{kbExpr:d.u.focus,primary:3133,weight:100}})}_run(e){return e.moveToPrevMatch()}}const _t=(0,r.rn)(new r.jY({id:k.StartFindReplaceAction,label:ee.NC("startReplace","Replace"),alias:"Replace",precondition:L.Ao.or(d.u.focus,L.Ao.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596},weight:100},menuOpts:{menuId:Ge.eH.MenubarEditMenu,group:"3_find",title:ee.NC({key:"miReplace",comment:["&& denotes a mnemonic"]},"&&Replace"),order:2}}));_t.addImplementation(0,((e,t,i)=>{if(!t.hasModel()||t.getOption(90))return!1;const n=it.get(t);if(!n)return!1;const s=t.getSelection(),o=n.isFindInputFocused(),r=!s.isEmpty()&&s.startLineNumber===s.endLineNumber&&"never"!==t.getOption(41).seedSearchStringFromSelection&&!o,a=o||r?2:1;return n.start({forceRevealReplace:!0,seedSearchStringFromSelection:r?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(41).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:"never"!==t.getOption(41).seedSearchStringFromSelection,shouldFocus:a,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop})})),(0,r._K)(it.ID,nt,0),(0,r.Qr)(rt),(0,r.Qr)(at),(0,r.Qr)(lt),(0,r.Qr)(ht),(0,r.Qr)(ct),(0,r.Qr)(gt),(0,r.Qr)(pt);const mt=r._l.bindToContribution(it.get);(0,r.fK)(new mt({id:k.CloseFindWidgetCommand,precondition:D,handler:e=>e.closeFindWidget(),kbOpts:{weight:105,kbExpr:L.Ao.and(d.u.focus,L.Ao.not("isComposing")),primary:9,secondary:[1033]}})),(0,r.fK)(new mt({id:k.ToggleCaseSensitiveCommand,precondition:void 0,handler:e=>e.toggleCaseSensitive(),kbOpts:{weight:105,kbExpr:d.u.focus,primary:P.primary,mac:P.mac,win:P.win,linux:P.linux}})),(0,r.fK)(new mt({id:k.ToggleWholeWordCommand,precondition:void 0,handler:e=>e.toggleWholeWords(),kbOpts:{weight:105,kbExpr:d.u.focus,primary:A.primary,mac:A.mac,win:A.win,linux:A.linux}})),(0,r.fK)(new mt({id:k.ToggleRegexCommand,precondition:void 0,handler:e=>e.toggleRegex(),kbOpts:{weight:105,kbExpr:d.u.focus,primary:O.primary,mac:O.mac,win:O.win,linux:O.linux}})),(0,r.fK)(new mt({id:k.ToggleSearchScopeCommand,precondition:void 0,handler:e=>e.toggleSearchScope(),kbOpts:{weight:105,kbExpr:d.u.focus,primary:F.primary,mac:F.mac,win:F.win,linux:F.linux}})),(0,r.fK)(new mt({id:k.TogglePreserveCaseCommand,precondition:void 0,handler:e=>e.togglePreserveCase(),kbOpts:{weight:105,kbExpr:d.u.focus,primary:T.primary,mac:T.mac,win:T.win,linux:T.linux}})),(0,r.fK)(new mt({id:k.ReplaceOneAction,precondition:D,handler:e=>e.replace(),kbOpts:{weight:105,kbExpr:d.u.focus,primary:3094}})),(0,r.fK)(new mt({id:k.ReplaceOneAction,precondition:D,handler:e=>e.replace(),kbOpts:{weight:105,kbExpr:L.Ao.and(d.u.focus,M),primary:3}})),(0,r.fK)(new mt({id:k.ReplaceAllAction,precondition:D,handler:e=>e.replaceAll(),kbOpts:{weight:105,kbExpr:d.u.focus,primary:2563}})),(0,r.fK)(new mt({id:k.ReplaceAllAction,precondition:D,handler:e=>e.replaceAll(),kbOpts:{weight:105,kbExpr:L.Ao.and(d.u.focus,M),primary:void 0,mac:{primary:2051}}})),(0,r.fK)(new mt({id:k.SelectAllMatchesAction,precondition:D,handler:e=>e.selectAllMatches(),kbOpts:{weight:105,kbExpr:d.u.focus,primary:515}}))},88969:(e,t,i)=>{i.d(t,{f:()=>U,n:()=>q});var n=i(85398),s=i(55191),o=i(98642),r=i(56082),a=i(70959),d=i(61720),l=i(55455),h=i(95402),c=i(48077),u=i(44950),g=i(67026),p=i(97297),_=i(92490),m=i(75912),f=i(11271),v=i(33162),C=i(20416);class b{get onDidChange(){return this._updateEventEmitter.event}get hiddenRanges(){return this._hiddenRanges}constructor(e){this._updateEventEmitter=new f.Q5,this._hasLineChanges=!1,this._foldingModel=e,this._foldingModelListener=e.onDidChange((e=>this.updateHiddenRanges())),this._hiddenRanges=[],e.regions.length&&this.updateHiddenRanges()}notifyChangeModelContent(e){this._hiddenRanges.length&&!this._hasLineChanges&&(this._hasLineChanges=e.changes.some((e=>e.range.endLineNumber!==e.range.startLineNumber||0!==(0,C.Q)(e.text)[0])))}updateHiddenRanges(){let e=!1;const t=[];let i=0,n=0,s=Number.MAX_VALUE,o=-1;const r=this._foldingModel.regions;for(;i<r.length;i++){if(!r.isCollapsed(i))continue;const a=r.getStartLineNumber(i)+1,d=r.getEndLineNumber(i);s<=a&&d<=o||(!e&&n<this._hiddenRanges.length&&this._hiddenRanges[n].startLineNumber===a&&this._hiddenRanges[n].endLineNumber===d?(t.push(this._hiddenRanges[n]),n++):(e=!0,t.push(new v.e(a,1,d,1))),s=a,o=d)}(this._hasLineChanges||e||n<this._hiddenRanges.length)&&this.applyHiddenRanges(t)}applyHiddenRanges(e){this._hiddenRanges=e,this._hasLineChanges=!1,this._updateEventEmitter.fire(e)}hasRanges(){return this._hiddenRanges.length>0}isHidden(e){return null!==N(this._hiddenRanges,e)}adjustSelections(e){let t=!1;const i=this._foldingModel.textModel;let n=null;const s=e=>(n&&S(e,n)||(n=N(this._hiddenRanges,e)),n?n.startLineNumber-1:null);for(let o=0,r=e.length;o<r;o++){let n=e[o];const r=s(n.startLineNumber);r&&(n=n.setStartPosition(r,i.getLineMaxColumn(r)),t=!0);const a=s(n.endLineNumber);a&&(n=n.setEndPosition(a,i.getLineMaxColumn(a)),t=!0),e[o]=n}return t}dispose(){this.hiddenRanges.length>0&&(this._hiddenRanges=[],this._updateEventEmitter.fire(this._hiddenRanges)),this._foldingModelListener&&(this._foldingModelListener.dispose(),this._foldingModelListener=null)}}function S(e,t){return e>=t.startLineNumber&&e<=t.endLineNumber}function N(e,t){const i=(0,m.J_)(e,(e=>t<e.startLineNumber))-1;return i>=0&&e[i].endLineNumber>=t?e[i]:null}var y,x=i(63947),R=i(25206),w=i(37174),I=i(30931),L=i(18915),D=i(59203),E=i(18736),M=i(54732),P=i(96729),A=i(16458),O=i(46871),F=i(95896),T=i(74016),k=i(47596),W=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},V=function(e,t){return function(i,n){t(i,n,e)}},B=function(e,t,i,n){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,o){function r(e){try{d(n.next(e))}catch(t){o(t)}}function a(e){try{d(n["throw"](e))}catch(t){o(t)}}function d(e){e.done?i(e.value):s(e.value).then(r,a)}d((n=n.apply(e,t||[])).next())}))};const H=new w.uy("foldingEnabled",!1);let U=y=class extends a.JT{static get(e){return e.getContribution(y.ID)}static getFoldingRangeProviders(e,t){var i,n;const s=e.foldingRangeProvider.ordered(t);return null!==(n=null===(i=y._foldingRangeSelector)||void 0===i?void 0:i.call(y,s,t))&&void 0!==n?n:s}constructor(e,t,i,n,s,o){super(),this.contextKeyService=t,this.languageConfigurationService=i,this.languageFeaturesService=o,this.localToDispose=this._register(new a.SL),this.editor=e,this._foldingLimitReporter=new q(e);const r=this.editor.getOptions();this._isEnabled=r.get(43),this._useFoldingProviders="indentation"!==r.get(44),this._unfoldOnClickAfterEndOfLine=r.get(48),this._restoringViewState=!1,this._currentModelHasFoldedImports=!1,this._foldingImportsByDefault=r.get(46),this.updateDebounceInfo=s.for(o.foldingRangeProvider,"Folding",{min:200}),this.foldingModel=null,this.hiddenRangeModel=null,this.rangeProvider=null,this.foldingRegionPromise=null,this.foldingModelPromise=null,this.updateScheduler=null,this.cursorChangedScheduler=null,this.mouseDownInfo=null,this.foldingDecorationProvider=new I.fF(e),this.foldingDecorationProvider.showFoldingControls=r.get(109),this.foldingDecorationProvider.showFoldingHighlights=r.get(45),this.foldingEnabled=H.bindTo(this.contextKeyService),this.foldingEnabled.set(this._isEnabled),this._register(this.editor.onDidChangeModel((()=>this.onModelChanged()))),this._register(this.editor.onDidChangeConfiguration((e=>{if(e.hasChanged(43)&&(this._isEnabled=this.editor.getOptions().get(43),this.foldingEnabled.set(this._isEnabled),this.onModelChanged()),e.hasChanged(47)&&this.onModelChanged(),e.hasChanged(109)||e.hasChanged(45)){const e=this.editor.getOptions();this.foldingDecorationProvider.showFoldingControls=e.get(109),this.foldingDecorationProvider.showFoldingHighlights=e.get(45),this.triggerFoldingModelChanged()}e.hasChanged(44)&&(this._useFoldingProviders="indentation"!==this.editor.getOptions().get(44),this.onFoldingStrategyChanged()),e.hasChanged(48)&&(this._unfoldOnClickAfterEndOfLine=this.editor.getOptions().get(48)),e.hasChanged(46)&&(this._foldingImportsByDefault=this.editor.getOptions().get(46))}))),this.onModelChanged()}saveViewState(){const e=this.editor.getModel();if(!e||!this._isEnabled||e.isTooLargeForTokenization())return{};if(this.foldingModel){const t=this.foldingModel.getMemento(),i=this.rangeProvider?this.rangeProvider.id:void 0;return{collapsedRegions:t,lineCount:e.getLineCount(),provider:i,foldedImports:this._currentModelHasFoldedImports}}}restoreViewState(e){const t=this.editor.getModel();if(t&&this._isEnabled&&!t.isTooLargeForTokenization()&&this.hiddenRangeModel&&e&&(this._currentModelHasFoldedImports=!!e.foldedImports,e.collapsedRegions&&e.collapsedRegions.length>0&&this.foldingModel)){this._restoringViewState=!0;try{this.foldingModel.applyMemento(e.collapsedRegions)}finally{this._restoringViewState=!1}}}onModelChanged(){this.localToDispose.clear();const e=this.editor.getModel();this._isEnabled&&e&&!e.isTooLargeForTokenization()&&(this._currentModelHasFoldedImports=!1,this.foldingModel=new _.av(e,this.foldingDecorationProvider),this.localToDispose.add(this.foldingModel),this.hiddenRangeModel=new b(this.foldingModel),this.localToDispose.add(this.hiddenRangeModel),this.localToDispose.add(this.hiddenRangeModel.onDidChange((e=>this.onHiddenRangesChanges(e)))),this.updateScheduler=new n.vp(this.updateDebounceInfo.get(e)),this.cursorChangedScheduler=new n.pY((()=>this.revealCursor()),200),this.localToDispose.add(this.cursorChangedScheduler),this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange((()=>this.onFoldingStrategyChanged()))),this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration((()=>this.onFoldingStrategyChanged()))),this.localToDispose.add(this.editor.onDidChangeModelContent((e=>this.onDidChangeModelContent(e)))),this.localToDispose.add(this.editor.onDidChangeCursorPosition((()=>this.onCursorPositionChanged()))),this.localToDispose.add(this.editor.onMouseDown((e=>this.onEditorMouseDown(e)))),this.localToDispose.add(this.editor.onMouseUp((e=>this.onEditorMouseUp(e)))),this.localToDispose.add({dispose:()=>{var e,t;this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),null===(e=this.updateScheduler)||void 0===e||e.cancel(),this.updateScheduler=null,this.foldingModel=null,this.foldingModelPromise=null,this.hiddenRangeModel=null,this.cursorChangedScheduler=null,null===(t=this.rangeProvider)||void 0===t||t.dispose(),this.rangeProvider=null}}),this.triggerFoldingModelChanged())}onFoldingStrategyChanged(){var e;null===(e=this.rangeProvider)||void 0===e||e.dispose(),this.rangeProvider=null,this.triggerFoldingModelChanged()}getRangeProvider(e){if(this.rangeProvider)return this.rangeProvider;const t=new x.aI(e,this.languageConfigurationService,this._foldingLimitReporter);if(this.rangeProvider=t,this._useFoldingProviders&&this.foldingModel){const i=y.getFoldingRangeProviders(this.languageFeaturesService,e);i.length>0&&(this.rangeProvider=new D.e(e,i,(()=>this.triggerFoldingModelChanged()),this._foldingLimitReporter,t))}return this.rangeProvider}getFoldingModel(){return this.foldingModelPromise}onDidChangeModelContent(e){var t;null===(t=this.hiddenRangeModel)||void 0===t||t.notifyChangeModelContent(e),this.triggerFoldingModelChanged()}triggerFoldingModelChanged(){this.updateScheduler&&(this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.foldingModelPromise=this.updateScheduler.trigger((()=>{const e=this.foldingModel;if(!e)return null;const t=new P.G,i=this.getRangeProvider(e.textModel),s=this.foldingRegionPromise=(0,n.PG)((e=>i.compute(e)));return s.then((i=>{if(i&&s===this.foldingRegionPromise){let n;if(this._foldingImportsByDefault&&!this._currentModelHasFoldedImports){const e=i.setCollapsedAllOfType(g.AD.Imports.value,!0);e&&(n=h.Z.capture(this.editor),this._currentModelHasFoldedImports=e)}const s=this.editor.getSelections(),o=s?s.map((e=>e.startLineNumber)):[];e.update(i,o),null===n||void 0===n||n.restore(this.editor);const r=this.updateDebounceInfo.update(e.textModel,t.elapsed());this.updateScheduler&&(this.updateScheduler.defaultDelay=r)}return e}))})).then(void 0,(e=>((0,o.dL)(e),null))))}onHiddenRangesChanges(e){if(this.hiddenRangeModel&&e.length&&!this._restoringViewState){const e=this.editor.getSelections();e&&this.hiddenRangeModel.adjustSelections(e)&&this.editor.setSelections(e)}this.editor.setHiddenAreas(e,this)}onCursorPositionChanged(){this.hiddenRangeModel&&this.hiddenRangeModel.hasRanges()&&this.cursorChangedScheduler.schedule()}revealCursor(){const e=this.getFoldingModel();e&&e.then((e=>{if(e){const t=this.editor.getSelections();if(t&&t.length>0){const i=[];for(const n of t){const t=n.selectionStartLineNumber;this.hiddenRangeModel&&this.hiddenRangeModel.isHidden(t)&&i.push(...e.getAllRegionsAtLine(t,(e=>e.isCollapsed&&t>e.startLineNumber)))}i.length&&(e.toggleCollapseState(i),this.reveal(t[0].getPosition()))}}})).then(void 0,o.dL)}onEditorMouseDown(e){if(this.mouseDownInfo=null,!this.hiddenRangeModel||!e.target||!e.target.range)return;if(!e.event.leftButton&&!e.event.middleButton)return;const t=e.target.range;let i=!1;switch(e.target.type){case 4:{const t=e.target.detail,n=e.target.element.offsetLeft,s=t.offsetX-n;if(s<4)return;i=!0;break}case 7:if(this._unfoldOnClickAfterEndOfLine&&this.hiddenRangeModel.hasRanges()){const t=e.target.detail;if(!t.isAfterLines)break}return;case 6:if(this.hiddenRangeModel.hasRanges()){const e=this.editor.getModel();if(e&&t.startColumn===e.getLineMaxColumn(t.startLineNumber))break}return;default:return}this.mouseDownInfo={lineNumber:t.startLineNumber,iconClicked:i}}onEditorMouseUp(e){const t=this.foldingModel;if(!t||!this.mouseDownInfo||!e.target)return;const i=this.mouseDownInfo.lineNumber,n=this.mouseDownInfo.iconClicked,s=e.target.range;if(!s||s.startLineNumber!==i)return;if(n){if(4!==e.target.type)return}else{const e=this.editor.getModel();if(!e||s.startColumn!==e.getLineMaxColumn(i))return}const o=t.getRegionAtLine(i);if(o&&o.startLineNumber===i){const s=o.isCollapsed;if(n||s){const n=e.event.altKey;let r=[];if(n){const e=e=>!e.containedBy(o)&&!o.containedBy(e),i=t.getRegionsInside(null,e);for(const t of i)t.isCollapsed&&r.push(t);0===r.length&&(r=i)}else{const i=e.event.middleButton||e.event.shiftKey;if(i)for(const e of t.getRegionsInside(o))e.isCollapsed===s&&r.push(e);!s&&i&&0!==r.length||r.push(o)}t.toggleCollapseState(r),this.reveal({lineNumber:i,column:1})}}}reveal(e){this.editor.revealPositionInCenterIfOutsideViewport(e,0)}};U.ID="editor.contrib.folding",U=y=W([V(1,w.i6),V(2,p.c_),V(3,E.lT),V(4,M.A),V(5,A.p)],U);class q{constructor(e){this.editor=e,this._onDidChange=new f.Q5,this._computed=0,this._limited=!1}get limit(){return this.editor.getOptions().get(47)}update(e,t){e===this._computed&&t===this._limited||(this._computed=e,this._limited=t,this._onDidChange.fire())}}class G extends c.R6{runEditorCommand(e,t,i){const n=e.get(p.c_),s=U.get(t);if(!s)return;const o=s.getFoldingModel();return o?(this.reportTelemetry(e,t),o.then((e=>{if(e){this.invoke(s,e,t,i,n);const o=t.getSelection();o&&s.reveal(o.getStartPosition())}}))):void 0}getSelectedLines(e){const t=e.getSelections();return t?t.map((e=>e.startLineNumber)):[]}getLineNumbers(e,t){return e&&e.selectionLines?e.selectionLines.map((e=>e+1)):this.getSelectedLines(t)}run(e,t){}}function $(e){if(!l.o8(e)){if(!l.Kn(e))return!1;const t=e;if(!l.o8(t.levels)&&!l.hj(t.levels))return!1;if(!l.o8(t.direction)&&!l.HD(t.direction))return!1;if(!l.o8(t.selectionLines)&&(!Array.isArray(t.selectionLines)||!t.selectionLines.every(l.hj)))return!1}return!0}class K extends G{constructor(){super({id:"editor.unfold",label:R.NC("unfoldAction.label","Unfold"),alias:"Unfold",precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,primary:3166,mac:{primary:2654},weight:100},description:{description:"Unfold the content in the editor",args:[{name:"Unfold editor argument",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t* 'levels': Number of levels to unfold. If not set, defaults to 1.\n\t\t\t\t\t\t* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.\n\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t",constraint:$,schema:{type:"object",properties:{levels:{type:"number",default:1},direction:{type:"string",enum:["up","down"],default:"down"},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,n){const s=n&&n.levels||1,o=this.getLineNumbers(n,i);n&&"up"===n.direction?(0,_.gU)(t,!1,s,o):(0,_.R$)(t,!1,s,o)}}class Z extends G{constructor(){super({id:"editor.unfoldRecursively",label:R.NC("unFoldRecursivelyAction.label","Unfold Recursively"),alias:"Unfold Recursively",precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,primary:(0,r.gx)(2089,2142),weight:100}})}invoke(e,t,i,n){(0,_.R$)(t,!1,Number.MAX_VALUE,this.getSelectedLines(i))}}class j extends G{constructor(){super({id:"editor.fold",label:R.NC("foldAction.label","Fold"),alias:"Fold",precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,primary:3164,mac:{primary:2652},weight:100},description:{description:"Fold the content in the editor",args:[{name:"Fold editor argument",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t\t* 'levels': Number of levels to fold.\n\t\t\t\t\t\t\t* 'direction': If 'up', folds given number of levels up otherwise folds down.\n\t\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t\tIf no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.\n\t\t\t\t\t\t",constraint:$,schema:{type:"object",properties:{levels:{type:"number"},direction:{type:"string",enum:["up","down"]},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,n){const s=this.getLineNumbers(n,i),o=n&&n.levels,r=n&&n.direction;"number"!==typeof o&&"string"!==typeof r?(0,_.HX)(t,!0,s):"up"===r?(0,_.gU)(t,!0,o||1,s):(0,_.R$)(t,!0,o||1,s)}}class X extends G{constructor(){super({id:"editor.toggleFold",label:R.NC("toggleFoldAction.label","Toggle Fold"),alias:"Toggle Fold",precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,primary:(0,r.gx)(2089,2090),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);(0,_.d8)(t,1,n)}}class z extends G{constructor(){super({id:"editor.foldRecursively",label:R.NC("foldRecursivelyAction.label","Fold Recursively"),alias:"Fold Recursively",precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,primary:(0,r.gx)(2089,2140),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);(0,_.R$)(t,!0,Number.MAX_VALUE,n)}}class Q extends G{constructor(){super({id:"editor.foldAllBlockComments",label:R.NC("foldAllBlockComments.label","Fold All Block Comments"),alias:"Fold All Block Comments",precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,primary:(0,r.gx)(2089,2138),weight:100}})}invoke(e,t,i,n,s){if(t.regions.hasTypes())(0,_.MW)(t,g.AD.Comment.value,!0);else{const e=i.getModel();if(!e)return;const n=s.getLanguageConfiguration(e.getLanguageId()).comments;if(n&&n.blockCommentStartToken){const e=new RegExp("^\\s*"+(0,d.ec)(n.blockCommentStartToken));(0,_.DW)(t,e,!0)}}}}class Y extends G{constructor(){super({id:"editor.foldAllMarkerRegions",label:R.NC("foldAllMarkerRegions.label","Fold All Regions"),alias:"Fold All Regions",precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,primary:(0,r.gx)(2089,2077),weight:100}})}invoke(e,t,i,n,s){if(t.regions.hasTypes())(0,_.MW)(t,g.AD.Region.value,!0);else{const e=i.getModel();if(!e)return;const n=s.getLanguageConfiguration(e.getLanguageId()).foldingRules;if(n&&n.markers&&n.markers.start){const e=new RegExp(n.markers.start);(0,_.DW)(t,e,!0)}}}}class J extends G{constructor(){super({id:"editor.unfoldAllMarkerRegions",label:R.NC("unfoldAllMarkerRegions.label","Unfold All Regions"),alias:"Unfold All Regions",precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,primary:(0,r.gx)(2089,2078),weight:100}})}invoke(e,t,i,n,s){if(t.regions.hasTypes())(0,_.MW)(t,g.AD.Region.value,!1);else{const e=i.getModel();if(!e)return;const n=s.getLanguageConfiguration(e.getLanguageId()).foldingRules;if(n&&n.markers&&n.markers.start){const e=new RegExp(n.markers.start);(0,_.DW)(t,e,!1)}}}}class ee extends G{constructor(){super({id:"editor.foldAllExcept",label:R.NC("foldAllExcept.label","Fold All Except Selected"),alias:"Fold All Except Selected",precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,primary:(0,r.gx)(2089,2136),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);(0,_.YT)(t,!0,n)}}class te extends G{constructor(){super({id:"editor.unfoldAllExcept",label:R.NC("unfoldAllExcept.label","Unfold All Except Selected"),alias:"Unfold All Except Selected",precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,primary:(0,r.gx)(2089,2134),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);(0,_.YT)(t,!1,n)}}class ie extends G{constructor(){super({id:"editor.foldAll",label:R.NC("foldAllAction.label","Fold All"),alias:"Fold All",precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,primary:(0,r.gx)(2089,2069),weight:100}})}invoke(e,t,i){(0,_.R$)(t,!0)}}class ne extends G{constructor(){super({id:"editor.unfoldAll",label:R.NC("unfoldAllAction.label","Unfold All"),alias:"Unfold All",precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,primary:(0,r.gx)(2089,2088),weight:100}})}invoke(e,t,i){(0,_.R$)(t,!1)}}class se extends G{getFoldingLevel(){return parseInt(this.id.substr(se.ID_PREFIX.length))}invoke(e,t,i){(0,_.Ln)(t,this.getFoldingLevel(),!0,this.getSelectedLines(i))}}se.ID_PREFIX="editor.foldLevel",se.ID=e=>se.ID_PREFIX+e;class oe extends G{constructor(){super({id:"editor.gotoParentFold",label:R.NC("gotoParentFold.label","Go to Parent Fold"),alias:"Go to Parent Fold",precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);if(n.length>0){const e=(0,_.PV)(n[0],t);null!==e&&i.setSelection({startLineNumber:e,startColumn:1,endLineNumber:e,endColumn:1})}}}class re extends G{constructor(){super({id:"editor.gotoPreviousFold",label:R.NC("gotoPreviousFold.label","Go to Previous Folding Range"),alias:"Go to Previous Folding Range",precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);if(n.length>0){const e=(0,_.sK)(n[0],t);null!==e&&i.setSelection({startLineNumber:e,startColumn:1,endLineNumber:e,endColumn:1})}}}class ae extends G{constructor(){super({id:"editor.gotoNextFold",label:R.NC("gotoNextFold.label","Go to Next Folding Range"),alias:"Go to Next Folding Range",precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);if(n.length>0){const e=(0,_.hE)(n[0],t);null!==e&&i.setSelection({startLineNumber:e,startColumn:1,endLineNumber:e,endColumn:1})}}}class de extends G{constructor(){super({id:"editor.createFoldingRangeFromSelection",label:R.NC("createManualFoldRange.label","Create Folding Range from Selection"),alias:"Create Folding Range from Selection",precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,primary:(0,r.gx)(2089,2135),weight:100}})}invoke(e,t,i){var n;const s=[],o=i.getSelections();if(o){for(const e of o){let t=e.endLineNumber;1===e.endColumn&&--t,t>e.startLineNumber&&(s.push({startLineNumber:e.startLineNumber,endLineNumber:t,type:void 0,isCollapsed:!0,source:1}),i.setSelection({startLineNumber:e.startLineNumber,startColumn:1,endLineNumber:e.startLineNumber,endColumn:1}))}if(s.length>0){s.sort(((e,t)=>e.startLineNumber-t.startLineNumber));const e=L.MN.sanitizeAndMerge(t.regions,s,null===(n=i.getModel())||void 0===n?void 0:n.getLineCount());t.updatePost(L.MN.fromFoldRanges(e))}}}}class le extends G{constructor(){super({id:"editor.removeManualFoldingRanges",label:R.NC("removeManualFoldingRanges.label","Remove Manual Folding Ranges"),alias:"Remove Manual Folding Ranges",precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,primary:(0,r.gx)(2089,2137),weight:100}})}invoke(e,t,i){const n=i.getSelections();if(n){const i=[];for(const e of n){const{startLineNumber:t,endLineNumber:n}=e;i.push(n>=t?{startLineNumber:t,endLineNumber:n}:{endLineNumber:n,startLineNumber:t})}t.removeManualRanges(i),e.triggerFoldingModelChanged()}}}(0,c._K)(U.ID,U,0),(0,c.Qr)(K),(0,c.Qr)(Z),(0,c.Qr)(j),(0,c.Qr)(z),(0,c.Qr)(ie),(0,c.Qr)(ne),(0,c.Qr)(Q),(0,c.Qr)(Y),(0,c.Qr)(J),(0,c.Qr)(ee),(0,c.Qr)(te),(0,c.Qr)(X),(0,c.Qr)(oe),(0,c.Qr)(re),(0,c.Qr)(ae),(0,c.Qr)(de),(0,c.Qr)(le);for(let he=1;he<=7;he++)(0,c.QG)(new se({id:se.ID(he),label:R.NC("foldLevelAction.label","Fold Level {0}",he),alias:`Fold Level ${he}`,precondition:H,kbOpts:{kbExpr:u.u.editorTextFocus,primary:(0,r.gx)(2089,2048|21+he),weight:100}}));O.P.registerCommand("_executeFoldingRangeProvider",(function(e,...t){return B(this,void 0,void 0,(function*(){const[i]=t;if(!(i instanceof F.o))throw(0,o.b1)();const n=e.get(A.p),r=e.get(T.q).getModel(i);if(!r)throw(0,o.b1)();const a=e.get(k.Ui);if(!a.getValue("editor.folding",{resource:i}))return[];const d=e.get(p.c_),l=a.getValue("editor.foldingStrategy",{resource:i}),h={get limit(){return a.getValue("editor.foldingMaximumRegions",{resource:i})},update:(e,t)=>{}},c=new x.aI(r,d,h);let u=c;if("indentation"!==l){const e=U.getFoldingRangeProviders(n,r);e.length&&(u=new D.e(r,e,(()=>{}),h,c))}const _=yield u.compute(s.T.None),m=[];try{if(_)for(let e=0;e<_.length;e++){const t=_.getType(e);m.push({start:_.getStartLineNumber(e),end:_.getEndLineNumber(e),kind:t?g.AD.fromValue(t):void 0})}return m}finally{u.dispose()}}))}))},30931:(e,t,i)=>{i.d(t,{Iy:()=>u,f5:()=>g,fF:()=>f});var n=i(8419),s=i(79857),o=i(16375),r=i(25206),a=i(47277),d=i(98158),l=i(32656),h=i(99588);const c=(0,a.P6G)("editor.foldBackground",{light:(0,a.ZnX)(a.hEj,.3),dark:(0,a.ZnX)(a.hEj,.3),hcDark:null,hcLight:null},(0,r.NC)("foldBackgroundBackground","Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations."),!0);(0,a.P6G)("editorGutter.foldingControlForeground",{dark:a.XZx,light:a.XZx,hcDark:a.XZx,hcLight:a.XZx},(0,r.NC)("editorGutter.foldingControlForeground","Color of the folding control in the editor gutter."));const u=(0,d.q5)("folding-expanded",n.l.chevronDown,(0,r.NC)("foldingExpandedIcon","Icon for expanded ranges in the editor glyph margin.")),g=(0,d.q5)("folding-collapsed",n.l.chevronRight,(0,r.NC)("foldingCollapsedIcon","Icon for collapsed ranges in the editor glyph margin.")),p=(0,d.q5)("folding-manual-collapsed",g,(0,r.NC)("foldingManualCollapedIcon","Icon for manually collapsed ranges in the editor glyph margin.")),_=(0,d.q5)("folding-manual-expanded",u,(0,r.NC)("foldingManualExpandedIcon","Icon for manually expanded ranges in the editor glyph margin.")),m={color:(0,l.EN)(c),position:s.F5.Inline};class f{constructor(e){this.editor=e,this.showFoldingControls="mouseover",this.showFoldingHighlights=!0}getDecorationOption(e,t,i){return t?f.HIDDEN_RANGE_DECORATION:"never"===this.showFoldingControls?e?this.showFoldingHighlights?f.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION:f.NO_CONTROLS_COLLAPSED_RANGE_DECORATION:f.NO_CONTROLS_EXPANDED_RANGE_DECORATION:e?i?this.showFoldingHighlights?f.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:f.MANUALLY_COLLAPSED_VISUAL_DECORATION:this.showFoldingHighlights?f.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:f.COLLAPSED_VISUAL_DECORATION:"mouseover"===this.showFoldingControls?i?f.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION:f.EXPANDED_AUTO_HIDE_VISUAL_DECORATION:i?f.MANUALLY_EXPANDED_VISUAL_DECORATION:f.EXPANDED_VISUAL_DECORATION}changeDecorations(e){return this.editor.changeDecorations(e)}removeDecorations(e){this.editor.removeDecorations(e)}}f.COLLAPSED_VISUAL_DECORATION=o.qx.register({description:"folding-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,firstLineDecorationClassName:h.k.asClassName(g)}),f.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=o.qx.register({description:"folding-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:m,isWholeLine:!0,firstLineDecorationClassName:h.k.asClassName(g)}),f.MANUALLY_COLLAPSED_VISUAL_DECORATION=o.qx.register({description:"folding-manually-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,firstLineDecorationClassName:h.k.asClassName(p)}),f.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=o.qx.register({description:"folding-manually-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:m,isWholeLine:!0,firstLineDecorationClassName:h.k.asClassName(p)}),f.NO_CONTROLS_COLLAPSED_RANGE_DECORATION=o.qx.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0}),f.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION=o.qx.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:m,isWholeLine:!0}),f.EXPANDED_VISUAL_DECORATION=o.qx.register({description:"folding-expanded-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+h.k.asClassName(u)}),f.EXPANDED_AUTO_HIDE_VISUAL_DECORATION=o.qx.register({description:"folding-expanded-auto-hide-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:h.k.asClassName(u)}),f.MANUALLY_EXPANDED_VISUAL_DECORATION=o.qx.register({description:"folding-manually-expanded-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+h.k.asClassName(_)}),f.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION=o.qx.register({description:"folding-manually-expanded-auto-hide-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:h.k.asClassName(_)}),f.NO_CONTROLS_EXPANDED_RANGE_DECORATION=o.qx.register({description:"folding-no-controls-range-decoration",stickiness:0,isWholeLine:!0}),f.HIDDEN_RANGE_DECORATION=o.qx.register({description:"folding-hidden-range-decoration",stickiness:1})},92490:(e,t,i)=>{i.d(t,{DW:()=>g,HX:()=>h,Ln:()=>c,MW:()=>p,PV:()=>_,R$:()=>d,YT:()=>u,av:()=>r,d8:()=>a,gU:()=>l,hE:()=>f,sK:()=>m});var n=i(11271),s=i(18915),o=i(63381);class r{get regions(){return this._regions}get textModel(){return this._textModel}constructor(e,t){this._updateEventEmitter=new n.Q5,this.onDidChange=this._updateEventEmitter.event,this._textModel=e,this._decorationProvider=t,this._regions=new s.MN(new Uint32Array(0),new Uint32Array(0)),this._editorDecorationIds=[]}toggleCollapseState(e){if(!e.length)return;e=e.sort(((e,t)=>e.regionIndex-t.regionIndex));const t={};this._decorationProvider.changeDecorations((i=>{let n=0,s=-1,o=-1;const r=e=>{while(n<e){const e=this._regions.getEndLineNumber(n),t=this._regions.isCollapsed(n);if(e<=s){const s=0!==this.regions.getSource(n);i.changeDecorationOptions(this._editorDecorationIds[n],this._decorationProvider.getDecorationOption(t,e<=o,s))}t&&e>o&&(o=e),n++}};for(const a of e){const e=a.regionIndex,i=this._editorDecorationIds[e];if(i&&!t[i]){t[i]=!0,r(e);const n=!this._regions.isCollapsed(e);this._regions.setCollapsed(e,n),s=Math.max(s,this._regions.getEndLineNumber(e))}}r(this._regions.length)})),this._updateEventEmitter.fire({model:this,collapseStateChanged:e})}removeManualRanges(e){const t=new Array,i=t=>{for(const i of e)if(!(i.startLineNumber>t.endLineNumber||t.startLineNumber>i.endLineNumber))return!0;return!1};for(let n=0;n<this._regions.length;n++){const e=this._regions.toFoldRange(n);0!==e.source&&i(e)||t.push(e)}this.updatePost(s.MN.fromFoldRanges(t))}update(e,t=[]){const i=this._currentFoldedOrManualRanges(t),n=s.MN.sanitizeAndMerge(e,i,this._textModel.getLineCount());this.updatePost(s.MN.fromFoldRanges(n))}updatePost(e){const t=[];let i=-1;for(let n=0,s=e.length;n<s;n++){const s=e.getStartLineNumber(n),o=e.getEndLineNumber(n),r=e.isCollapsed(n),a=0!==e.getSource(n),d={startLineNumber:s,startColumn:this._textModel.getLineMaxColumn(s),endLineNumber:o,endColumn:this._textModel.getLineMaxColumn(o)+1};t.push({range:d,options:this._decorationProvider.getDecorationOption(r,o<=i,a)}),r&&o>i&&(i=o)}this._decorationProvider.changeDecorations((e=>this._editorDecorationIds=e.deltaDecorations(this._editorDecorationIds,t))),this._regions=e,this._updateEventEmitter.fire({model:this})}_currentFoldedOrManualRanges(e=[]){const t=(t,i)=>{for(const n of e)if(t<n&&n<=i)return!0;return!1},i=[];for(let n=0,s=this._regions.length;n<s;n++){let e=this.regions.isCollapsed(n);const s=this.regions.getSource(n);if(e||0!==s){const o=this._regions.toFoldRange(n),r=this._textModel.getDecorationRange(this._editorDecorationIds[n]);r&&(e&&t(r.startLineNumber,r.endLineNumber)&&(e=!1),i.push({startLineNumber:r.startLineNumber,endLineNumber:r.endLineNumber,type:o.type,isCollapsed:e,source:s}))}}return i}getMemento(){const e=this._currentFoldedOrManualRanges(),t=[],i=this._textModel.getLineCount();for(let n=0,s=e.length;n<s;n++){const s=e[n];if(s.startLineNumber>=s.endLineNumber||s.startLineNumber<1||s.endLineNumber>i)continue;const o=this._getLinesChecksum(s.startLineNumber+1,s.endLineNumber);t.push({startLineNumber:s.startLineNumber,endLineNumber:s.endLineNumber,isCollapsed:s.isCollapsed,source:s.source,checksum:o})}return t.length>0?t:void 0}applyMemento(e){var t,i;if(!Array.isArray(e))return;const n=[],o=this._textModel.getLineCount();for(const s of e){if(s.startLineNumber>=s.endLineNumber||s.startLineNumber<1||s.endLineNumber>o)continue;const e=this._getLinesChecksum(s.startLineNumber+1,s.endLineNumber);s.checksum&&e!==s.checksum||n.push({startLineNumber:s.startLineNumber,endLineNumber:s.endLineNumber,type:void 0,isCollapsed:null===(t=s.isCollapsed)||void 0===t||t,source:null!==(i=s.source)&&void 0!==i?i:0})}const r=s.MN.sanitizeAndMerge(this._regions,n,o);this.updatePost(s.MN.fromFoldRanges(r))}_getLinesChecksum(e,t){const i=(0,o.vp)(this._textModel.getLineContent(e)+this._textModel.getLineContent(t));return i%1e6}dispose(){this._decorationProvider.removeDecorations(this._editorDecorationIds)}getAllRegionsAtLine(e,t){const i=[];if(this._regions){let n=this._regions.findRange(e),s=1;while(n>=0){const e=this._regions.toRegion(n);t&&!t(e,s)||i.push(e),s++,n=e.parentIndex}}return i}getRegionAtLine(e){if(this._regions){const t=this._regions.findRange(e);if(t>=0)return this._regions.toRegion(t)}return null}getRegionsInside(e,t){const i=[],n=e?e.regionIndex+1:0,s=e?e.endLineNumber:Number.MAX_VALUE;if(t&&2===t.length){const e=[];for(let o=n,r=this._regions.length;o<r;o++){const n=this._regions.toRegion(o);if(!(this._regions.getStartLineNumber(o)<s))break;while(e.length>0&&!n.containedBy(e[e.length-1]))e.pop();e.push(n),t(n,e.length)&&i.push(n)}}else for(let o=n,r=this._regions.length;o<r;o++){const e=this._regions.toRegion(o);if(!(this._regions.getStartLineNumber(o)<s))break;t&&!t(e)||i.push(e)}return i}}function a(e,t,i){const n=[];for(const s of i){const i=e.getRegionAtLine(s);if(i){const s=!i.isCollapsed;if(n.push(i),t>1){const o=e.getRegionsInside(i,((e,i)=>e.isCollapsed!==s&&i<t));n.push(...o)}}}e.toggleCollapseState(n)}function d(e,t,i=Number.MAX_VALUE,n){const s=[];if(n&&n.length>0)for(const o of n){const n=e.getRegionAtLine(o);if(n&&(n.isCollapsed!==t&&s.push(n),i>1)){const o=e.getRegionsInside(n,((e,n)=>e.isCollapsed!==t&&n<i));s.push(...o)}}else{const n=e.getRegionsInside(null,((e,n)=>e.isCollapsed!==t&&n<i));s.push(...n)}e.toggleCollapseState(s)}function l(e,t,i,n){const s=[];for(const o of n){const n=e.getAllRegionsAtLine(o,((e,n)=>e.isCollapsed!==t&&n<=i));s.push(...n)}e.toggleCollapseState(s)}function h(e,t,i){const n=[];for(const s of i){const i=e.getAllRegionsAtLine(s,(e=>e.isCollapsed!==t));i.length>0&&n.push(i[0])}e.toggleCollapseState(n)}function c(e,t,i,n){const s=(e,s)=>s===t&&e.isCollapsed!==i&&!n.some((t=>e.containsLine(t))),o=e.getRegionsInside(null,s);e.toggleCollapseState(o)}function u(e,t,i){const n=[];for(const r of i){const t=e.getAllRegionsAtLine(r,void 0);t.length>0&&n.push(t[0])}const s=e=>n.every((t=>!t.containedBy(e)&&!e.containedBy(t)))&&e.isCollapsed!==t,o=e.getRegionsInside(null,s);e.toggleCollapseState(o)}function g(e,t,i){const n=e.textModel,s=e.regions,o=[];for(let r=s.length-1;r>=0;r--)if(i!==s.isCollapsed(r)){const e=s.getStartLineNumber(r);t.test(n.getLineContent(e))&&o.push(s.toRegion(r))}e.toggleCollapseState(o)}function p(e,t,i){const n=e.regions,s=[];for(let o=n.length-1;o>=0;o--)i!==n.isCollapsed(o)&&t===n.getType(o)&&s.push(n.toRegion(o));e.toggleCollapseState(s)}function _(e,t){let i=null;const n=t.getRegionAtLine(e);if(null!==n&&(i=n.startLineNumber,e===i)){const e=n.parentIndex;i=-1!==e?t.regions.getStartLineNumber(e):null}return i}function m(e,t){let i=t.getRegionAtLine(e);if(null!==i&&i.startLineNumber===e){if(e!==i.startLineNumber)return i.startLineNumber;{const e=i.parentIndex;let n=0;-1!==e&&(n=t.regions.getStartLineNumber(i.parentIndex));while(null!==i){if(!(i.regionIndex>0))return null;if(i=t.regions.toRegion(i.regionIndex-1),i.startLineNumber<=n)return null;if(i.parentIndex===e)return i.startLineNumber}}}else if(t.regions.length>0){i=t.regions.toRegion(t.regions.length-1);while(null!==i){if(i.startLineNumber<e)return i.startLineNumber;i=i.regionIndex>0?t.regions.toRegion(i.regionIndex-1):null}}return null}function f(e,t){let i=t.getRegionAtLine(e);if(null!==i&&i.startLineNumber===e){const e=i.parentIndex;let n=0;if(-1!==e)n=t.regions.getEndLineNumber(i.parentIndex);else{if(0===t.regions.length)return null;n=t.regions.getEndLineNumber(t.regions.length-1)}while(null!==i){if(!(i.regionIndex<t.regions.length))return null;if(i=t.regions.toRegion(i.regionIndex+1),i.startLineNumber>=n)return null;if(i.parentIndex===e)return i.startLineNumber}}else if(t.regions.length>0){i=t.regions.toRegion(0);while(null!==i){if(i.startLineNumber>e)return i.startLineNumber;i=i.regionIndex<t.regions.length?t.regions.toRegion(i.regionIndex+1):null}}return null}},18915:(e,t,i)=>{i.d(t,{MN:()=>d,Xl:()=>o});const n={[0]:" ",[1]:"u",[2]:"r"},s=65535,o=16777215,r=4278190080;class a{constructor(e){const t=Math.ceil(e/32);this._states=new Uint32Array(t)}get(e){const t=e/32|0,i=e%32;return 0!==(this._states[t]&1<<i)}set(e,t){const i=e/32|0,n=e%32,s=this._states[i];this._states[i]=t?s|1<<n:s&~(1<<n)}}class d{constructor(e,t,i){if(e.length!==t.length||e.length>s)throw new Error("invalid startIndexes or endIndexes size");this._startIndexes=e,this._endIndexes=t,this._collapseStates=new a(e.length),this._userDefinedStates=new a(e.length),this._recoveredStates=new a(e.length),this._types=i,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;const e=[],t=(t,i)=>{const n=e[e.length-1];return this.getStartLineNumber(n)<=t&&this.getEndLineNumber(n)>=i};for(let i=0,n=this._startIndexes.length;i<n;i++){const n=this._startIndexes[i],s=this._endIndexes[i];if(n>o||s>o)throw new Error("startLineNumber or endLineNumber must not exceed "+o);while(e.length>0&&!t(n,s))e.pop();const r=e.length>0?e[e.length-1]:-1;e.push(i),this._startIndexes[i]=n+((255&r)<<24),this._endIndexes[i]=s+((65280&r)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&o}getEndLineNumber(e){return this._endIndexes[e]&o}getType(e){return this._types?this._types[e]:void 0}hasTypes(){return!!this._types}isCollapsed(e){return this._collapseStates.get(e)}setCollapsed(e,t){this._collapseStates.set(e,t)}isUserDefined(e){return this._userDefinedStates.get(e)}setUserDefined(e,t){return this._userDefinedStates.set(e,t)}isRecovered(e){return this._recoveredStates.get(e)}setRecovered(e,t){return this._recoveredStates.set(e,t)}getSource(e){return this.isUserDefined(e)?1:this.isRecovered(e)?2:0}setSource(e,t){1===t?(this.setUserDefined(e,!0),this.setRecovered(e,!1)):2===t?(this.setUserDefined(e,!1),this.setRecovered(e,!0)):(this.setUserDefined(e,!1),this.setRecovered(e,!1))}setCollapsedAllOfType(e,t){let i=!1;if(this._types)for(let n=0;n<this._types.length;n++)this._types[n]===e&&(this.setCollapsed(n,t),i=!0);return i}toRegion(e){return new l(this,e)}getParentIndex(e){this.ensureParentIndices();const t=((this._startIndexes[e]&r)>>>24)+((this._endIndexes[e]&r)>>>16);return t===s?-1:t}contains(e,t){return this.getStartLineNumber(e)<=t&&this.getEndLineNumber(e)>=t}findIndex(e){let t=0,i=this._startIndexes.length;if(0===i)return-1;while(t<i){const n=Math.floor((t+i)/2);e<this.getStartLineNumber(n)?i=n:t=n+1}return t-1}findRange(e){let t=this.findIndex(e);if(t>=0){const i=this.getEndLineNumber(t);if(i>=e)return t;t=this.getParentIndex(t);while(-1!==t){if(this.contains(t,e))return t;t=this.getParentIndex(t)}}return-1}toString(){const e=[];for(let t=0;t<this.length;t++)e[t]=`[${n[this.getSource(t)]}${this.isCollapsed(t)?"+":"-"}] ${this.getStartLineNumber(t)}/${this.getEndLineNumber(t)}`;return e.join(", ")}toFoldRange(e){return{startLineNumber:this._startIndexes[e]&o,endLineNumber:this._endIndexes[e]&o,type:this._types?this._types[e]:void 0,isCollapsed:this.isCollapsed(e),source:this.getSource(e)}}static fromFoldRanges(e){const t=e.length,i=new Uint32Array(t),n=new Uint32Array(t);let s=[],o=!1;for(let a=0;a<t;a++){const t=e[a];i[a]=t.startLineNumber,n[a]=t.endLineNumber,s.push(t.type),t.type&&(o=!0)}o||(s=void 0);const r=new d(i,n,s);for(let a=0;a<t;a++)e[a].isCollapsed&&r.setCollapsed(a,!0),r.setSource(a,e[a].source);return r}static sanitizeAndMerge(e,t,i){i=null!==i&&void 0!==i?i:Number.MAX_VALUE;const n=(e,t)=>Array.isArray(e)?i=>i<t?e[i]:void 0:i=>i<t?e.toFoldRange(i):void 0,s=n(e,e.length),o=n(t,t.length);let r=0,a=0,d=s(0),l=o(0);const h=[];let c,u=0;const g=[];while(d||l){let e;if(l&&(!d||d.startLineNumber>=l.startLineNumber))d&&d.startLineNumber===l.startLineNumber?(1===l.source?e=l:(e=d,e.isCollapsed=l.isCollapsed&&d.endLineNumber===l.endLineNumber,e.source=0),d=s(++r)):(e=l,l.isCollapsed&&0===l.source&&(e.source=2)),l=o(++a);else{let t=a,i=l;while(1){if(!i||i.startLineNumber>d.endLineNumber){e=d;break}if(1===i.source&&i.endLineNumber>d.endLineNumber)break;i=o(++t)}d=s(++r)}if(e){while(c&&c.endLineNumber<e.startLineNumber)c=h.pop();e.endLineNumber>e.startLineNumber&&e.startLineNumber>u&&e.endLineNumber<=i&&(!c||c.endLineNumber>=e.endLineNumber)&&(g.push(e),u=e.startLineNumber,c&&h.push(c),c=e)}}return g}}class l{constructor(e,t){this.ranges=e,this.index=t}get startLineNumber(){return this.ranges.getStartLineNumber(this.index)}get endLineNumber(){return this.ranges.getEndLineNumber(this.index)}get regionIndex(){return this.index}get parentIndex(){return this.ranges.getParentIndex(this.index)}get isCollapsed(){return this.ranges.isCollapsed(this.index)}containedBy(e){return e.startLineNumber<=this.startLineNumber&&e.endLineNumber>=this.endLineNumber}containsLine(e){return this.startLineNumber<=e&&e<=this.endLineNumber}}},63947:(e,t,i)=>{i.d(t,{aI:()=>a});var n=i(83787),s=i(18915);const o=5e3,r="indent";class a{constructor(e,t,i){this.editorModel=e,this.languageConfigurationService=t,this.foldingRangesLimit=i,this.id=r}dispose(){}compute(e){const t=this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules,i=t&&!!t.offSide,n=t&&t.markers;return Promise.resolve(h(this.editorModel,i,n,this.foldingRangesLimit))}}class d{constructor(e){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=e}insertFirst(e,t,i){if(e>s.Xl||t>s.Xl)return;const n=this._length;this._startIndexes[n]=e,this._endIndexes[n]=t,this._length++,i<1e3&&(this._indentOccurrences[i]=(this._indentOccurrences[i]||0)+1)}toIndentRanges(e){const t=this._foldingRangesLimit.limit;if(this._length<=t){this._foldingRangesLimit.update(this._length,!1);const e=new Uint32Array(this._length),t=new Uint32Array(this._length);for(let i=this._length-1,n=0;i>=0;i--,n++)e[n]=this._startIndexes[i],t[n]=this._endIndexes[i];return new s.MN(e,t)}{this._foldingRangesLimit.update(this._length,t);let i=0,o=this._indentOccurrences.length;for(let e=0;e<this._indentOccurrences.length;e++){const n=this._indentOccurrences[e];if(n){if(n+i>t){o=e;break}i+=n}}const r=e.getOptions().tabSize,a=new Uint32Array(t),d=new Uint32Array(t);for(let s=this._length-1,l=0;s>=0;s--){const h=this._startIndexes[s],c=e.getLineContent(h),u=(0,n.q)(c,r);(u<o||u===o&&i++<t)&&(a[l]=h,d[l]=this._endIndexes[s],l++)}return new s.MN(a,d)}}}const l={limit:o,update:()=>{}};function h(e,t,i,s=l){const o=e.getOptions().tabSize,r=new d(s);let a;i&&(a=new RegExp(`(${i.start.source})|(?:${i.end.source})`));const h=[],c=e.getLineCount()+1;h.push({indent:-1,endAbove:c,line:c});for(let d=e.getLineCount();d>0;d--){const i=e.getLineContent(d),s=(0,n.q)(i,o);let l,c=h[h.length-1];if(-1!==s){if(a&&(l=i.match(a))){if(!l[1]){h.push({indent:-2,endAbove:d,line:d});continue}{let e=h.length-1;while(e>0&&-2!==h[e].indent)e--;if(e>0){h.length=e+1,c=h[e],r.insertFirst(d,c.line,s),c.line=d,c.indent=s,c.endAbove=d;continue}}}if(c.indent>s){do{h.pop(),c=h[h.length-1]}while(c.indent>s);const e=c.endAbove-1;e-d>=1&&r.insertFirst(d,e,s)}c.indent===s?c.endAbove=d:h.push({indent:s,endAbove:d,line:d})}else t&&(c.endAbove=d)}return r.toIndentRanges(e)}},59203:(e,t,i)=>{i.d(t,{e:()=>d});var n=i(98642),s=i(70959),o=i(18915);const r={},a="syntax";class d{constructor(e,t,i,n,o){this.editorModel=e,this.providers=t,this.handleFoldingRangesChange=i,this.foldingRangesLimit=n,this.fallbackRangeProvider=o,this.id=a,this.disposables=new s.SL,o&&this.disposables.add(o);for(const s of t)"function"===typeof s.onDidChange&&this.disposables.add(s.onDidChange(i))}compute(e){return l(this.providers,this.editorModel,e).then((t=>{var i,n;if(t){const e=c(t,this.foldingRangesLimit);return e}return null!==(n=null===(i=this.fallbackRangeProvider)||void 0===i?void 0:i.compute(e))&&void 0!==n?n:null}))}dispose(){this.disposables.dispose()}}function l(e,t,i){let s=null;const o=e.map(((e,o)=>Promise.resolve(e.provideFoldingRanges(t,r,i)).then((e=>{if(!i.isCancellationRequested&&Array.isArray(e)){Array.isArray(s)||(s=[]);const i=t.getLineCount();for(const t of e)t.start>0&&t.end>t.start&&t.end<=i&&s.push({start:t.start,end:t.end,rank:o,kind:t.kind})}}),n.Cp)));return Promise.all(o).then((e=>s))}class h{constructor(e){this._startIndexes=[],this._endIndexes=[],this._nestingLevels=[],this._nestingLevelCounts=[],this._types=[],this._length=0,this._foldingRangesLimit=e}add(e,t,i,n){if(e>o.Xl||t>o.Xl)return;const s=this._length;this._startIndexes[s]=e,this._endIndexes[s]=t,this._nestingLevels[s]=n,this._types[s]=i,this._length++,n<30&&(this._nestingLevelCounts[n]=(this._nestingLevelCounts[n]||0)+1)}toIndentRanges(){const e=this._foldingRangesLimit.limit;if(this._length<=e){this._foldingRangesLimit.update(this._length,!1);const e=new Uint32Array(this._length),t=new Uint32Array(this._length);for(let i=0;i<this._length;i++)e[i]=this._startIndexes[i],t[i]=this._endIndexes[i];return new o.MN(e,t,this._types)}{this._foldingRangesLimit.update(this._length,e);let t=0,i=this._nestingLevelCounts.length;for(let o=0;o<this._nestingLevelCounts.length;o++){const n=this._nestingLevelCounts[o];if(n){if(n+t>e){i=o;break}t+=n}}const n=new Uint32Array(e),s=new Uint32Array(e),r=[];for(let o=0,a=0;o<this._length;o++){const d=this._nestingLevels[o];(d<i||d===i&&t++<e)&&(n[a]=this._startIndexes[o],s[a]=this._endIndexes[o],r[a]=this._types[o],a++)}return new o.MN(n,s,r)}}}function c(e,t){const i=e.sort(((e,t)=>{let i=e.start-t.start;return 0===i&&(i=e.rank-t.rank),i})),n=new h(t);let s;const o=[];for(const r of i)if(s){if(r.start>s.start)if(r.end<=s.end)o.push(s),s=r,n.add(r.start,r.end,r.kind&&r.kind.value,o.length);else{if(r.start>s.end){do{s=o.pop()}while(s&&r.start>s.end);s&&o.push(s),s=r}n.add(r.start,r.end,r.kind&&r.kind.value,o.length)}}else s=r,n.add(r.start,r.end,r.kind&&r.kind.value,o.length);return n.toIndentRanges()}}}]);