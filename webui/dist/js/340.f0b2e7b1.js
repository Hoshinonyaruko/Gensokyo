"use strict";(globalThis["webpackChunkfrontend"]=globalThis["webpackChunkfrontend"]||[]).push([[340],{86858:(e,t,i)=>{var o=i(48077),n=i(99868),r=i(25206);class s extends o.R6{constructor(){super({id:"editor.action.fontZoomIn",label:r.NC("EditorFontZoomIn.label","Editor Font Zoom In"),alias:"Editor Font Zoom In",precondition:void 0})}run(e,t){n.C.setZoomLevel(n.C.getZoomLevel()+1)}}class a extends o.R6{constructor(){super({id:"editor.action.fontZoomOut",label:r.NC("EditorFontZoomOut.label","Editor Font Zoom Out"),alias:"Editor Font Zoom Out",precondition:void 0})}run(e,t){n.C.setZoomLevel(n.C.getZoomLevel()-1)}}class d extends o.R6{constructor(){super({id:"editor.action.fontZoomReset",label:r.NC("EditorFontZoomReset.label","Editor Font Zoom Reset"),alias:"Editor Font Zoom Reset",precondition:void 0})}run(e,t){n.C.setZoomLevel(0)}}(0,o.Qr)(s),(0,o.Qr)(a),(0,o.Qr)(d)},60219:(e,t,i)=>{i.d(t,{Qq:()=>L,Qs:()=>O,Zg:()=>M,x$:()=>R,xC:()=>P});var o=i(69332),n=i(21921),r=i(55191),s=i(98642),a=i(39595),d=i(33010),l=i(55455),c=i(95896),h=i(39363),u=i(35491),g=i(89999),p=i(33162),_=i(54644),m=i(52473),v=i(15498),f=i(20606),y=i(25206),b=i(46871),w=i(94022),C=i(21881),S=i(16458),D=i(23034),k=function(e,t,i,o){function n(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(o.next(e))}catch(t){r(t)}}function a(e){try{d(o["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):n(e.value).then(s,a)}d((o=o.apply(e,t||[])).next())}))};function M(e){if(e=e.filter((e=>e.range)),!e.length)return;let{range:t}=e[0];for(let o=1;o<e.length;o++)t=p.e.plusRange(t,e[o].range);const{startLineNumber:i,endLineNumber:n}=t;i===n?1===e.length?(0,o.Z9)(y.NC("hint11","Made 1 formatting edit on line {0}",i)):(0,o.Z9)(y.NC("hintn1","Made {0} formatting edits on line {1}",e.length,i)):1===e.length?(0,o.Z9)(y.NC("hint1n","Made 1 formatting edit between lines {0} and {1}",i,n)):(0,o.Z9)(y.NC("hintnn","Made {0} formatting edits between lines {1} and {2}",e.length,i,n))}function N(e,t,i){const o=[],n=new w.o,r=e.ordered(i);for(const a of r)o.push(a),a.extensionId&&n.add(a.extensionId);const s=t.ordered(i);for(const a of s){if(a.extensionId){if(n.has(a.extensionId))continue;n.add(a.extensionId)}o.push({displayName:a.displayName,extensionId:a.extensionId,provideDocumentFormattingEdits(e,t,i){return a.provideDocumentRangeFormattingEdits(e,e.getFullModelRange(),t,i)}})}return o}class P{static setFormatterSelector(e){const t=P._selectors.unshift(e);return{dispose:t}}static select(e,t,i){return k(this,void 0,void 0,(function*(){if(0===e.length)return;const o=a.$.first(P._selectors);return o?yield o(e,t,i):void 0}))}}function R(e,t,i,o,n,r){return k(this,void 0,void 0,(function*(){const s=e.get(C.TG),{documentRangeFormattingEditProvider:a}=e.get(S.p),d=(0,u.CL)(t)?t.getModel():t,l=a.ordered(d),c=yield P.select(l,d,o);c&&(n.report(c),yield s.invokeFunction(x,c,t,i,r))}))}function x(e,t,i,o,r){var s,a;return k(this,void 0,void 0,(function*(){const d=e.get(m.p),l=e.get(D.VZ);let c,g;(0,u.CL)(i)?(c=i.getModel(),g=new h.Dl(i,5,void 0,r)):(c=i,g=new h.YQ(i,r));const v=[];let y=0;for(const e of(0,n._2)(o).sort(p.e.compareRangesUsingStarts))y>0&&p.e.areIntersectingOrTouching(v[y-1],e)?v[y-1]=p.e.fromPositions(v[y-1].getStartPosition(),e.getEndPosition()):y=v.push(e);const b=e=>k(this,void 0,void 0,(function*(){var i,o;l.trace("[format][provideDocumentRangeFormattingEdits] (request)",null===(i=t.extensionId)||void 0===i?void 0:i.value,e);const n=(yield t.provideDocumentRangeFormattingEdits(c,e,c.getFormattingOptions(),g.token))||[];return l.trace("[format][provideDocumentRangeFormattingEdits] (response)",null===(o=t.extensionId)||void 0===o?void 0:o.value,n),n})),w=(e,t)=>{if(!e.length||!t.length)return!1;const i=e.reduce(((e,t)=>p.e.plusRange(e,t.range)),e[0].range);if(!t.some((e=>p.e.intersectRanges(i,e.range))))return!1;for(const o of e)for(const e of t)if(p.e.intersectRanges(o.range,e.range))return!0;return!1},C=[],S=[];try{if("function"===typeof t.provideDocumentRangesFormattingEdits){l.trace("[format][provideDocumentRangeFormattingEdits] (request)",null===(s=t.extensionId)||void 0===s?void 0:s.value,v);const e=(yield t.provideDocumentRangesFormattingEdits(c,v,c.getFormattingOptions(),g.token))||[];l.trace("[format][provideDocumentRangeFormattingEdits] (response)",null===(a=t.extensionId)||void 0===a?void 0:a.value,e),S.push(e)}else{for(const e of v){if(g.token.isCancellationRequested)return!0;S.push(yield b(e))}for(let e=0;e<v.length;++e)for(let t=e+1;t<v.length;++t){if(g.token.isCancellationRequested)return!0;if(w(S[e],S[t])){const i=p.e.plusRange(v[e],v[t]),o=yield b(i);v.splice(t,1),v.splice(e,1),v.push(i),S.splice(t,1),S.splice(e,1),S.push(o),e=0,t=0}}}for(const e of S){if(g.token.isCancellationRequested)return!0;const t=yield d.computeMoreMinimalEdits(c.uri,e);t&&C.push(...t)}}finally{g.dispose()}if(0===C.length)return!1;if((0,u.CL)(i))f.V.execute(i,C,!0),M(C),i.revealPositionInCenterIfOutsideViewport(i.getPosition(),1);else{const[{range:e}]=C,t=new _.Y(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn);c.pushEditOperations([t],C.map((e=>({text:e.text,range:p.e.lift(e.range),forceMoveMarkers:!0}))),(e=>{for(const{range:i}of e)if(p.e.areIntersectingOrTouching(i,t))return[new _.Y(i.startLineNumber,i.startColumn,i.endLineNumber,i.endColumn)];return null}))}return!0}))}function L(e,t,i,o,n){return k(this,void 0,void 0,(function*(){const r=e.get(C.TG),s=e.get(S.p),a=(0,u.CL)(t)?t.getModel():t,d=N(s.documentFormattingEditProvider,s.documentRangeFormattingEditProvider,a),l=yield P.select(d,a,i);l&&(o.report(l),yield r.invokeFunction(I,l,t,i,n))}))}function I(e,t,i,o,n){return k(this,void 0,void 0,(function*(){const r=e.get(m.p);let s,a,d;(0,u.CL)(i)?(s=i.getModel(),a=new h.Dl(i,5,void 0,n)):(s=i,a=new h.YQ(i,n));try{const e=yield t.provideDocumentFormattingEdits(s,s.getFormattingOptions(),a.token);if(d=yield r.computeMoreMinimalEdits(s.uri,e),a.token.isCancellationRequested)return!0}finally{a.dispose()}if(!d||0===d.length)return!1;if((0,u.CL)(i))f.V.execute(i,d,2!==o),2!==o&&(M(d),i.revealPositionInCenterIfOutsideViewport(i.getPosition(),1));else{const[{range:e}]=d,t=new _.Y(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn);s.pushEditOperations([t],d.map((e=>({text:e.text,range:p.e.lift(e.range),forceMoveMarkers:!0}))),(e=>{for(const{range:i}of e)if(p.e.areIntersectingOrTouching(i,t))return[new _.Y(i.startLineNumber,i.startColumn,i.endLineNumber,i.endColumn)];return null}))}return!0}))}function T(e,t,i,o,r,a){return k(this,void 0,void 0,(function*(){const d=t.documentRangeFormattingEditProvider.ordered(i);for(const t of d){const d=yield Promise.resolve(t.provideDocumentRangeFormattingEdits(i,o,r,a)).catch(s.Cp);if((0,n.Of)(d))return yield e.computeMoreMinimalEdits(i.uri,d)}}))}function E(e,t,i,o,r){return k(this,void 0,void 0,(function*(){const a=N(t.documentFormattingEditProvider,t.documentRangeFormattingEditProvider,i);for(const t of a){const a=yield Promise.resolve(t.provideDocumentFormattingEdits(i,o,r)).catch(s.Cp);if((0,n.Of)(a))return yield e.computeMoreMinimalEdits(i.uri,a)}}))}function O(e,t,i,o,n,r,a){const d=t.onTypeFormattingEditProvider.ordered(i);return 0===d.length||d[0].autoFormatTriggerCharacters.indexOf(n)<0?Promise.resolve(void 0):Promise.resolve(d[0].provideOnTypeFormattingEdits(i,o,n,r,a)).catch(s.Cp).then((t=>e.computeMoreMinimalEdits(i.uri,t)))}P._selectors=new d.S,b.P.registerCommand("_executeFormatRangeProvider",(function(e,...t){return k(this,void 0,void 0,(function*(){const[i,o,n]=t;(0,l.p_)(c.o.isUri(i)),(0,l.p_)(p.e.isIRange(o));const s=e.get(v.S),a=e.get(m.p),d=e.get(S.p),h=yield s.createModelReference(i);try{return T(a,d,h.object.textEditorModel,p.e.lift(o),n,r.T.None)}finally{h.dispose()}}))})),b.P.registerCommand("_executeFormatDocumentProvider",(function(e,...t){return k(this,void 0,void 0,(function*(){const[i,o]=t;(0,l.p_)(c.o.isUri(i));const n=e.get(v.S),s=e.get(m.p),a=e.get(S.p),d=yield n.createModelReference(i);try{return E(s,a,d.object.textEditorModel,o,r.T.None)}finally{d.dispose()}}))})),b.P.registerCommand("_executeFormatOnTypeProvider",(function(e,...t){return k(this,void 0,void 0,(function*(){const[i,o,n,s]=t;(0,l.p_)(c.o.isUri(i)),(0,l.p_)(g.L.isIPosition(o)),(0,l.p_)("string"===typeof n);const a=e.get(v.S),d=e.get(m.p),h=e.get(S.p),u=yield a.createModelReference(i);try{return O(d,h,u.object.textEditorModel,g.L.lift(o),n,s,r.T.None)}finally{u.dispose()}}))}))},64457:(e,t,i)=>{var o=i(21921),n=i(55191),r=i(98642),s=i(56082),a=i(70959),d=i(48077),l=i(35195),c=i(51099),h=i(33162),u=i(44950),g=i(52473),p=i(16458),_=i(60219),m=i(20606),v=i(25206),f=i(46871),y=i(37174),b=i(21881),w=i(34679),C=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},S=function(e,t){return function(i,o){t(i,o,e)}},D=function(e,t,i,o){function n(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(o.next(e))}catch(t){r(t)}}function a(e){try{d(o["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):n(e.value).then(s,a)}d((o=o.apply(e,t||[])).next())}))};let k=class{constructor(e,t,i){this._editor=e,this._languageFeaturesService=t,this._workerService=i,this._disposables=new a.SL,this._sessionDisposables=new a.SL,this._disposables.add(t.onTypeFormattingEditProvider.onDidChange(this._update,this)),this._disposables.add(e.onDidChangeModel((()=>this._update()))),this._disposables.add(e.onDidChangeModelLanguage((()=>this._update()))),this._disposables.add(e.onDidChangeConfiguration((e=>{e.hasChanged(56)&&this._update()}))),this._update()}dispose(){this._disposables.dispose(),this._sessionDisposables.dispose()}_update(){if(this._sessionDisposables.clear(),!this._editor.getOption(56))return;if(!this._editor.hasModel())return;const e=this._editor.getModel(),[t]=this._languageFeaturesService.onTypeFormattingEditProvider.ordered(e);if(!t||!t.autoFormatTriggerCharacters)return;const i=new c.q;for(const o of t.autoFormatTriggerCharacters)i.add(o.charCodeAt(0));this._sessionDisposables.add(this._editor.onDidType((e=>{const t=e.charCodeAt(e.length-1);i.has(t)&&this._trigger(String.fromCharCode(t))})))}_trigger(e){if(!this._editor.hasModel())return;if(this._editor.getSelections().length>1||!this._editor.getSelection().isEmpty())return;const t=this._editor.getModel(),i=this._editor.getPosition(),r=new n.A,s=this._editor.onDidChangeModelContent((e=>{if(e.isFlush)return r.cancel(),void s.dispose();for(let t=0,o=e.changes.length;t<o;t++){const o=e.changes[t];if(o.range.endLineNumber<=i.lineNumber)return r.cancel(),void s.dispose()}}));(0,_.Qs)(this._workerService,this._languageFeaturesService,t,i,e,t.getFormattingOptions(),r.token).then((e=>{r.token.isCancellationRequested||(0,o.Of)(e)&&(m.V.execute(this._editor,e,!0),(0,_.Zg)(e))})).finally((()=>{s.dispose()}))}};k.ID="editor.contrib.autoFormat",k=C([S(1,p.p),S(2,g.p)],k);let M=class{constructor(e,t,i){this.editor=e,this._languageFeaturesService=t,this._instantiationService=i,this._callOnDispose=new a.SL,this._callOnModel=new a.SL,this._callOnDispose.add(e.onDidChangeConfiguration((()=>this._update()))),this._callOnDispose.add(e.onDidChangeModel((()=>this._update()))),this._callOnDispose.add(e.onDidChangeModelLanguage((()=>this._update()))),this._callOnDispose.add(t.documentRangeFormattingEditProvider.onDidChange(this._update,this))}dispose(){this._callOnDispose.dispose(),this._callOnModel.dispose()}_update(){this._callOnModel.clear(),this.editor.getOption(55)&&this.editor.hasModel()&&this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())&&this._callOnModel.add(this.editor.onDidPaste((({range:e})=>this._trigger(e))))}_trigger(e){this.editor.hasModel()&&(this.editor.getSelections().length>1||this._instantiationService.invokeFunction(_.x$,this.editor,e,2,w.Ex.None,n.T.None).catch(r.dL))}};M.ID="editor.contrib.formatOnPaste",M=C([S(1,p.p),S(2,b.TG)],M);class N extends d.R6{constructor(){super({id:"editor.action.formatDocument",label:v.NC("formatDocument.label","Format Document"),alias:"Format Document",precondition:y.Ao.and(u.u.notInCompositeEditor,u.u.writable,u.u.hasDocumentFormattingProvider),kbOpts:{kbExpr:u.u.editorTextFocus,primary:1572,linux:{primary:3111},weight:100},contextMenuOpts:{group:"1_modification",order:1.3}})}run(e,t){return D(this,void 0,void 0,(function*(){if(t.hasModel()){const i=e.get(b.TG),o=e.get(w.ek);yield o.showWhile(i.invokeFunction(_.Qq,t,1,w.Ex.None,n.T.None),250)}}))}}class P extends d.R6{constructor(){super({id:"editor.action.formatSelection",label:v.NC("formatSelection.label","Format Selection"),alias:"Format Selection",precondition:y.Ao.and(u.u.writable,u.u.hasDocumentSelectionFormattingProvider),kbOpts:{kbExpr:u.u.editorTextFocus,primary:(0,s.gx)(2089,2084),weight:100},contextMenuOpts:{when:u.u.hasNonEmptySelection,group:"1_modification",order:1.31}})}run(e,t){return D(this,void 0,void 0,(function*(){if(!t.hasModel())return;const i=e.get(b.TG),o=t.getModel(),r=t.getSelections().map((e=>e.isEmpty()?new h.e(e.startLineNumber,1,e.startLineNumber,o.getLineMaxColumn(e.startLineNumber)):e)),s=e.get(w.ek);yield s.showWhile(i.invokeFunction(_.x$,t,r,1,w.Ex.None,n.T.None),250)}))}}(0,d._K)(k.ID,k,2),(0,d._K)(M.ID,M,2),(0,d.Qr)(N),(0,d.Qr)(P),f.P.registerCommand("editor.action.format",(e=>D(void 0,void 0,void 0,(function*(){const t=e.get(l.$).getFocusedCodeEditor();if(!t||!t.hasModel())return;const i=e.get(f.H);t.getSelection().isEmpty()?yield i.executeCommand("editor.action.formatDocument"):yield i.executeCommand("editor.action.formatSelection")}))))},20606:(e,t,i)=>{i.d(t,{V:()=>s});var o=i(90970),n=i(33162),r=i(95402);class s{static _handleEolEdits(e,t){let i;const o=[];for(const n of t)"number"===typeof n.eol&&(i=n.eol),n.range&&"string"===typeof n.text&&o.push(n);return"number"===typeof i&&e.hasModel()&&e.getModel().pushEOL(i),o}static _isFullModelReplaceEdit(e,t){if(!e.hasModel())return!1;const i=e.getModel(),o=i.validateRange(t.range),n=i.getFullModelRange();return n.equalsRange(o)}static execute(e,t,i){i&&e.pushUndoStop();const a=r.Z.capture(e),d=s._handleEolEdits(e,t);1===d.length&&s._isFullModelReplaceEdit(e,d[0])?e.executeEdits("formatEditsCommand",d.map((e=>o.h.replace(n.e.lift(e.range),e.text)))):e.executeEdits("formatEditsCommand",d.map((e=>o.h.replaceMove(n.e.lift(e.range),e.text)))),i&&e.pushUndoStop(),a.restoreRelativeVerticalPositionOfCursor(e)}}},68703:(e,t,i)=>{i.d(t,{BT:()=>Qe,Bj:()=>je,_k:()=>Ge});var o,n=i(69332),r=i(85398),s=i(56082),a=i(55455),d=i(95896),l=i(39363),c=i(35491),h=i(48077),u=i(35195),g=i(24788),p=i(89999),_=i(33162),m=i(44950),v=i(67026),f=i(98642),y=i(70959),b=i(78097),w=i(25206),C=i(46871),S=i(47596),D=i(37174),k=i(21881),M=i(37395),N=i(15142),P=i(18736),R=i(51906),x=i(7316),L=i(2548),I=i(26156),T=i(60204),E=i(11271),O=i(50200),F=i(21230),A=i(16375),W=i(97297),H=i(32484),z=i(61141),B=i(15498),U=i(86829),V=i(32907),K=i(10791),G=i(70546),j=i(15285),Q=i(51549),$=i(22454),Z=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},q=function(e,t){return function(i,o){t(i,o,e)}};let X=class{constructor(e){this._resolverService=e}hasChildren(e){return e instanceof x.oQ||e instanceof x.F2}getChildren(e){if(e instanceof x.oQ)return e.groups;if(e instanceof x.F2)return e.resolve(this._resolverService).then((e=>e.children));throw new Error("bad tree")}};X=Z([q(0,B.S)],X);class J{getHeight(){return 23}getTemplateId(e){return e instanceof x.F2?ie.id:ne.id}}let Y=class{constructor(e){this._keybindingService=e}getKeyboardNavigationLabel(e){var t;if(e instanceof x.WX){const i=null===(t=e.parent.getPreview(e))||void 0===t?void 0:t.preview(e.range);if(i)return i.value}return(0,F.EZ)(e.uri)}};Y=Z([q(0,j.d)],Y);class ee{getId(e){return e instanceof x.WX?e.id:e.uri}}let te=class extends y.JT{constructor(e,t){super(),this._labelService=t;const i=document.createElement("div");i.classList.add("reference-file"),this.file=this._register(new K.g(i,{supportHighlights:!0})),this.badge=new U.Z(L.R3(i,L.$(".count")),{},$.ku),e.appendChild(i)}set(e,t){const i=(0,F.XX)(e.uri);this.file.setLabel(this._labelService.getUriBasenameLabel(e.uri),this._labelService.getUriLabel(i,{relative:!0}),{title:this._labelService.getUriLabel(e.uri),matches:t});const o=e.children.length;this.badge.setCount(o),o>1?this.badge.setTitleFormat((0,w.NC)("referencesCount","{0} references",o)):this.badge.setTitleFormat((0,w.NC)("referenceCount","{0} reference",o))}};te=Z([q(1,Q.e)],te);let ie=o=class{constructor(e){this._instantiationService=e,this.templateId=o.id}renderTemplate(e){return this._instantiationService.createInstance(te,e)}renderElement(e,t,i){i.set(e.element,(0,G.mB)(e.filterData))}disposeTemplate(e){e.dispose()}};ie.id="FileReferencesRenderer",ie=o=Z([q(0,k.TG)],ie);class oe{constructor(e){this.label=new V.q(e)}set(e,t){var i;const o=null===(i=e.parent.getPreview(e))||void 0===i?void 0:i.preview(e.range);if(o&&o.value){const{value:e,highlight:i}=o;t&&!G.CL.isDefault(t)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(e,(0,G.mB)(t))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(e,[i]))}else this.label.set(`${(0,F.EZ)(e.uri)}:${e.range.startLineNumber+1}:${e.range.startColumn+1}`)}}class ne{constructor(){this.templateId=ne.id}renderTemplate(e){return new oe(e)}renderElement(e,t,i){i.set(e.element,e.filterData)}disposeTemplate(){}}ne.id="OneReferenceRenderer";class re{getWidgetAriaLabel(){return(0,w.NC)("treeAriaLabel","References")}getAriaLabel(e){return e.ariaMessage}}var se=i(32656),ae=i(70813),de=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},le=function(e,t){return function(i,o){t(i,o,e)}},ce=function(e,t,i,o){function n(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(o.next(e))}catch(t){r(t)}}function a(e){try{d(o["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):n(e.value).then(s,a)}d((o=o.apply(e,t||[])).next())}))};class he{constructor(e,t){this._editor=e,this._model=t,this._decorations=new Map,this._decorationIgnoreSet=new Set,this._callOnDispose=new y.SL,this._callOnModelChange=new y.SL,this._callOnDispose.add(this._editor.onDidChangeModel((()=>this._onModelChanged()))),this._onModelChanged()}dispose(){this._callOnModelChange.dispose(),this._callOnDispose.dispose(),this.removeDecorations()}_onModelChanged(){this._callOnModelChange.clear();const e=this._editor.getModel();if(e)for(const t of this._model.references)if(t.uri.toString()===e.uri.toString())return void this._addDecorations(t.parent)}_addDecorations(e){if(!this._editor.hasModel())return;this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations((()=>this._onDecorationChanged())));const t=[],i=[];for(let o=0,n=e.children.length;o<n;o++){const n=e.children[o];this._decorationIgnoreSet.has(n.id)||n.uri.toString()===this._editor.getModel().uri.toString()&&(t.push({range:n.range,options:he.DecorationOptions}),i.push(o))}this._editor.changeDecorations((o=>{const n=o.deltaDecorations([],t);for(let t=0;t<n.length;t++)this._decorations.set(n[t],e.children[i[t]])}))}_onDecorationChanged(){const e=[],t=this._editor.getModel();if(t){for(const[i,o]of this._decorations){const n=t.getDecorationRange(i);if(!n)continue;let r=!1;if(!_.e.equalsRange(n,o.range)){if(_.e.spansMultipleLines(n))r=!0;else{const e=o.range.endColumn-o.range.startColumn,t=n.endColumn-n.startColumn;e!==t&&(r=!0)}r?(this._decorationIgnoreSet.add(o.id),e.push(i)):o.range=n}}for(let t=0,i=e.length;t<i;t++)this._decorations.delete(e[t]);this._editor.removeDecorations(e)}}removeDecorations(){this._editor.removeDecorations([...this._decorations.keys()]),this._decorations.clear()}}he.DecorationOptions=A.qx.register({description:"reference-decoration",stickiness:1,className:"reference-decoration"});class ue{constructor(){this.ratio=.7,this.heightInLines=18}static fromJSON(e){let t,i;try{const o=JSON.parse(e);t=o.ratio,i=o.heightInLines}catch(Re){}return{ratio:t||.7,heightInLines:i||18}}}class ge extends N.ls{}let pe=class extends b.vk{constructor(e,t,i,o,n,r,s,a,d,l,c,h){super(e,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0,supportOnTitleClick:!0},r),this._defaultTreeKeyboardSupport=t,this.layoutData=i,this._textModelResolverService=n,this._instantiationService=r,this._peekViewService=s,this._uriLabel=a,this._undoRedoService=d,this._keybindingService=l,this._languageService=c,this._languageConfigurationService=h,this._disposeOnNewModel=new y.SL,this._callOnDispose=new y.SL,this._onDidSelectReference=new E.Q5,this.onDidSelectReference=this._onDidSelectReference.event,this._dim=new L.Ro(0,0),this._applyTheme(o.getColorTheme()),this._callOnDispose.add(o.onDidColorThemeChange(this._applyTheme.bind(this))),this._peekViewService.addExclusiveWidget(e,this),this.create()}dispose(){this.setModel(void 0),this._callOnDispose.dispose(),this._disposeOnNewModel.dispose(),(0,y.B9)(this._preview),(0,y.B9)(this._previewNotAvailableMessage),(0,y.B9)(this._tree),(0,y.B9)(this._previewModelReference),this._splitView.dispose(),super.dispose()}_applyTheme(e){const t=e.getColor(b.SC)||T.Il.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(b.KY)||T.Il.transparent,primaryHeadingColor:e.getColor(b.IH),secondaryHeadingColor:e.getColor(b.R7)})}show(e){super.show(e,this.layoutData.heightInLines||18)}focusOnReferenceTree(){this._tree.domFocus()}focusOnPreviewEditor(){this._preview.focus()}isPreviewEditorFocused(){return this._preview.hasTextFocus()}_onTitleClick(e){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:e.ctrlKey||e.metaKey||e.altKey?"side":"open",source:"title"})}_fillBody(e){this.setCssClass("reference-zone-widget"),this._messageContainer=L.R3(e,L.$("div.messages")),L.Cp(this._messageContainer),this._splitView=new I.z(e,{orientation:1}),this._previewContainer=L.R3(e,L.$("div.preview.inline"));const t={scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!0},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}};this._preview=this._instantiationService.createInstance(g.H,this._previewContainer,t,{},this.editor),L.Cp(this._previewContainer),this._previewNotAvailableMessage=new A.yO(w.NC("missingPreviewMessage","no preview available"),H.bd,A.yO.DEFAULT_CREATION_OPTIONS,null,this._undoRedoService,this._languageService,this._languageConfigurationService),this._treeContainer=L.R3(e,L.$("div.ref-tree.inline"));const i={keyboardSupport:this._defaultTreeKeyboardSupport,accessibilityProvider:new re,keyboardNavigationLabelProvider:this._instantiationService.createInstance(Y),identityProvider:new ee,openOnSingleClick:!0,selectionNavigation:!0,overrideStyles:{listBackground:b.M8}};this._defaultTreeKeyboardSupport&&this._callOnDispose.add(L.mu(this._treeContainer,"keydown",(e=>{e.equals(9)&&(this._keybindingService.dispatchEvent(e,e.target),e.stopPropagation())}),!0)),this._tree=this._instantiationService.createInstance(ge,"ReferencesWidget",this._treeContainer,new J,[this._instantiationService.createInstance(ie),this._instantiationService.createInstance(ne)],this._instantiationService.createInstance(X),i),this._splitView.addView({onDidChange:E.ju.None,element:this._previewContainer,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:e=>{this._preview.layout({height:this._dim.height,width:e})}},I.M.Distribute),this._splitView.addView({onDidChange:E.ju.None,element:this._treeContainer,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:e=>{this._treeContainer.style.height=`${this._dim.height}px`,this._treeContainer.style.width=`${e}px`,this._tree.layout(this._dim.height,e)}},I.M.Distribute),this._disposables.add(this._splitView.onDidSashChange((()=>{this._dim.width&&(this.layoutData.ratio=this._splitView.getViewSize(0)/this._dim.width)}),void 0));const o=(e,t)=>{e instanceof x.WX&&("show"===t&&this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:t,source:"tree"}))};this._tree.onDidOpen((e=>{e.sideBySide?o(e.element,"side"):e.editorOptions.pinned?o(e.element,"goto"):o(e.element,"show")})),L.Cp(this._treeContainer)}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._dim=new L.Ro(t,e),this.layoutData.heightInLines=this._viewZone?this._viewZone.heightInLines:this.layoutData.heightInLines,this._splitView.layout(t),this._splitView.resizeView(0,t*this.layoutData.ratio)}setSelection(e){return this._revealReference(e,!0).then((()=>{this._model&&(this._tree.setSelection([e]),this._tree.setFocus([e]))}))}setModel(e){return this._disposeOnNewModel.clear(),this._model=e,this._model?this._onNewModel():Promise.resolve()}_onNewModel(){return this._model?this._model.isEmpty?(this.setTitle(""),this._messageContainer.innerText=w.NC("noResults","No results"),L.$Z(this._messageContainer),Promise.resolve(void 0)):(L.Cp(this._messageContainer),this._decorationsManager=new he(this._preview,this._model),this._disposeOnNewModel.add(this._decorationsManager),this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange((e=>this._tree.rerender(e)))),this._disposeOnNewModel.add(this._preview.onMouseDown((e=>{const{event:t,target:i}=e;if(2!==t.detail)return;const o=this._getFocusedReference();o&&this._onDidSelectReference.fire({element:{uri:o.uri,range:i.range},kind:t.ctrlKey||t.metaKey||t.altKey?"side":"open",source:"editor"})}))),this.container.classList.add("results-loaded"),L.$Z(this._treeContainer),L.$Z(this._previewContainer),this._splitView.layout(this._dim.width),this.focusOnReferenceTree(),this._tree.setInput(1===this._model.groups.length?this._model.groups[0]:this._model)):Promise.resolve(void 0)}_getFocusedReference(){const[e]=this._tree.getFocus();return e instanceof x.WX?e:e instanceof x.F2&&e.children.length>0?e.children[0]:void 0}revealReference(e){return ce(this,void 0,void 0,(function*(){yield this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:"goto",source:"tree"})}))}_revealReference(e,t){return ce(this,void 0,void 0,(function*(){if(this._revealedReference===e)return;this._revealedReference=e,e.uri.scheme!==O.lg.inMemory?this.setTitle((0,F.Hx)(e.uri),this._uriLabel.getUriLabel((0,F.XX)(e.uri))):this.setTitle(w.NC("peekView.alternateTitle","References"));const i=this._textModelResolverService.createModelReference(e.uri);this._tree.getInput()===e.parent||(t&&this._tree.reveal(e.parent),yield this._tree.expand(e.parent)),this._tree.reveal(e);const o=yield i;if(!this._model)return void o.dispose();(0,y.B9)(this._previewModelReference);const n=o.object;if(n){const t=this._preview.getModel()===n.textEditorModel?0:1,i=_.e.lift(e.range).collapseToStart();this._previewModelReference=o,this._preview.setModel(n.textEditorModel),this._preview.setSelection(i),this._preview.revealRangeInCenter(i,t)}else this._preview.setModel(this._previewNotAvailableMessage),o.dispose()}))}};pe=de([le(3,se.XE),le(4,B.S),le(5,k.TG),le(6,b.Fw),le(7,Q.e),le(8,ae.tJ),le(9,j.d),le(10,z.O),le(11,W.c_)],pe);var _e,me=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},ve=function(e,t){return function(i,o){t(i,o,e)}},fe=function(e,t,i,o){function n(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(o.next(e))}catch(t){r(t)}}function a(e){try{d(o["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):n(e.value).then(s,a)}d((o=o.apply(e,t||[])).next())}))};const ye=new D.uy("referenceSearchVisible",!1,w.NC("referenceSearchVisible","Whether reference peek is visible, like 'Peek References' or 'Peek Definition'"));let be=_e=class{static get(e){return e.getContribution(_e.ID)}constructor(e,t,i,o,n,r,s,a){this._defaultTreeKeyboardSupport=e,this._editor=t,this._editorService=o,this._notificationService=n,this._instantiationService=r,this._storageService=s,this._configurationService=a,this._disposables=new y.SL,this._requestIdPool=0,this._ignoreModelChangeEvent=!1,this._referenceSearchVisible=ye.bindTo(i)}dispose(){var e,t;this._referenceSearchVisible.reset(),this._disposables.dispose(),null===(e=this._widget)||void 0===e||e.dispose(),null===(t=this._model)||void 0===t||t.dispose(),this._widget=void 0,this._model=void 0}toggleWidget(e,t,i){let o;if(this._widget&&(o=this._widget.position),this.closeWidget(),o&&e.containsPosition(o))return;this._peekMode=i,this._referenceSearchVisible.set(!0),this._disposables.add(this._editor.onDidChangeModelLanguage((()=>{this.closeWidget()}))),this._disposables.add(this._editor.onDidChangeModel((()=>{this._ignoreModelChangeEvent||this.closeWidget()})));const n="peekViewLayout",r=ue.fromJSON(this._storageService.get(n,0,"{}"));this._widget=this._instantiationService.createInstance(pe,this._editor,this._defaultTreeKeyboardSupport,r),this._widget.setTitle(w.NC("labelLoading","Loading...")),this._widget.show(e),this._disposables.add(this._widget.onDidClose((()=>{t.cancel(),this._widget&&(this._storageService.store(n,JSON.stringify(this._widget.layoutData),0,1),this._widget=void 0),this.closeWidget()}))),this._disposables.add(this._widget.onDidSelectReference((e=>{const{element:t,kind:o}=e;if(t)switch(o){case"open":"editor"===e.source&&this._configurationService.getValue("editor.stablePeek")||this.openReference(t,!1,!1);break;case"side":this.openReference(t,!0,!1);break;case"goto":i?this._gotoReference(t,!0):this.openReference(t,!1,!0);break}})));const s=++this._requestIdPool;t.then((t=>{var i;if(s===this._requestIdPool&&this._widget)return null===(i=this._model)||void 0===i||i.dispose(),this._model=t,this._widget.setModel(this._model).then((()=>{if(this._widget&&this._model&&this._editor.hasModel()){this._model.isEmpty?this._widget.setMetaTitle(""):this._widget.setMetaTitle(w.NC("metaTitle.N","{0} ({1})",this._model.title,this._model.references.length));const t=this._editor.getModel().uri,i=new p.L(e.startLineNumber,e.startColumn),o=this._model.nearestReference(t,i);if(o)return this._widget.setSelection(o).then((()=>{this._widget&&"editor"===this._editor.getOption(86)&&this._widget.focusOnPreviewEditor()}))}}));t.dispose()}),(e=>{this._notificationService.error(e)}))}changeFocusBetweenPreviewAndReferences(){this._widget&&(this._widget.isPreviewEditorFocused()?this._widget.focusOnReferenceTree():this._widget.focusOnPreviewEditor())}goToNextOrPreviousReference(e){return fe(this,void 0,void 0,(function*(){if(!this._editor.hasModel()||!this._model||!this._widget)return;const t=this._widget.position;if(!t)return;const i=this._model.nearestReference(this._editor.getModel().uri,t);if(!i)return;const o=this._model.nextOrPreviousReference(i,e),n=this._editor.hasTextFocus(),r=this._widget.isPreviewEditorFocused();yield this._widget.setSelection(o),yield this._gotoReference(o,!1),n?this._editor.focus():this._widget&&r&&this._widget.focusOnPreviewEditor()}))}revealReference(e){return fe(this,void 0,void 0,(function*(){this._editor.hasModel()&&this._model&&this._widget&&(yield this._widget.revealReference(e))}))}closeWidget(e=!0){var t,i;null===(t=this._widget)||void 0===t||t.dispose(),null===(i=this._model)||void 0===i||i.dispose(),this._referenceSearchVisible.reset(),this._disposables.clear(),this._widget=void 0,this._model=void 0,e&&this._editor.focus(),this._requestIdPool+=1}_gotoReference(e,t){var i;null===(i=this._widget)||void 0===i||i.hide(),this._ignoreModelChangeEvent=!0;const o=_.e.lift(e.range).collapseToStart();return this._editorService.openCodeEditor({resource:e.uri,options:{selection:o,selectionSource:"code.jump",pinned:t}},this._editor).then((e=>{var t;if(this._ignoreModelChangeEvent=!1,e&&this._widget)if(this._editor===e)this._widget.show(o),this._widget.focusOnReferenceTree();else{const i=_e.get(e),n=this._model.clone();this.closeWidget(),e.focus(),null===i||void 0===i||i.toggleWidget(o,(0,r.PG)((e=>Promise.resolve(n))),null!==(t=this._peekMode)&&void 0!==t&&t)}else this.closeWidget()}),(e=>{this._ignoreModelChangeEvent=!1,(0,f.dL)(e)}))}openReference(e,t,i){t||this.closeWidget();const{uri:o,range:n}=e;this._editorService.openCodeEditor({resource:o,options:{selection:n,selectionSource:"code.jump",pinned:i}},this._editor,t)}};function we(e,t){const i=(0,b.rc)(e);if(!i)return;const o=be.get(i);o&&t(o)}be.ID="editor.contrib.referencesController",be=_e=me([ve(2,D.i6),ve(3,u.$),ve(4,P.lT),ve(5,k.TG),ve(6,R.Uy),ve(7,S.Ui)],be),M.W.registerCommandAndKeybindingRule({id:"togglePeekWidgetFocus",weight:100,primary:(0,s.gx)(2089,60),when:D.Ao.or(ye,b.Jy.inPeekEditor),handler(e){we(e,(e=>{e.changeFocusBetweenPreviewAndReferences()}))}}),M.W.registerCommandAndKeybindingRule({id:"goToNextReference",weight:90,primary:62,secondary:[70],when:D.Ao.or(ye,b.Jy.inPeekEditor),handler(e){we(e,(e=>{e.goToNextOrPreviousReference(!0)}))}}),M.W.registerCommandAndKeybindingRule({id:"goToPreviousReference",weight:90,primary:1086,secondary:[1094],when:D.Ao.or(ye,b.Jy.inPeekEditor),handler(e){we(e,(e=>{e.goToNextOrPreviousReference(!1)}))}}),C.P.registerCommandAlias("goToNextReferenceFromEmbeddedEditor","goToNextReference"),C.P.registerCommandAlias("goToPreviousReferenceFromEmbeddedEditor","goToPreviousReference"),C.P.registerCommandAlias("closeReferenceSearchEditor","closeReferenceSearch"),C.P.registerCommand("closeReferenceSearch",(e=>we(e,(e=>e.closeWidget())))),M.W.registerKeybindingRule({id:"closeReferenceSearch",weight:-1,primary:9,secondary:[1033],when:D.Ao.and(b.Jy.inPeekEditor,D.Ao.not("config.editor.stablePeek"))}),M.W.registerKeybindingRule({id:"closeReferenceSearch",weight:250,primary:9,secondary:[1033],when:D.Ao.and(ye,D.Ao.not("config.editor.stablePeek"))}),M.W.registerCommandAndKeybindingRule({id:"revealReference",weight:200,primary:3,mac:{primary:3,secondary:[2066]},when:D.Ao.and(ye,N.CQ,N.PS.negate(),N.uJ.negate()),handler(e){var t;const i=e.get(N.Lw),o=null===(t=i.lastFocusedList)||void 0===t?void 0:t.getFocus();Array.isArray(o)&&o[0]instanceof x.WX&&we(e,(e=>e.revealReference(o[0])))}}),M.W.registerCommandAndKeybindingRule({id:"openReferenceToSide",weight:100,primary:2051,mac:{primary:259},when:D.Ao.and(ye,N.CQ,N.PS.negate(),N.uJ.negate()),handler(e){var t;const i=e.get(N.Lw),o=null===(t=i.lastFocusedList)||void 0===t?void 0:t.getFocus();Array.isArray(o)&&o[0]instanceof x.WX&&we(e,(e=>e.openReference(o[0],!0,!0)))}}),C.P.registerCommand("openReference",(e=>{var t;const i=e.get(N.Lw),o=null===(t=i.lastFocusedList)||void 0===t?void 0:t.getFocus();Array.isArray(o)&&o[0]instanceof x.WX&&we(e,(e=>e.openReference(o[0],!1,!0)))}));var Ce=i(39326),Se=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},De=function(e,t){return function(i,o){t(i,o,e)}};const ke=new D.uy("hasSymbols",!1,(0,w.NC)("hasSymbols","Whether there are symbol locations that can be navigated via keyboard-only.")),Me=(0,k.yh)("ISymbolNavigationService");let Ne=class{constructor(e,t,i,o){this._editorService=t,this._notificationService=i,this._keybindingService=o,this._currentModel=void 0,this._currentIdx=-1,this._ignoreEditorChange=!1,this._ctxHasSymbols=ke.bindTo(e)}reset(){var e,t;this._ctxHasSymbols.reset(),null===(e=this._currentState)||void 0===e||e.dispose(),null===(t=this._currentMessage)||void 0===t||t.dispose(),this._currentModel=void 0,this._currentIdx=-1}put(e){const t=e.parent.parent;if(t.references.length<=1)return void this.reset();this._currentModel=t,this._currentIdx=t.references.indexOf(e),this._ctxHasSymbols.set(!0),this._showMessage();const i=new Pe(this._editorService),o=i.onDidChange((e=>{if(this._ignoreEditorChange)return;const i=this._editorService.getActiveCodeEditor();if(!i)return;const o=i.getModel(),n=i.getPosition();if(!o||!n)return;let r=!1,s=!1;for(const a of t.references)if((0,F.Xy)(a.uri,o.uri))r=!0,s=s||_.e.containsPosition(a.range,n);else if(r)break;r&&s||this.reset()}));this._currentState=(0,y.F8)(i,o)}revealNext(e){if(!this._currentModel)return Promise.resolve();this._currentIdx+=1,this._currentIdx%=this._currentModel.references.length;const t=this._currentModel.references[this._currentIdx];return this._showMessage(),this._ignoreEditorChange=!0,this._editorService.openCodeEditor({resource:t.uri,options:{selection:_.e.collapseToStart(t.range),selectionRevealType:3}},e).finally((()=>{this._ignoreEditorChange=!1}))}_showMessage(){var e;null===(e=this._currentMessage)||void 0===e||e.dispose();const t=this._keybindingService.lookupKeybinding("editor.gotoNextSymbolFromResult"),i=t?(0,w.NC)("location.kb","Symbol {0} of {1}, {2} for next",this._currentIdx+1,this._currentModel.references.length,t.getLabel()):(0,w.NC)("location","Symbol {0} of {1}",this._currentIdx+1,this._currentModel.references.length);this._currentMessage=this._notificationService.status(i)}};Ne=Se([De(0,D.i6),De(1,u.$),De(2,P.lT),De(3,j.d)],Ne),(0,Ce.z)(Me,Ne,1),(0,h.fK)(new class extends h._l{constructor(){super({id:"editor.gotoNextSymbolFromResult",precondition:ke,kbOpts:{weight:100,primary:70}})}runEditorCommand(e,t){return e.get(Me).revealNext(t)}}),M.W.registerCommandAndKeybindingRule({id:"editor.gotoNextSymbolFromResult.cancel",weight:100,when:ke,primary:9,handler(e){e.get(Me).reset()}});let Pe=class{constructor(e){this._listener=new Map,this._disposables=new y.SL,this._onDidChange=new E.Q5,this.onDidChange=this._onDidChange.event,this._disposables.add(e.onCodeEditorRemove(this._onDidRemoveEditor,this)),this._disposables.add(e.onCodeEditorAdd(this._onDidAddEditor,this)),e.listCodeEditors().forEach(this._onDidAddEditor,this)}dispose(){this._disposables.dispose(),this._onDidChange.dispose(),(0,y.B9)(this._listener.values())}_onDidAddEditor(e){this._listener.set(e,(0,y.F8)(e.onDidChangeCursorPosition((t=>this._onDidChange.fire({editor:e}))),e.onDidChangeModelContent((t=>this._onDidChange.fire({editor:e})))))}_onDidRemoveEditor(e){var t;null===(t=this._listener.get(e))||void 0===t||t.dispose(),this._listener.delete(e)}};Pe=Se([De(0,u.$)],Pe);var Re,xe,Le,Ie,Te,Ee,Oe,Fe,Ae=i(11898),We=i(82693),He=i(34679),ze=i(18815),Be=i(16458),Ue=i(39595),Ve=i(29689),Ke=function(e,t,i,o){function n(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(o.next(e))}catch(t){r(t)}}function a(e){try{d(o["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):n(e.value).then(s,a)}d((o=o.apply(e,t||[])).next())}))};We.BH.appendMenuItem(We.eH.EditorContext,{submenu:We.eH.EditorContextPeek,title:w.NC("peek.submenu","Peek"),group:"navigation",order:100});class Ge{static is(e){return!(!e||"object"!==typeof e)&&(e instanceof Ge||!(!p.L.isIPosition(e.position)||!e.model))}constructor(e,t){this.model=e,this.position=t}}class je extends h.x1{static all(){return je._allSymbolNavigationCommands.values()}static _patchConfig(e){const t=Object.assign(Object.assign({},e),{f1:!0});if(t.menu)for(const i of Ue.$.wrap(t.menu))i.id!==We.eH.EditorContext&&i.id!==We.eH.EditorContextPeek||(i.when=D.Ao.and(e.precondition,i.when));return t}constructor(e,t){super(je._patchConfig(t)),this.configuration=e,je._allSymbolNavigationCommands.set(t.id,this)}runEditorCommand(e,t,i,o){if(!t.hasModel())return Promise.resolve(void 0);const s=e.get(P.lT),a=e.get(u.$),d=e.get(He.ek),c=e.get(Me),h=e.get(Be.p),g=e.get(k.TG),p=t.getModel(),_=t.getPosition(),m=Ge.is(i)?i:new Ge(p,_),v=new l.Dl(t,5),f=(0,r.eP)(this._getLocationModel(h,m.model,m.position,v.token),v.token).then((e=>Ke(this,void 0,void 0,(function*(){var r;if(!e||v.token.isCancellationRequested)return;let s;if((0,n.Z9)(e.ariaMessage),e.referenceAt(p.uri,_)){const e=this._getAlternativeCommand(t);!je._activeAlternativeCommands.has(e)&&je._allSymbolNavigationCommands.has(e)&&(s=je._allSymbolNavigationCommands.get(e))}const d=e.references.length;if(0===d){if(!this.configuration.muteMessage){const e=p.getWordAtPosition(_);null===(r=Ae.O.get(t))||void 0===r||r.showMessage(this._getNoResultFoundMessage(e),_)}}else{if(1!==d||!s)return this._onResult(a,c,t,e,o);je._activeAlternativeCommands.add(this.desc.id),g.invokeFunction((e=>s.runEditorCommand(e,t,i,o).finally((()=>{je._activeAlternativeCommands.delete(this.desc.id)}))))}}))),(e=>{s.error(e)})).finally((()=>{v.dispose()}));return d.showWhile(f,250),f}_onResult(e,t,i,o,n){return Ke(this,void 0,void 0,(function*(){const r=this._getGoToPreference(i);if(i instanceof g.H||!(this.configuration.openInPeek||"peek"===r&&o.references.length>1)){const s=o.firstReference(),a=o.references.length>1&&"gotoAndPeek"===r,d=yield this._openReference(i,e,s,this.configuration.openToSide,!a);a&&d?this._openInPeek(d,o,n):o.dispose(),"goto"===r&&t.put(s)}else this._openInPeek(i,o,n)}))}_openReference(e,t,i,o,n){return Ke(this,void 0,void 0,(function*(){let r;if((0,v.vx)(i)&&(r=i.targetSelectionRange),r||(r=i.range),!r)return;const s=yield t.openCodeEditor({resource:i.uri,options:{selection:_.e.collapseToStart(r),selectionRevealType:3,selectionSource:"code.jump"}},e,o);if(s){if(n){const e=s.getModel(),t=s.createDecorationsCollection([{range:r,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout((()=>{s.getModel()===e&&t.clear()}),350)}return s}}))}_openInPeek(e,t,i){const o=be.get(e);o&&e.hasModel()?o.toggleWidget(null!==i&&void 0!==i?i:e.getSelection(),(0,r.PG)((e=>Promise.resolve(t))),this.configuration.openInPeek):t.dispose()}}je._allSymbolNavigationCommands=new Map,je._activeAlternativeCommands=new Set;class Qe extends je{_getLocationModel(e,t,i,o){return Ke(this,void 0,void 0,(function*(){return new x.oQ(yield(0,ze.nD)(e.definitionProvider,t,i,o),w.NC("def.title","Definitions"))}))}_getNoResultFoundMessage(e){return e&&e.word?w.NC("noResultWord","No definition found for '{0}'",e.word):w.NC("generic.noResults","No definition found")}_getAlternativeCommand(e){return e.getOption(58).alternativeDefinitionCommand}_getGoToPreference(e){return e.getOption(58).multipleDefinitions}}(0,We.r1)((Re=class extends Qe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:Re.id,title:{value:w.NC("actions.goToDecl.label","Go to Definition"),original:"Go to Definition",mnemonicTitle:w.NC({key:"miGotoDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Definition")},precondition:D.Ao.and(m.u.hasDefinitionProvider,m.u.isInWalkThroughSnippet.toNegated()),keybinding:[{when:m.u.editorTextFocus,primary:70,weight:100},{when:D.Ao.and(m.u.editorTextFocus,Ve.Pf),primary:2118,weight:100}],menu:[{id:We.eH.EditorContext,group:"navigation",order:1.1},{id:We.eH.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:2}]}),C.P.registerCommandAlias("editor.action.goToDeclaration",Re.id)}},Re.id="editor.action.revealDefinition",Re)),(0,We.r1)((xe=class extends Qe{constructor(){super({openToSide:!0,openInPeek:!1,muteMessage:!1},{id:xe.id,title:{value:w.NC("actions.goToDeclToSide.label","Open Definition to the Side"),original:"Open Definition to the Side"},precondition:D.Ao.and(m.u.hasDefinitionProvider,m.u.isInWalkThroughSnippet.toNegated()),keybinding:[{when:m.u.editorTextFocus,primary:(0,s.gx)(2089,70),weight:100},{when:D.Ao.and(m.u.editorTextFocus,Ve.Pf),primary:(0,s.gx)(2089,2118),weight:100}]}),C.P.registerCommandAlias("editor.action.openDeclarationToTheSide",xe.id)}},xe.id="editor.action.revealDefinitionAside",xe)),(0,We.r1)((Le=class extends Qe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:Le.id,title:{value:w.NC("actions.previewDecl.label","Peek Definition"),original:"Peek Definition"},precondition:D.Ao.and(m.u.hasDefinitionProvider,b.Jy.notInPeekEditor,m.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:m.u.editorTextFocus,primary:582,linux:{primary:3140},weight:100},menu:{id:We.eH.EditorContextPeek,group:"peek",order:2}}),C.P.registerCommandAlias("editor.action.previewDeclaration",Le.id)}},Le.id="editor.action.peekDefinition",Le));class $e extends je{_getLocationModel(e,t,i,o){return Ke(this,void 0,void 0,(function*(){return new x.oQ(yield(0,ze.zq)(e.declarationProvider,t,i,o),w.NC("decl.title","Declarations"))}))}_getNoResultFoundMessage(e){return e&&e.word?w.NC("decl.noResultWord","No declaration found for '{0}'",e.word):w.NC("decl.generic.noResults","No declaration found")}_getAlternativeCommand(e){return e.getOption(58).alternativeDeclarationCommand}_getGoToPreference(e){return e.getOption(58).multipleDeclarations}}(0,We.r1)((Ie=class extends $e{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:Ie.id,title:{value:w.NC("actions.goToDeclaration.label","Go to Declaration"),original:"Go to Declaration",mnemonicTitle:w.NC({key:"miGotoDeclaration",comment:["&& denotes a mnemonic"]},"Go to &&Declaration")},precondition:D.Ao.and(m.u.hasDeclarationProvider,m.u.isInWalkThroughSnippet.toNegated()),menu:[{id:We.eH.EditorContext,group:"navigation",order:1.3},{id:We.eH.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}_getNoResultFoundMessage(e){return e&&e.word?w.NC("decl.noResultWord","No declaration found for '{0}'",e.word):w.NC("decl.generic.noResults","No declaration found")}},Ie.id="editor.action.revealDeclaration",Ie)),(0,We.r1)(class extends $e{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.peekDeclaration",title:{value:w.NC("actions.peekDecl.label","Peek Declaration"),original:"Peek Declaration"},precondition:D.Ao.and(m.u.hasDeclarationProvider,b.Jy.notInPeekEditor,m.u.isInWalkThroughSnippet.toNegated()),menu:{id:We.eH.EditorContextPeek,group:"peek",order:3}})}});class Ze extends je{_getLocationModel(e,t,i,o){return Ke(this,void 0,void 0,(function*(){return new x.oQ(yield(0,ze.L3)(e.typeDefinitionProvider,t,i,o),w.NC("typedef.title","Type Definitions"))}))}_getNoResultFoundMessage(e){return e&&e.word?w.NC("goToTypeDefinition.noResultWord","No type definition found for '{0}'",e.word):w.NC("goToTypeDefinition.generic.noResults","No type definition found")}_getAlternativeCommand(e){return e.getOption(58).alternativeTypeDefinitionCommand}_getGoToPreference(e){return e.getOption(58).multipleTypeDefinitions}}(0,We.r1)((Te=class extends Ze{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:Te.ID,title:{value:w.NC("actions.goToTypeDefinition.label","Go to Type Definition"),original:"Go to Type Definition",mnemonicTitle:w.NC({key:"miGotoTypeDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Type Definition")},precondition:D.Ao.and(m.u.hasTypeDefinitionProvider,m.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:m.u.editorTextFocus,primary:0,weight:100},menu:[{id:We.eH.EditorContext,group:"navigation",order:1.4},{id:We.eH.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}},Te.ID="editor.action.goToTypeDefinition",Te)),(0,We.r1)((Ee=class extends Ze{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:Ee.ID,title:{value:w.NC("actions.peekTypeDefinition.label","Peek Type Definition"),original:"Peek Type Definition"},precondition:D.Ao.and(m.u.hasTypeDefinitionProvider,b.Jy.notInPeekEditor,m.u.isInWalkThroughSnippet.toNegated()),menu:{id:We.eH.EditorContextPeek,group:"peek",order:4}})}},Ee.ID="editor.action.peekTypeDefinition",Ee));class qe extends je{_getLocationModel(e,t,i,o){return Ke(this,void 0,void 0,(function*(){return new x.oQ(yield(0,ze.f4)(e.implementationProvider,t,i,o),w.NC("impl.title","Implementations"))}))}_getNoResultFoundMessage(e){return e&&e.word?w.NC("goToImplementation.noResultWord","No implementation found for '{0}'",e.word):w.NC("goToImplementation.generic.noResults","No implementation found")}_getAlternativeCommand(e){return e.getOption(58).alternativeImplementationCommand}_getGoToPreference(e){return e.getOption(58).multipleImplementations}}(0,We.r1)((Oe=class extends qe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:Oe.ID,title:{value:w.NC("actions.goToImplementation.label","Go to Implementations"),original:"Go to Implementations",mnemonicTitle:w.NC({key:"miGotoImplementation",comment:["&& denotes a mnemonic"]},"Go to &&Implementations")},precondition:D.Ao.and(m.u.hasImplementationProvider,m.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:m.u.editorTextFocus,primary:2118,weight:100},menu:[{id:We.eH.EditorContext,group:"navigation",order:1.45},{id:We.eH.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:4}]})}},Oe.ID="editor.action.goToImplementation",Oe)),(0,We.r1)((Fe=class extends qe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:Fe.ID,title:{value:w.NC("actions.peekImplementation.label","Peek Implementations"),original:"Peek Implementations"},precondition:D.Ao.and(m.u.hasImplementationProvider,b.Jy.notInPeekEditor,m.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:m.u.editorTextFocus,primary:3142,weight:100},menu:{id:We.eH.EditorContextPeek,group:"peek",order:5}})}},Fe.ID="editor.action.peekImplementation",Fe));class Xe extends je{_getNoResultFoundMessage(e){return e?w.NC("references.no","No references found for '{0}'",e.word):w.NC("references.noGeneric","No references found")}_getAlternativeCommand(e){return e.getOption(58).alternativeReferenceCommand}_getGoToPreference(e){return e.getOption(58).multipleReferences}}(0,We.r1)(class extends Xe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:"editor.action.goToReferences",title:{value:w.NC("goToReferences.label","Go to References"),original:"Go to References",mnemonicTitle:w.NC({key:"miGotoReference",comment:["&& denotes a mnemonic"]},"Go to &&References")},precondition:D.Ao.and(m.u.hasReferenceProvider,b.Jy.notInPeekEditor,m.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:m.u.editorTextFocus,primary:1094,weight:100},menu:[{id:We.eH.EditorContext,group:"navigation",order:1.45},{id:We.eH.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:5}]})}_getLocationModel(e,t,i,o){return Ke(this,void 0,void 0,(function*(){return new x.oQ(yield(0,ze.aA)(e.referenceProvider,t,i,!0,o),w.NC("ref.title","References"))}))}}),(0,We.r1)(class extends Xe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.referenceSearch.trigger",title:{value:w.NC("references.action.label","Peek References"),original:"Peek References"},precondition:D.Ao.and(m.u.hasReferenceProvider,b.Jy.notInPeekEditor,m.u.isInWalkThroughSnippet.toNegated()),menu:{id:We.eH.EditorContextPeek,group:"peek",order:6}})}_getLocationModel(e,t,i,o){return Ke(this,void 0,void 0,(function*(){return new x.oQ(yield(0,ze.aA)(e.referenceProvider,t,i,!1,o),w.NC("ref.title","References"))}))}});class Je extends je{constructor(e,t,i){super(e,{id:"editor.action.goToLocation",title:{value:w.NC("label.generic","Go to Any Symbol"),original:"Go to Any Symbol"},precondition:D.Ao.and(b.Jy.notInPeekEditor,m.u.isInWalkThroughSnippet.toNegated())}),this._references=t,this._gotoMultipleBehaviour=i}_getLocationModel(e,t,i,o){return Ke(this,void 0,void 0,(function*(){return new x.oQ(this._references,w.NC("generic.title","Locations"))}))}_getNoResultFoundMessage(e){return e&&w.NC("generic.noResult","No results for '{0}'",e.word)||""}_getGoToPreference(e){var t;return null!==(t=this._gotoMultipleBehaviour)&&void 0!==t?t:e.getOption(58).multipleReferences}_getAlternativeCommand(){return""}}C.P.registerCommand({id:"editor.action.goToLocations",description:{description:"Go to locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:d.o},{name:"position",description:"The position at which to start",constraint:p.L.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"},{name:"noResultsMessage",description:"Human readable message that shows when locations is empty."}]},handler:(e,t,i,o,n,r,s)=>Ke(void 0,void 0,void 0,(function*(){(0,a.p_)(d.o.isUri(t)),(0,a.p_)(p.L.isIPosition(i)),(0,a.p_)(Array.isArray(o)),(0,a.p_)("undefined"===typeof n||"string"===typeof n),(0,a.p_)("undefined"===typeof s||"boolean"===typeof s);const l=e.get(u.$),h=yield l.openCodeEditor({resource:t},l.getFocusedCodeEditor());if((0,c.CL)(h))return h.setPosition(i),h.revealPositionInCenterIfOutsideViewport(i,0),h.invokeWithinContext((e=>{const t=new class extends Je{_getNoResultFoundMessage(e){return r||super._getNoResultFoundMessage(e)}}({muteMessage:!Boolean(r),openInPeek:Boolean(s),openToSide:!1},o,n);e.get(k.TG).invokeFunction(t.run.bind(t),h)}))}))}),C.P.registerCommand({id:"editor.action.peekLocations",description:{description:"Peek locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:d.o},{name:"position",description:"The position at which to start",constraint:p.L.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"}]},handler:(e,t,i,o,n)=>Ke(void 0,void 0,void 0,(function*(){e.get(C.H).executeCommand("editor.action.goToLocations",t,i,o,n,void 0,!0)}))}),C.P.registerCommand({id:"editor.action.findReferences",handler:(e,t,i)=>{(0,a.p_)(d.o.isUri(t)),(0,a.p_)(p.L.isIPosition(i));const o=e.get(Be.p),n=e.get(u.$);return n.openCodeEditor({resource:t},n.getFocusedCodeEditor()).then((e=>{if(!(0,c.CL)(e)||!e.hasModel())return;const t=be.get(e);if(!t)return;const n=(0,r.PG)((t=>(0,ze.aA)(o.referenceProvider,e.getModel(),p.L.lift(i),!1,t).then((e=>new x.oQ(e,w.NC("ref.title","References")))))),s=new _.e(i.lineNumber,i.column,i.lineNumber,i.column);return Promise.resolve(t.toggleWidget(s,n,!1))}))}}),C.P.registerCommandAlias("editor.action.showReferences","editor.action.peekLocations")},18815:(e,t,i)=>{i.d(t,{L3:()=>p,aA:()=>_,f4:()=>g,nD:()=>h,zq:()=>u});var o=i(21921),n=i(55191),r=i(98642),s=i(48077),a=i(16458),d=i(7316),l=function(e,t,i,o){function n(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(o.next(e))}catch(t){r(t)}}function a(e){try{d(o["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):n(e.value).then(s,a)}d((o=o.apply(e,t||[])).next())}))};function c(e,t,i,n){return l(this,void 0,void 0,(function*(){const s=i.ordered(e),a=s.map((i=>Promise.resolve(n(i,e,t)).then(void 0,(e=>{(0,r.Cp)(e)})))),d=yield Promise.all(a);return(0,o.kX)(d.flat())}))}function h(e,t,i,o){return c(t,i,e,((e,t,i)=>e.provideDefinition(t,i,o)))}function u(e,t,i,o){return c(t,i,e,((e,t,i)=>e.provideDeclaration(t,i,o)))}function g(e,t,i,o){return c(t,i,e,((e,t,i)=>e.provideImplementation(t,i,o)))}function p(e,t,i,o){return c(t,i,e,((e,t,i)=>e.provideTypeDefinition(t,i,o)))}function _(e,t,i,o,n){return c(t,i,e,((e,t,i)=>l(this,void 0,void 0,(function*(){const r=yield e.provideReferences(t,i,{includeDeclaration:!0},n);if(!o||!r||2!==r.length)return r;const s=yield e.provideReferences(t,i,{includeDeclaration:!1},n);return s&&1===s.length?s:r}))))}function m(e){return l(this,void 0,void 0,(function*(){const t=yield e(),i=new d.oQ(t,""),o=i.references.map((e=>e.link));return i.dispose(),o}))}(0,s.sb)("_executeDefinitionProvider",((e,t,i)=>{const o=e.get(a.p),r=h(o.definitionProvider,t,i,n.T.None);return m((()=>r))})),(0,s.sb)("_executeTypeDefinitionProvider",((e,t,i)=>{const o=e.get(a.p),r=p(o.typeDefinitionProvider,t,i,n.T.None);return m((()=>r))})),(0,s.sb)("_executeDeclarationProvider",((e,t,i)=>{const o=e.get(a.p),r=u(o.declarationProvider,t,i,n.T.None);return m((()=>r))})),(0,s.sb)("_executeReferenceProvider",((e,t,i)=>{const o=e.get(a.p),r=_(o.referenceProvider,t,i,!1,n.T.None);return m((()=>r))})),(0,s.sb)("_executeImplementationProvider",((e,t,i)=>{const o=e.get(a.p),r=g(o.implementationProvider,t,i,n.T.None);return m((()=>r))}))},28130:(e,t,i)=>{i.d(t,{yN:()=>h});var o=i(11271),n=i(70959),r=i(47606);function s(e,t){return!!e[t]}class a{constructor(e,t){this.target=e.target,this.isLeftClick=e.event.leftButton,this.isMiddleClick=e.event.middleButton,this.isRightClick=e.event.rightButton,this.hasTriggerModifier=s(e.event,t.triggerModifier),this.hasSideBySideModifier=s(e.event,t.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=e.event.detail<=1}}class d{constructor(e,t){this.keyCodeIsTriggerKey=e.keyCode===t.triggerKey,this.keyCodeIsSideBySideKey=e.keyCode===t.triggerSideBySideKey,this.hasTriggerModifier=s(e,t.triggerModifier)}}class l{constructor(e,t,i,o){this.triggerKey=e,this.triggerModifier=t,this.triggerSideBySideKey=i,this.triggerSideBySideModifier=o}equals(e){return this.triggerKey===e.triggerKey&&this.triggerModifier===e.triggerModifier&&this.triggerSideBySideKey===e.triggerSideBySideKey&&this.triggerSideBySideModifier===e.triggerSideBySideModifier}}function c(e){return"altKey"===e?r.dz?new l(57,"metaKey",6,"altKey"):new l(5,"ctrlKey",6,"altKey"):r.dz?new l(6,"altKey",57,"metaKey"):new l(6,"altKey",5,"ctrlKey")}class h extends n.JT{constructor(e,t){var i;super(),this._onMouseMoveOrRelevantKeyDown=this._register(new o.Q5),this.onMouseMoveOrRelevantKeyDown=this._onMouseMoveOrRelevantKeyDown.event,this._onExecute=this._register(new o.Q5),this.onExecute=this._onExecute.event,this._onCancel=this._register(new o.Q5),this.onCancel=this._onCancel.event,this._editor=e,this._extractLineNumberFromMouseEvent=null!==(i=null===t||void 0===t?void 0:t.extractLineNumberFromMouseEvent)&&void 0!==i?i:e=>e.target.position?e.target.position.lineNumber:0,this._opts=c(this._editor.getOption(77)),this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._register(this._editor.onDidChangeConfiguration((e=>{if(e.hasChanged(77)){const e=c(this._editor.getOption(77));if(this._opts.equals(e))return;this._opts=e,this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._onCancel.fire()}}))),this._register(this._editor.onMouseMove((e=>this._onEditorMouseMove(new a(e,this._opts))))),this._register(this._editor.onMouseDown((e=>this._onEditorMouseDown(new a(e,this._opts))))),this._register(this._editor.onMouseUp((e=>this._onEditorMouseUp(new a(e,this._opts))))),this._register(this._editor.onKeyDown((e=>this._onEditorKeyDown(new d(e,this._opts))))),this._register(this._editor.onKeyUp((e=>this._onEditorKeyUp(new d(e,this._opts))))),this._register(this._editor.onMouseDrag((()=>this._resetHandler()))),this._register(this._editor.onDidChangeCursorSelection((e=>this._onDidChangeCursorSelection(e)))),this._register(this._editor.onDidChangeModel((e=>this._resetHandler()))),this._register(this._editor.onDidChangeModelContent((()=>this._resetHandler()))),this._register(this._editor.onDidScrollChange((e=>{(e.scrollTopChanged||e.scrollLeftChanged)&&this._resetHandler()})))}_onDidChangeCursorSelection(e){e.selection&&e.selection.startColumn!==e.selection.endColumn&&this._resetHandler()}_onEditorMouseMove(e){this._lastMouseMoveEvent=e,this._onMouseMoveOrRelevantKeyDown.fire([e,null])}_onEditorMouseDown(e){this._hasTriggerKeyOnMouseDown=e.hasTriggerModifier,this._lineNumberOnMouseDown=this._extractLineNumberFromMouseEvent(e)}_onEditorMouseUp(e){const t=this._extractLineNumberFromMouseEvent(e);this._hasTriggerKeyOnMouseDown&&this._lineNumberOnMouseDown&&this._lineNumberOnMouseDown===t&&this._onExecute.fire(e)}_onEditorKeyDown(e){this._lastMouseMoveEvent&&(e.keyCodeIsTriggerKey||e.keyCodeIsSideBySideKey&&e.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent,e]):e.hasTriggerModifier&&this._onCancel.fire()}_onEditorKeyUp(e){e.keyCodeIsTriggerKey&&this._onCancel.fire()}_resetHandler(){this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}}},20713:(e,t,i)=>{i.d(t,{S:()=>D});var o,n=i(85398),r=i(98642),s=i(81478),a=i(70959),d=i(39363),l=i(48077),c=i(33162),h=i(61141),u=i(15498),g=i(28130),p=i(78097),_=i(25206),m=i(37174),v=i(68703),f=i(18815),y=i(16458),b=i(16375),w=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},C=function(e,t){return function(i,o){t(i,o,e)}},S=function(e,t,i,o){function n(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(o.next(e))}catch(t){r(t)}}function a(e){try{d(o["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):n(e.value).then(s,a)}d((o=o.apply(e,t||[])).next())}))};let D=o=class{constructor(e,t,i,o){this.textModelResolverService=t,this.languageService=i,this.languageFeaturesService=o,this.toUnhook=new a.SL,this.toUnhookForKeyboard=new a.SL,this.currentWordAtPosition=null,this.previousPromise=null,this.editor=e,this.linkDecorations=this.editor.createDecorationsCollection();const n=new g.yN(e);this.toUnhook.add(n),this.toUnhook.add(n.onMouseMoveOrRelevantKeyDown((([e,t])=>{this.startFindDefinitionFromMouse(e,null!==t&&void 0!==t?t:void 0)}))),this.toUnhook.add(n.onExecute((e=>{this.isEnabled(e)&&this.gotoDefinition(e.target.position,e.hasSideBySideModifier).catch((e=>{(0,r.dL)(e)})).finally((()=>{this.removeLinkDecorations()}))}))),this.toUnhook.add(n.onCancel((()=>{this.removeLinkDecorations(),this.currentWordAtPosition=null})))}static get(e){return e.getContribution(o.ID)}startFindDefinitionFromCursor(e){return S(this,void 0,void 0,(function*(){yield this.startFindDefinition(e),this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition((()=>{this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear()}))),this.toUnhookForKeyboard.add(this.editor.onKeyDown((e=>{e&&(this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear())})))}))}startFindDefinitionFromMouse(e,t){if(9===e.target.type&&this.linkDecorations.length>0)return;if(!this.editor.hasModel()||!this.isEnabled(e,t))return this.currentWordAtPosition=null,void this.removeLinkDecorations();const i=e.target.position;this.startFindDefinition(i)}startFindDefinition(e){var t;return S(this,void 0,void 0,(function*(){this.toUnhookForKeyboard.clear();const i=e?null===(t=this.editor.getModel())||void 0===t?void 0:t.getWordAtPosition(e):null;if(!i)return this.currentWordAtPosition=null,void this.removeLinkDecorations();if(this.currentWordAtPosition&&this.currentWordAtPosition.startColumn===i.startColumn&&this.currentWordAtPosition.endColumn===i.endColumn&&this.currentWordAtPosition.word===i.word)return;this.currentWordAtPosition=i;const o=new d.yy(this.editor,15);let a;this.previousPromise&&(this.previousPromise.cancel(),this.previousPromise=null),this.previousPromise=(0,n.PG)((t=>this.findDefinition(e,t)));try{a=yield this.previousPromise}catch(h){return void(0,r.dL)(h)}if(!a||!a.length||!o.validate(this.editor))return void this.removeLinkDecorations();const l=a[0].originSelectionRange?c.e.lift(a[0].originSelectionRange):new c.e(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn);if(a.length>1){let e=l;for(const{originSelectionRange:t}of a)t&&(e=c.e.plusRange(e,t));this.addDecoration(e,(new s.W5).appendText(_.NC("multipleResults","Click to show {0} definitions.",a.length)))}else{const e=a[0];if(!e.uri)return;this.textModelResolverService.createModelReference(e.uri).then((t=>{if(!t.object||!t.object.textEditorModel)return void t.dispose();const{object:{textEditorModel:i}}=t,{startLineNumber:o}=e.range;if(o<1||o>i.getLineCount())return void t.dispose();const n=this.getPreviewValue(i,o,e),r=this.languageService.guessLanguageIdByFilepathOrFirstLine(i.uri);this.addDecoration(l,n?(new s.W5).appendCodeblock(r||"",n):void 0),t.dispose()}))}}))}getPreviewValue(e,t,i){let n=i.range;const r=n.endLineNumber-n.startLineNumber;r>=o.MAX_SOURCE_PREVIEW_LINES&&(n=this.getPreviewRangeBasedOnIndentation(e,t));const s=this.stripIndentationFromPreviewRange(e,t,n);return s}stripIndentationFromPreviewRange(e,t,i){const o=e.getLineFirstNonWhitespaceColumn(t);let n=o;for(let s=t+1;s<i.endLineNumber;s++){const t=e.getLineFirstNonWhitespaceColumn(s);n=Math.min(n,t)}const r=e.getValueInRange(i).replace(new RegExp(`^\\s{${n-1}}`,"gm"),"").trim();return r}getPreviewRangeBasedOnIndentation(e,t){const i=e.getLineFirstNonWhitespaceColumn(t),n=Math.min(e.getLineCount(),t+o.MAX_SOURCE_PREVIEW_LINES);let r=t+1;for(;r<n;r++){const t=e.getLineFirstNonWhitespaceColumn(r);if(i===t)break}return new c.e(t,1,r+1,1)}addDecoration(e,t){const i={range:e,options:{description:"goto-definition-link",inlineClassName:"goto-definition-link",hoverMessage:t}};this.linkDecorations.set([i])}removeLinkDecorations(){this.linkDecorations.clear()}isEnabled(e,t){var i;return this.editor.hasModel()&&e.isLeftClick&&e.isNoneOrSingleMouseDown&&6===e.target.type&&!((null===(i=e.target.detail.injectedText)||void 0===i?void 0:i.options)instanceof b.HS)&&(e.hasTriggerModifier||!!t&&t.keyCodeIsTriggerKey)&&this.languageFeaturesService.definitionProvider.has(this.editor.getModel())}findDefinition(e,t){const i=this.editor.getModel();return i?(0,f.nD)(this.languageFeaturesService.definitionProvider,i,e,t):Promise.resolve(null)}gotoDefinition(e,t){return this.editor.setPosition(e),this.editor.invokeWithinContext((e=>{const i=!t&&this.editor.getOption(87)&&!this.isInPeekEditor(e),o=new v.BT({openToSide:t,openInPeek:i,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0});return o.run(e)}))}isInPeekEditor(e){const t=e.get(m.i6);return p.Jy.inPeekEditor.getValue(t)}dispose(){this.toUnhook.dispose(),this.toUnhookForKeyboard.dispose()}};D.ID="editor.contrib.gotodefinitionatposition",D.MAX_SOURCE_PREVIEW_LINES=8,D=o=w([C(1,u.S),C(2,h.O),C(3,y.p)],D),(0,l._K)(D.ID,D,2)},7316:(e,t,i)=>{i.d(t,{F2:()=>_,WX:()=>g,oQ:()=>m});var o=i(98642),n=i(11271),r=i(58247),s=i(70959),a=i(71400),d=i(21230),l=i(61720),c=i(33162),h=i(25206),u=function(e,t,i,o){function n(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(o.next(e))}catch(t){r(t)}}function a(e){try{d(o["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):n(e.value).then(s,a)}d((o=o.apply(e,t||[])).next())}))};class g{constructor(e,t,i,o){this.isProviderFirst=e,this.parent=t,this.link=i,this._rangeCallback=o,this.id=r.a.nextId()}get uri(){return this.link.uri}get range(){var e,t;return null!==(t=null!==(e=this._range)&&void 0!==e?e:this.link.targetSelectionRange)&&void 0!==t?t:this.link.range}set range(e){this._range=e,this._rangeCallback(this)}get ariaMessage(){var e;const t=null===(e=this.parent.getPreview(this))||void 0===e?void 0:e.preview(this.range);return t?(0,h.NC)({key:"aria.oneReference.preview",comment:["Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code"]},"{0} in {1} on line {2} at column {3}",t.value,(0,d.EZ)(this.uri),this.range.startLineNumber,this.range.startColumn):(0,h.NC)("aria.oneReference","in {0} on line {1} at column {2}",(0,d.EZ)(this.uri),this.range.startLineNumber,this.range.startColumn)}}class p{constructor(e){this._modelReference=e}dispose(){this._modelReference.dispose()}preview(e,t=8){const i=this._modelReference.object.textEditorModel;if(!i)return;const{startLineNumber:o,startColumn:n,endLineNumber:r,endColumn:s}=e,a=i.getWordUntilPosition({lineNumber:o,column:n-t}),d=new c.e(o,a.startColumn,o,n),l=new c.e(r,s,r,1073741824),h=i.getValueInRange(d).replace(/^\s+/,""),u=i.getValueInRange(e),g=i.getValueInRange(l).replace(/\s+$/,"");return{value:h+u+g,highlight:{start:h.length,end:h.length+u.length}}}}class _{constructor(e,t){this.parent=e,this.uri=t,this.children=[],this._previews=new a.Y9}dispose(){(0,s.B9)(this._previews.values()),this._previews.clear()}getPreview(e){return this._previews.get(e.uri)}get ariaMessage(){const e=this.children.length;return 1===e?(0,h.NC)("aria.fileReferences.1","1 symbol in {0}, full path {1}",(0,d.EZ)(this.uri),this.uri.fsPath):(0,h.NC)("aria.fileReferences.N","{0} symbols in {1}, full path {2}",e,(0,d.EZ)(this.uri),this.uri.fsPath)}resolve(e){return u(this,void 0,void 0,(function*(){if(0!==this._previews.size)return this;for(const i of this.children)if(!this._previews.has(i.uri))try{const t=yield e.createModelReference(i.uri);this._previews.set(i.uri,new p(t))}catch(t){(0,o.dL)(t)}return this}))}}class m{constructor(e,t){this.groups=[],this.references=[],this._onDidChangeReferenceRange=new n.Q5,this.onDidChangeReferenceRange=this._onDidChangeReferenceRange.event,this._links=e,this._title=t;const[i]=e;let o;e.sort(m._compareReferences);for(const n of e)if(o&&d.SF.isEqual(o.uri,n.uri,!0)||(o=new _(this,n.uri),this.groups.push(o)),0===o.children.length||0!==m._compareReferences(n,o.children[o.children.length-1])){const e=new g(i===n,o,n,(e=>this._onDidChangeReferenceRange.fire(e)));this.references.push(e),o.children.push(e)}}dispose(){(0,s.B9)(this.groups),this._onDidChangeReferenceRange.dispose(),this.groups.length=0}clone(){return new m(this._links,this._title)}get title(){return this._title}get isEmpty(){return 0===this.groups.length}get ariaMessage(){return this.isEmpty?(0,h.NC)("aria.result.0","No results found"):1===this.references.length?(0,h.NC)("aria.result.1","Found 1 symbol in {0}",this.references[0].uri.fsPath):1===this.groups.length?(0,h.NC)("aria.result.n1","Found {0} symbols in {1}",this.references.length,this.groups[0].uri.fsPath):(0,h.NC)("aria.result.nm","Found {0} symbols in {1} files",this.references.length,this.groups.length)}nextOrPreviousReference(e,t){const{parent:i}=e;let o=i.children.indexOf(e);const n=i.children.length,r=i.parent.groups.length;return 1===r||t&&o+1<n||!t&&o>0?(o=t?(o+1)%n:(o+n-1)%n,i.children[o]):(o=i.parent.groups.indexOf(i),t?(o=(o+1)%r,i.parent.groups[o].children[0]):(o=(o+r-1)%r,i.parent.groups[o].children[i.parent.groups[o].children.length-1]))}nearestReference(e,t){const i=this.references.map(((i,o)=>({idx:o,prefixLen:l.Mh(i.uri.toString(),e.toString()),offsetDist:100*Math.abs(i.range.startLineNumber-t.lineNumber)+Math.abs(i.range.startColumn-t.column)}))).sort(((e,t)=>e.prefixLen>t.prefixLen?-1:e.prefixLen<t.prefixLen?1:e.offsetDist<t.offsetDist?-1:e.offsetDist>t.offsetDist?1:0))[0];if(i)return this.references[i.idx]}referenceAt(e,t){for(const i of this.references)if(i.uri.toString()===e.toString()&&c.e.containsPosition(i.range,t))return i}firstReference(){for(const e of this.references)if(e.isProviderFirst)return e;return this.references[0]}static _compareReferences(e,t){return d.SF.compare(e.uri,t.uri)||c.e.compareRangesUsingStarts(e.range,t.range)}}},48864:(e,t,i)=>{i.d(t,{R8:()=>h});var o=i(85398),n=i(55191),r=i(98642),s=i(48077),a=i(16458),d=function(e,t,i,o){function n(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(o.next(e))}catch(t){r(t)}}function a(e){try{d(o["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):n(e.value).then(s,a)}d((o=o.apply(e,t||[])).next())}))};class l{constructor(e,t,i){this.provider=e,this.hover=t,this.ordinal=i}}function c(e,t,i,o,n){return d(this,void 0,void 0,(function*(){try{const r=yield Promise.resolve(e.provideHover(i,o,n));if(r&&g(r))return new l(e,r,t)}catch(s){(0,r.Cp)(s)}}))}function h(e,t,i,n){const r=e.ordered(t),s=r.map(((e,o)=>c(e,o,t,i,n)));return o.Aq.fromPromises(s).coalesce()}function u(e,t,i,o){return h(e,t,i,o).map((e=>e.hover)).toPromise()}function g(e){const t="undefined"!==typeof e.range,i="undefined"!==typeof e.contents&&e.contents&&e.contents.length>0;return t&&i}(0,s.sb)("_executeHoverProvider",((e,t,i)=>{const o=e.get(a.p);return u(o.hoverProvider,t,i,n.T.None)}))},31089:(e,t,i)=>{var o=i(56082),n=i(70959),r=i(48077),s=i(33162),a=i(44950),d=i(61141),l=i(20713),c=i(2548),h=i(90422),u=i(21921),g=i(89999),p=i(16375),_=i(67026),m=i(85398),v=i(98642),f=i(11271),y=function(e,t,i,o){function n(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(o.next(e))}catch(t){r(t)}}function a(e){try{d(o["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):n(e.value).then(s,a)}d((o=o.apply(e,t||[])).next())}))},b=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e="function"===typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(i){t[i]=e[i]&&function(t){return new Promise((function(o,r){t=e[i](t),n(o,r,t.done,t.value)}))}}function n(e,t,i,o){Promise.resolve(o).then((function(t){e({value:t,done:i})}),t)}};class w{constructor(e,t,i){this.value=e,this.isComplete=t,this.hasLoadingMessage=i}}class C extends n.JT{constructor(e,t){super(),this._editor=e,this._computer=t,this._onResult=this._register(new f.Q5),this.onResult=this._onResult.event,this._firstWaitScheduler=this._register(new m.pY((()=>this._triggerAsyncComputation()),0)),this._secondWaitScheduler=this._register(new m.pY((()=>this._triggerSyncComputation()),0)),this._loadingMessageScheduler=this._register(new m.pY((()=>this._triggerLoadingMessage()),0)),this._state=0,this._asyncIterable=null,this._asyncIterableDone=!1,this._result=[]}dispose(){this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),super.dispose()}get _hoverTime(){return this._editor.getOption(60).delay}get _firstWaitTime(){return this._hoverTime/2}get _secondWaitTime(){return this._hoverTime-this._firstWaitTime}get _loadingMessageTime(){return 3*this._hoverTime}_setState(e,t=!0){this._state=e,t&&this._fireResult()}_triggerAsyncComputation(){this._setState(2),this._secondWaitScheduler.schedule(this._secondWaitTime),this._computer.computeAsync?(this._asyncIterableDone=!1,this._asyncIterable=(0,m.zS)((e=>this._computer.computeAsync(e))),(()=>{y(this,void 0,void 0,(function*(){var e,t,i,o;try{try{for(var n,r=!0,s=b(this._asyncIterable);n=yield s.next(),e=n.done,!e;r=!0){o=n.value,r=!1;const e=o;e&&(this._result.push(e),this._fireResult())}}catch(a){t={error:a}}finally{try{r||e||!(i=s.return)||(yield i.call(s))}finally{if(t)throw t.error}}this._asyncIterableDone=!0,3!==this._state&&4!==this._state||this._setState(0)}catch(d){(0,v.dL)(d)}}))})()):this._asyncIterableDone=!0}_triggerSyncComputation(){this._computer.computeSync&&(this._result=this._result.concat(this._computer.computeSync())),this._setState(this._asyncIterableDone?0:3)}_triggerLoadingMessage(){3===this._state&&this._setState(4)}_fireResult(){if(1===this._state||2===this._state)return;const e=0===this._state,t=4===this._state;this._onResult.fire(new w(this._result.slice(0),e,t))}start(e){if(0===e)0===this._state&&(this._setState(1),this._firstWaitScheduler.schedule(this._firstWaitTime),this._loadingMessageScheduler.schedule(this._loadingMessageTime));else switch(this._state){case 0:this._triggerAsyncComputation(),this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break;case 2:this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break}}cancel(){this._firstWaitScheduler.cancel(),this._secondWaitScheduler.cancel(),this._loadingMessageScheduler.cancel(),this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),this._result=[],this._setState(0,!1)}}var S=i(97791),D=i(21881),k=i(15285),M=i(37174),N=i(83950);const P=30,R=24;class x extends n.JT{constructor(e,t=new c.Ro(10,10)){super(),this._editor=e,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._resizableNode=this._register(new N.f),this._contentPosition=null,this._isResizing=!1,this._resizableNode.domNode.style.position="absolute",this._resizableNode.minSize=c.Ro.lift(t),this._resizableNode.layout(t.height,t.width),this._resizableNode.enableSashes(!0,!0,!0,!0),this._register(this._resizableNode.onDidResize((e=>{this._resize(new c.Ro(e.dimension.width,e.dimension.height)),e.done&&(this._isResizing=!1)}))),this._register(this._resizableNode.onDidWillResize((()=>{this._isResizing=!0})))}get isResizing(){return this._isResizing}getDomNode(){return this._resizableNode.domNode}getPosition(){return this._contentPosition}get position(){var e;return(null===(e=this._contentPosition)||void 0===e?void 0:e.position)?g.L.lift(this._contentPosition.position):void 0}_availableVerticalSpaceAbove(e){const t=this._editor.getDomNode(),i=this._editor.getScrolledVisiblePosition(e);if(!t||!i)return;const o=c.i(t);return o.top+i.top-P}_availableVerticalSpaceBelow(e){const t=this._editor.getDomNode(),i=this._editor.getScrolledVisiblePosition(e);if(!t||!i)return;const o=c.i(t),n=c.D6(t.ownerDocument.body),r=o.top+i.top+i.height;return n.height-r-R}_findPositionPreference(e,t){var i,o;const n=Math.min(null!==(i=this._availableVerticalSpaceBelow(t))&&void 0!==i?i:1/0,e),r=Math.min(null!==(o=this._availableVerticalSpaceAbove(t))&&void 0!==o?o:1/0,e),s=Math.min(Math.max(r,n),e),a=Math.min(e,s);let d;return d=this._editor.getOption(60).above?a<=r?1:2:a<=n?2:1,1===d?this._resizableNode.enableSashes(!0,!0,!1,!1):this._resizableNode.enableSashes(!1,!0,!0,!1),d}_resize(e){this._resizableNode.layout(e.height,e.width)}}var L,I,T=i(47596),E=i(55907),O=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},F=function(e,t){return function(i,o){t(i,o,e)}};const A=c.$;let W=L=class extends n.JT{constructor(e,t,i){super(),this._editor=e,this._instantiationService=t,this._keybindingService=i,this._currentResult=null,this._widget=this._register(this._instantiationService.createInstance(G,this._editor)),this._participants=[];for(const o of S.Ae.getAll())this._participants.push(this._instantiationService.createInstance(o,this._editor));this._participants.sort(((e,t)=>e.hoverOrdinal-t.hoverOrdinal)),this._computer=new Q(this._editor,this._participants),this._hoverOperation=this._register(new C(this._editor,this._computer)),this._register(this._hoverOperation.onResult((e=>{if(!this._computer.anchor)return;const t=e.hasLoadingMessage?this._addLoadingMessage(e.value):e.value;this._withResult(new H(this._computer.anchor,t,e.isComplete))}))),this._register(c.mu(this._widget.getDomNode(),"keydown",(e=>{e.equals(9)&&this.hide()}))),this._register(_.RW.onDidChange((()=>{this._widget.position&&this._currentResult&&this._setCurrentResult(this._currentResult)})))}get widget(){return this._widget}maybeShowAt(e){if(this._widget.isResizing)return!0;const t=[];for(const o of this._participants)if(o.suggestHoverAnchor){const i=o.suggestHoverAnchor(e);i&&t.push(i)}const i=e.target;if(6===i.type&&t.push(new S.Qj(0,i.range,e.event.posx,e.event.posy)),7===i.type){const o=this._editor.getOption(50).typicalHalfwidthCharacterWidth/2;!i.detail.isAfterLines&&"number"===typeof i.detail.horizontalDistanceToText&&i.detail.horizontalDistanceToText<o&&t.push(new S.Qj(0,i.range,e.event.posx,e.event.posy))}return 0===t.length?this._startShowingOrUpdateHover(null,0,0,!1,e):(t.sort(((e,t)=>t.priority-e.priority)),this._startShowingOrUpdateHover(t[0],0,0,!1,e))}startShowingAtRange(e,t,i,o){this._startShowingOrUpdateHover(new S.Qj(0,e,void 0,void 0),t,i,o,null)}_startShowingOrUpdateHover(e,t,i,o,n){if(!this._widget.position||!this._currentResult)return!!e&&(this._startHoverOperationIfNecessary(e,t,i,o,!1),!0);const r=this._editor.getOption(60).sticky,s=r&&n&&this._widget.isMouseGettingCloser(n.event.posx,n.event.posy);return s?(e&&this._startHoverOperationIfNecessary(e,t,i,o,!0),!0):e?!(!e||!this._currentResult.anchor.equals(e))||(e.canAdoptVisibleHover(this._currentResult.anchor,this._widget.position)?(this._setCurrentResult(this._currentResult.filter(e)),this._startHoverOperationIfNecessary(e,t,i,o,!1),!0):(this._setCurrentResult(null),this._startHoverOperationIfNecessary(e,t,i,o,!1),!0)):(this._setCurrentResult(null),!1)}_startHoverOperationIfNecessary(e,t,i,o,n){this._computer.anchor&&this._computer.anchor.equals(e)||(this._hoverOperation.cancel(),this._computer.anchor=e,this._computer.shouldFocus=o,this._computer.source=i,this._computer.insistOnKeepingHoverVisible=n,this._hoverOperation.start(t))}_setCurrentResult(e){this._currentResult!==e&&(e&&0===e.messages.length&&(e=null),this._currentResult=e,this._currentResult?this._renderMessages(this._currentResult.anchor,this._currentResult.messages):this._widget.hide())}hide(){this._computer.anchor=null,this._hoverOperation.cancel(),this._setCurrentResult(null)}get isColorPickerVisible(){return this._widget.isColorPickerVisible}get isVisibleFromKeyboard(){return this._widget.isVisibleFromKeyboard}get isVisible(){return this._widget.isVisible}get isFocused(){return this._widget.isFocused}get isResizing(){return this._widget.isResizing}containsNode(e){return!!e&&this._widget.getDomNode().contains(e)}_addLoadingMessage(e){if(this._computer.anchor)for(const t of this._participants)if(t.createLoadingMessage){const i=t.createLoadingMessage(this._computer.anchor);if(i)return e.slice(0).concat([i])}return e}_withResult(e){if(this._widget.position&&this._currentResult&&this._currentResult.isComplete){if(!e.isComplete)return;if(this._computer.insistOnKeepingHoverVisible&&0===e.messages.length)return}this._setCurrentResult(e)}_renderMessages(e,t){const{showAtPosition:i,showAtSecondaryPosition:o,highlightRange:r}=L.computeHoverRanges(this._editor,e.range,t),s=new n.SL,a=s.add(new j(this._keybindingService)),d=document.createDocumentFragment();let l=null;const c={fragment:d,statusBar:a,setColorPicker:e=>l=e,onContentsChanged:()=>this._widget.onContentsChanged(),setMinimumDimensions:e=>this._widget.setMinimumDimensions(e),hide:()=>this.hide()};for(const n of this._participants){const e=t.filter((e=>e.owner===n));e.length>0&&s.add(n.renderHoverParts(c,e))}const h=t.some((e=>e.isBeforeContent));if(a.hasContent&&d.appendChild(a.hoverElement),d.hasChildNodes()){if(r){const e=this._editor.createDecorationsCollection();e.set([{range:r,options:L._DECORATION_OPTIONS}]),s.add((0,n.OF)((()=>{e.clear()})))}this._widget.showAt(d,new B(l,i,o,this._editor.getOption(60).above,this._computer.shouldFocus,this._computer.source,h,e.initialMousePosX,e.initialMousePosY,s))}else s.dispose()}static computeHoverRanges(e,t,i){let o=1;if(e.hasModel()){const i=e._getViewModel(),n=i.coordinatesConverter,r=n.convertModelRangeToViewRange(t),s=new g.L(r.startLineNumber,i.getLineMinColumn(r.startLineNumber));o=n.convertViewPositionToModelPosition(s).column}const n=t.startLineNumber;let r=t.startColumn,a=i[0].range,d=null;for(const l of i)a=s.e.plusRange(a,l.range),l.range.startLineNumber===n&&l.range.endLineNumber===n&&(r=Math.max(Math.min(r,l.range.startColumn),o)),l.forceShowAtRange&&(d=l.range);return{showAtPosition:d?d.getStartPosition():new g.L(n,t.startColumn),showAtSecondaryPosition:d?d.getStartPosition():new g.L(n,r),highlightRange:a}}focus(){this._widget.focus()}scrollUp(){this._widget.scrollUp()}scrollDown(){this._widget.scrollDown()}scrollLeft(){this._widget.scrollLeft()}scrollRight(){this._widget.scrollRight()}pageUp(){this._widget.pageUp()}pageDown(){this._widget.pageDown()}goToTop(){this._widget.goToTop()}goToBottom(){this._widget.goToBottom()}};W._DECORATION_OPTIONS=p.qx.register({description:"content-hover-highlight",className:"hoverHighlight"}),W=L=O([F(1,D.TG),F(2,k.d)],W);class H{constructor(e,t,i){this.anchor=e,this.messages=t,this.isComplete=i}filter(e){const t=this.messages.filter((t=>t.isValidForHoverAnchor(e)));return t.length===this.messages.length?this:new z(this,this.anchor,t,this.isComplete)}}class z extends H{constructor(e,t,i,o){super(t,i,o),this.original=e}filter(e){return this.original.filter(e)}}class B{constructor(e,t,i,o,n,r,s,a,d,l){this.colorPicker=e,this.showAtPosition=t,this.showAtSecondaryPosition=i,this.preferAbove=o,this.stoleFocus=n,this.source=r,this.isBeforeContent=s,this.initialMousePosX=a,this.initialMousePosY=d,this.disposables=l,this.closestMouseDistance=void 0}}const U=30,V=10,K=6;let G=I=class extends x{get isColorPickerVisible(){var e;return Boolean(null===(e=this._visibleData)||void 0===e?void 0:e.colorPicker)}get isVisibleFromKeyboard(){var e;return 1===(null===(e=this._visibleData)||void 0===e?void 0:e.source)}get isVisible(){var e;return null!==(e=this._hoverVisibleKey.get())&&void 0!==e&&e}get isFocused(){var e;return null!==(e=this._hoverFocusedKey.get())&&void 0!==e&&e}constructor(e,t,i,o,n){const r=e.getOption(66)+8,s=150,d=new c.Ro(s,r);super(e,d),this._configurationService=i,this._accessibilityService=o,this._keybindingService=n,this._hover=this._register(new h.c8),this._minimumSize=d,this._hoverVisibleKey=a.u.hoverVisible.bindTo(t),this._hoverFocusedKey=a.u.hoverFocused.bindTo(t),c.R3(this._resizableNode.domNode,this._hover.containerDomNode),this._resizableNode.domNode.style.zIndex="50",this._register(this._editor.onDidLayoutChange((()=>this._layout()))),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(50)&&this._updateFont()})));const l=this._register(c.go(this._resizableNode.domNode));this._register(l.onDidFocus((()=>{this._hoverFocusedKey.set(!0)}))),this._register(l.onDidBlur((()=>{this._hoverFocusedKey.set(!1)}))),this._setHoverData(void 0),this._layout(),this._editor.addContentWidget(this)}dispose(){var e;super.dispose(),null===(e=this._visibleData)||void 0===e||e.disposables.dispose(),this._editor.removeContentWidget(this)}getId(){return I.ID}static _applyDimensions(e,t,i){const o="number"===typeof t?`${t}px`:t,n="number"===typeof i?`${i}px`:i;e.style.width=o,e.style.height=n}_setContentsDomNodeDimensions(e,t){const i=this._hover.contentsDomNode;return I._applyDimensions(i,e,t)}_setContainerDomNodeDimensions(e,t){const i=this._hover.containerDomNode;return I._applyDimensions(i,e,t)}_setHoverWidgetDimensions(e,t){this._setContentsDomNodeDimensions(e,t),this._setContainerDomNodeDimensions(e,t),this._layoutContentWidget()}static _applyMaxDimensions(e,t,i){const o="number"===typeof t?`${t}px`:t,n="number"===typeof i?`${i}px`:i;e.style.maxWidth=o,e.style.maxHeight=n}_setHoverWidgetMaxDimensions(e,t){I._applyMaxDimensions(this._hover.contentsDomNode,e,t),I._applyMaxDimensions(this._hover.containerDomNode,e,t),this._hover.containerDomNode.style.setProperty("--vscode-hover-maxWidth","number"===typeof e?`${e}px`:e),this._layoutContentWidget()}_hasHorizontalScrollbar(){const e=this._hover.scrollbar.getScrollDimensions(),t=e.scrollWidth>e.width;return t}_adjustContentsBottomPadding(){const e=this._hover.contentsDomNode,t=`${this._hover.scrollbar.options.horizontalScrollbarSize}px`;e.style.paddingBottom!==t&&(e.style.paddingBottom=t)}_setAdjustedHoverWidgetDimensions(e){this._setHoverWidgetMaxDimensions("none","none");const t=e.width,i=e.height;this._setHoverWidgetDimensions(t,i),this._hasHorizontalScrollbar()&&(this._adjustContentsBottomPadding(),this._setContentsDomNodeDimensions(t,i-V))}_updateResizableNodeMaxDimensions(){var e,t;const i=null!==(e=this._findMaximumRenderingWidth())&&void 0!==e?e:1/0,o=null!==(t=this._findMaximumRenderingHeight())&&void 0!==t?t:1/0;this._resizableNode.maxSize=new c.Ro(i,o),this._setHoverWidgetMaxDimensions(i,o)}_resize(e){var t,i;I._lastDimensions=new c.Ro(e.width,e.height),this._setAdjustedHoverWidgetDimensions(e),this._resizableNode.layout(e.height,e.width),this._updateResizableNodeMaxDimensions(),this._hover.scrollbar.scanDomNode(),this._editor.layoutContentWidget(this),null===(i=null===(t=this._visibleData)||void 0===t?void 0:t.colorPicker)||void 0===i||i.layout()}_findAvailableSpaceVertically(){var e;const t=null===(e=this._visibleData)||void 0===e?void 0:e.showAtPosition;if(t)return 1===this._positionPreference?this._availableVerticalSpaceAbove(t):this._availableVerticalSpaceBelow(t)}_findMaximumRenderingHeight(){const e=this._findAvailableSpaceVertically();if(!e)return;let t=K;return Array.from(this._hover.contentsDomNode.children).forEach((e=>{t+=e.clientHeight})),this._hasHorizontalScrollbar()&&(t+=V),Math.min(e,t)}_isHoverTextOverflowing(){this._hover.containerDomNode.style.setProperty("--vscode-hover-whiteSpace","nowrap"),this._hover.containerDomNode.style.setProperty("--vscode-hover-sourceWhiteSpace","nowrap");const e=Array.from(this._hover.contentsDomNode.children).some((e=>e.scrollWidth>e.clientWidth));return this._hover.containerDomNode.style.removeProperty("--vscode-hover-whiteSpace"),this._hover.containerDomNode.style.removeProperty("--vscode-hover-sourceWhiteSpace"),e}_findMaximumRenderingWidth(){if(!this._editor||!this._editor.hasModel())return;const e=this._isHoverTextOverflowing(),t="undefined"===typeof this._contentWidth?0:this._contentWidth-2;if(e||this._hover.containerDomNode.clientWidth<t){const e=c.D6(this._hover.containerDomNode.ownerDocument.body).width,t=14;return e-t}return this._hover.containerDomNode.clientWidth+2}isMouseGettingCloser(e,t){if(!this._visibleData)return!1;if("undefined"===typeof this._visibleData.initialMousePosX||"undefined"===typeof this._visibleData.initialMousePosY)return this._visibleData.initialMousePosX=e,this._visibleData.initialMousePosY=t,!1;const i=c.i(this.getDomNode());"undefined"===typeof this._visibleData.closestMouseDistance&&(this._visibleData.closestMouseDistance=$(this._visibleData.initialMousePosX,this._visibleData.initialMousePosY,i.left,i.top,i.width,i.height));const o=$(e,t,i.left,i.top,i.width,i.height);return!(o>this._visibleData.closestMouseDistance+4)&&(this._visibleData.closestMouseDistance=Math.min(this._visibleData.closestMouseDistance,o),!0)}_setHoverData(e){var t;null===(t=this._visibleData)||void 0===t||t.disposables.dispose(),this._visibleData=e,this._hoverVisibleKey.set(!!e),this._hover.containerDomNode.classList.toggle("hidden",!e)}_layout(){const{fontSize:e,lineHeight:t}=this._editor.getOption(50),i=this._hover.contentsDomNode;i.style.fontSize=`${e}px`,i.style.lineHeight=""+t/e,this._updateMaxDimensions()}_updateFont(){const e=Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code"));e.forEach((e=>this._editor.applyFontInfo(e)))}_updateContent(e){const t=this._hover.contentsDomNode;t.style.paddingBottom="",t.textContent="",t.appendChild(e)}_layoutContentWidget(){this._editor.layoutContentWidget(this),this._hover.onContentsChanged()}_updateMaxDimensions(){const e=Math.max(this._editor.getLayoutInfo().height/4,250,I._lastDimensions.height),t=Math.max(.66*this._editor.getLayoutInfo().width,500,I._lastDimensions.width);this._setHoverWidgetMaxDimensions(t,e)}_render(e,t){this._setHoverData(t),this._updateFont(),this._updateContent(e),this._updateMaxDimensions(),this.onContentsChanged(),this._editor.render()}getPosition(){var e;return this._visibleData?{position:this._visibleData.showAtPosition,secondaryPosition:this._visibleData.showAtSecondaryPosition,positionAffinity:this._visibleData.isBeforeContent?3:void 0,preference:[null!==(e=this._positionPreference)&&void 0!==e?e:1]}:null}showAt(e,t){var i,o,n,r;if(!this._editor||!this._editor.hasModel())return;this._render(e,t);const s=c.wn(this._hover.containerDomNode),a=t.showAtPosition;this._positionPreference=null!==(i=this._findPositionPreference(s,a))&&void 0!==i?i:1,this.onContentsChanged(),t.stoleFocus&&this._hover.containerDomNode.focus(),null===(o=t.colorPicker)||void 0===o||o.layout();const d=(0,h.uX)(!0===this._configurationService.getValue("accessibility.verbosity.hover")&&this._accessibilityService.isScreenReaderOptimized(),null!==(r=null===(n=this._keybindingService.lookupKeybinding("editor.action.accessibleView"))||void 0===n?void 0:n.getAriaLabel())&&void 0!==r?r:"");d&&(this._hover.contentsDomNode.ariaLabel=this._hover.contentsDomNode.textContent+", "+d)}hide(){if(!this._visibleData)return;const e=this._visibleData.stoleFocus||this._hoverFocusedKey.get();this._setHoverData(void 0),this._resizableNode.maxSize=new c.Ro(1/0,1/0),this._resizableNode.clearSashHoverState(),this._hoverFocusedKey.set(!1),this._editor.layoutContentWidget(this),e&&this._editor.focus()}_removeConstraintsRenderNormally(){const e=this._editor.getLayoutInfo();this._resizableNode.layout(e.height,e.width),this._setHoverWidgetDimensions("auto","auto")}_adjustHoverHeightForScrollbar(e){var t;const i=this._hover.containerDomNode,o=this._hover.contentsDomNode,n=null!==(t=this._findMaximumRenderingHeight())&&void 0!==t?t:1/0;this._setContainerDomNodeDimensions(c.w(i),Math.min(n,e)),this._setContentsDomNodeDimensions(c.w(o),Math.min(n,e-V))}setMinimumDimensions(e){this._minimumSize=new c.Ro(Math.max(this._minimumSize.width,e.width),Math.max(this._minimumSize.height,e.height)),this._updateMinimumWidth()}_updateMinimumWidth(){const e="undefined"===typeof this._contentWidth?this._minimumSize.width:Math.min(this._contentWidth,this._minimumSize.width);this._resizableNode.minSize=new c.Ro(e,this._minimumSize.height)}onContentsChanged(){var e;this._removeConstraintsRenderNormally();const t=this._hover.containerDomNode;let i=c.wn(t),o=c.w(t);if(this._resizableNode.layout(i,o),this._setHoverWidgetDimensions(o,i),i=c.wn(t),o=c.w(t),this._contentWidth=o,this._updateMinimumWidth(),this._resizableNode.layout(i,o),this._hasHorizontalScrollbar()&&(this._adjustContentsBottomPadding(),this._adjustHoverHeightForScrollbar(i)),null===(e=this._visibleData)||void 0===e?void 0:e.showAtPosition){const e=c.wn(this._hover.containerDomNode);this._positionPreference=this._findPositionPreference(e,this._visibleData.showAtPosition)}this._layoutContentWidget()}focus(){this._hover.containerDomNode.focus()}scrollUp(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._editor.getOption(50);this._hover.scrollbar.setScrollPosition({scrollTop:e-t.lineHeight})}scrollDown(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._editor.getOption(50);this._hover.scrollbar.setScrollPosition({scrollTop:e+t.lineHeight})}scrollLeft(){const e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e-U})}scrollRight(){const e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e+U})}pageUp(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e-t})}pageDown(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e+t})}goToTop(){this._hover.scrollbar.setScrollPosition({scrollTop:0})}goToBottom(){this._hover.scrollbar.setScrollPosition({scrollTop:this._hover.scrollbar.getScrollDimensions().scrollHeight})}};G.ID="editor.contrib.resizableContentHoverWidget",G._lastDimensions=new c.Ro(0,0),G=I=O([F(1,M.i6),F(2,T.Ui),F(3,E.F),F(4,k.d)],G);let j=class extends n.JT{get hasContent(){return this._hasContent}constructor(e){super(),this._keybindingService=e,this._hasContent=!1,this.hoverElement=A("div.hover-row.status-bar"),this.actionsElement=c.R3(this.hoverElement,A("div.actions"))}addAction(e){const t=this._keybindingService.lookupKeybinding(e.commandId),i=t?t.getLabel():null;return this._hasContent=!0,this._register(h.Sr.render(this.actionsElement,e,i))}append(e){const t=c.R3(this.actionsElement,e);return this._hasContent=!0,t}};j=O([F(0,k.d)],j);class Q{get anchor(){return this._anchor}set anchor(e){this._anchor=e}get shouldFocus(){return this._shouldFocus}set shouldFocus(e){this._shouldFocus=e}get source(){return this._source}set source(e){this._source=e}get insistOnKeepingHoverVisible(){return this._insistOnKeepingHoverVisible}set insistOnKeepingHoverVisible(e){this._insistOnKeepingHoverVisible=e}constructor(e,t){this._editor=e,this._participants=t,this._anchor=null,this._shouldFocus=!1,this._source=0,this._insistOnKeepingHoverVisible=!1}static _getLineDecorations(e,t){if(1!==t.type&&!t.supportsMarkerHover)return[];const i=e.getModel(),o=t.range.startLineNumber;if(o>i.getLineCount())return[];const n=i.getLineMaxColumn(o);return e.getLineDecorations(o).filter((e=>{if(e.options.isWholeLine)return!0;const i=e.range.startLineNumber===o?e.range.startColumn:1,r=e.range.endLineNumber===o?e.range.endColumn:n;if(e.options.showIfCollapsed){if(i>t.range.startColumn+1||t.range.endColumn-1>r)return!1}else if(i>t.range.startColumn||t.range.endColumn>r)return!1;return!0}))}computeAsync(e){const t=this._anchor;if(!this._editor.hasModel()||!t)return m.Aq.EMPTY;const i=Q._getLineDecorations(this._editor,t);return m.Aq.merge(this._participants.map((o=>o.computeAsync?o.computeAsync(t,i,e):m.Aq.EMPTY)))}computeSync(){if(!this._editor.hasModel()||!this._anchor)return[];const e=Q._getLineDecorations(this._editor,this._anchor);let t=[];for(const i of this._participants)t=t.concat(i.computeSync(this._anchor,e));return(0,u.kX)(t)}}function $(e,t,i,o,n,r){const s=i+n/2,a=o+r/2,d=Math.max(Math.abs(e-s)-n/2,0),l=Math.max(Math.abs(t-a)-r/2,0);return Math.sqrt(d*d+l*l)}var Z=i(81478),q=i(92767);const X=c.$;class J extends n.JT{constructor(e,t,i){super(),this._renderDisposeables=this._register(new n.SL),this._editor=e,this._isVisible=!1,this._messages=[],this._hover=this._register(new h.c8),this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._markdownRenderer=this._register(new q.$({editor:this._editor},t,i)),this._computer=new Y(this._editor),this._hoverOperation=this._register(new C(this._editor,this._computer)),this._register(this._hoverOperation.onResult((e=>{this._withResult(e.value)}))),this._register(this._editor.onDidChangeModelDecorations((()=>this._onModelDecorationsChanged()))),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(50)&&this._updateFont()}))),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return J.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){return null}_updateFont(){const e=Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code"));e.forEach((e=>this._editor.applyFontInfo(e)))}_onModelDecorationsChanged(){this._isVisible&&(this._hoverOperation.cancel(),this._hoverOperation.start(0))}startShowingAt(e){this._computer.lineNumber!==e&&(this._hoverOperation.cancel(),this.hide(),this._computer.lineNumber=e,this._hoverOperation.start(0))}hide(){this._computer.lineNumber=-1,this._hoverOperation.cancel(),this._isVisible&&(this._isVisible=!1,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible))}_withResult(e){this._messages=e,this._messages.length>0?this._renderMessages(this._computer.lineNumber,this._messages):this.hide()}_renderMessages(e,t){this._renderDisposeables.clear();const i=document.createDocumentFragment();for(const o of t){const e=X("div.hover-row.markdown-hover"),t=c.R3(e,X("div.hover-contents")),n=this._renderDisposeables.add(this._markdownRenderer.render(o.value));t.appendChild(n.element),i.appendChild(e)}this._updateContents(i),this._showAt(e)}_updateContents(e){this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(e),this._updateFont()}_showAt(e){this._isVisible||(this._isVisible=!0,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible));const t=this._editor.getLayoutInfo(),i=this._editor.getTopForLineNumber(e),o=this._editor.getScrollTop(),n=this._editor.getOption(66),r=this._hover.containerDomNode.clientHeight,s=i-o-(r-n)/2;this._hover.containerDomNode.style.left=`${t.glyphMarginLeft+t.glyphMarginWidth}px`,this._hover.containerDomNode.style.top=`${Math.max(Math.round(s),0)}px`}}J.ID="editor.contrib.modesGlyphHoverWidget";class Y{get lineNumber(){return this._lineNumber}set lineNumber(e){this._lineNumber=e}constructor(e){this._editor=e,this._lineNumber=-1}computeSync(){const e=e=>({value:e}),t=this._editor.getLineDecorations(this._lineNumber),i=[];if(!t)return i;for(const o of t){if(!o.options.glyphMarginClassName)continue;const t=o.options.glyphMarginHoverMessage;t&&!(0,Z.CP)(t)&&i.push(...(0,u._2)(t).map(e))}return i}}var ee=i(6544),te=i(47277),ie=i(32656),oe=i(25903),ne=i(21230),re=i(16458),se=i(54693),ae=i(88266),de=i(34244),le=i(7710),ce=i(8419),he=i(35195),ue=i(33010),ge=i(61720),pe=i(95896),_e=i(39326),me=i(48580),ve=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},fe=function(e,t){return function(i,o){t(i,o,e)}};class ye{constructor(e,t,i){this.marker=e,this.index=t,this.total=i}}let be=class{constructor(e,t,i){this._markerService=t,this._configService=i,this._onDidChange=new f.Q5,this.onDidChange=this._onDidChange.event,this._dispoables=new n.SL,this._markers=[],this._nextIdx=-1,pe.o.isUri(e)?this._resourceFilter=t=>t.toString()===e.toString():e&&(this._resourceFilter=e);const o=this._configService.getValue("problems.sortOrder"),r=(e,t)=>{let i=(0,ge.qu)(e.resource.toString(),t.resource.toString());return 0===i&&(i="position"===o?s.e.compareRangesUsingStarts(e,t)||me.ZL.compare(e.severity,t.severity):me.ZL.compare(e.severity,t.severity)||s.e.compareRangesUsingStarts(e,t)),i},a=()=>{this._markers=this._markerService.read({resource:pe.o.isUri(e)?e:void 0,severities:me.ZL.Error|me.ZL.Warning|me.ZL.Info}),"function"===typeof e&&(this._markers=this._markers.filter((e=>this._resourceFilter(e.resource)))),this._markers.sort(r)};a(),this._dispoables.add(t.onMarkerChanged((e=>{this._resourceFilter&&!e.some((e=>this._resourceFilter(e)))||(a(),this._nextIdx=-1,this._onDidChange.fire())})))}dispose(){this._dispoables.dispose(),this._onDidChange.dispose()}matches(e){return!this._resourceFilter&&!e||!(!this._resourceFilter||!e)&&this._resourceFilter(e)}get selected(){const e=this._markers[this._nextIdx];return e&&new ye(e,this._nextIdx+1,this._markers.length)}_initIdx(e,t,i){let o=!1,n=this._markers.findIndex((t=>t.resource.toString()===e.uri.toString()));n<0&&(n=(0,u.ry)(this._markers,{resource:e.uri},((e,t)=>(0,ge.qu)(e.resource.toString(),t.resource.toString()))),n<0&&(n=~n));for(let r=n;r<this._markers.length;r++){let i=s.e.lift(this._markers[r]);if(i.isEmpty()){const t=e.getWordAtPosition(i.getStartPosition());t&&(i=new s.e(i.startLineNumber,t.startColumn,i.startLineNumber,t.endColumn))}if(t&&(i.containsPosition(t)||t.isBeforeOrEqual(i.getStartPosition()))){this._nextIdx=r,o=!0;break}if(this._markers[r].resource.toString()!==e.uri.toString())break}o||(this._nextIdx=i?0:this._markers.length-1),this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}resetIndex(){this._nextIdx=-1}move(e,t,i){if(0===this._markers.length)return!1;const o=this._nextIdx;return-1===this._nextIdx?this._initIdx(t,i,e):e?this._nextIdx=(this._nextIdx+1)%this._markers.length:e||(this._nextIdx=(this._nextIdx-1+this._markers.length)%this._markers.length),o!==this._nextIdx}find(e,t){let i=this._markers.findIndex((t=>t.resource.toString()===e.toString()));if(!(i<0))for(;i<this._markers.length;i++)if(s.e.containsPosition(this._markers[i],t))return new ye(this._markers[i],i+1,this._markers.length)}};be=ve([fe(1,me.lT),fe(2,T.Ui)],be);const we=(0,D.yh)("IMarkerNavigationService");let Ce=class{constructor(e,t){this._markerService=e,this._configService=t,this._provider=new ue.S}getMarkerList(e){for(const t of this._provider){const i=t.getMarkerList(e);if(i)return i}return new be(e,this._markerService,this._configService)}};Ce=ve([fe(0,me.lT),fe(1,T.Ui)],Ce),(0,_e.z)(we,Ce,1);var Se,De=i(25206),ke=i(82693),Me=i(98158),Ne=i(60841),Pe=i(60204),Re=i(78097),xe=i(94700),Le=i(51549),Ie=i(12898),Te=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},Ee=function(e,t){return function(i,o){t(i,o,e)}};class Oe{constructor(e,t,i,o,r){this._openerService=o,this._labelService=r,this._lines=0,this._longestLineLength=0,this._relatedDiagnostics=new WeakMap,this._disposables=new n.SL,this._editor=t;const s=document.createElement("div");s.className="descriptioncontainer",this._messageBlock=document.createElement("div"),this._messageBlock.classList.add("message"),this._messageBlock.setAttribute("aria-live","assertive"),this._messageBlock.setAttribute("role","alert"),s.appendChild(this._messageBlock),this._relatedBlock=document.createElement("div"),s.appendChild(this._relatedBlock),this._disposables.add(c.mu(this._relatedBlock,"click",(e=>{e.preventDefault();const t=this._relatedDiagnostics.get(e.target);t&&i(t)}))),this._scrollable=new Ne.NB(s,{horizontal:1,vertical:1,useShadows:!1,horizontalScrollbarSize:6,verticalScrollbarSize:6}),e.appendChild(this._scrollable.getDomNode()),this._disposables.add(this._scrollable.onScroll((e=>{s.style.left=`-${e.scrollLeft}px`,s.style.top=`-${e.scrollTop}px`}))),this._disposables.add(this._scrollable)}dispose(){(0,n.B9)(this._disposables)}update(e){const{source:t,message:i,relatedInformation:o,code:n}=e;let r=((null===t||void 0===t?void 0:t.length)||0)+2;n&&(r+="string"===typeof n?n.length:n.value.length);const s=(0,ge.uq)(i);this._lines=s.length,this._longestLineLength=0;for(const c of s)this._longestLineLength=Math.max(c.length+r,this._longestLineLength);c.PO(this._messageBlock),this._messageBlock.setAttribute("aria-label",this.getAriaLabel(e)),this._editor.applyFontInfo(this._messageBlock);let a=this._messageBlock;for(const c of s)a=document.createElement("div"),a.innerText=c,""===c&&(a.style.height=this._messageBlock.style.lineHeight),this._messageBlock.appendChild(a);if(t||n){const e=document.createElement("span");if(e.classList.add("details"),a.appendChild(e),t){const i=document.createElement("span");i.innerText=t,i.classList.add("source"),e.appendChild(i)}if(n)if("string"===typeof n){const t=document.createElement("span");t.innerText=`(${n})`,t.classList.add("code"),e.appendChild(t)}else{this._codeLink=c.$("a.code-link"),this._codeLink.setAttribute("href",`${n.target.toString()}`),this._codeLink.onclick=e=>{this._openerService.open(n.target,{allowCommands:!0}),e.preventDefault(),e.stopPropagation()};const t=c.R3(this._codeLink,c.$("span"));t.innerText=n.value,e.appendChild(this._codeLink)}}if(c.PO(this._relatedBlock),this._editor.applyFontInfo(this._relatedBlock),(0,u.Of)(o)){const e=this._relatedBlock.appendChild(document.createElement("div"));e.style.paddingTop=`${Math.floor(.66*this._editor.getOption(66))}px`,this._lines+=1;for(const t of o){const i=document.createElement("div"),o=document.createElement("a");o.classList.add("filename"),o.innerText=`${this._labelService.getUriBasenameLabel(t.resource)}(${t.startLineNumber}, ${t.startColumn}): `,o.title=this._labelService.getUriLabel(t.resource),this._relatedDiagnostics.set(o,t);const n=document.createElement("span");n.innerText=t.message,i.appendChild(o),i.appendChild(n),this._lines+=1,e.appendChild(i)}}const d=this._editor.getOption(50),l=Math.ceil(d.typicalFullwidthCharacterWidth*this._longestLineLength*.75),h=d.lineHeight*this._lines;this._scrollable.setScrollDimensions({scrollWidth:l,scrollHeight:h})}layout(e,t){this._scrollable.getDomNode().style.height=`${e}px`,this._scrollable.getDomNode().style.width=`${t}px`,this._scrollable.setScrollDimensions({width:t,height:e})}getHeightInLines(){return Math.min(17,this._lines)}getAriaLabel(e){let t="";switch(e.severity){case me.ZL.Error:t=De.NC("Error","Error");break;case me.ZL.Warning:t=De.NC("Warning","Warning");break;case me.ZL.Info:t=De.NC("Info","Info");break;case me.ZL.Hint:t=De.NC("Hint","Hint");break}let i=De.NC("marker aria","{0} at {1}. ",t,e.startLineNumber+":"+e.startColumn);const o=this._editor.getModel();if(o&&e.startLineNumber<=o.getLineCount()&&e.startLineNumber>=1){const t=o.getLineContent(e.startLineNumber);i=`${t}, ${i}`}return i}}let Fe=Se=class extends Re.vk{constructor(e,t,i,o,r,s,a){super(e,{showArrow:!0,showFrame:!0,isAccessible:!0,frameWidth:1},r),this._themeService=t,this._openerService=i,this._menuService=o,this._contextKeyService=s,this._labelService=a,this._callOnDispose=new n.SL,this._onDidSelectRelatedInformation=new f.Q5,this.onDidSelectRelatedInformation=this._onDidSelectRelatedInformation.event,this._severity=me.ZL.Warning,this._backgroundColor=Pe.Il.white,this._applyTheme(t.getColorTheme()),this._callOnDispose.add(t.onDidColorThemeChange(this._applyTheme.bind(this))),this.create()}_applyTheme(e){this._backgroundColor=e.getColor(je);let t=ze,i=Be;this._severity===me.ZL.Warning?(t=Ue,i=Ve):this._severity===me.ZL.Info&&(t=Ke,i=Ge);const o=e.getColor(t),n=e.getColor(i);this.style({arrowColor:o,frameColor:o,headerBackgroundColor:n,primaryHeadingColor:e.getColor(Re.IH),secondaryHeadingColor:e.getColor(Re.R7)})}_applyStyles(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor?this._backgroundColor.toString():""),super._applyStyles()}dispose(){this._callOnDispose.dispose(),super.dispose()}_fillHead(e){super._fillHead(e),this._disposables.add(this._actionbarWidget.actionRunner.onWillRun((e=>this.editor.focus())));const t=[],i=this._menuService.createMenu(Se.TitleMenu,this._contextKeyService);(0,xe.vr)(i,void 0,t),this._actionbarWidget.push(t,{label:!1,icon:!0,index:0}),i.dispose()}_fillTitleIcon(e){this._icon=c.R3(e,c.$(""))}_fillBody(e){this._parentContainer=e,e.classList.add("marker-widget"),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute("role","tooltip"),this._container=document.createElement("div"),e.appendChild(this._container),this._message=new Oe(this._container,this.editor,(e=>this._onDidSelectRelatedInformation.fire(e)),this._openerService,this._labelService),this._disposables.add(this._message)}show(){throw new Error("call showAtMarker")}showAtMarker(e,t,i){this._container.classList.remove("stale"),this._message.update(e),this._severity=e.severity,this._applyTheme(this._themeService.getColorTheme());const o=s.e.lift(e),n=this.editor.getPosition(),r=n&&o.containsPosition(n)?n:o.getStartPosition();super.show(r,this.computeRequiredHeight());const a=this.editor.getModel();if(a){const e=i>1?De.NC("problems","{0} of {1} problems",t,i):De.NC("change","{0} of {1} problem",t,i);this.setTitle((0,ne.EZ)(a.uri),e)}this._icon.className=`codicon ${Ie.j.className(me.ZL.toSeverity(this._severity))}`,this.editor.revealPositionNearTop(r,0),this.editor.focus()}updateMarker(e){this._container.classList.remove("stale"),this._message.update(e)}showStale(){this._container.classList.add("stale"),this._relayout()}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._heightInPixel=e,this._message.layout(e,t),this._container.style.height=`${e}px`}_onWidth(e){this._message.layout(this._heightInPixel,e)}_relayout(){super._relayout(this.computeRequiredHeight())}computeRequiredHeight(){return 3+this._message.getHeightInLines()}};Fe.TitleMenu=new ke.eH("gotoErrorTitleMenu"),Fe=Se=Te([Ee(1,ie.XE),Ee(2,ee.v4),Ee(3,ke.co),Ee(4,D.TG),Ee(5,M.i6),Ee(6,Le.e)],Fe);const Ae=(0,te.kwl)(te.lXJ,te.b6y),We=(0,te.kwl)(te.uoC,te.pW3),He=(0,te.kwl)(te.c63,te.T83),ze=(0,te.P6G)("editorMarkerNavigationError.background",{dark:Ae,light:Ae,hcDark:te.lRK,hcLight:te.lRK},De.NC("editorMarkerNavigationError","Editor marker navigation widget error color.")),Be=(0,te.P6G)("editorMarkerNavigationError.headerBackground",{dark:(0,te.ZnX)(ze,.1),light:(0,te.ZnX)(ze,.1),hcDark:null,hcLight:null},De.NC("editorMarkerNavigationErrorHeaderBackground","Editor marker navigation widget error heading background.")),Ue=(0,te.P6G)("editorMarkerNavigationWarning.background",{dark:We,light:We,hcDark:te.lRK,hcLight:te.lRK},De.NC("editorMarkerNavigationWarning","Editor marker navigation widget warning color.")),Ve=(0,te.P6G)("editorMarkerNavigationWarning.headerBackground",{dark:(0,te.ZnX)(Ue,.1),light:(0,te.ZnX)(Ue,.1),hcDark:"#0C141F",hcLight:(0,te.ZnX)(Ue,.2)},De.NC("editorMarkerNavigationWarningBackground","Editor marker navigation widget warning heading background.")),Ke=(0,te.P6G)("editorMarkerNavigationInfo.background",{dark:He,light:He,hcDark:te.lRK,hcLight:te.lRK},De.NC("editorMarkerNavigationInfo","Editor marker navigation widget info color.")),Ge=(0,te.P6G)("editorMarkerNavigationInfo.headerBackground",{dark:(0,te.ZnX)(Ke,.1),light:(0,te.ZnX)(Ke,.1),hcDark:null,hcLight:null},De.NC("editorMarkerNavigationInfoHeaderBackground","Editor marker navigation widget info heading background.")),je=(0,te.P6G)("editorMarkerNavigation.background",{dark:te.cvW,light:te.cvW,hcDark:te.cvW,hcLight:te.cvW},De.NC("editorMarkerNavigationBackground","Editor marker navigation widget background."));var Qe,$e=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},Ze=function(e,t){return function(i,o){t(i,o,e)}},qe=function(e,t,i,o){function n(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(o.next(e))}catch(t){r(t)}}function a(e){try{d(o["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):n(e.value).then(s,a)}d((o=o.apply(e,t||[])).next())}))};let Xe=Qe=class{static get(e){return e.getContribution(Qe.ID)}constructor(e,t,i,o,r){this._markerNavigationService=t,this._contextKeyService=i,this._editorService=o,this._instantiationService=r,this._sessionDispoables=new n.SL,this._editor=e,this._widgetVisible=ot.bindTo(this._contextKeyService)}dispose(){this._cleanUp(),this._sessionDispoables.dispose()}_cleanUp(){this._widgetVisible.reset(),this._sessionDispoables.clear(),this._widget=void 0,this._model=void 0}_getOrCreateModel(e){if(this._model&&this._model.matches(e))return this._model;let t=!1;return this._model&&(t=!0,this._cleanUp()),this._model=this._markerNavigationService.getMarkerList(e),t&&this._model.move(!0,this._editor.getModel(),this._editor.getPosition()),this._widget=this._instantiationService.createInstance(Fe,this._editor),this._widget.onDidClose((()=>this.close()),this,this._sessionDispoables),this._widgetVisible.set(!0),this._sessionDispoables.add(this._model),this._sessionDispoables.add(this._widget),this._sessionDispoables.add(this._editor.onDidChangeCursorPosition((e=>{var t,i,o;(null===(t=this._model)||void 0===t?void 0:t.selected)&&s.e.containsPosition(null===(i=this._model)||void 0===i?void 0:i.selected.marker,e.position)||null===(o=this._model)||void 0===o||o.resetIndex()}))),this._sessionDispoables.add(this._model.onDidChange((()=>{if(!this._widget||!this._widget.position||!this._model)return;const e=this._model.find(this._editor.getModel().uri,this._widget.position);e?this._widget.updateMarker(e.marker):this._widget.showStale()}))),this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation((e=>{this._editorService.openCodeEditor({resource:e.resource,options:{pinned:!0,revealIfOpened:!0,selection:s.e.lift(e).collapseToStart()}},this._editor),this.close(!1)}))),this._sessionDispoables.add(this._editor.onDidChangeModel((()=>this._cleanUp()))),this._model}close(e=!0){this._cleanUp(),e&&this._editor.focus()}showAtMarker(e){if(this._editor.hasModel()){const t=this._getOrCreateModel(this._editor.getModel().uri);t.resetIndex(),t.move(!0,this._editor.getModel(),new g.L(e.startLineNumber,e.startColumn)),t.selected&&this._widget.showAtMarker(t.selected.marker,t.selected.index,t.selected.total)}}nagivate(e,t){var i,o;return qe(this,void 0,void 0,(function*(){if(this._editor.hasModel()){const n=this._getOrCreateModel(t?void 0:this._editor.getModel().uri);if(n.move(e,this._editor.getModel(),this._editor.getPosition()),!n.selected)return;if(n.selected.marker.resource.toString()!==this._editor.getModel().uri.toString()){this._cleanUp();const r=yield this._editorService.openCodeEditor({resource:n.selected.marker.resource,options:{pinned:!1,revealIfOpened:!0,selectionRevealType:2,selection:n.selected.marker}},this._editor);r&&(null===(i=Qe.get(r))||void 0===i||i.close(),null===(o=Qe.get(r))||void 0===o||o.nagivate(e,t))}else this._widget.showAtMarker(n.selected.marker,n.selected.index,n.selected.total)}}))}};Xe.ID="editor.contrib.markerController",Xe=Qe=$e([Ze(1,we),Ze(2,M.i6),Ze(3,he.$),Ze(4,D.TG)],Xe);class Je extends r.R6{constructor(e,t,i){super(i),this._next=e,this._multiFile=t}run(e,t){var i;return qe(this,void 0,void 0,(function*(){t.hasModel()&&(null===(i=Xe.get(t))||void 0===i||i.nagivate(this._next,this._multiFile))}))}}class Ye extends Je{constructor(){super(!0,!1,{id:Ye.ID,label:Ye.LABEL,alias:"Go to Next Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:a.u.focus,primary:578,weight:100},menuOpts:{menuId:Fe.TitleMenu,title:Ye.LABEL,icon:(0,Me.q5)("marker-navigation-next",ce.l.arrowDown,De.NC("nextMarkerIcon","Icon for goto next marker.")),group:"navigation",order:1}})}}Ye.ID="editor.action.marker.next",Ye.LABEL=De.NC("markerAction.next.label","Go to Next Problem (Error, Warning, Info)");class et extends Je{constructor(){super(!1,!1,{id:et.ID,label:et.LABEL,alias:"Go to Previous Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:a.u.focus,primary:1602,weight:100},menuOpts:{menuId:Fe.TitleMenu,title:et.LABEL,icon:(0,Me.q5)("marker-navigation-previous",ce.l.arrowUp,De.NC("previousMarkerIcon","Icon for goto previous marker.")),group:"navigation",order:2}})}}et.ID="editor.action.marker.prev",et.LABEL=De.NC("markerAction.previous.label","Go to Previous Problem (Error, Warning, Info)");class tt extends Je{constructor(){super(!0,!0,{id:"editor.action.marker.nextInFiles",label:De.NC("markerAction.nextInFiles.label","Go to Next Problem in Files (Error, Warning, Info)"),alias:"Go to Next Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:a.u.focus,primary:66,weight:100},menuOpts:{menuId:ke.eH.MenubarGoMenu,title:De.NC({key:"miGotoNextProblem",comment:["&& denotes a mnemonic"]},"Next &&Problem"),group:"6_problem_nav",order:1}})}}class it extends Je{constructor(){super(!1,!0,{id:"editor.action.marker.prevInFiles",label:De.NC("markerAction.previousInFiles.label","Go to Previous Problem in Files (Error, Warning, Info)"),alias:"Go to Previous Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:a.u.focus,primary:1090,weight:100},menuOpts:{menuId:ke.eH.MenubarGoMenu,title:De.NC({key:"miGotoPreviousProblem",comment:["&& denotes a mnemonic"]},"Previous &&Problem"),group:"6_problem_nav",order:2}})}}(0,r._K)(Xe.ID,Xe,4),(0,r.Qr)(Ye),(0,r.Qr)(et),(0,r.Qr)(tt),(0,r.Qr)(it);const ot=new M.uy("markersNavigationVisible",!1),nt=r._l.bindToContribution(Xe.get);(0,r.fK)(new nt({id:"closeMarkersNavigation",precondition:ot,handler:e=>e.close(),kbOpts:{weight:150,kbExpr:a.u.focus,primary:9,secondary:[1033]}}));var rt=i(34679),st=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},at=function(e,t){return function(i,o){t(i,o,e)}};const dt=c.$;class lt{constructor(e,t,i){this.owner=e,this.range=t,this.marker=i}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}const ct={type:1,filter:{include:le.yN.QuickFix},triggerAction:le.aQ.QuickFixHover};let ht=class{constructor(e,t,i,o){this._editor=e,this._markerDecorationsService=t,this._openerService=i,this._languageFeaturesService=o,this.hoverOrdinal=1,this.recentMarkerCodeActionsInfo=void 0}computeSync(e,t){if(!this._editor.hasModel()||1!==e.type&&!e.supportsMarkerHover)return[];const i=this._editor.getModel(),o=e.range.startLineNumber,n=i.getLineMaxColumn(o),r=[];for(const a of t){const t=a.range.startLineNumber===o?a.range.startColumn:1,d=a.range.endLineNumber===o?a.range.endColumn:n,l=this._markerDecorationsService.getMarker(i.uri,a);if(!l)continue;const c=new s.e(e.range.startLineNumber,t,e.range.startLineNumber,d);r.push(new lt(this,c,l))}return r}renderHoverParts(e,t){if(!t.length)return n.JT.None;const i=new n.SL;t.forEach((t=>e.fragment.appendChild(this.renderMarkerHover(t,i))));const o=1===t.length?t[0]:t.sort(((e,t)=>me.ZL.compare(e.marker.severity,t.marker.severity)))[0];return this.renderMarkerStatusbar(e,o,i),i}renderMarkerHover(e,t){const i=dt("div.hover-row"),o=c.R3(i,dt("div.marker.hover-contents")),{source:n,message:r,code:s,relatedInformation:a}=e.marker;this._editor.applyFontInfo(o);const d=c.R3(o,dt("span"));if(d.style.whiteSpace="pre-wrap",d.innerText=r,n||s)if(s&&"string"!==typeof s){const e=dt("span");if(n){const t=c.R3(e,dt("span"));t.innerText=n}const i=c.R3(e,dt("a.code-link"));i.setAttribute("href",s.target.toString()),t.add(c.nm(i,"click",(e=>{this._openerService.open(s.target,{allowCommands:!0}),e.preventDefault(),e.stopPropagation()})));const r=c.R3(i,dt("span"));r.innerText=s.value;const a=c.R3(o,e);a.style.opacity="0.6",a.style.paddingLeft="6px"}else{const e=c.R3(o,dt("span"));e.style.opacity="0.6",e.style.paddingLeft="6px",e.innerText=n&&s?`${n}(${s})`:n||`(${s})`}if((0,u.Of)(a))for(const{message:l,resource:h,startLineNumber:u,startColumn:g}of a){const e=c.R3(o,dt("div"));e.style.marginTop="8px";const i=c.R3(e,dt("a"));i.innerText=`${(0,ne.EZ)(h)}(${u}, ${g}): `,i.style.cursor="pointer",t.add(c.nm(i,"click",(e=>{e.stopPropagation(),e.preventDefault(),this._openerService&&this._openerService.open(h,{fromUserGesture:!0,editorOptions:{selection:{startLineNumber:u,startColumn:g}}}).catch(v.dL)})));const n=c.R3(e,dt("span"));n.innerText=l,this._editor.applyFontInfo(n)}return i}renderMarkerStatusbar(e,t,i){if(t.marker.severity!==me.ZL.Error&&t.marker.severity!==me.ZL.Warning&&t.marker.severity!==me.ZL.Info||e.statusBar.addAction({label:De.NC("view problem","View Problem"),commandId:Ye.ID,run:()=>{var i;e.hide(),null===(i=Xe.get(this._editor))||void 0===i||i.showAtMarker(t.marker),this._editor.focus()}}),!this._editor.getOption(90)){const o=e.statusBar.append(dt("div"));this.recentMarkerCodeActionsInfo&&(me.H0.makeKey(this.recentMarkerCodeActionsInfo.marker)===me.H0.makeKey(t.marker)?this.recentMarkerCodeActionsInfo.hasCodeActions||(o.textContent=De.NC("noQuickFixes","No quick fixes available")):this.recentMarkerCodeActionsInfo=void 0);const r=this.recentMarkerCodeActionsInfo&&!this.recentMarkerCodeActionsInfo.hasCodeActions?n.JT.None:i.add((0,m.Vg)((()=>o.textContent=De.NC("checkingForQuickFixes","Checking for quick fixes...")),200));o.textContent||(o.textContent=String.fromCharCode(160));const s=this.getCodeActions(t.marker);i.add((0,n.OF)((()=>s.cancel()))),s.then((s=>{if(r.dispose(),this.recentMarkerCodeActionsInfo={marker:t.marker,hasCodeActions:s.validActions.length>0},!this.recentMarkerCodeActionsInfo.hasCodeActions)return s.dispose(),void(o.textContent=De.NC("noQuickFixes","No quick fixes available"));o.style.display="none";let a=!1;i.add((0,n.OF)((()=>{a||s.dispose()}))),e.statusBar.addAction({label:De.NC("quick fixes","Quick Fix..."),commandId:ae.cz,run:t=>{a=!0;const i=de.G.get(this._editor),o=c.i(t);e.hide(),null===i||void 0===i||i.showCodeActions(ct,s,{x:o.left,y:o.top,width:o.width,height:o.height})}})}),v.dL)}}getCodeActions(e){return(0,m.PG)((t=>(0,ae.aI)(this._languageFeaturesService.codeActionProvider,this._editor.getModel(),new s.e(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),ct,rt.Ex.None,t)))}};ht=st([at(1,se.i),at(2,ee.v4),at(3,re.p)],ht);var ut,gt=i(70955),pt=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},_t=function(e,t){return function(i,o){t(i,o,e)}};const mt=!1;let vt=ut=class extends n.JT{static get(e){return e.getContribution(ut.ID)}constructor(e,t,i,o,r){super(),this._editor=e,this._instantiationService=t,this._openerService=i,this._languageService=o,this._keybindingService=r,this._toUnhook=new n.SL,this._hoverActivatedByColorDecoratorClick=!1,this._isMouseDown=!1,this._hoverClicked=!1,this._contentWidget=null,this._glyphWidget=null,this._reactToEditorMouseMoveRunner=this._register(new m.pY((()=>this._reactToEditorMouseMove(this._mouseMoveEvent)),0)),this._hookEvents(),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(60)&&(this._unhookEvents(),this._hookEvents())}))),this._register(this._editor.onMouseLeave((()=>{this._mouseMoveEvent=void 0,this._reactToEditorMouseMoveRunner.cancel()})))}_hookEvents(){const e=()=>this._hideWidgets(),t=this._editor.getOption(60);this._isHoverEnabled=t.enabled,this._isHoverSticky=t.sticky,this._hidingDelay=t.hidingDelay,this._isHoverEnabled?(this._toUnhook.add(this._editor.onMouseDown((e=>this._onEditorMouseDown(e)))),this._toUnhook.add(this._editor.onMouseUp((e=>this._onEditorMouseUp(e)))),this._toUnhook.add(this._editor.onMouseMove((e=>this._onEditorMouseMove(e)))),this._toUnhook.add(this._editor.onKeyDown((e=>this._onKeyDown(e))))):(this._toUnhook.add(this._editor.onMouseMove((e=>this._onEditorMouseMove(e)))),this._toUnhook.add(this._editor.onKeyDown((e=>this._onKeyDown(e))))),this._toUnhook.add(this._editor.onMouseLeave((e=>this._onEditorMouseLeave(e)))),this._toUnhook.add(this._editor.onDidChangeModel(e)),this._toUnhook.add(this._editor.onDidScrollChange((e=>this._onEditorScrollChanged(e))))}_unhookEvents(){this._toUnhook.clear()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(e){var t;this._isMouseDown=!0;const i=e.target;9!==i.type||i.detail!==G.ID?12===i.type&&i.detail===J.ID||(12!==i.type&&(this._hoverClicked=!1),(null===(t=this._contentWidget)||void 0===t?void 0:t.widget.isResizing)||this._hideWidgets()):this._hoverClicked=!0}_onEditorMouseUp(e){this._isMouseDown=!1}_onEditorMouseLeave(e){var t,i;const o=e.event.browserEvent.relatedTarget;(null===(t=this._contentWidget)||void 0===t?void 0:t.widget.isResizing)||(null===(i=this._contentWidget)||void 0===i?void 0:i.containsNode(o))||mt||this._hideWidgets()}_isMouseOverWidget(e){var t,i,o,n,r;const s=e.target;return!(!this._isHoverSticky||9!==s.type||s.detail!==G.ID)||(!(!this._isHoverSticky||!(null===(t=this._contentWidget)||void 0===t?void 0:t.containsNode(null===(i=e.event.browserEvent.view)||void 0===i?void 0:i.document.activeElement))||(null===(n=null===(o=e.event.browserEvent.view)||void 0===o?void 0:o.getSelection())||void 0===n?void 0:n.isCollapsed))||(!(this._isHoverSticky||9!==s.type||s.detail!==G.ID||!(null===(r=this._contentWidget)||void 0===r?void 0:r.isColorPickerVisible))||!(!this._isHoverSticky||12!==s.type||s.detail!==J.ID)))}_onEditorMouseMove(e){var t,i,o,n;if(this._mouseMoveEvent=e,(null===(t=this._contentWidget)||void 0===t?void 0:t.isFocused)||(null===(i=this._contentWidget)||void 0===i?void 0:i.isResizing))return;if(this._isMouseDown&&this._hoverClicked)return;if(this._isHoverSticky&&(null===(o=this._contentWidget)||void 0===o?void 0:o.isVisibleFromKeyboard))return;const r=this._isMouseOverWidget(e);r?this._reactToEditorMouseMoveRunner.cancel():(null===(n=this._contentWidget)||void 0===n?void 0:n.isVisible)&&this._isHoverSticky&&this._hidingDelay>0?this._reactToEditorMouseMoveRunner.isScheduled()||this._reactToEditorMouseMoveRunner.schedule(this._hidingDelay):this._reactToEditorMouseMove(e)}_reactToEditorMouseMove(e){var t,i,o;if(!e)return;const n=e.target,r=null===(t=n.element)||void 0===t?void 0:t.classList.contains("colorpicker-color-decoration"),s=this._editor.getOption(146);if(r&&("click"===s&&!this._hoverActivatedByColorDecoratorClick||"hover"===s&&!this._isHoverEnabled&&!mt||"clickAndHover"===s&&!this._isHoverEnabled&&!this._hoverActivatedByColorDecoratorClick)||!r&&!this._isHoverEnabled&&!this._hoverActivatedByColorDecoratorClick)return void this._hideWidgets();const a=this._getOrCreateContentWidget();if(!a.maybeShowAt(e))return 2===n.type&&n.position?(null===(o=this._contentWidget)||void 0===o||o.hide(),this._glyphWidget||(this._glyphWidget=new J(this._editor,this._languageService,this._openerService)),void this._glyphWidget.startShowingAt(n.position.lineNumber)):void(mt||this._hideWidgets());null===(i=this._glyphWidget)||void 0===i||i.hide()}_onKeyDown(e){var t;if(!this._editor.hasModel())return;const i=this._keybindingService.softDispatch(e,this._editor.getDomNode()),o=1===i.kind||2===i.kind&&"editor.action.showHover"===i.commandId&&(null===(t=this._contentWidget)||void 0===t?void 0:t.isVisible);5===e.keyCode||6===e.keyCode||57===e.keyCode||4===e.keyCode||o||this._hideWidgets()}_hideWidgets(){var e,t,i;mt||this._isMouseDown&&this._hoverClicked&&(null===(e=this._contentWidget)||void 0===e?void 0:e.isColorPickerVisible)||gt.QG.dropDownVisible||(this._hoverActivatedByColorDecoratorClick=!1,this._hoverClicked=!1,null===(t=this._glyphWidget)||void 0===t||t.hide(),null===(i=this._contentWidget)||void 0===i||i.hide())}_getOrCreateContentWidget(){return this._contentWidget||(this._contentWidget=this._instantiationService.createInstance(W,this._editor)),this._contentWidget}showContentHover(e,t,i,o,n=!1){this._hoverActivatedByColorDecoratorClick=n,this._getOrCreateContentWidget().startShowingAtRange(e,t,i,o)}focus(){var e;null===(e=this._contentWidget)||void 0===e||e.focus()}scrollUp(){var e;null===(e=this._contentWidget)||void 0===e||e.scrollUp()}scrollDown(){var e;null===(e=this._contentWidget)||void 0===e||e.scrollDown()}scrollLeft(){var e;null===(e=this._contentWidget)||void 0===e||e.scrollLeft()}scrollRight(){var e;null===(e=this._contentWidget)||void 0===e||e.scrollRight()}pageUp(){var e;null===(e=this._contentWidget)||void 0===e||e.pageUp()}pageDown(){var e;null===(e=this._contentWidget)||void 0===e||e.pageDown()}goToTop(){var e;null===(e=this._contentWidget)||void 0===e||e.goToTop()}goToBottom(){var e;null===(e=this._contentWidget)||void 0===e||e.goToBottom()}get isColorPickerVisible(){var e;return null===(e=this._contentWidget)||void 0===e?void 0:e.isColorPickerVisible}get isHoverVisible(){var e;return null===(e=this._contentWidget)||void 0===e?void 0:e.isVisible}dispose(){var e,t;super.dispose(),this._unhookEvents(),this._toUnhook.dispose(),null===(e=this._glyphWidget)||void 0===e||e.dispose(),null===(t=this._contentWidget)||void 0===t||t.dispose()}};vt.ID="editor.contrib.hover",vt=ut=pt([_t(1,D.TG),_t(2,ee.v4),_t(3,d.O),_t(4,k.d)],vt);class ft extends r.R6{constructor(){super({id:"editor.action.showHover",label:De.NC({key:"showOrFocusHover",comment:["Label for action that will trigger the showing/focusing of a hover in the editor.","If the hover is not visible, it will show the hover.","This allows for users to show the hover without using the mouse.","If the hover is already visible, it will take focus."]},"Show or Focus Hover"),description:{description:"Show or Focus Hover",args:[{name:"args",schema:{type:"object",properties:{focus:{description:"Controls if when triggered with the keyboard, the hover should take focus immediately.",type:"boolean",default:!1}}}}]},alias:"Show or Focus Hover",precondition:void 0,kbOpts:{kbExpr:a.u.editorTextFocus,primary:(0,o.gx)(2089,2087),weight:100}})}run(e,t,i){if(!t.hasModel())return;const o=vt.get(t);if(!o)return;const n=t.getPosition(),r=new s.e(n.lineNumber,n.column,n.lineNumber,n.column),a=2===t.getOption(2)||!!(null===i||void 0===i?void 0:i.focus);o.isHoverVisible?o.focus():o.showContentHover(r,1,1,a)}}class yt extends r.R6{constructor(){super({id:"editor.action.showDefinitionPreviewHover",label:De.NC({key:"showDefinitionPreviewHover",comment:["Label for action that will trigger the showing of definition preview hover in the editor.","This allows for users to show the definition preview hover without using the mouse."]},"Show Definition Preview Hover"),alias:"Show Definition Preview Hover",precondition:void 0})}run(e,t){const i=vt.get(t);if(!i)return;const o=t.getPosition();if(!o)return;const n=new s.e(o.lineNumber,o.column,o.lineNumber,o.column),r=l.S.get(t);if(!r)return;const a=r.startFindDefinitionFromCursor(o);a.then((()=>{i.showContentHover(n,1,1,!0)}))}}class bt extends r.R6{constructor(){super({id:"editor.action.scrollUpHover",label:De.NC({key:"scrollUpHover",comment:["Action that allows to scroll up in the hover widget with the up arrow when the hover widget is focused."]},"Scroll Up Hover"),alias:"Scroll Up Hover",precondition:a.u.hoverFocused,kbOpts:{kbExpr:a.u.hoverFocused,primary:16,weight:100}})}run(e,t){const i=vt.get(t);i&&i.scrollUp()}}class wt extends r.R6{constructor(){super({id:"editor.action.scrollDownHover",label:De.NC({key:"scrollDownHover",comment:["Action that allows to scroll down in the hover widget with the up arrow when the hover widget is focused."]},"Scroll Down Hover"),alias:"Scroll Down Hover",precondition:a.u.hoverFocused,kbOpts:{kbExpr:a.u.hoverFocused,primary:18,weight:100}})}run(e,t){const i=vt.get(t);i&&i.scrollDown()}}class Ct extends r.R6{constructor(){super({id:"editor.action.scrollLeftHover",label:De.NC({key:"scrollLeftHover",comment:["Action that allows to scroll left in the hover widget with the left arrow when the hover widget is focused."]},"Scroll Left Hover"),alias:"Scroll Left Hover",precondition:a.u.hoverFocused,kbOpts:{kbExpr:a.u.hoverFocused,primary:15,weight:100}})}run(e,t){const i=vt.get(t);i&&i.scrollLeft()}}class St extends r.R6{constructor(){super({id:"editor.action.scrollRightHover",label:De.NC({key:"scrollRightHover",comment:["Action that allows to scroll right in the hover widget with the right arrow when the hover widget is focused."]},"Scroll Right Hover"),alias:"Scroll Right Hover",precondition:a.u.hoverFocused,kbOpts:{kbExpr:a.u.hoverFocused,primary:17,weight:100}})}run(e,t){const i=vt.get(t);i&&i.scrollRight()}}class Dt extends r.R6{constructor(){super({id:"editor.action.pageUpHover",label:De.NC({key:"pageUpHover",comment:["Action that allows to page up in the hover widget with the page up command when the hover widget is focused."]},"Page Up Hover"),alias:"Page Up Hover",precondition:a.u.hoverFocused,kbOpts:{kbExpr:a.u.hoverFocused,primary:11,secondary:[528],weight:100}})}run(e,t){const i=vt.get(t);i&&i.pageUp()}}class kt extends r.R6{constructor(){super({id:"editor.action.pageDownHover",label:De.NC({key:"pageDownHover",comment:["Action that allows to page down in the hover widget with the page down command when the hover widget is focused."]},"Page Down Hover"),alias:"Page Down Hover",precondition:a.u.hoverFocused,kbOpts:{kbExpr:a.u.hoverFocused,primary:12,secondary:[530],weight:100}})}run(e,t){const i=vt.get(t);i&&i.pageDown()}}class Mt extends r.R6{constructor(){super({id:"editor.action.goToTopHover",label:De.NC({key:"goToTopHover",comment:["Action that allows to go to the top of the hover widget with the home command when the hover widget is focused."]},"Go To Top Hover"),alias:"Go To Bottom Hover",precondition:a.u.hoverFocused,kbOpts:{kbExpr:a.u.hoverFocused,primary:14,secondary:[2064],weight:100}})}run(e,t){const i=vt.get(t);i&&i.goToTop()}}class Nt extends r.R6{constructor(){super({id:"editor.action.goToBottomHover",label:De.NC({key:"goToBottomHover",comment:["Action that allows to go to the bottom in the hover widget with the end command when the hover widget is focused."]},"Go To Bottom Hover"),alias:"Go To Bottom Hover",precondition:a.u.hoverFocused,kbOpts:{kbExpr:a.u.hoverFocused,primary:13,secondary:[2066],weight:100}})}run(e,t){const i=vt.get(t);i&&i.goToBottom()}}(0,r._K)(vt.ID,vt,2),(0,r.Qr)(ft),(0,r.Qr)(yt),(0,r.Qr)(bt),(0,r.Qr)(wt),(0,r.Qr)(Ct),(0,r.Qr)(St),(0,r.Qr)(Dt),(0,r.Qr)(kt),(0,r.Qr)(Mt),(0,r.Qr)(Nt),S.Ae.register(oe.D5),S.Ae.register(ht),(0,ie.Ic)(((e,t)=>{const i=e.getColor(te.CNo);i&&(t.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${i.transparent(.5)}; }`),t.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${i.transparent(.5)}; }`),t.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${i.transparent(.5)}; }`))}))},97791:(e,t,i)=>{i.d(t,{Ae:()=>r,Qj:()=>o,YM:()=>n});class o{constructor(e,t,i,o){this.priority=e,this.range=t,this.initialMousePosX=i,this.initialMousePosY=o,this.type=1}equals(e){return 1===e.type&&this.range.equalsRange(e.range)}canAdoptVisibleHover(e,t){return 1===e.type&&t.lineNumber===this.range.startLineNumber}}class n{constructor(e,t,i,o,n,r){this.priority=e,this.owner=t,this.range=i,this.initialMousePosX=o,this.initialMousePosY=n,this.supportsMarkerHover=r,this.type=2}equals(e){return 2===e.type&&this.owner===e.owner}canAdoptVisibleHover(e,t){return 2===e.type&&this.owner===e.owner}}const r=new class{constructor(){this._participants=[]}register(e){this._participants.push(e)}getAll(){return this._participants}}},25903:(e,t,i)=>{i.d(t,{D5:()=>w,c:()=>C,hU:()=>b});var o=i(2548),n=i(21921),r=i(85398),s=i(81478),a=i(70959),d=i(92767),l=i(89999),c=i(33162),h=i(61141),u=i(48864),g=i(25206),p=i(47596),_=i(6544),m=i(16458),v=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},f=function(e,t){return function(i,o){t(i,o,e)}};const y=o.$;class b{constructor(e,t,i,o,n){this.owner=e,this.range=t,this.contents=i,this.isBeforeContent=o,this.ordinal=n}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let w=class{constructor(e,t,i,o,n){this._editor=e,this._languageService=t,this._openerService=i,this._configurationService=o,this._languageFeaturesService=n,this.hoverOrdinal=3}createLoadingMessage(e){return new b(this,e.range,[(new s.W5).appendText(g.NC("modesContentHover.loading","Loading..."))],!1,2e3)}computeSync(e,t){if(!this._editor.hasModel()||1!==e.type)return[];const i=this._editor.getModel(),o=e.range.startLineNumber,r=i.getLineMaxColumn(o),a=[];let d=1e3;const l=i.getLineLength(o),h=i.getLanguageIdAtPosition(e.range.startLineNumber,e.range.startColumn),u=this._editor.getOption(116),p=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:h});let _=!1;u>=0&&l>u&&e.range.startColumn>=u&&(_=!0,a.push(new b(this,e.range,[{value:g.NC("stopped rendering","Rendering paused for long line for performance reasons. This can be configured via `editor.stopRenderingLineAfter`.")}],!1,d++))),!_&&"number"===typeof p&&l>=p&&a.push(new b(this,e.range,[{value:g.NC("too many characters","Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.")}],!1,d++));let m=!1;for(const g of t){const t=g.range.startLineNumber===o?g.range.startColumn:1,i=g.range.endLineNumber===o?g.range.endColumn:r,l=g.options.hoverMessage;if(!l||(0,s.CP)(l))continue;g.options.beforeContentClassName&&(m=!0);const h=new c.e(e.range.startLineNumber,t,e.range.startLineNumber,i);a.push(new b(this,h,(0,n._2)(l),m,d++))}return a}computeAsync(e,t,i){if(!this._editor.hasModel()||1!==e.type)return r.Aq.EMPTY;const o=this._editor.getModel();if(!this._languageFeaturesService.hoverProvider.has(o))return r.Aq.EMPTY;const n=new l.L(e.range.startLineNumber,e.range.startColumn);return(0,u.R8)(this._languageFeaturesService.hoverProvider,o,n,i).filter((e=>!(0,s.CP)(e.hover.contents))).map((t=>{const i=t.hover.range?c.e.lift(t.hover.range):e.range;return new b(this,i,t.hover.contents,!1,t.ordinal)}))}renderHoverParts(e,t){return C(e,t,this._editor,this._languageService,this._openerService)}};function C(e,t,i,n,r){t.sort(((e,t)=>e.ordinal-t.ordinal));const l=new a.SL;for(const a of t)for(const t of a.contents){if((0,s.CP)(t))continue;const a=y("div.hover-row.markdown-hover"),c=o.R3(a,y("div.hover-contents")),h=l.add(new d.$({editor:i},n,r));l.add(h.onDidRenderAsync((()=>{c.className="hover-contents code-hover-contents",e.onContentsChanged()})));const u=l.add(h.render(t));c.appendChild(u.element),e.fragment.appendChild(a)}return l}w=v([f(1,h.O),f(2,_.v4),f(3,p.Ui),f(4,m.p)],w)},28649:(e,t,i)=>{function o(e,t){let i=0;for(let o=0;o<e.length;o++)"\t"===e.charAt(o)?i+=t:i++;return i}function n(e,t,i){e=e<0?0:e;let o="";if(!i){const i=Math.floor(e/t);e%=t;for(let e=0;e<i;e++)o+="\t"}for(let n=0;n<e;n++)o+=" ";return o}i.d(t,{J:()=>n,Y:()=>o})},92954:(e,t,i)=>{var o=i(70959),n=i(61720),r=i(48077),s=i(85175),a=i(90970),d=i(33162),l=i(54644),c=i(44950),h=i(97297),u=i(74016),g=i(28649),p=i(25206),_=i(45726),m=i(65006),v=i(52185),f=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},y=function(e,t){return function(i,o){t(i,o,e)}};function b(e,t,i,o,r){if(1===e.getLineCount()&&1===e.getLineMaxColumn(1))return[];const d=t.getLanguageConfiguration(e.getLanguageId()).indentationRules;if(!d)return[];o=Math.min(o,e.getLineCount());while(i<=o){if(!d.unIndentedLinePattern)break;const t=e.getLineContent(i);if(!d.unIndentedLinePattern.test(t))break;i++}if(i>o-1)return[];const{tabSize:c,indentSize:h,insertSpaces:u}=e.getOptions(),g=(e,t)=>(t=t||1,s.U.shiftIndent(e,e.length+t,c,h,u)),p=(e,t)=>(t=t||1,s.U.unshiftIndent(e,e.length+t,c,h,u)),_=[];let v;const f=e.getLineContent(i);let y=f;if(void 0!==r&&null!==r){v=r;const e=n.V8(f);y=v+f.substring(e.length),d.decreaseIndentPattern&&d.decreaseIndentPattern.test(y)&&(v=p(v),y=v+f.substring(e.length)),f!==y&&_.push(a.h.replaceMove(new l.Y(i,1,i,e.length+1),(0,m.x)(v,h,u)))}else v=n.V8(f);let b=v;d.increaseIndentPattern&&d.increaseIndentPattern.test(y)?(b=g(b),v=g(v)):d.indentNextLinePattern&&d.indentNextLinePattern.test(y)&&(b=g(b)),i++;for(let s=i;s<=o;s++){const t=e.getLineContent(s),i=n.V8(t),o=b+t.substring(i.length);d.decreaseIndentPattern&&d.decreaseIndentPattern.test(o)&&(b=p(b),v=p(v)),i!==b&&_.push(a.h.replaceMove(new l.Y(s,1,s,i.length+1),(0,m.x)(b,h,u))),d.unIndentedLinePattern&&d.unIndentedLinePattern.test(t)||(d.increaseIndentPattern&&d.increaseIndentPattern.test(o)?(v=g(v),b=v):b=d.indentNextLinePattern&&d.indentNextLinePattern.test(o)?g(b):v)}return _}class w extends r.R6{constructor(){super({id:w.ID,label:p.NC("indentationToSpaces","Convert Indentation to Spaces"),alias:"Convert Indentation to Spaces",precondition:c.u.writable})}run(e,t){const i=t.getModel();if(!i)return;const o=i.getOptions(),n=t.getSelection();if(!n)return;const r=new T(n,o.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[r]),t.pushUndoStop(),i.updateOptions({insertSpaces:!0})}}w.ID="editor.action.indentationToSpaces";class C extends r.R6{constructor(){super({id:C.ID,label:p.NC("indentationToTabs","Convert Indentation to Tabs"),alias:"Convert Indentation to Tabs",precondition:c.u.writable})}run(e,t){const i=t.getModel();if(!i)return;const o=i.getOptions(),n=t.getSelection();if(!n)return;const r=new E(n,o.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[r]),t.pushUndoStop(),i.updateOptions({insertSpaces:!1})}}C.ID="editor.action.indentationToTabs";class S extends r.R6{constructor(e,t,i){super(i),this.insertSpaces=e,this.displaySizeOnly=t}run(e,t){const i=e.get(_.eJ),o=e.get(u.q),n=t.getModel();if(!n)return;const r=o.getCreationOptions(n.getLanguageId(),n.uri,n.isForSimpleWidget),s=n.getOptions(),a=[1,2,3,4,5,6,7,8].map((e=>({id:e.toString(),label:e.toString(),description:e===r.tabSize&&e===s.tabSize?p.NC("configuredTabSize","Configured Tab Size"):e===r.tabSize?p.NC("defaultTabSize","Default Tab Size"):e===s.tabSize?p.NC("currentTabSize","Current Tab Size"):void 0}))),d=Math.min(n.getOptions().tabSize-1,7);setTimeout((()=>{i.pick(a,{placeHolder:p.NC({key:"selectTabWidth",comment:["Tab corresponds to the tab key"]},"Select Tab Size for Current File"),activeItem:a[d]}).then((e=>{if(e&&n&&!n.isDisposed()){const t=parseInt(e.label,10);this.displaySizeOnly?n.updateOptions({tabSize:t}):n.updateOptions({tabSize:t,indentSize:t,insertSpaces:this.insertSpaces})}}))}),50)}}class D extends S{constructor(){super(!1,!1,{id:D.ID,label:p.NC("indentUsingTabs","Indent Using Tabs"),alias:"Indent Using Tabs",precondition:void 0})}}D.ID="editor.action.indentUsingTabs";class k extends S{constructor(){super(!0,!1,{id:k.ID,label:p.NC("indentUsingSpaces","Indent Using Spaces"),alias:"Indent Using Spaces",precondition:void 0})}}k.ID="editor.action.indentUsingSpaces";class M extends S{constructor(){super(!0,!0,{id:M.ID,label:p.NC("changeTabDisplaySize","Change Tab Display Size"),alias:"Change Tab Display Size",precondition:void 0})}}M.ID="editor.action.changeTabDisplaySize";class N extends r.R6{constructor(){super({id:N.ID,label:p.NC("detectIndentation","Detect Indentation from Content"),alias:"Detect Indentation from Content",precondition:void 0})}run(e,t){const i=e.get(u.q),o=t.getModel();if(!o)return;const n=i.getCreationOptions(o.getLanguageId(),o.uri,o.isForSimpleWidget);o.detectIndentation(n.insertSpaces,n.tabSize)}}N.ID="editor.action.detectIndentation";class P extends r.R6{constructor(){super({id:"editor.action.reindentlines",label:p.NC("editor.reindentlines","Reindent Lines"),alias:"Reindent Lines",precondition:c.u.writable})}run(e,t){const i=e.get(h.c_),o=t.getModel();if(!o)return;const n=b(o,i,1,o.getLineCount());n.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,n),t.pushUndoStop())}}class R extends r.R6{constructor(){super({id:"editor.action.reindentselectedlines",label:p.NC("editor.reindentselectedlines","Reindent Selected Lines"),alias:"Reindent Selected Lines",precondition:c.u.writable})}run(e,t){const i=e.get(h.c_),o=t.getModel();if(!o)return;const n=t.getSelections();if(null===n)return;const r=[];for(const s of n){let e=s.startLineNumber,t=s.endLineNumber;if(e!==t&&1===s.endColumn&&t--,1===e){if(e===t)continue}else e--;const n=b(o,i,e,t);r.push(...n)}r.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,r),t.pushUndoStop())}}class x{constructor(e,t){this._initialSelection=t,this._edits=[],this._selectionId=null;for(const i of e)i.range&&"string"===typeof i.text&&this._edits.push(i)}getEditOperations(e,t){for(const o of this._edits)t.addEditOperation(d.e.lift(o.range),o.text);let i=!1;Array.isArray(this._edits)&&1===this._edits.length&&this._initialSelection.isEmpty()&&(this._edits[0].range.startColumn===this._initialSelection.endColumn&&this._edits[0].range.startLineNumber===this._initialSelection.endLineNumber?(i=!0,this._selectionId=t.trackSelection(this._initialSelection,!0)):this._edits[0].range.endColumn===this._initialSelection.startColumn&&this._edits[0].range.endLineNumber===this._initialSelection.startLineNumber&&(i=!0,this._selectionId=t.trackSelection(this._initialSelection,!1))),i||(this._selectionId=t.trackSelection(this._initialSelection))}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}let L=class{constructor(e,t){this.editor=e,this._languageConfigurationService=t,this.callOnDispose=new o.SL,this.callOnModel=new o.SL,this.callOnDispose.add(e.onDidChangeConfiguration((()=>this.update()))),this.callOnDispose.add(e.onDidChangeModel((()=>this.update()))),this.callOnDispose.add(e.onDidChangeModelLanguage((()=>this.update())))}update(){this.callOnModel.clear(),this.editor.getOption(12)<4||this.editor.getOption(55)||this.editor.hasModel()&&this.callOnModel.add(this.editor.onDidPaste((({range:e})=>{this.trigger(e)})))}trigger(e){const t=this.editor.getSelections();if(null===t||t.length>1)return;const i=this.editor.getModel();if(!i)return;if(!i.tokenization.isCheapToTokenize(e.getStartPosition().lineNumber))return;const o=this.editor.getOption(12),{tabSize:r,indentSize:a,insertSpaces:l}=i.getOptions(),c=[],h={shiftIndent:e=>s.U.shiftIndent(e,e.length+1,r,a,l),unshiftIndent:e=>s.U.unshiftIndent(e,e.length+1,r,a,l)};let u=e.startLineNumber;while(u<=e.endLineNumber){if(!this.shouldIgnoreLine(i,u))break;u++}if(u>e.endLineNumber)return;let p=i.getLineContent(u);if(!/\S/.test(p.substring(0,e.startColumn-1))){const e=(0,v.n8)(o,i,i.getLanguageId(),u,h,this._languageConfigurationService);if(null!==e){const t=n.V8(p),o=g.Y(e,r),s=g.Y(t,r);if(o!==s){const e=g.J(o,r,l);c.push({range:new d.e(u,1,u,t.length+1),text:e}),p=e+p.substr(t.length)}else{const e=(0,v.tI)(i,u,this._languageConfigurationService);if(0===e||8===e)return}}}const _=u;while(u<e.endLineNumber){if(/\S/.test(i.getLineContent(u+1)))break;u++}if(u!==e.endLineNumber){const t={tokenization:{getLineTokens:e=>i.tokenization.getLineTokens(e),getLanguageId:()=>i.getLanguageId(),getLanguageIdAtPosition:(e,t)=>i.getLanguageIdAtPosition(e,t)},getLineContent:e=>e===_?p:i.getLineContent(e)},s=(0,v.n8)(o,t,i.getLanguageId(),u+1,h,this._languageConfigurationService);if(null!==s){const t=g.Y(s,r),o=g.Y(n.V8(i.getLineContent(u+1)),r);if(t!==o){const s=t-o;for(let t=u+1;t<=e.endLineNumber;t++){const e=i.getLineContent(t),o=n.V8(e),a=g.Y(o,r),h=a+s,u=g.J(h,r,l);u!==o&&c.push({range:new d.e(t,1,t,o.length+1),text:u})}}}}if(c.length>0){this.editor.pushUndoStop();const e=new x(c,this.editor.getSelection());this.editor.executeCommand("autoIndentOnPaste",e),this.editor.pushUndoStop()}}shouldIgnoreLine(e,t){e.tokenization.forceTokenization(t);const i=e.getLineFirstNonWhitespaceColumn(t);if(0===i)return!0;const o=e.tokenization.getLineTokens(t);if(o.getCount()>0){const e=o.findTokenIndexAtOffset(i);if(e>=0&&1===o.getStandardTokenType(e))return!0}return!1}dispose(){this.callOnDispose.dispose(),this.callOnModel.dispose()}};function I(e,t,i,o){if(1===e.getLineCount()&&1===e.getLineMaxColumn(1))return;let n="";for(let s=0;s<i;s++)n+=" ";const r=new RegExp(n,"gi");for(let s=1,a=e.getLineCount();s<=a;s++){let i=e.getLineFirstNonWhitespaceColumn(s);if(0===i&&(i=e.getLineMaxColumn(s)),1===i)continue;const a=new d.e(s,1,s,i),l=e.getValueInRange(a),c=o?l.replace(/\t/gi,n):l.replace(r,"\t");t.addEditOperation(a,c)}}L.ID="editor.contrib.autoIndentOnPaste",L=f([y(1,h.c_)],L);class T{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),I(e,t,this.tabSize,!0)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}class E{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),I(e,t,this.tabSize,!1)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}(0,r._K)(L.ID,L,2),(0,r.Qr)(w),(0,r.Qr)(C),(0,r.Qr)(D),(0,r.Qr)(k),(0,r.Qr)(M),(0,r.Qr)(N),(0,r.Qr)(P),(0,r.Qr)(R)}}]);