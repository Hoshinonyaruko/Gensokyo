"use strict";(globalThis["webpackChunkfrontend"]=globalThis["webpackChunkfrontend"]||[]).push([[41],{73632:(e,t,n)=>{var i=n(48077),o=n(97791),s=n(2548),r=n(21921),a=n(85398),l=n(55191),d=n(98642),c=n(70959),u=n(71400),h=n(55455),g=n(95896),p=n(81086),m=n(95402),f=n(93215),v=n(90970),_=n(33162),C=n(67026),b=n(79857),S=n(16375),w=n(54732),x=n(16458),L=n(15498),y=n(28130),N=n(89999),I=n(50200),M=function(e,t,n,i){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function r(e){try{l(i.next(e))}catch(t){s(t)}}function a(e){try{l(i["throw"](e))}catch(t){s(t)}}function l(e){e.done?n(e.value):o(e.value).then(r,a)}l((i=i.apply(e,t||[])).next())}))};class T{constructor(e,t){this.range=e,this.direction=t}}class R{constructor(e,t,n){this.hint=e,this.anchor=t,this.provider=n,this._isResolved=!1}with(e){const t=new R(this.hint,e.anchor,this.provider);return t._isResolved=this._isResolved,t._currentResolve=this._currentResolve,t}resolve(e){return M(this,void 0,void 0,(function*(){if("function"===typeof this.provider.resolveInlayHint){if(this._currentResolve){if(yield this._currentResolve,e.isCancellationRequested)return;return this.resolve(e)}this._isResolved||(this._currentResolve=this._doResolve(e).finally((()=>this._currentResolve=void 0))),yield this._currentResolve}}))}_doResolve(e){var t,n;return M(this,void 0,void 0,(function*(){try{const i=yield Promise.resolve(this.provider.resolveInlayHint(this.hint,e));this.hint.tooltip=null!==(t=null===i||void 0===i?void 0:i.tooltip)&&void 0!==t?t:this.hint.tooltip,this.hint.label=null!==(n=null===i||void 0===i?void 0:i.label)&&void 0!==n?n:this.hint.label,this._isResolved=!0}catch(i){(0,d.Cp)(i),this._isResolved=!1}}))}}class O{static create(e,t,n,i){return M(this,void 0,void 0,(function*(){const o=[],s=e.ordered(t).reverse().map((e=>n.map((n=>M(this,void 0,void 0,(function*(){try{const s=yield e.provideInlayHints(t,n,i);(null===s||void 0===s?void 0:s.hints.length)&&o.push([s,e])}catch(s){(0,d.Cp)(s)}}))))));if(yield Promise.all(s.flat()),i.isCancellationRequested||t.isDisposed())throw new d.FU;return new O(n,o,t)}))}constructor(e,t,n){this._disposables=new c.SL,this.ranges=e,this.provider=new Set;const i=[];for(const[o,s]of t){this._disposables.add(o),this.provider.add(s);for(const e of o.hints){const t=n.validatePosition(e.position);let o="before";const r=O._getRangeAtPosition(n,t);let a;r.getStartPosition().isBefore(t)?(a=_.e.fromPositions(r.getStartPosition(),t),o="after"):(a=_.e.fromPositions(t,r.getEndPosition()),o="before"),i.push(new R(e,new T(a,o),s))}}this.items=i.sort(((e,t)=>N.L.compare(e.hint.position,t.hint.position)))}dispose(){this._disposables.dispose()}static _getRangeAtPosition(e,t){const n=t.lineNumber,i=e.getWordAtPosition(t);if(i)return new _.e(n,i.startColumn,n,i.endColumn);e.tokenization.tokenizeIfCheap(n);const o=e.tokenization.getLineTokens(n),s=t.column-1,r=o.findTokenIndexAtOffset(s);let a=o.getStartOffset(r),l=o.getEndOffset(r);return l-a===1&&(a===s&&r>1?(a=o.getStartOffset(r-1),l=o.getEndOffset(r-1)):l===s&&r<o.getCount()-1&&(a=o.getStartOffset(r+1),l=o.getEndOffset(r+1))),new _.e(n,a+1,n,l+1)}}function D(e){return g.o.from({scheme:I.lg.command,path:e.id,query:e.arguments&&encodeURIComponent(JSON.stringify(e.arguments))}).toString()}var P=n(23507),E=n(46871),A=n(39326),k=n(21881),F=n(18736),V=n(47277),H=n(32656),W=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},U=function(e,t){return function(n,i){t(n,i,e)}},B=function(e,t,n,i){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function r(e){try{l(i.next(e))}catch(t){s(t)}}function a(e){try{l(i["throw"](e))}catch(t){s(t)}}function l(e){e.done?n(e.value):o(e.value).then(r,a)}l((i=i.apply(e,t||[])).next())}))};class K{constructor(){this._entries=new u.z6(50)}get(e){const t=K._key(e);return this._entries.get(t)}set(e,t){const n=K._key(e);this._entries.set(n,t)}static _key(e){return`${e.uri.toString()}/${e.getVersionId()}`}}const j=(0,k.yh)("IInlayHintsCache");(0,A.z)(j,K,1);class q{constructor(e,t){this.item=e,this.index=t}get part(){const e=this.item.hint.label;return"string"===typeof e?{label:e}:e[this.index]}}class Y{constructor(e,t){this.part=e,this.hasTriggerModifier=t}}let Q=class e{static get(t){var n;return null!==(n=t.getContribution(e.ID))&&void 0!==n?n:void 0}constructor(e,t,n,i,o,s,r){this._editor=e,this._languageFeaturesService=t,this._inlayHintsCache=i,this._commandService=o,this._notificationService=s,this._instaService=r,this._disposables=new c.SL,this._sessionDisposables=new c.SL,this._decorationsMetadata=new Map,this._ruleFactory=new p.t7(this._editor),this._activeRenderMode=0,this._debounceInfo=n.for(t.inlayHintsProvider,"InlayHint",{min:25}),this._disposables.add(t.inlayHintsProvider.onDidChange((()=>this._update()))),this._disposables.add(e.onDidChangeModel((()=>this._update()))),this._disposables.add(e.onDidChangeModelLanguage((()=>this._update()))),this._disposables.add(e.onDidChangeConfiguration((e=>{e.hasChanged(138)&&this._update()}))),this._update()}dispose(){this._sessionDisposables.dispose(),this._removeAllDecorations(),this._disposables.dispose()}_update(){this._sessionDisposables.clear(),this._removeAllDecorations();const e=this._editor.getOption(138);if("off"===e.enabled)return;const t=this._editor.getModel();if(!t||!this._languageFeaturesService.inlayHintsProvider.has(t))return;const n=this._inlayHintsCache.get(t);let i;n&&this._updateHintsDecorators([t.getFullModelRange()],n),this._sessionDisposables.add((0,c.OF)((()=>{t.isDisposed()||this._cacheHintsForFastRestore(t)})));const o=new Set,r=new a.pY((()=>B(this,void 0,void 0,(function*(){const e=Date.now();null===i||void 0===i||i.dispose(!0),i=new l.A;const n=t.onWillDispose((()=>null===i||void 0===i?void 0:i.cancel()));try{const n=i.token,s=yield O.create(this._languageFeaturesService.inlayHintsProvider,t,this._getHintsRanges(),n);if(r.delay=this._debounceInfo.update(t,Date.now()-e),n.isCancellationRequested)return void s.dispose();for(const e of s.provider)"function"!==typeof e.onDidChangeInlayHints||o.has(e)||(o.add(e),this._sessionDisposables.add(e.onDidChangeInlayHints((()=>{r.isScheduled()||r.schedule()}))));this._sessionDisposables.add(s),this._updateHintsDecorators(s.ranges,s.items),this._cacheHintsForFastRestore(t)}catch(s){(0,d.dL)(s)}finally{i.dispose(),n.dispose()}}))),this._debounceInfo.get(t));if(this._sessionDisposables.add(r),this._sessionDisposables.add((0,c.OF)((()=>null===i||void 0===i?void 0:i.dispose(!0)))),r.schedule(0),this._sessionDisposables.add(this._editor.onDidScrollChange((e=>{!e.scrollTopChanged&&r.isScheduled()||r.schedule()}))),this._sessionDisposables.add(this._editor.onDidChangeModelContent((e=>{const t=Math.max(r.delay,1250);r.schedule(t)}))),"on"===e.enabled)this._activeRenderMode=0;else{let t,n;"onUnlessPressed"===e.enabled?(t=0,n=1):(t=1,n=0),this._activeRenderMode=t,this._sessionDisposables.add(s._q.getInstance().event((e=>{if(!this._editor.hasModel())return;const i=e.altKey&&e.ctrlKey&&!e.shiftKey&&!e.metaKey?n:t;if(i!==this._activeRenderMode){this._activeRenderMode=i;const e=this._editor.getModel(),t=this._copyInlayHintsWithCurrentAnchor(e);this._updateHintsDecorators([e.getFullModelRange()],t),r.schedule(0)}})))}this._sessionDisposables.add(this._installDblClickGesture((()=>r.schedule(0)))),this._sessionDisposables.add(this._installLinkGesture()),this._sessionDisposables.add(this._installContextMenu())}_installLinkGesture(){const e=new c.SL,t=e.add(new y.yN(this._editor)),n=new c.SL;return e.add(n),e.add(t.onMouseMoveOrRelevantKeyDown((e=>{const[t]=e,i=this._getInlayHintLabelPart(t),o=this._editor.getModel();if(!i||!o)return void n.clear();const s=new l.A;n.add((0,c.OF)((()=>s.dispose(!0)))),i.item.resolve(s.token),this._activeInlayHintPart=i.part.command||i.part.location?new Y(i,t.hasTriggerModifier):void 0;const r=o.validatePosition(i.item.hint.position).lineNumber,a=new _.e(r,1,r,o.getLineMaxColumn(r)),d=this._getInlineHintsForRange(a);this._updateHintsDecorators([a],d),n.add((0,c.OF)((()=>{this._activeInlayHintPart=void 0,this._updateHintsDecorators([a],d)})))}))),e.add(t.onCancel((()=>n.clear()))),e.add(t.onExecute((e=>B(this,void 0,void 0,(function*(){const t=this._getInlayHintLabelPart(e);if(t){const n=t.part;n.location?this._instaService.invokeFunction(P.K,e,this._editor,n.location):C.mY.is(n.command)&&(yield this._invokeCommand(n.command,t.item))}}))))),e}_getInlineHintsForRange(e){const t=new Set;for(const n of this._decorationsMetadata.values())e.containsRange(n.item.anchor.range)&&t.add(n.item);return Array.from(t)}_installDblClickGesture(e){return this._editor.onMouseUp((t=>B(this,void 0,void 0,(function*(){if(2!==t.event.detail)return;const n=this._getInlayHintLabelPart(t);if(n&&(t.event.preventDefault(),yield n.item.resolve(l.T.None),(0,r.Of)(n.item.hint.textEdits))){const t=n.item.hint.textEdits.map((e=>v.h.replace(_.e.lift(e.range),e.text)));this._editor.executeEdits("inlayHint.default",t),e()}}))))}_installContextMenu(){return this._editor.onContextMenu((e=>B(this,void 0,void 0,(function*(){if(!(e.event.target instanceof HTMLElement))return;const t=this._getInlayHintLabelPart(e);t&&(yield this._instaService.invokeFunction(P.u,this._editor,e.event.target,t))}))))}_getInlayHintLabelPart(e){var t;if(6!==e.target.type)return;const n=null===(t=e.target.detail.injectedText)||void 0===t?void 0:t.options;return n instanceof S.HS&&(null===n||void 0===n?void 0:n.attachedData)instanceof q?n.attachedData:void 0}_invokeCommand(e,t){var n;return B(this,void 0,void 0,(function*(){try{yield this._commandService.executeCommand(e.id,...null!==(n=e.arguments)&&void 0!==n?n:[])}catch(i){this._notificationService.notify({severity:F.zb.Error,source:t.provider.displayName,message:i})}}))}_cacheHintsForFastRestore(e){const t=this._copyInlayHintsWithCurrentAnchor(e);this._inlayHintsCache.set(e,t)}_copyInlayHintsWithCurrentAnchor(e){const t=new Map;for(const[n,i]of this._decorationsMetadata){if(t.has(i.item))continue;const o=e.getDecorationRange(n);if(o){const e=new T(o,i.item.anchor.direction),n=i.item.with({anchor:e});t.set(i.item,n)}}return Array.from(t.values())}_getHintsRanges(){const e=30,t=this._editor.getModel(),n=this._editor.getVisibleRangesPlusViewportAboveBelow(),i=[];for(const o of n.sort(_.e.compareRangesUsingStarts)){const n=t.validateRange(new _.e(o.startLineNumber-e,o.startColumn,o.endLineNumber+e,o.endColumn));0!==i.length&&_.e.areIntersectingOrTouching(i[i.length-1],n)?i[i.length-1]=_.e.plusRange(i[i.length-1],n):i.push(n)}return i}_updateHintsDecorators(t,n){var i,o;const s=[],a=(e,t,n,i,o)=>{const r={content:n,inlineClassNameAffectsLetterSpacing:!0,inlineClassName:t.className,cursorStops:i,attachedData:o};s.push({item:e,classNameRef:t,decoration:{range:e.anchor.range,options:{description:"InlayHint",showIfCollapsed:e.anchor.range.isEmpty(),collapseOnReplaceEdit:!e.anchor.range.isEmpty(),stickiness:0,[e.anchor.direction]:0===this._activeRenderMode?r:void 0}}})},l=(e,t)=>{const n=this._ruleFactory.createClassNameRef({width:(d/3|0)+"px",display:"inline-block"});a(e,n," ",t?b.RM.Right:b.RM.None)},{fontSize:d,fontFamily:c,padding:u,isUniform:h}=this._getLayoutInfo(),g="--code-editorInlayHintsFontFamily";this._editor.getContainerDomNode().style.setProperty(g,c);for(const m of n){m.hint.paddingLeft&&l(m,!1);const t="string"===typeof m.hint.label?[{label:m.hint.label}]:m.hint.label;for(let e=0;e<t.length;e++){const n=t[e],o=0===e,s=e===t.length-1,l={fontSize:`${d}px`,fontFamily:`var(${g}), ${f.hL.fontFamily}`,verticalAlign:h?"baseline":"middle",unicodeBidi:"isolate"};(0,r.Of)(m.hint.textEdits)&&(l.cursor="default"),this._fillInColors(l,m.hint),(n.command||n.location)&&(null===(i=this._activeInlayHintPart)||void 0===i?void 0:i.part.item)===m&&this._activeInlayHintPart.part.index===e&&(l.textDecoration="underline",this._activeInlayHintPart.hasTriggerModifier&&(l.color=(0,H.EN)(V._Yy),l.cursor="pointer")),u&&(o&&s?(l.padding=`1px ${0|Math.max(1,d/4)}px`,l.borderRadius=(d/4|0)+"px"):o?(l.padding=`1px 0 1px ${0|Math.max(1,d/4)}px`,l.borderRadius=`${d/4|0}px 0 0 ${d/4|0}px`):s?(l.padding=`1px ${0|Math.max(1,d/4)}px 1px 0`,l.borderRadius=`0 ${d/4|0}px ${d/4|0}px 0`):l.padding="1px 0 1px 0"),a(m,this._ruleFactory.createClassNameRef(l),$(n.label),s&&!m.hint.paddingRight?b.RM.Right:b.RM.None,new q(m,e))}if(m.hint.paddingRight&&l(m,!0),s.length>e._MAX_DECORATORS)break}const p=[];for(const e of t)for(const{id:t}of null!==(o=this._editor.getDecorationsInRange(e))&&void 0!==o?o:[]){const e=this._decorationsMetadata.get(t);e&&(p.push(t),e.classNameRef.dispose(),this._decorationsMetadata.delete(t))}const v=m.Z.capture(this._editor);this._editor.changeDecorations((e=>{const t=e.deltaDecorations(p,s.map((e=>e.decoration)));for(let n=0;n<t.length;n++){const e=s[n];this._decorationsMetadata.set(t[n],e)}})),v.restore(this._editor)}_fillInColors(e,t){t.kind===C.gl.Parameter?(e.backgroundColor=(0,H.EN)(V.phM),e.color=(0,H.EN)(V.HCL)):t.kind===C.gl.Type?(e.backgroundColor=(0,H.EN)(V.bKB),e.color=(0,H.EN)(V.hX8)):(e.backgroundColor=(0,H.EN)(V.PpC),e.color=(0,H.EN)(V.VVv))}_getLayoutInfo(){const e=this._editor.getOption(138),t=e.padding,n=this._editor.getOption(51),i=this._editor.getOption(48);let o=e.fontSize;(!o||o<5||o>n)&&(o=n);const s=e.fontFamily||i,r=!t&&s===i&&o===n;return{fontSize:o,fontFamily:s,padding:t,isUniform:r}}_removeAllDecorations(){this._editor.removeDecorations(Array.from(this._decorationsMetadata.keys()));for(const e of this._decorationsMetadata.values())e.classNameRef.dispose();this._decorationsMetadata.clear()}};function $(e){const t=" ";return e.replace(/[ \t]/g,t)}Q.ID="editor.contrib.InlayHints",Q._MAX_DECORATORS=1500,Q=W([U(1,x.p),U(2,w.A),U(3,j),U(4,E.H),U(5,F.lT),U(6,k.TG)],Q),E.P.registerCommand("_executeInlayHintProvider",((e,...t)=>B(void 0,void 0,void 0,(function*(){const[n,i]=t;(0,h.p_)(g.o.isUri(n)),(0,h.p_)(_.e.isIRange(i));const{inlayHintsProvider:o}=e.get(x.p),s=yield e.get(L.S).createModelReference(n);try{const e=yield O.create(o,s.object.textEditorModel,[_.e.lift(i)],l.T.None),t=e.items.map((e=>e.hint));return setTimeout((()=>e.dispose()),0),t}finally{s.dispose()}}))));var z=n(81478),G=n(61141),Z=n(48864),J=n(25903),X=n(47596),ee=n(6544),te=n(25206),ne=n(47606),ie=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},oe=function(e,t){return function(n,i){t(n,i,e)}},se=function(e,t,n,i){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function r(e){try{l(i.next(e))}catch(t){s(t)}}function a(e){try{l(i["throw"](e))}catch(t){s(t)}}function l(e){e.done?n(e.value):o(e.value).then(r,a)}l((i=i.apply(e,t||[])).next())}))},re=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"===typeof __values?__values(e):e[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,s){t=e[n](t),o(i,s,t.done,t.value)}))}}function o(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)}};class ae extends o.YM{constructor(e,t,n,i){super(10,t,e.item.anchor.range,n,i,!0),this.part=e}}let le=class extends J.D5{constructor(e,t,n,i,o,s){super(e,t,n,i,s),this._resolverService=o,this.hoverOrdinal=6}suggestHoverAnchor(e){var t;const n=Q.get(this._editor);if(!n)return null;if(6!==e.target.type)return null;const i=null===(t=e.target.detail.injectedText)||void 0===t?void 0:t.options;return i instanceof S.HS&&i.attachedData instanceof q?new ae(i.attachedData,this,e.event.posx,e.event.posy):null}computeSync(){return[]}computeAsync(e,t,n){return e instanceof ae?new a.Aq((t=>se(this,void 0,void 0,(function*(){var i,o,s,a;const{part:l}=e;if(yield l.item.resolve(n),n.isCancellationRequested)return;let d,c;if("string"===typeof l.item.hint.tooltip?d=(new z.W5).appendText(l.item.hint.tooltip):l.item.hint.tooltip&&(d=l.item.hint.tooltip),d&&t.emitOne(new J.hU(this,e.range,[d],!1,0)),(0,r.Of)(l.item.hint.textEdits)&&t.emitOne(new J.hU(this,e.range,[(new z.W5).appendText((0,te.NC)("hint.dbl","Double-click to insert"))],!1,10001)),"string"===typeof l.part.tooltip?c=(new z.W5).appendText(l.part.tooltip):l.part.tooltip&&(c=l.part.tooltip),c&&t.emitOne(new J.hU(this,e.range,[c],!1,1)),l.part.location||l.part.command){let n;const i="altKey"===this._editor.getOption(76),o=i?ne.dz?(0,te.NC)("links.navigate.kb.meta.mac","cmd + click"):(0,te.NC)("links.navigate.kb.meta","ctrl + click"):ne.dz?(0,te.NC)("links.navigate.kb.alt.mac","option + click"):(0,te.NC)("links.navigate.kb.alt","alt + click");l.part.location&&l.part.command?n=(new z.W5).appendText((0,te.NC)("hint.defAndCommand","Go to Definition ({0}), right click for more",o)):l.part.location?n=(new z.W5).appendText((0,te.NC)("hint.def","Go to Definition ({0})",o)):l.part.command&&(n=new z.W5(`[${(0,te.NC)("hint.cmd","Execute Command")}](${D(l.part.command)} "${l.part.command.title}") (${o})`,{isTrusted:!0})),n&&t.emitOne(new J.hU(this,e.range,[n],!1,1e4))}const u=yield this._resolveInlayHintLabelPartHover(l,n);try{for(var h,g=!0,p=re(u);h=yield p.next(),i=h.done,!i;g=!0){a=h.value,g=!1;const e=a;t.emitOne(e)}}catch(m){o={error:m}}finally{try{g||i||!(s=p.return)||(yield s.call(p))}finally{if(o)throw o.error}}})))):a.Aq.EMPTY}_resolveInlayHintLabelPartHover(e,t){return se(this,void 0,void 0,(function*(){if(!e.part.location)return a.Aq.EMPTY;const{uri:n,range:i}=e.part.location,o=yield this._resolverService.createModelReference(n);try{const n=o.object.textEditorModel;return this._languageFeaturesService.hoverProvider.has(n)?(0,Z.R8)(this._languageFeaturesService.hoverProvider,n,new N.L(i.startLineNumber,i.startColumn),t).filter((e=>!(0,z.CP)(e.hover.contents))).map((t=>new J.hU(this,e.item.anchor.range,t.hover.contents,!1,2+t.ordinal))):a.Aq.EMPTY}finally{o.dispose()}}))}};le=ie([oe(1,G.O),oe(2,ee.v4),oe(3,X.Ui),oe(4,L.S),oe(5,x.p)],le),(0,i._K)(Q.ID,Q,1),o.Ae.register(le)},23507:(e,t,n)=>{n.d(t,{K:()=>C,u:()=>_});var i=n(2548),o=n(10205),s=n(55191),r=n(7091),a=n(33162),l=n(15498),d=n(68703),c=n(78097),u=n(82693),h=n(46871),g=n(37174),p=n(93753),m=n(21881),f=n(18736),v=function(e,t,n,i){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function r(e){try{l(i.next(e))}catch(t){s(t)}}function a(e){try{l(i["throw"](e))}catch(t){s(t)}}function l(e){e.done?n(e.value):o(e.value).then(r,a)}l((i=i.apply(e,t||[])).next())}))};function _(e,t,n,c){var g;return v(this,void 0,void 0,(function*(){const _=e.get(l.S),C=e.get(p.i),b=e.get(h.H),S=e.get(m.TG),w=e.get(f.lT);if(yield c.item.resolve(s.T.None),!c.part.location)return;const x=c.part.location,L=[],y=new Set(u.BH.getMenuItems(u.eH.EditorContext).map((e=>(0,u.vr)(e)?e.command.id:(0,r.R)())));for(const e of d.Bj.all())y.has(e.desc.id)&&L.push(new o.aU(e.desc.id,u.U8.label(e.desc,{renderShortTitle:!0}),void 0,!0,(()=>v(this,void 0,void 0,(function*(){const n=yield _.createModelReference(x.uri);try{const i=new d._k(n.object.textEditorModel,a.e.getStartPosition(x.range)),o=c.item.anchor.range;yield S.invokeFunction(e.runEditorCommand.bind(e),t,i,o)}finally{n.dispose()}})))));if(c.part.command){const{command:e}=c.part;L.push(new o.Z0),L.push(new o.aU(e.id,e.title,void 0,!0,(()=>v(this,void 0,void 0,(function*(){var t;try{yield b.executeCommand(e.id,...null!==(t=e.arguments)&&void 0!==t?t:[])}catch(n){w.notify({severity:f.zb.Error,source:c.item.provider.displayName,message:n})}})))))}const N=t.getOption(125);C.showContextMenu({domForShadowRoot:N&&null!==(g=t.getDomNode())&&void 0!==g?g:void 0,getAnchor:()=>{const e=i.i(n);return{x:e.left,y:e.top+e.height+8}},getActions:()=>L,onHide:()=>{t.focus()},autoSelectFirstItem:!0})}))}function C(e,t,n,i){return v(this,void 0,void 0,(function*(){const o=e.get(l.S),s=yield o.createModelReference(i.uri);yield n.invokeWithinContext((e=>v(this,void 0,void 0,(function*(){const o=t.hasSideBySideModifier,r=e.get(g.i6),l=c.Jy.inPeekEditor.getValue(r),u=!o&&n.getOption(86)&&!l,h=new d.BT({openToSide:o,openInPeek:u,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0});return h.run(e,new d._k(s.object.textEditorModel,a.e.getStartPosition(i.range)),a.e.lift(i.range))})))),s.dispose()}))}},34665:(e,t,n)=>{n.d(t,{Np:()=>o,OW:()=>s,Ou:()=>i});const i="editor.action.inlineSuggest.commit",o="editor.action.inlineSuggest.showPrevious",s="editor.action.inlineSuggest.showNext"},42985:(e,t,n)=>{n.d(t,{f:()=>d});var i=n(90168),o=n(61720),s=n(16779),r=n(37174),a=n(70959),l=n(25206);class d extends a.JT{constructor(e,t){super(),this.contextKeyService=e,this.model=t,this.inlineCompletionVisible=d.inlineSuggestionVisible.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentation=d.inlineSuggestionHasIndentation.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentationLessThanTabSize=d.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService),this.suppressSuggestions=d.suppressSuggestions.bindTo(this.contextKeyService),this._register((0,i.EH)("update context key: inlineCompletionVisible, suppressSuggestions",(e=>{const t=this.model.read(e),n=null===t||void 0===t?void 0:t.state.read(e),i=!!(null===n||void 0===n?void 0:n.inlineCompletion)&&void 0!==(null===n||void 0===n?void 0:n.ghostText)&&!(null===n||void 0===n?void 0:n.ghostText.isEmpty());this.inlineCompletionVisible.set(i),(null===n||void 0===n?void 0:n.ghostText)&&(null===n||void 0===n?void 0:n.inlineCompletion)&&this.suppressSuggestions.set(n.inlineCompletion.inlineCompletion.source.inlineCompletions.suppressSuggestions)}))),this._register((0,i.EH)("update context key: inlineCompletionSuggestsIndentation, inlineCompletionSuggestsIndentationLessThanTabSize",(e=>{const t=this.model.read(e);let n=!1,i=!0;const r=null===t||void 0===t?void 0:t.ghostText.read(e);if((null===t||void 0===t?void 0:t.selectedSuggestItem)&&r&&r.parts.length>0){const{column:e,lines:a}=r.parts[0],l=a[0],d=t.textModel.getLineIndentColumn(r.lineNumber),c=e<=d;if(c){let e=(0,o.LC)(l);-1===e&&(e=l.length-1),n=e>0;const r=t.textModel.getOptions().tabSize,a=s.i.visibleColumnFromColumn(l,e+1,r);i=a<r}}this.inlineCompletionSuggestsIndentation.set(n),this.inlineCompletionSuggestsIndentationLessThanTabSize.set(i)})))}}d.inlineSuggestionVisible=new r.uy("inlineSuggestionVisible",!1,(0,l.NC)("inlineSuggestionVisible","Whether an inline suggestion is visible")),d.inlineSuggestionHasIndentation=new r.uy("inlineSuggestionHasIndentation",!1,(0,l.NC)("inlineSuggestionHasIndentation","Whether the inline suggestion starts with whitespace")),d.inlineSuggestionHasIndentationLessThanTabSize=new r.uy("inlineSuggestionHasIndentationLessThanTabSize",!0,(0,l.NC)("inlineSuggestionHasIndentationLessThanTabSize","Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab")),d.suppressSuggestions=new r.uy("inlineSuggestionSuppressSuggestions",void 0,(0,l.NC)("suppressSuggestions","Whether suggestions should be suppressed for the current suggestion"))},21053:(e,t,n)=>{var i=n(48077),o=n(97791),s=n(90168),r=n(44950),a=n(34665),l=n(42985),d=n(69332),c=n(11271),u=n(70959),h=n(33125),g=n(25109),p=n(89999),m=n(54732),f=n(16458),v=n(82168),_=n(61720),C=n(6155),b=n(93215),S=n(33162),w=n(69427),x=n(61141),L=n(79857),y=n(81083),N=n(56998),I=n(93489),M=n(98642);function T(e,t){const n=new R(e),i=t.map((e=>{const t=S.e.lift(e.range);return{startOffset:n.getOffset(t.getStartPosition()),endOffset:n.getOffset(t.getEndPosition()),text:e.text}}));i.sort(((e,t)=>t.startOffset-e.startOffset));for(const o of i)e=e.substring(0,o.startOffset)+o.text+e.substring(o.endOffset);return e}class R{constructor(e){this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)"\n"===e.charAt(t)&&this.lineStartOffsetByLineIdx.push(t+1)}getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}}const O=[];function D(){return O}class P{constructor(e,t){if(this.startColumn=e,this.endColumnExclusive=t,e>t)throw new M.he(`startColumn ${e} cannot be after endColumnExclusive ${t}`)}toRange(e){return new S.e(e,this.startColumn,e,this.endColumnExclusive)}}function E(e,t){const n=new u.SL,i=e.createDecorationsCollection();return n.add((0,s.EH)(`Apply decorations from ${t.debugName}`,(e=>{const n=t.read(e);i.set(n)}))),n.add({dispose:()=>{i.clear()}}),n}function A(e,t){return new p.L(e.lineNumber+t.lineNumber-1,1===t.lineNumber?e.column+t.column-1:t.column)}function k(e){let t=1,n=1;for(const i of e)"\n"===i?(t++,n=1):n++;return new p.L(t,n)}class F{constructor(e,t){this.lineNumber=e,this.parts=t}renderForScreenReader(e){if(0===this.parts.length)return"";const t=this.parts[this.parts.length-1],n=e.substr(0,t.column-1),i=T(n,this.parts.map((e=>({range:{startLineNumber:1,endLineNumber:1,startColumn:e.column,endColumn:e.column},text:e.lines.join("\n")}))));return i.substring(this.parts[0].column-1)}isEmpty(){return this.parts.every((e=>0===e.lines.length))}get lineCount(){return 1+this.parts.reduce(((e,t)=>e+t.lines.length-1),0)}}class V{constructor(e,t,n){this.column=e,this.lines=t,this.preview=n}}class H{constructor(e,t,n,i=0){this.lineNumber=e,this.columnRange=t,this.newLines=n,this.additionalReservedLineCount=i,this.parts=[new V(this.columnRange.endColumnExclusive,this.newLines,!1)]}renderForScreenReader(e){return this.newLines.join("\n")}get lineCount(){return this.newLines.length}isEmpty(){return this.parts.every((e=>0===e.lines.length))}}var W=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},U=function(e,t){return function(n,i){t(n,i,e)}};let B=class extends u.JT{constructor(e,t,n){super(),this.editor=e,this.model=t,this.languageService=n,this.isDisposed=(0,s.uh)("isDisposed",!1),this.currentTextModel=(0,s.rD)(this.editor.onDidChangeModel,(()=>this.editor.getModel())),this.uiState=(0,s.nK)("uiState",(e=>{if(this.isDisposed.read(e))return;const t=this.currentTextModel.read(e);if(t!==this.model.targetTextModel.read(e))return;const n=this.model.ghostText.read(e);if(!n)return;const i=n instanceof H?n.columnRange:void 0,o=[],s=[];function r(e,t){if(s.length>0){const n=s[s.length-1];t&&n.decorations.push(new N.Kp(n.content.length+1,n.content.length+1+e[0].length,t,0)),n.content+=e[0],e=e.slice(1)}for(const n of e)s.push({content:n,decorations:t?[new N.Kp(1,n.length+1,t,0)]:[]})}const a=t.getLineContent(n.lineNumber);let l,d=0;for(const u of n.parts){let e=u.lines;void 0===l?(o.push({column:u.column,text:e[0],preview:u.preview}),e=e.slice(1)):r([a.substring(d,u.column-1)],void 0),e.length>0&&(r(e,"ghost-text"),void 0===l&&u.column<=a.length&&(l=u.column)),d=u.column-1}void 0!==l&&r([a.substring(d)],void 0);const c=void 0!==l?new P(l,a.length+1):void 0;return{replacedRange:i,inlineTexts:o,additionalLines:s,hiddenRange:c,lineNumber:n.lineNumber,additionalReservedLineCount:this.model.minReservedLineCount.read(e),targetTextModel:t}})),this.decorations=(0,s.nK)("decorations",(e=>{const t=this.uiState.read(e);if(!t)return[];const n=[];t.replacedRange&&n.push({range:t.replacedRange.toRange(t.lineNumber),options:{inlineClassName:"inline-completion-text-to-replace",description:"GhostTextReplacement"}}),t.hiddenRange&&n.push({range:t.hiddenRange.toRange(t.lineNumber),options:{inlineClassName:"ghost-text-hidden",description:"ghost-text-hidden"}});for(const i of t.inlineTexts)n.push({range:S.e.fromPositions(new p.L(t.lineNumber,i.column)),options:{description:"ghost-text",after:{content:i.text,inlineClassName:i.preview?"ghost-text-decoration-preview":"ghost-text-decoration",cursorStops:L.RM.Left},showIfCollapsed:!0}});return n})),this.additionalLinesWidget=this._register(new K(this.editor,this.languageService.languageIdCodec,(0,s.nK)("lines",(e=>{const t=this.uiState.read(e);return t?{lineNumber:t.lineNumber,additionalLines:t.additionalLines,minReservedLineCount:t.additionalReservedLineCount,targetTextModel:t.targetTextModel}:void 0})))),this._register((0,u.OF)((()=>{this.isDisposed.set(!0,void 0)}))),this._register(E(this.editor,this.decorations))}ownsViewZone(e){return this.additionalLinesWidget.viewZoneId===e}};B=W([U(2,x.O)],B);class K extends u.JT{get viewZoneId(){return this._viewZoneId}constructor(e,t,n){super(),this.editor=e,this.languageIdCodec=t,this.lines=n,this._viewZoneId=void 0,this.editorOptionsChanged=(0,s.aq)("editorOptionChanged",c.ju.filter(this.editor.onDidChangeConfiguration,(e=>e.hasChanged(32)||e.hasChanged(115)||e.hasChanged(97)||e.hasChanged(92)||e.hasChanged(50)||e.hasChanged(49)||e.hasChanged(65)))),this._register((0,s.EH)("update view zone",(e=>{const t=this.lines.read(e);this.editorOptionsChanged.read(e),t?this.updateLines(t.lineNumber,t.additionalLines,t.minReservedLineCount):this.clear()})))}dispose(){super.dispose(),this.clear()}clear(){this.editor.changeViewZones((e=>{this._viewZoneId&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0)}))}updateLines(e,t,n){const i=this.editor.getModel();if(!i)return;const{tabSize:o}=i.getOptions();this.editor.changeViewZones((i=>{this._viewZoneId&&(i.removeZone(this._viewZoneId),this._viewZoneId=void 0);const s=Math.max(t.length,n);if(s>0){const n=document.createElement("div");j(n,o,t,this.editor.getOptions(),this.languageIdCodec),this._viewZoneId=i.addZone({afterLineNumber:e,heightInLines:s,domNode:n,afterColumnAffinity:1})}}))}}function j(e,t,n,i,o){const s=i.get(32),r=i.get(115),a="none",l=i.get(92),d=i.get(50),c=i.get(49),u=i.get(65),h=new w.HT(1e4);h.appendString('<div class="suggest-preview-text">');for(let m=0,f=n.length;m<f;m++){const e=n[m],i=e.content;h.appendString('<div class="view-line'),h.appendString('" style="top:'),h.appendString(String(m*u)),h.appendString('px;width:1000000px;">');const g=_.$i(i),p=_.Ut(i),f=y.A.createEmpty(i,o);(0,I.d1)(new I.IJ(c.isMonospace&&!s,c.canUseHalfwidthRightwardsArrow,i,!1,g,p,0,f,e.decorations,t,0,c.spaceWidth,c.middotWidth,c.wsmiddotWidth,r,a,l,d!==b.n0.OFF,null),h),h.appendString("</div>")}h.appendString("</div>"),(0,C.N)(e,c);const g=h.build(),p=q?q.createHTML(g):g;e.innerHTML=p}const q=(0,v.Z)("editorGhostText",{createHTML:e=>e});var Y=n(70955),Q=n(21921),$=n(82861),z=n(55455),G=n(90970),Z=n(67026),J=n(97297),X=n(55191),ee=n(70546),te=n(88994);class ne{constructor(e,t){this.range=e,this.text=t}removeCommonPrefix(e,t){const n=t?this.range.intersectRanges(t):this.range;if(!n)return this;const i=e.getValueInRange(n,1),o=(0,_.Mh)(i,this.text),s=A(this.range.getStartPosition(),k(i.substring(0,o))),r=this.text.substring(o),a=S.e.fromPositions(s,this.range.getEndPosition());return new ne(a,r)}augments(e){return this.text.startsWith(e.text)&&ie(this.range,e.range)}computeGhostText(e,t,n,i=0){let o=this.removeCommonPrefix(e);if(o.range.endLineNumber!==o.range.startLineNumber)return;const s=e.getLineContent(o.range.startLineNumber),r=(0,_.V8)(s).length,a=o.range.startColumn-1<=r;if(a){const e=(0,_.V8)(o.text).length,t=s.substring(o.range.startColumn-1,r),[n,i]=[o.range.getStartPosition(),o.range.getEndPosition()],a=n.column+t.length<=i.column?n.delta(0,t.length):i,l=S.e.fromPositions(a,i),d=o.text.startsWith(t)?o.text.substring(t.length):o.text.substring(e);o=new ne(l,d)}const l=e.getValueInRange(o.range),d=se(l,o.text);if(!d)return;const c=o.range.startLineNumber,u=new Array;if("prefix"===t){const e=d.filter((e=>0===e.originalLength));if(e.length>1||1===e.length&&e[0].originalStart!==l.length)return}const h=o.text.length-i;for(const g of d){const e=o.range.startColumn+g.originalStart+g.originalLength;if("subwordSmart"===t&&n&&n.lineNumber===o.range.startLineNumber&&e<n.column)return;if(g.originalLength>0)return;if(0===g.modifiedLength)continue;const i=g.modifiedStart+g.modifiedLength,s=Math.max(g.modifiedStart,Math.min(i,h)),r=o.text.substring(g.modifiedStart,s),a=o.text.substring(s,Math.max(g.modifiedStart,i));if(r.length>0){const t=(0,_.uq)(r);u.push(new V(e,t,!1))}if(a.length>0){const t=(0,_.uq)(a);u.push(new V(e,t,!0))}}return new F(c,u)}}function ie(e,t){return t.getStartPosition().equals(e.getStartPosition())&&t.getEndPosition().isBeforeOrEqual(e.getEndPosition())}let oe;function se(e,t){if((null===oe||void 0===oe?void 0:oe.originalValue)===e&&(null===oe||void 0===oe?void 0:oe.newValue)===t)return null===oe||void 0===oe?void 0:oe.changes;{let n=ae(e,t,!0);if(n){const i=re(n);if(i>0){const o=ae(e,t,!1);o&&re(o)<i&&(n=o)}}return oe={originalValue:e,newValue:t,changes:n},n}}function re(e){let t=0;for(const n of e)t+=n.originalLength;return t}function ae(e,t,n){if(e.length>5e3||t.length>5e3)return;function i(e){let t=0;for(let n=0,i=e.length;n<i;n++){const i=e.charCodeAt(n);i>t&&(t=i)}return t}const o=Math.max(i(e),i(t));function s(e){if(e<0)throw new Error("unexpected");return o+e+1}function r(e){let t=0,i=0;const o=new Int32Array(e.length);for(let r=0,a=e.length;r<a;r++)if(n&&"("===e[r]){const e=100*i+t;o[r]=s(2*e),t++}else if(n&&")"===e[r]){t=Math.max(t-1,0);const e=100*i+t;o[r]=s(2*e+1),0===t&&i++}else o[r]=e.charCodeAt(r);return o}const a=r(e),l=r(t);return new te.Hs({getElements:()=>a},{getElements:()=>l}).ComputeDiff(!1).changes}var le=n(65662),de=n(85398),ce=n(22237),ue=n(98817),he=n(43124),ge=function(e,t,n,i){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function r(e){try{l(i.next(e))}catch(t){s(t)}}function a(e){try{l(i["throw"](e))}catch(t){s(t)}}function l(e){e.done?n(e.value):o(e.value).then(r,a)}l((i=i.apply(e,t||[])).next())}))};function pe(e,t,n,i,o=X.T.None,s){return ge(this,void 0,void 0,(function*(){const r=_e(t,n),a=e.all(n),l=new ce.r;for(const e of a)e.groupId&&l.add(e.groupId,e);function d(e){if(!e.yieldsToGroupIds)return[];const t=[];for(const n of e.yieldsToGroupIds||[]){const e=l.get(n);for(const n of e)t.push(n)}return t}const c=new Map,u=new Set;function h(e,t){if(t=[...t,e],u.has(e))return t;u.add(e);try{const n=d(e);for(const e of n){const n=h(e,t);if(n)return n}}finally{u.delete(e)}}function g(e){const s=c.get(e);if(s)return s;const r=h(e,[]);r&&(0,M.Cp)(new Error(`Inline completions: cyclic yield-to dependency detected. Path: ${r.map((e=>e.toString?e.toString():""+e)).join(" -> ")}`));const a=new de.CR;return c.set(e,a.p),(()=>ge(this,void 0,void 0,(function*(){if(!r){const t=d(e);for(const e of t){const t=yield g(e);if(t&&t.items.length>0)return}}try{const s=yield e.provideInlineCompletions(n,t,i,o);return s}catch(s){return void(0,M.Cp)(s)}})))().then((e=>a.complete(e)),(e=>a.error(e))),a.p}const p=yield Promise.all(a.map((e=>ge(this,void 0,void 0,(function*(){return{provider:e,completions:yield g(e)}}))))),m=new Map,f=[];for(const e of p){const t=e.completions;if(!t)continue;const i=new fe(t,e.provider);f.push(i);for(const e of t.items){const t=ve.from(e,i,r,n,s);m.set(t.hash(),t)}}return new me(Array.from(m.values()),new Set(m.keys()),f)}))}class me{constructor(e,t,n){this.completions=e,this.hashs=t,this.providerResults=n}has(e){return this.hashs.has(e.hash())}dispose(){for(const e of this.providerResults)e.removeRef()}}class fe{constructor(e,t){this.inlineCompletions=e,this.provider=t,this.refCount=1}addRef(){this.refCount++}removeRef(){this.refCount--,0===this.refCount&&this.provider.freeInlineCompletions(this.inlineCompletions)}}class ve{static from(e,t,n,i,o){let s,r,a=e.range?S.e.lift(e.range):n;if("string"===typeof e.insertText){if(s=e.insertText,o&&e.completeBracketPairs){s=Ce(s,a.getStartPosition(),i,o);const t=s.length-e.insertText.length;0!==t&&(a=new S.e(a.startLineNumber,a.startColumn,a.endLineNumber,a.endColumn+t))}r=void 0}else if("snippet"in e.insertText){const t=e.insertText.snippet.length;if(o&&e.completeBracketPairs){e.insertText.snippet=Ce(e.insertText.snippet,a.getStartPosition(),i,o);const n=e.insertText.snippet.length-t;0!==n&&(a=new S.e(a.startLineNumber,a.startColumn,a.endLineNumber,a.endColumn+n))}const n=(new he.Yj).parse(e.insertText.snippet);1===n.children.length&&n.children[0]instanceof he.xv?(s=n.children[0].value,r=void 0):(s=n.toString(),r={snippet:e.insertText.snippet,range:a})}else(0,le.vE)(e.insertText);return new ve(s,e.command,a,s,r,e.additionalTextEdits||D(),e,t)}constructor(e,t,n,i,o,s,r,a){this.filterText=e,this.command=t,this.range=n,this.insertText=i,this.snippetInfo=o,this.additionalTextEdits=s,this.sourceInlineCompletion=r,this.source=a,e=e.replace(/\r\n|\r/g,"\n"),i=e.replace(/\r\n|\r/g,"\n")}withRange(e){return new ve(this.filterText,this.command,e,this.insertText,this.snippetInfo,this.additionalTextEdits,this.sourceInlineCompletion,this.source)}hash(){return JSON.stringify({insertText:this.insertText,range:this.range.toString()})}}function _e(e,t){const n=t.getWordAtPosition(e),i=t.getLineMaxColumn(e.lineNumber);return n?new S.e(e.lineNumber,n.startColumn,e.lineNumber,i):S.e.fromPositions(e,e.with(void 0,i))}function Ce(e,t,n,i){const o=n.getLineContent(t.lineNumber).substring(0,t.column-1),s=o+e,r=n.tokenization.tokenizeLineWithEdit(t,s.length-(t.column-1),e),a=null===r||void 0===r?void 0:r.sliceAndInflate(t.column-1,s.length,0);if(!a)return e;const l=(0,ue.r)(a,i);return l}var be=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},Se=function(e,t){return function(n,i){t(n,i,e)}},we=function(e,t,n,i){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function r(e){try{l(i.next(e))}catch(t){s(t)}}function a(e){try{l(i["throw"](e))}catch(t){s(t)}}function l(e){e.done?n(e.value):o(e.value).then(r,a)}l((i=i.apply(e,t||[])).next())}))};let xe=class extends u.JT{constructor(e,t,n,i,o){super(),this.textModel=e,this.versionId=t,this._debounceValue=n,this.languageFeaturesService=i,this.languageConfigurationService=o,this._updateOperation=this._register(new u.XK),this.inlineCompletions=(0,h.DN)("inlineCompletions",void 0),this.suggestWidgetInlineCompletions=(0,h.DN)("suggestWidgetInlineCompletions",void 0),this._register(this.textModel.onDidChangeContent((()=>{this._updateOperation.clear()})))}fetch(e,t,n){var i,o;const s=new ye(e,t,this.textModel.getVersionId()),r=t.selectedSuggestionInfo?this.suggestWidgetInlineCompletions:this.inlineCompletions;if(null===(i=this._updateOperation.value)||void 0===i?void 0:i.request.satisfies(s))return this._updateOperation.value.promise;if(null===(o=r.get())||void 0===o?void 0:o.request.satisfies(s))return Promise.resolve(!0);const a=!!this._updateOperation.value;this._updateOperation.clear();const l=new X.A,d=(()=>we(this,void 0,void 0,(function*(){const i=a||t.triggerKind===Z.bw.Automatic;if(i&&(yield Le(this._debounceValue.get(this.textModel))),l.token.isCancellationRequested||this.textModel.getVersionId()!==s.versionId)return!1;const o=new Date,d=yield pe(this.languageFeaturesService.inlineCompletionsProvider,e,this.textModel,t,l.token,this.languageConfigurationService);if(l.token.isCancellationRequested||this.textModel.getVersionId()!==s.versionId)return!1;const c=new Date;this._debounceValue.update(this.textModel,c.getTime()-o.getTime());const u=new Me(d,s,this.textModel,this.versionId);if(n){const t=n.toInlineCompletion(void 0);n.canBeReused(this.textModel,e)&&!d.has(t)&&u.prepend(n.inlineCompletion,t.range,!0)}return this._updateOperation.clear(),(0,h.PS)((e=>{r.set(u,e)})),!0})))(),c=new Ie(s,l,d);return this._updateOperation.value=c,d}clear(e){this._updateOperation.clear(),this.inlineCompletions.set(void 0,e),this.suggestWidgetInlineCompletions.set(void 0,e)}clearSuggestWidgetInlineCompletions(e){var t;(null===(t=this._updateOperation.value)||void 0===t?void 0:t.request.context.selectedSuggestionInfo)&&this._updateOperation.clear(),this.suggestWidgetInlineCompletions.set(void 0,e)}cancelUpdate(){this._updateOperation.clear()}};function Le(e,t){return new Promise((n=>{let i;const o=setTimeout((()=>{i&&i.dispose(),n()}),e);t&&(i=t.onCancellationRequested((()=>{clearTimeout(o),i&&i.dispose(),n()})))}))}xe=be([Se(3,f.p),Se(4,J.c_)],xe);class ye{constructor(e,t,n){this.position=e,this.context=t,this.versionId=n}satisfies(e){return this.position.equals(e.position)&&Ne(this.context.selectedSuggestionInfo,e.context.selectedSuggestionInfo,((e,t)=>e.equals(t)))&&(e.context.triggerKind===Z.bw.Automatic||this.context.triggerKind===Z.bw.Explicit)&&this.versionId===e.versionId}}function Ne(e,t,n){return e&&t?n(e,t):e===t}class Ie{constructor(e,t,n){this.request=e,this.cancellationTokenSource=t,this.promise=n}dispose(){this.cancellationTokenSource.cancel()}}class Me{get inlineCompletions(){return this._inlineCompletions}constructor(e,t,n,i){this.inlineCompletionProviderResult=e,this.request=t,this.textModel=n,this.versionId=i,this._refCount=1,this._prependedInlineCompletionItems=[],this._rangeVersionIdValue=0,this._rangeVersionId=(0,s.nK)("ranges",(e=>{this.versionId.read(e);let t=!1;for(const n of this._inlineCompletions)t=t||n._updateRange(this.textModel);return t&&this._rangeVersionIdValue++,this._rangeVersionIdValue}));const o=n.deltaDecorations([],e.completions.map((e=>({range:e.range,options:{description:"inline-completion-tracking-range"}}))));this._inlineCompletions=e.completions.map(((e,t)=>new Te(e,o[t],this._rangeVersionId)))}clone(){return this._refCount++,this}dispose(){if(this._refCount--,0===this._refCount){setTimeout((()=>{this.textModel.isDisposed()||this.textModel.deltaDecorations(this._inlineCompletions.map((e=>e.decorationId)),[])}),0),this.inlineCompletionProviderResult.dispose();for(const e of this._prependedInlineCompletionItems)e.source.removeRef()}}prepend(e,t,n){n&&e.source.addRef();const i=this.textModel.deltaDecorations([],[{range:t,options:{description:"inline-completion-tracking-range"}}])[0];this._inlineCompletions.unshift(new Te(e,i,this._rangeVersionId,t)),this._prependedInlineCompletionItems.push(e)}}class Te{get forwardStable(){var e;return null!==(e=this.inlineCompletion.source.inlineCompletions.enableForwardStability)&&void 0!==e&&e}constructor(e,t,n,i){this.inlineCompletion=e,this.decorationId=t,this.rangeVersion=n,this.semanticId=JSON.stringify([this.inlineCompletion.filterText,this.inlineCompletion.insertText,this.inlineCompletion.range.getStartPosition().toString()]),this._isValid=!0,this._updatedRange=null!==i&&void 0!==i?i:e.range}toInlineCompletion(e){return this.inlineCompletion.withRange(this._getUpdatedRange(e))}toSingleTextEdit(e){return new ne(this._getUpdatedRange(e),this.inlineCompletion.insertText)}isVisible(e,t,n){const i=this._toFilterTextReplacement(n).removeCommonPrefix(e);if(!this._isValid||!this.inlineCompletion.range.getStartPosition().equals(this._getUpdatedRange(n).getStartPosition())||t.lineNumber!==i.range.startLineNumber)return!1;const o=e.getValueInRange(i.range,1).toLowerCase(),s=i.text.toLowerCase(),r=Math.max(0,t.column-i.range.startColumn);let a=s.substring(0,r),l=s.substring(r),d=o.substring(0,r),c=o.substring(r);const u=e.getLineIndentColumn(i.range.startLineNumber);return i.range.startColumn<=u&&(d=d.trimStart(),0===d.length&&(c=c.trimStart()),a=a.trimStart(),0===a.length&&(l=l.trimStart())),a.startsWith(d)&&!!(0,ee.Sy)(c,l)}canBeReused(e,t){const n=this._isValid&&this._getUpdatedRange(void 0).containsPosition(t)&&this.isVisible(e,t,void 0)&&!this._isSmallerThanOriginal(void 0);return n}_toFilterTextReplacement(e){return new ne(this._getUpdatedRange(e),this.inlineCompletion.filterText)}_isSmallerThanOriginal(e){return Re(this._getUpdatedRange(e)).isBefore(Re(this.inlineCompletion.range))}_getUpdatedRange(e){return this.rangeVersion.read(e),this._updatedRange}_updateRange(e){const t=e.getDecorationRange(this.decorationId);return t?!this._updatedRange.equalsRange(t)&&(this._updatedRange=t,!0):(this._isValid=!1,!0)}}function Re(e){return e.startLineNumber===e.endLineNumber?new p.L(1,1+e.endColumn-e.startColumn):new p.L(1+e.endLineNumber-e.startLineNumber,e.endColumn)}var Oe,De=n(58151),Pe=n(46871),Ee=n(21881),Ae=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},ke=function(e,t){return function(n,i){t(n,i,e)}},Fe=function(e,t,n,i){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function r(e){try{l(i.next(e))}catch(t){s(t)}}function a(e){try{l(i["throw"](e))}catch(t){s(t)}}function l(e){e.done?n(e.value):o(e.value).then(r,a)}l((i=i.apply(e,t||[])).next())}))};(function(e){e[e["Undo"]=0]="Undo",e[e["Redo"]=1]="Redo",e[e["AcceptWord"]=2]="AcceptWord",e[e["Other"]=3]="Other"})(Oe||(Oe={}));let Ve=class extends u.JT{get isAcceptingPartially(){return this._isAcceptingPartially}constructor(e,t,n,i,o,r,a,l,d,c,u,h){let g;super(),this.textModel=e,this.selectedSuggestItem=t,this.cursorPosition=n,this.textModelVersionId=i,this._debounceValue=o,this._suggestPreviewEnabled=r,this._suggestPreviewMode=a,this._inlineSuggestMode=l,this._enabled=d,this._instantiationService=c,this._commandService=u,this._languageConfigurationService=h,this._source=this._register(this._instantiationService.createInstance(xe,this.textModel,this.textModelVersionId,this._debounceValue)),this._isActive=(0,s.uh)("isActive",!1),this._forceUpdate=(0,s.GN)("forceUpdate"),this._selectedInlineCompletionId=(0,s.uh)("selectedInlineCompletionId",void 0),this._isAcceptingPartially=!1,this._preserveCurrentCompletionReasons=new Set([Oe.Redo,Oe.Undo,Oe.AcceptWord]),this._fetchInlineCompletions=(0,$.aK)("fetch inline completions",{createEmptyChangeSummary:()=>({preserveCurrentCompletion:!1,inlineCompletionTriggerKind:Z.bw.Automatic}),handleChange:(e,t)=>(e.didChange(this.textModelVersionId)&&this._preserveCurrentCompletionReasons.has(e.change)?t.preserveCurrentCompletion=!0:e.didChange(this._forceUpdate)&&(t.inlineCompletionTriggerKind=e.change),!0)},((e,t)=>{this._forceUpdate.read(e);const n=this._enabled.read(e)&&this.selectedSuggestItem.read(e)||this._isActive.read(e);if(!n)return void this._source.cancelUpdate();this.textModelVersionId.read(e);const i=this.selectedInlineCompletion.get(),o=t.preserveCurrentCompletion||(null===i||void 0===i?void 0:i.forwardStable)?i:void 0,r=this._source.suggestWidgetInlineCompletions.get(),a=this.selectedSuggestItem.read(e);if(r&&!a){const e=this._source.inlineCompletions.get();(0,s.PS)((t=>{e&&r.request.versionId>e.request.versionId&&this._source.inlineCompletions.set(r.clone(),t),this._source.clearSuggestWidgetInlineCompletions(t)}))}const l=this.cursorPosition.read(e),d={triggerKind:t.inlineCompletionTriggerKind,selectedSuggestionInfo:null===a||void 0===a?void 0:a.toSelectedSuggestionInfo()};return this._source.fetch(l,d,o)})),this._filteredInlineCompletionItems=(0,s.nK)("filteredInlineCompletionItems",(e=>{const t=this._source.inlineCompletions.read(e);if(!t)return[];const n=this.cursorPosition.read(e),i=t.inlineCompletions.filter((t=>t.isVisible(this.textModel,n,e)));return i})),this.selectedInlineCompletionIndex=(0,s.nK)("selectedCachedCompletionIndex",(e=>{const t=this._selectedInlineCompletionId.read(e),n=this._filteredInlineCompletionItems.read(e),i=void 0===this._selectedInlineCompletionId?-1:n.findIndex((e=>e.semanticId===t));return-1===i?(this._selectedInlineCompletionId.set(void 0,void 0),0):i})),this.selectedInlineCompletion=(0,s.nK)("selectedCachedCompletion",(e=>{const t=this._filteredInlineCompletionItems.read(e),n=this.selectedInlineCompletionIndex.read(e);return t[n]})),this.lastTriggerKind=this._source.inlineCompletions.map((e=>null===e||void 0===e?void 0:e.request.context.triggerKind)),this.inlineCompletionsCount=(0,s.nK)("selectedInlineCompletionsCount",(e=>this.lastTriggerKind.read(e)===Z.bw.Explicit?this._filteredInlineCompletionItems.read(e).length:void 0)),this.state=(0,s.nK)("ghostTextAndCompletion",(e=>{var t;const n=this.textModel,i=this.selectedSuggestItem.read(e);if(i){const o=this._source.suggestWidgetInlineCompletions.read(e),s=o?o.inlineCompletions:[this.selectedInlineCompletion.read(e)].filter(z.$K),r=i.toSingleTextEdit().removeCommonPrefix(n),a=(0,Q.bX)(s,(t=>{let o=t.toSingleTextEdit(e);return o=o.removeCommonPrefix(n,S.e.fromPositions(o.range.getStartPosition(),i.range.getEndPosition())),o.augments(r)?{edit:o,completion:t}:void 0})),l=this._suggestPreviewEnabled.read(e);if(!l&&!a)return;const d=null!==(t=null===a||void 0===a?void 0:a.edit)&&void 0!==t?t:r,c=a?a.edit.text.length-r.text.length:0,u=this._suggestPreviewMode.read(e),h=this.cursorPosition.read(e),g=d.computeGhostText(n,u,h,c),p=null!==g&&void 0!==g?g:new F(d.range.endLineNumber,[]);return{ghostText:p,inlineCompletion:null===a||void 0===a?void 0:a.completion,suggestItem:i}}{if(!this._isActive.read(e))return;const t=this.selectedInlineCompletion.read(e);if(!t)return;const i=t.toSingleTextEdit(e),o=this._inlineSuggestMode.read(e),s=this.cursorPosition.read(e),r=i.computeGhostText(n,o,s);return r?{ghostText:r,inlineCompletion:t,suggestItem:void 0}:void 0}})),this.ghostText=(0,s.nK)("ghostText",(e=>{const t=this.state.read(e);if(t)return t.ghostText})),this._register((0,s.$g)(this._fetchInlineCompletions,!0)),this._register((0,s.EH)("call handleItemDidShow",(e=>{var t,n;const i=this.state.read(e),o=null===i||void 0===i?void 0:i.inlineCompletion;if((null===o||void 0===o?void 0:o.semanticId)!==(null===g||void 0===g?void 0:g.semanticId)&&(g=o,o)){const e=o.inlineCompletion,i=e.source;null===(n=(t=i.provider).handleItemDidShow)||void 0===n||n.call(t,i.inlineCompletions,e.sourceInlineCompletion,e.insertText)}})))}trigger(e){return Fe(this,void 0,void 0,(function*(){this._isActive.set(!0,e),yield this._fetchInlineCompletions.get()}))}triggerExplicitly(e){return Fe(this,void 0,void 0,(function*(){(0,h.c8)(e,(e=>{this._isActive.set(!0,e),this._forceUpdate.trigger(e,Z.bw.Explicit)})),yield this._fetchInlineCompletions.get()}))}stop(e){(0,h.c8)(e,(e=>{this._isActive.set(!1,e),this._source.clear(e)}))}_deltaSelectedInlineCompletionIndex(e){return Fe(this,void 0,void 0,(function*(){yield this.triggerExplicitly();const t=this._filteredInlineCompletionItems.get()||[];if(t.length>0){const n=(this.selectedInlineCompletionIndex.get()+e+t.length)%t.length;this._selectedInlineCompletionId.set(t[n].semanticId,void 0)}else this._selectedInlineCompletionId.set(void 0,void 0)}))}next(){return Fe(this,void 0,void 0,(function*(){yield this._deltaSelectedInlineCompletionIndex(1)}))}previous(){return Fe(this,void 0,void 0,(function*(){yield this._deltaSelectedInlineCompletionIndex(-1)}))}accept(e){var t;return Fe(this,void 0,void 0,(function*(){if(e.getModel()!==this.textModel)throw new M.he;const n=this.state.get();if(!n||n.ghostText.isEmpty()||!n.inlineCompletion)return;const i=n.inlineCompletion.toInlineCompletion(void 0);e.pushUndoStop(),i.snippetInfo?(e.executeEdits("inlineSuggestion.accept",[G.h.replaceMove(i.range,""),...i.additionalTextEdits]),e.setPosition(i.snippetInfo.range.getStartPosition()),null===(t=De.f.get(e))||void 0===t||t.insert(i.snippetInfo.snippet,{undoStopBefore:!1})):e.executeEdits("inlineSuggestion.accept",[G.h.replaceMove(i.range,i.insertText),...i.additionalTextEdits]),i.command&&i.source.addRef(),(0,s.PS)((e=>{this._source.clear(e),this._isActive.set(!1,e)})),i.command&&(yield this._commandService.executeCommand(i.command.id,...i.command.arguments||[]).then(void 0,M.Cp),i.source.removeRef())}))}acceptNextWord(e){return Fe(this,void 0,void 0,(function*(){yield this._acceptNext(e,((e,t)=>{const n=this.textModel.getLanguageIdAtPosition(e.lineNumber,e.column),i=this._languageConfigurationService.getLanguageConfiguration(n),o=new RegExp(i.wordDefinition.source,i.wordDefinition.flags.replace("g","")),s=t.match(o);let r=0;r=s&&void 0!==s.index?0===s.index?s[0].length:s.index:t.length;const a=/\s+/g,l=a.exec(t);return l&&void 0!==l.index&&l.index+l[0].length<r&&(r=l.index+l[0].length),r}))}))}acceptNextLine(e){return Fe(this,void 0,void 0,(function*(){yield this._acceptNext(e,((e,t)=>{const n=t.match(/\n/);return n&&void 0!==n.index?n.index+1:t.length}))}))}_acceptNext(e,t){return Fe(this,void 0,void 0,(function*(){if(e.getModel()!==this.textModel)throw new M.he;const n=this.state.get();if(!n||n.ghostText.isEmpty()||!n.inlineCompletion)return;const i=n.ghostText,o=n.inlineCompletion.toInlineCompletion(void 0);if(o.snippetInfo||o.filterText!==o.insertText)return void(yield this.accept(e));const s=i.parts[0],r=new p.L(i.lineNumber,s.column),a=s.lines.join("\n"),l=t(r,a);if(l===a.length&&1===i.parts.length)return void this.accept(e);const d=a.substring(0,l);this._isAcceptingPartially=!0;try{e.pushUndoStop(),e.executeEdits("inlineSuggestion.accept",[G.h.replace(S.e.fromPositions(r),d)]);const t=k(d);e.setPosition(A(r,t))}finally{this._isAcceptingPartially=!1}if(o.source.provider.handlePartialAccept){const t=S.e.fromPositions(o.range.getStartPosition(),A(r,k(d))),n=e.getModel().getValueInRange(t,1);o.source.provider.handlePartialAccept(o.source.inlineCompletions,o.sourceInlineCompletion,n.length)}}))}};Ve=Ae([ke(9,Ee.TG),ke(10,Pe.H),ke(11,J.c_)],Ve);var He=n(69377),We=n(55743);class Ue extends u.JT{get selectedItem(){return this._selectedItem}constructor(e,t,n){super(),this.editor=e,this.suggestControllerPreselector=t,this.checkModelVersion=n,this.isSuggestWidgetVisible=!1,this.isShiftKeyPressed=!1,this._isActive=!1,this._currentSuggestItemInfo=void 0,this._selectedItem=(0,s.uh)("suggestWidgetInlineCompletionProvider.selectedItem",void 0),this._register(e.onKeyDown((e=>{e.shiftKey&&!this.isShiftKeyPressed&&(this.isShiftKeyPressed=!0,this.update(this._isActive))}))),this._register(e.onKeyUp((e=>{e.shiftKey&&this.isShiftKeyPressed&&(this.isShiftKeyPressed=!1,this.update(this._isActive))})));const i=We.n.get(this.editor);if(i){this._register(i.registerSelector({priority:100,select:(e,t,n)=>{var o;(0,s.PS)((e=>this.checkModelVersion(e)));const r=this.editor.getModel();if(!r)return-1;const a=null===(o=this.suggestControllerPreselector())||void 0===o?void 0:o.removeCommonPrefix(r);if(!a)return-1;const l=p.L.lift(t),d=n.map(((e,t)=>{const n=Be.fromSuggestion(i,r,l,e,this.isShiftKeyPressed),o=n.toSingleTextEdit().removeCommonPrefix(r),s=a.augments(o);return{index:t,valid:s,prefixLength:o.text.length,suggestItem:e}})).filter((e=>e&&e.valid&&e.prefixLength>0)),c=(0,Q.Dc)(d,(0,Q.tT)((e=>e.prefixLength),Q.fv));return c?c.index:-1}}));let e=!1;const t=()=>{e||(e=!0,this._register(i.widget.value.onDidShow((()=>{this.isSuggestWidgetVisible=!0,this.update(!0)}))),this._register(i.widget.value.onDidHide((()=>{this.isSuggestWidgetVisible=!1,this.update(!1)}))),this._register(i.widget.value.onDidFocus((()=>{this.isSuggestWidgetVisible=!0,this.update(!0)}))))};this._register(c.ju.once(i.model.onDidTrigger)((e=>{t()})))}this.update(this._isActive)}update(e){const t=this.getSuggestItemInfo();this._isActive===e&&Ke(this._currentSuggestItemInfo,t)||(this._isActive=e,this._currentSuggestItemInfo=t,(0,s.PS)((e=>{this.checkModelVersion(e),this._selectedItem.set(this._isActive?this._currentSuggestItemInfo:void 0,e)})))}getSuggestItemInfo(){const e=We.n.get(this.editor);if(!e||!this.isSuggestWidgetVisible)return;const t=e.widget.value.getFocusedItem(),n=this.editor.getPosition(),i=this.editor.getModel();return t&&n&&i?Be.fromSuggestion(e,i,n,t.item,this.isShiftKeyPressed):void 0}stopForceRenderingAbove(){const e=We.n.get(this.editor);null===e||void 0===e||e.stopForceRenderingAbove()}forceRenderingAbove(){const e=We.n.get(this.editor);null===e||void 0===e||e.forceRenderingAbove()}}class Be{static fromSuggestion(e,t,n,i,o){let{insertText:s}=i.completion,r=!1;if(4&i.completion.insertTextRules){const e=(new he.Yj).parse(s);e.children.length<100&&He.l.adjustWhitespace(t,n,!0,e),s=e.toString(),r=!0}const a=e.getOverwriteInfo(i,o);return new Be(S.e.fromPositions(n.delta(0,-a.overwriteBefore),n.delta(0,Math.max(a.overwriteAfter,0))),s,i.completion.kind,r)}constructor(e,t,n,i){this.range=e,this.insertText=t,this.completionItemKind=n,this.isSnippetText=i}equals(e){return this.range.equalsRange(e.range)&&this.insertText===e.insertText&&this.completionItemKind===e.completionItemKind&&this.isSnippetText===e.isSnippetText}toSelectedSuggestionInfo(){return new Z.ln(this.range,this.insertText,this.completionItemKind,this.isSnippetText)}toSingleTextEdit(){return new ne(this.range,this.insertText)}}function Ke(e,t){return e===t||!(!e||!t)&&e.equals(t)}var je=n(70936),qe=n(47596),Ye=n(37174),Qe=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},$e=function(e,t){return function(n,i){t(n,i,e)}};let ze=class e extends u.JT{static get(t){return t.getContribution(e.ID)}constructor(e,t,n,i,o,r,m,f){super(),this.editor=e,this.instantiationService=t,this.contextKeyService=n,this.configurationService=i,this.commandService=o,this.debounceService=r,this.languageFeaturesService=m,this.audioCueService=f,this.model=(0,h.DN)("inlineCompletionModel",void 0),this.textModelVersionId=(0,s.uh)("textModelVersionId",-1),this.cursorPosition=(0,s.uh)("cursorPosition",new p.L(1,1)),this.suggestWidgetAdaptor=this._register(new Ue(this.editor,(()=>{var e,t;return null===(t=null===(e=this.model.get())||void 0===e?void 0:e.selectedInlineCompletion.get())||void 0===t?void 0:t.toSingleTextEdit(void 0)}),(e=>this.updateObservables(e,Oe.Other)))),this._enabled=(0,s.rD)(this.editor.onDidChangeConfiguration,(()=>this.editor.getOption(61).enabled)),this.ghostTextWidget=this._register(this.instantiationService.createInstance(B,this.editor,{ghostText:this.model.map(((e,t)=>null===e||void 0===e?void 0:e.ghostText.read(t))),minReservedLineCount:(0,s.Dz)(0),targetTextModel:this.model.map((e=>null===e||void 0===e?void 0:e.textModel))})),this._debounceValue=this.debounceService.for(this.languageFeaturesService.inlineCompletionsProvider,"InlineCompletionsDebounce",{min:50,max:50}),this._register(new l.f(this.contextKeyService,this.model)),this._register(c.ju.runAndSubscribe(e.onDidChangeModel,(()=>(0,h.PS)((n=>{this.model.set(void 0,n),this.updateObservables(n,Oe.Other);const i=e.getModel();if(i){const o=t.createInstance(Ve,i,this.suggestWidgetAdaptor.selectedItem,this.cursorPosition,this.textModelVersionId,this._debounceValue,(0,s.rD)(e.onDidChangeConfiguration,(()=>e.getOption(116).preview)),(0,s.rD)(e.onDidChangeConfiguration,(()=>e.getOption(116).previewMode)),(0,s.rD)(e.onDidChangeConfiguration,(()=>e.getOption(61).mode)),this._enabled);this.model.set(o,n)}})))));const v=e=>{var t;return e.isUndoing?Oe.Undo:e.isRedoing?Oe.Redo:(null===(t=this.model.get())||void 0===t?void 0:t.isAcceptingPartially)?Oe.AcceptWord:Oe.Other};let _;this._register(e.onDidChangeModelContent((e=>(0,h.PS)((t=>this.updateObservables(t,v(e))))))),this._register(e.onDidChangeCursorPosition((e=>(0,h.PS)((t=>{var n;this.updateObservables(t,Oe.Other),3===e.reason&&(null===(n=this.model.get())||void 0===n||n.stop(t))}))))),this._register(e.onDidType((()=>(0,h.PS)((e=>{var t;this.updateObservables(e,Oe.Other),this._enabled.get()&&(null===(t=this.model.get())||void 0===t||t.trigger(e))}))))),this._register(this.commandService.onDidExecuteCommand((t=>{const n=new Set([g.wk.Tab.id,g.wk.DeleteLeft.id,g.wk.DeleteRight.id,a.Ou,"acceptSelectedSuggestion"]);n.has(t.commandId)&&e.hasTextFocus()&&this._enabled.get()&&(0,h.PS)((e=>{var t;null===(t=this.model.get())||void 0===t||t.trigger(e)}))}))),this._register(this.editor.onDidBlurEditorWidget((()=>{this.configurationService.getValue("editor.inlineSuggest.keepOnBlur")||e.getOption(61).keepOnBlur||Y.QG.dropDownVisible||(0,h.PS)((e=>{var t;null===(t=this.model.get())||void 0===t||t.stop(e)}))}))),this._register((0,s.EH)("forceRenderingAbove",(e=>{var t;const n=null===(t=this.model.read(e))||void 0===t?void 0:t.state.read(e);(null===n||void 0===n?void 0:n.suggestItem)?n.ghostText.lineCount>=2&&this.suggestWidgetAdaptor.forceRenderingAbove():this.suggestWidgetAdaptor.stopForceRenderingAbove()}))),this._register((0,u.OF)((()=>{this.suggestWidgetAdaptor.stopForceRenderingAbove()}))),this._register((0,s.EH)("play audio cue & read suggestion",(e=>{const t=this.model.read(e),n=null===t||void 0===t?void 0:t.state.read(e);if(t&&n&&n.inlineCompletion){if(n.inlineCompletion.semanticId!==_){_=n.inlineCompletion.semanticId;const e=t.textModel.getLineContent(n.ghostText.lineNumber);this.audioCueService.playAudioCue(je.y$.inlineSuggestion).then((()=>{this.editor.getOption(7)&&(0,d.Z9)(n.ghostText.renderForScreenReader(e))}))}}else _=void 0}))),this._register(new Y.oU(this.editor,this.model,this.instantiationService))}updateObservables(e,t){var n,i;const o=this.editor.getModel();this.textModelVersionId.set(null!==(n=null===o||void 0===o?void 0:o.getVersionId())&&void 0!==n?n:-1,e,t),this.cursorPosition.set(null!==(i=this.editor.getPosition())&&void 0!==i?i:new p.L(1,1),e)}shouldShowHoverAt(e){var t;const n=null===(t=this.model.get())||void 0===t?void 0:t.ghostText.get();return!!n&&n.parts.some((t=>e.containsPosition(new p.L(n.lineNumber,t.column))))}shouldShowHoverAtViewZone(e){return this.ghostTextWidget.ownsViewZone(e)}};ze.ID="editor.contrib.inlineCompletionsController",ze=Qe([$e(1,Ee.TG),$e(2,Ye.i6),$e(3,qe.Ui),$e(4,Pe.H),$e(5,m.A),$e(6,f.p),$e(7,je.e7)],ze);var Ge=n(49864),Ze=n(25206),Je=n(82693),Xe=function(e,t,n,i){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function r(e){try{l(i.next(e))}catch(t){s(t)}}function a(e){try{l(i["throw"](e))}catch(t){s(t)}}function l(e){e.done?n(e.value):o(e.value).then(r,a)}l((i=i.apply(e,t||[])).next())}))};class et extends i.R6{constructor(){super({id:et.ID,label:Ze.NC("action.inlineSuggest.showNext","Show Next Inline Suggestion"),alias:"Show Next Inline Suggestion",precondition:Ye.Ao.and(r.u.writable,l.f.inlineSuggestionVisible),kbOpts:{weight:100,primary:606}})}run(e,t){var n;return Xe(this,void 0,void 0,(function*(){const e=ze.get(t);null===(n=null===e||void 0===e?void 0:e.model.get())||void 0===n||n.next()}))}}et.ID=a.OW;class tt extends i.R6{constructor(){super({id:tt.ID,label:Ze.NC("action.inlineSuggest.showPrevious","Show Previous Inline Suggestion"),alias:"Show Previous Inline Suggestion",precondition:Ye.Ao.and(r.u.writable,l.f.inlineSuggestionVisible),kbOpts:{weight:100,primary:604}})}run(e,t){var n;return Xe(this,void 0,void 0,(function*(){const e=ze.get(t);null===(n=null===e||void 0===e?void 0:e.model.get())||void 0===n||n.previous()}))}}tt.ID=a.Np;class nt extends i.R6{constructor(){super({id:"editor.action.inlineSuggest.trigger",label:Ze.NC("action.inlineSuggest.trigger","Trigger Inline Suggestion"),alias:"Trigger Inline Suggestion",precondition:r.u.writable})}run(e,t){var n;return Xe(this,void 0,void 0,(function*(){const e=ze.get(t);null===(n=null===e||void 0===e?void 0:e.model.get())||void 0===n||n.triggerExplicitly()}))}}class it extends i.R6{constructor(){super({id:"editor.action.inlineSuggest.acceptNextWord",label:Ze.NC("action.inlineSuggest.acceptNextWord","Accept Next Word Of Inline Suggestion"),alias:"Accept Next Word Of Inline Suggestion",precondition:Ye.Ao.and(r.u.writable,l.f.inlineSuggestionVisible),kbOpts:{weight:101,primary:2065,kbExpr:Ye.Ao.and(r.u.writable,l.f.inlineSuggestionVisible)},menuOpts:[{menuId:Je.eH.InlineSuggestionToolbar,title:Ze.NC("acceptWord","Accept Word"),group:"primary",order:2}]})}run(e,t){var n;return Xe(this,void 0,void 0,(function*(){const e=ze.get(t);yield null===(n=null===e||void 0===e?void 0:e.model.get())||void 0===n?void 0:n.acceptNextWord(e.editor)}))}}class ot extends i.R6{constructor(){super({id:"editor.action.inlineSuggest.acceptNextLine",label:Ze.NC("action.inlineSuggest.acceptNextLine","Accept Next Line Of Inline Suggestion"),alias:"Accept Next Line Of Inline Suggestion",precondition:Ye.Ao.and(r.u.writable,l.f.inlineSuggestionVisible),kbOpts:{weight:101},menuOpts:[{menuId:Je.eH.InlineSuggestionToolbar,title:Ze.NC("acceptLine","Accept Line"),group:"secondary",order:2}]})}run(e,t){var n;return Xe(this,void 0,void 0,(function*(){const e=ze.get(t);yield null===(n=null===e||void 0===e?void 0:e.model.get())||void 0===n?void 0:n.acceptNextLine(e.editor)}))}}class st extends i.R6{constructor(){super({id:a.Ou,label:Ze.NC("action.inlineSuggest.accept","Accept Inline Suggestion"),alias:"Accept Inline Suggestion",precondition:l.f.inlineSuggestionVisible,menuOpts:[{menuId:Je.eH.InlineSuggestionToolbar,title:Ze.NC("accept","Accept"),group:"primary",order:1}],kbOpts:{primary:2,weight:200,kbExpr:Ye.Ao.and(l.f.inlineSuggestionVisible,r.u.tabMovesFocus.toNegated(),l.f.inlineSuggestionHasIndentationLessThanTabSize,Ge._y.Visible.toNegated())}})}run(e,t){var n;return Xe(this,void 0,void 0,(function*(){const e=ze.get(t);e&&(null===(n=e.model.get())||void 0===n||n.accept(e.editor),e.editor.focus())}))}}class rt extends i.R6{constructor(){super({id:rt.ID,label:Ze.NC("action.inlineSuggest.hide","Hide Inline Suggestion"),alias:"Hide Inline Suggestion",precondition:l.f.inlineSuggestionVisible,kbOpts:{weight:100,primary:9}})}run(e,t){return Xe(this,void 0,void 0,(function*(){const e=ze.get(t);(0,s.PS)((t=>{var n;null===(n=null===e||void 0===e?void 0:e.model.get())||void 0===n||n.stop(t)}))}))}}rt.ID="editor.action.inlineSuggest.hide";class at extends Je.Ke{constructor(){super({id:at.ID,title:Ze.NC("action.inlineSuggest.alwaysShowToolbar","Always Show Toolbar"),f1:!1,precondition:void 0,menu:[{id:Je.eH.InlineSuggestionToolbar,group:"secondary",order:10}],toggled:Ye.Ao.equals("config.editor.inlineSuggest.showToolbar","always")})}run(e,t){return Xe(this,void 0,void 0,(function*(){const t=e.get(qe.Ui),n=t.getValue("editor.inlineSuggest.showToolbar"),i="always"===n?"onHover":"always";t.updateValue("editor.inlineSuggest.showToolbar",i)}))}}at.ID="editor.action.inlineSuggest.toggleAlwaysShowToolbar";var lt=n(2548),dt=n(81478),ct=n(92767),ut=n(55907),ht=n(6544),gt=n(38857),pt=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},mt=function(e,t){return function(n,i){t(n,i,e)}};class ft{constructor(e,t,n){this.owner=e,this.range=t,this.controller=n}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let vt=class{constructor(e,t,n,i,o,s){this._editor=e,this._languageService=t,this._openerService=n,this.accessibilityService=i,this._instantiationService=o,this._telemetryService=s,this.hoverOrdinal=4}suggestHoverAnchor(e){const t=ze.get(this._editor);if(!t)return null;const n=e.target;if(8===n.type){const i=n.detail;if(t.shouldShowHoverAtViewZone(i.viewZoneId))return new o.YM(1e3,this,S.e.fromPositions(this._editor.getModel().validatePosition(i.positionBefore||i.position)),e.event.posx,e.event.posy,!1)}if(7===n.type&&t.shouldShowHoverAt(n.range))return new o.YM(1e3,this,n.range,e.event.posx,e.event.posy,!1);if(6===n.type){const i=n.detail.mightBeForeignElement;if(i&&t.shouldShowHoverAt(n.range))return new o.YM(1e3,this,n.range,e.event.posx,e.event.posy,!1)}return null}computeSync(e,t){if("always"===this._editor.getOption(61).showToolbar)return[];const n=ze.get(this._editor);return n&&n.shouldShowHoverAt(e.range)?[new ft(this,e.range,n)]:[]}renderHoverParts(e,t){const n=new u.SL,i=t[0];this._telemetryService.publicLog2("inlineCompletionHover.shown"),this.accessibilityService.isScreenReaderOptimized()&&!this._editor.getOption(7)&&this.renderScreenReaderText(e,i,n);const o=i.controller.model.get(),r=this._instantiationService.createInstance(Y.QG,this._editor,!1,(0,s.Dz)(null),o.selectedInlineCompletionIndex,o.inlineCompletionsCount,o.selectedInlineCompletion.map((e=>{var t;return null!==(t=null===e||void 0===e?void 0:e.inlineCompletion.source.inlineCompletions.commands)&&void 0!==t?t:[]})));return e.fragment.appendChild(r.getDomNode()),o.triggerExplicitly(),n.add(r),n}renderScreenReaderText(e,t,n){const i=lt.$,o=i("div.hover-row.markdown-hover"),r=lt.R3(o,i("div.hover-contents",{["aria-live"]:"assertive"})),a=n.add(new ct.$({editor:this._editor},this._languageService,this._openerService)),l=t=>{n.add(a.onDidRenderAsync((()=>{r.className="hover-contents code-hover-contents",e.onContentsChanged()})));const i=Ze.NC("inlineSuggestionFollows","Suggestion:"),o=n.add(a.render((new dt.W5).appendText(i).appendCodeblock("text",t)));r.replaceChildren(o.element)};n.add((0,s.EH)("update hover",(e=>{var n;const i=null===(n=t.controller.model.read(e))||void 0===n?void 0:n.ghostText.read(e);if(i){const e=this._editor.getModel().getLineContent(i.lineNumber);l(i.renderForScreenReader(e))}else lt.mc(r)}))),e.fragment.appendChild(o)}};vt=pt([mt(1,x.O),mt(2,ht.v4),mt(3,ut.F),mt(4,Ee.TG),mt(5,gt.b)],vt),(0,i._K)(ze.ID,ze,3),(0,i.Qr)(nt),(0,i.Qr)(et),(0,i.Qr)(tt),(0,i.Qr)(it),(0,i.Qr)(ot),(0,i.Qr)(st),(0,i.Qr)(rt),(0,Je.r1)(at),o.Ae.register(vt)},70955:(e,t,n)=>{n.d(t,{QG:()=>E,oU:()=>O});var i=n(2548),o=n(78089),s=n(64347),r=n(10205),a=n(21921),l=n(85398),d=n(8419),c=n(70959),u=n(90168),h=n(61818),g=n(47606),p=n(99588),m=n(89999),f=n(67026),v=n(34665),_=n(25206),C=n(94700),b=n(40251),S=n(82693),w=n(46871),x=n(37174),L=n(93753),y=n(21881),N=n(15285),I=n(38857),M=n(98158),T=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},R=function(e,t){return function(n,i){t(n,i,e)}};let O=class extends c.JT{constructor(e,t,n){super(),this.editor=e,this.model=t,this.instantiationService=n,this.alwaysShowToolbar=(0,u.rD)(this.editor.onDidChangeConfiguration,(()=>"always"===this.editor.getOption(61).showToolbar)),this.sessionPosition=void 0,this.position=(0,u.nK)("position",(e=>{var t,n,i;const o=null===(t=this.model.read(e))||void 0===t?void 0:t.ghostText.read(e);if(!this.alwaysShowToolbar.read(e)||!o||0===o.parts.length)return this.sessionPosition=void 0,null;const s=o.parts[0].column;this.sessionPosition&&this.sessionPosition.lineNumber!==o.lineNumber&&(this.sessionPosition=void 0);const r=new m.L(o.lineNumber,Math.min(s,null!==(i=null===(n=this.sessionPosition)||void 0===n?void 0:n.column)&&void 0!==i?i:Number.MAX_SAFE_INTEGER));return this.sessionPosition=r,r})),this._register((0,h.b2)("setup content widget",((t,n)=>{const i=this.model.read(t);if(!i||!this.alwaysShowToolbar.read(t))return;const o=n.add(this.instantiationService.createInstance(E,this.editor,!0,this.position,i.selectedInlineCompletionIndex,i.inlineCompletionsCount,i.selectedInlineCompletion.map((e=>{var t;return null!==(t=null===e||void 0===e?void 0:e.inlineCompletion.source.inlineCompletions.commands)&&void 0!==t?t:[]}))));e.addContentWidget(o),n.add((0,c.OF)((()=>e.removeContentWidget(o)))),n.add((0,u.EH)("request explicit",(e=>{const t=this.position.read(e);t&&i.lastTriggerKind.read(e)!==f.bw.Explicit&&i.triggerExplicitly()})))})))}};O=T([R(2,y.TG)],O);const D=(0,M.q5)("inline-suggestion-hints-next",d.l.chevronRight,(0,_.NC)("parameterHintsNextIcon","Icon for show next parameter hint.")),P=(0,M.q5)("inline-suggestion-hints-previous",d.l.chevronLeft,(0,_.NC)("parameterHintsPreviousIcon","Icon for show previous parameter hint."));let E=class e extends c.JT{static get dropDownVisible(){return this._dropDownVisible}createCommandAction(e,t,n){const i=new r.aU(e,t,n,!0,(()=>this._commandService.executeCommand(e))),o=this.keybindingService.lookupKeybinding(e,this._contextKeyService);let s=t;return o&&(s=(0,_.NC)({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",t,o.getLabel())),i.tooltip=s,i}constructor(t,n,s,d,c,h,g,m,f,C,b){super(),this.editor=t,this.withBorder=n,this._position=s,this._currentSuggestionIdx=d,this._suggestionCount=c,this._extraCommands=h,this._commandService=g,this.keybindingService=f,this._contextKeyService=C,this._menuService=b,this.id="InlineSuggestionHintsContentWidget"+e.id++,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this.nodes=(0,i.h)("div.inlineSuggestionsHints",{className:this.withBorder?".withBorder":""},[(0,i.h)("div",{style:{display:"flex"}},[(0,i.h)("div@actionBar",{className:"custom-actions"}),(0,i.h)("div@toolBar")])]),this.previousAction=this.createCommandAction(v.Np,(0,_.NC)("previous","Previous"),p.k.asClassName(P)),this.availableSuggestionCountAction=new r.aU("inlineSuggestionHints.availableSuggestionCount","",void 0,!1),this.nextAction=this.createCommandAction(v.OW,(0,_.NC)("next","Next"),p.k.asClassName(D)),this.inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(S.eH.InlineCompletionsActions,this._contextKeyService)),this.clearAvailableSuggestionCountLabelDebounced=this._register(new l.pY((()=>{this.availableSuggestionCountAction.label=""}),100)),this.disableButtonsDebounced=this._register(new l.pY((()=>{this.previousAction.enabled=this.nextAction.enabled=!1}),100)),this.lastCommands=[];const w=this._register(new o.o(this.nodes.actionBar));w.push(this.previousAction,{icon:!0,label:!1}),w.push(this.availableSuggestionCountAction),w.push(this.nextAction,{icon:!0,label:!1}),this.toolBar=this._register(m.createInstance(k,this.nodes.toolBar,S.eH.InlineSuggestionToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:e=>e.startsWith("primary")},actionViewItemProvider:(e,t)=>e instanceof S.U8?m.createInstance(A,e,void 0):void 0,telemetrySource:"InlineSuggestionToolbar"})),this._register(this.toolBar.onDidChangeDropdownVisibility((t=>{e._dropDownVisible=t}))),this._register((0,u.EH)("update position",(e=>{this._position.read(e),this.editor.layoutContentWidget(this)}))),this._register((0,u.EH)("counts",(e=>{const t=this._suggestionCount.read(e),n=this._currentSuggestionIdx.read(e);void 0!==t?(this.clearAvailableSuggestionCountLabelDebounced.cancel(),this.availableSuggestionCountAction.label=`${n+1}/${t}`):this.clearAvailableSuggestionCountLabelDebounced.schedule(),void 0!==t&&t>1?(this.disableButtonsDebounced.cancel(),this.previousAction.enabled=this.nextAction.enabled=!0):this.disableButtonsDebounced.schedule()}))),this._register((0,u.EH)("extra commands",(e=>{const t=this._extraCommands.read(e);if((0,a.fS)(this.lastCommands,t))return;this.lastCommands=t;const n=t.map((e=>({class:void 0,id:e.id,enabled:!0,tooltip:e.tooltip||"",label:e.title,run:t=>this._commandService.executeCommand(e.id)})));for(const[i,o]of this.inlineCompletionsActionsMenus.getActions())for(const e of o)e instanceof S.U8&&n.push(e);n.length>0&&n.unshift(new r.Z0),this.toolBar.setAdditionalSecondaryActions(n)})))}getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}};E._dropDownVisible=!1,E.id=0,E=T([R(6,w.H),R(7,y.TG),R(8,N.d),R(9,x.i6),R(10,S.co)],E);class A extends C.Mm{updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){const t=(0,i.h)("div.keybinding").root,n=new s.e(t,g.OS,Object.assign({disableTitle:!0},s.F));n.set(e),this.label.textContent=this._action.label,this.label.appendChild(t),this.label.classList.add("inlineSuggestionStatusBarItemLabel")}}}let k=class extends b.T{constructor(e,t,n,i,o,s,r,a){super(e,Object.assign({resetMenu:t},n),i,o,s,r,a),this.menuId=t,this.options2=n,this.menuService=i,this.contextKeyService=o,this.menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.additionalActions=[],this._store.add(this.menu.onDidChange((()=>this.updateToolbar()))),this.updateToolbar()}updateToolbar(){var e,t,n,i,o,s,r;const a=[],l=[];(0,C.vr)(this.menu,null===(e=this.options2)||void 0===e?void 0:e.menuOptions,{primary:a,secondary:l},null===(n=null===(t=this.options2)||void 0===t?void 0:t.toolbarOptions)||void 0===n?void 0:n.primaryGroup,null===(o=null===(i=this.options2)||void 0===i?void 0:i.toolbarOptions)||void 0===o?void 0:o.shouldInlineSubmenu,null===(r=null===(s=this.options2)||void 0===s?void 0:s.toolbarOptions)||void 0===r?void 0:r.useSeparatorsInPrimaryActions),l.push(...this.additionalActions),this.setActions(a,l)}setAdditionalSecondaryActions(e){(0,a.fS)(this.additionalActions,e,((e,t)=>e===t))||(this.additionalActions=e,this.updateToolbar())}};k=T([R(3,S.co),R(4,x.i6),R(5,L.i),R(6,N.d),R(7,I.b)],k)},44737:(e,t,n)=>{n.d(t,{r:()=>v});var i=n(2548),o=n(85398),s=n(8419),r=n(70959),a=n(61720),l=n(99588),d=n(33162),c=n(16375),u=n(21881),h=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},g=function(e,t){return function(n,i){t(n,i,e)}},p=function(e,t,n,i){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function r(e){try{l(i.next(e))}catch(t){s(t)}}function a(e){try{l(i["throw"](e))}catch(t){s(t)}}function l(e){e.done?n(e.value):o(e.value).then(r,a)}l((i=i.apply(e,t||[])).next())}))};const m=c.qx.register({description:"inline-progress-widget",stickiness:1,showIfCollapsed:!0,after:{content:a.B4,inlineClassName:"inline-editor-progress-decoration",inlineClassNameAffectsLetterSpacing:!0}});class f extends r.JT{constructor(e,t,n,i,o){super(),this.typeId=e,this.editor=t,this.range=n,this.delegate=o,this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this.create(i),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this)}create(e){this.domNode=i.$(".inline-progress-widget"),this.domNode.role="button",this.domNode.title=e;const t=i.$("span.icon");this.domNode.append(t),t.classList.add(...l.k.asClassNameArray(s.l.loading),"codicon-modifier-spin");const n=()=>{const e=this.editor.getOption(65);this.domNode.style.height=`${e}px`,this.domNode.style.width=`${Math.ceil(.8*e)}px`};n(),this._register(this.editor.onDidChangeConfiguration((e=>{(e.hasChanged(51)||e.hasChanged(65))&&n()}))),this._register(i.nm(this.domNode,i.tw.CLICK,(e=>{this.delegate.cancel()})))}getId(){return f.baseId+"."+this.typeId}getDomNode(){return this.domNode}getPosition(){return{position:{lineNumber:this.range.startLineNumber,column:this.range.startColumn},preference:[0]}}dispose(){super.dispose(),this.editor.removeContentWidget(this)}}f.baseId="editor.widget.inlineProgressWidget";let v=class extends r.JT{constructor(e,t,n){super(),this.id=e,this._editor=t,this._instantiationService=n,this._showDelay=500,this._showPromise=this._register(new r.XK),this._currentWidget=new r.XK,this._operationIdPool=0,this._currentDecorations=t.createDecorationsCollection()}showWhile(e,t,n){return p(this,void 0,void 0,(function*(){const i=this._operationIdPool++;this._currentOperation=i,this.clear(),this._showPromise.value=(0,o.Vg)((()=>{const i=d.e.fromPositions(e),o=this._currentDecorations.set([{range:i,options:m}]);o.length>0&&(this._currentWidget.value=this._instantiationService.createInstance(f,this.id,this._editor,i,t,n))}),this._showDelay);try{return yield n}finally{this._currentOperation===i&&(this.clear(),this._currentOperation=void 0)}}))}clear(){this._showPromise.clear(),this._currentDecorations.clear(),this._currentWidget.clear()}};v=h([g(2,u.TG)],v)},41287:(e,t,n)=>{var i=n(48077),o=n(55880),s=n(44950),r=n(25206);class a extends i.R6{constructor(){super({id:"expandLineSelection",label:r.NC("expandLineSelection","Expand Line Selection"),alias:"Expand Line Selection",precondition:void 0,kbOpts:{weight:0,kbExpr:s.u.textInputFocus,primary:2090}})}run(e,t,n){if(n=n||{},!t.hasModel())return;const i=t._getViewModel();i.model.pushStackElement(),i.setCursorStates(n.source,3,o.P.expandLineSelection(i,i.getCursorStates())),i.revealPrimaryCursor(n.source,!0)}}(0,i.Qr)(a)},90376:(e,t,n)=>{var i=n(56082),o=n(25109),s=n(48077),r=n(74816),a=n(38159),l=n(64360),d=n(90970),c=n(89999),u=n(33162),h=n(54644),g=n(44950);class p{constructor(e,t,n){this._selection=e,this._isCopyingDown=t,this._noop=n||!1,this._selectionDirection=0,this._selectionId=null,this._startLineNumberDelta=0,this._endLineNumberDelta=0}getEditOperations(e,t){let n=this._selection;this._startLineNumberDelta=0,this._endLineNumberDelta=0,n.startLineNumber<n.endLineNumber&&1===n.endColumn&&(this._endLineNumberDelta=1,n=n.setEndPosition(n.endLineNumber-1,e.getLineMaxColumn(n.endLineNumber-1)));const i=[];for(let s=n.startLineNumber;s<=n.endLineNumber;s++)i.push(e.getLineContent(s));const o=i.join("\n");""===o&&this._isCopyingDown&&(this._startLineNumberDelta++,this._endLineNumberDelta++),this._noop?t.addEditOperation(new u.e(n.endLineNumber,e.getLineMaxColumn(n.endLineNumber),n.endLineNumber+1,1),n.endLineNumber===e.getLineCount()?"":"\n"):this._isCopyingDown?t.addEditOperation(new u.e(n.startLineNumber,1,n.startLineNumber,1),o+"\n"):t.addEditOperation(new u.e(n.endLineNumber,e.getLineMaxColumn(n.endLineNumber),n.endLineNumber,e.getLineMaxColumn(n.endLineNumber)),"\n"+o),this._selectionId=t.trackSelection(n),this._selectionDirection=this._selection.getDirection()}computeCursorState(e,t){let n=t.getTrackedSelection(this._selectionId);if(0!==this._startLineNumberDelta||0!==this._endLineNumberDelta){let e=n.startLineNumber,t=n.startColumn,i=n.endLineNumber,o=n.endColumn;0!==this._startLineNumberDelta&&(e+=this._startLineNumberDelta,t=1),0!==this._endLineNumberDelta&&(i+=this._endLineNumberDelta,o=1),n=h.Y.createWithDirection(e,t,i,o,this._selectionDirection)}return n}}var m=n(61720),f=n(85175),v=n(11432),_=n(97297),C=n(28649),b=n(52185),S=n(74177),w=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},x=function(e,t){return function(n,i){t(n,i,e)}};let L=class{constructor(e,t,n,i){this._languageConfigurationService=i,this._selection=e,this._isMovingDown=t,this._autoIndent=n,this._selectionId=null,this._moveEndLineSelectionShrink=!1}getEditOperations(e,t){const n=e.getLineCount();if(this._isMovingDown&&this._selection.endLineNumber===n)return void(this._selectionId=t.trackSelection(this._selection));if(!this._isMovingDown&&1===this._selection.startLineNumber)return void(this._selectionId=t.trackSelection(this._selection));this._moveEndPositionDown=!1;let i=this._selection;i.startLineNumber<i.endLineNumber&&1===i.endColumn&&(this._moveEndPositionDown=!0,i=i.setEndPosition(i.endLineNumber-1,e.getLineMaxColumn(i.endLineNumber-1)));const{tabSize:o,indentSize:s,insertSpaces:r}=e.getOptions(),a=this.buildIndentConverter(o,s,r),l={tokenization:{getLineTokens:t=>e.tokenization.getLineTokens(t),getLanguageId:()=>e.getLanguageId(),getLanguageIdAtPosition:(t,n)=>e.getLanguageIdAtPosition(t,n)},getLineContent:null};if(i.startLineNumber===i.endLineNumber&&1===e.getLineMaxColumn(i.startLineNumber)){const n=i.startLineNumber,o=this._isMovingDown?n+1:n-1;1===e.getLineMaxColumn(o)?t.addEditOperation(new u.e(1,1,1,1),null):(t.addEditOperation(new u.e(n,1,n,1),e.getLineContent(o)),t.addEditOperation(new u.e(o,1,o,e.getLineMaxColumn(o)),null)),i=new h.Y(o,1,o,1)}else{let n,s;if(this._isMovingDown){n=i.endLineNumber+1,s=e.getLineContent(n),t.addEditOperation(new u.e(n-1,e.getLineMaxColumn(n-1),n,e.getLineMaxColumn(n)),null);let d=s;if(this.shouldAutoIndent(e,i)){const c=this.matchEnterRule(e,a,o,n,i.startLineNumber-1);if(null!==c){const t=m.V8(e.getLineContent(n)),i=c+C.Y(t,o),a=C.J(i,o,r);d=a+this.trimLeft(s)}else{l.getLineContent=t=>t===i.startLineNumber?e.getLineContent(n):e.getLineContent(t);const t=(0,b.n8)(this._autoIndent,l,e.getLanguageIdAtPosition(n,1),i.startLineNumber,a,this._languageConfigurationService);if(null!==t){const i=m.V8(e.getLineContent(n)),a=C.Y(t,o),l=C.Y(i,o);if(a!==l){const e=C.J(a,o,r);d=e+this.trimLeft(s)}}}t.addEditOperation(new u.e(i.startLineNumber,1,i.startLineNumber,1),d+"\n");const h=this.matchEnterRuleMovingDown(e,a,o,i.startLineNumber,n,d);if(null!==h)0!==h&&this.getIndentEditsOfMovingBlock(e,t,i,o,r,h);else{l.getLineContent=t=>t===i.startLineNumber?d:t>=i.startLineNumber+1&&t<=i.endLineNumber+1?e.getLineContent(t-1):e.getLineContent(t);const s=(0,b.n8)(this._autoIndent,l,e.getLanguageIdAtPosition(n,1),i.startLineNumber+1,a,this._languageConfigurationService);if(null!==s){const n=m.V8(e.getLineContent(i.startLineNumber)),a=C.Y(s,o),l=C.Y(n,o);if(a!==l){const n=a-l;this.getIndentEditsOfMovingBlock(e,t,i,o,r,n)}}}}else t.addEditOperation(new u.e(i.startLineNumber,1,i.startLineNumber,1),d+"\n")}else if(n=i.startLineNumber-1,s=e.getLineContent(n),t.addEditOperation(new u.e(n,1,n+1,1),null),t.addEditOperation(new u.e(i.endLineNumber,e.getLineMaxColumn(i.endLineNumber),i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),"\n"+s),this.shouldAutoIndent(e,i)){l.getLineContent=t=>t===n?e.getLineContent(i.startLineNumber):e.getLineContent(t);const s=this.matchEnterRule(e,a,o,i.startLineNumber,i.startLineNumber-2);if(null!==s)0!==s&&this.getIndentEditsOfMovingBlock(e,t,i,o,r,s);else{const s=(0,b.n8)(this._autoIndent,l,e.getLanguageIdAtPosition(i.startLineNumber,1),n,a,this._languageConfigurationService);if(null!==s){const n=m.V8(e.getLineContent(i.startLineNumber)),a=C.Y(s,o),l=C.Y(n,o);if(a!==l){const n=a-l;this.getIndentEditsOfMovingBlock(e,t,i,o,r,n)}}}}}this._selectionId=t.trackSelection(i)}buildIndentConverter(e,t,n){return{shiftIndent:i=>f.U.shiftIndent(i,i.length+1,e,t,n),unshiftIndent:i=>f.U.unshiftIndent(i,i.length+1,e,t,n)}}parseEnterResult(e,t,n,i,o){if(o){let s=o.indentation;o.indentAction===v.wU.None||o.indentAction===v.wU.Indent?s=o.indentation+o.appendText:o.indentAction===v.wU.IndentOutdent?s=o.indentation:o.indentAction===v.wU.Outdent&&(s=t.unshiftIndent(o.indentation)+o.appendText);const r=e.getLineContent(i);if(this.trimLeft(r).indexOf(this.trimLeft(s))>=0){const o=m.V8(e.getLineContent(i));let r=m.V8(s);const a=(0,b.tI)(e,i,this._languageConfigurationService);null!==a&&2&a&&(r=t.unshiftIndent(r));const l=C.Y(r,n),d=C.Y(o,n);return l-d}}return null}matchEnterRuleMovingDown(e,t,n,i,o,s){if(m.ow(s)>=0){const s=e.getLineMaxColumn(o),r=(0,S.A)(this._autoIndent,e,new u.e(o,s,o,s),this._languageConfigurationService);return this.parseEnterResult(e,t,n,i,r)}{let o=i-1;while(o>=1){const t=e.getLineContent(o),n=m.ow(t);if(n>=0)break;o--}if(o<1||i>e.getLineCount())return null;const s=e.getLineMaxColumn(o),r=(0,S.A)(this._autoIndent,e,new u.e(o,s,o,s),this._languageConfigurationService);return this.parseEnterResult(e,t,n,i,r)}}matchEnterRule(e,t,n,i,o,s){let r=o;while(r>=1){let t;t=r===o&&void 0!==s?s:e.getLineContent(r);const n=m.ow(t);if(n>=0)break;r--}if(r<1||i>e.getLineCount())return null;const a=e.getLineMaxColumn(r),l=(0,S.A)(this._autoIndent,e,new u.e(r,a,r,a),this._languageConfigurationService);return this.parseEnterResult(e,t,n,i,l)}trimLeft(e){return e.replace(/^\s+/,"")}shouldAutoIndent(e,t){if(this._autoIndent<4)return!1;if(!e.tokenization.isCheapToTokenize(t.startLineNumber))return!1;const n=e.getLanguageIdAtPosition(t.startLineNumber,1),i=e.getLanguageIdAtPosition(t.endLineNumber,1);return n===i&&null!==this._languageConfigurationService.getLanguageConfiguration(n).indentRulesSupport}getIndentEditsOfMovingBlock(e,t,n,i,o,s){for(let r=n.startLineNumber;r<=n.endLineNumber;r++){const a=e.getLineContent(r),l=m.V8(a),d=C.Y(l,i),c=d+s,h=C.J(c,i,o);h!==l&&(t.addEditOperation(new u.e(r,1,r,l.length+1),h),r===n.endLineNumber&&n.endColumn<=l.length+1&&""===h&&(this._moveEndLineSelectionShrink=!0))}}computeCursorState(e,t){let n=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(n=n.setEndPosition(n.endLineNumber+1,1)),this._moveEndLineSelectionShrink&&n.startLineNumber<n.endLineNumber&&(n=n.setEndPosition(n.endLineNumber,2)),n}};L=w([x(3,_.c_)],L);class y{static getCollator(){return y._COLLATOR||(y._COLLATOR=new Intl.Collator),y._COLLATOR}constructor(e,t){this.selection=e,this.descending=t,this.selectionId=null}getEditOperations(e,t){const n=I(e,this.selection,this.descending);n&&t.addEditOperation(n.range,n.text),this.selectionId=t.trackSelection(this.selection)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}static canRun(e,t,n){if(null===e)return!1;const i=N(e,t,n);if(!i)return!1;for(let o=0,s=i.before.length;o<s;o++)if(i.before[o]!==i.after[o])return!0;return!1}}function N(e,t,n){const i=t.startLineNumber;let o=t.endLineNumber;if(1===t.endColumn&&o--,i>=o)return null;const s=[];for(let a=i;a<=o;a++)s.push(e.getLineContent(a));let r=s.slice(0);return r.sort(y.getCollator().compare),!0===n&&(r=r.reverse()),{startLineNumber:i,endLineNumber:o,before:s,after:r}}function I(e,t,n){const i=N(e,t,n);return i?d.h.replace(new u.e(i.startLineNumber,1,i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),i.after.join("\n")):null}y._COLLATOR=null;var M=n(25206),T=n(82693);class R extends s.R6{constructor(e,t){super(t),this.down=e}run(e,t){if(!t.hasModel())return;const n=t.getSelections().map(((e,t)=>({selection:e,index:t,ignore:!1})));n.sort(((e,t)=>u.e.compareRangesUsingStarts(e.selection,t.selection)));let i=n[0];for(let s=1;s<n.length;s++){const e=n[s];i.selection.endLineNumber===e.selection.startLineNumber&&(i.index<e.index?e.ignore=!0:(i.ignore=!0,i=e))}const o=[];for(const s of n)o.push(new p(s.selection,this.down,s.ignore));t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}class O extends R{constructor(){super(!1,{id:"editor.action.copyLinesUpAction",label:M.NC("lines.copyUp","Copy Line Up"),alias:"Copy Line Up",precondition:g.u.writable,kbOpts:{kbExpr:g.u.editorTextFocus,primary:1552,linux:{primary:3600},weight:100},menuOpts:{menuId:T.eH.MenubarSelectionMenu,group:"2_line",title:M.NC({key:"miCopyLinesUp",comment:["&& denotes a mnemonic"]},"&&Copy Line Up"),order:1}})}}class D extends R{constructor(){super(!0,{id:"editor.action.copyLinesDownAction",label:M.NC("lines.copyDown","Copy Line Down"),alias:"Copy Line Down",precondition:g.u.writable,kbOpts:{kbExpr:g.u.editorTextFocus,primary:1554,linux:{primary:3602},weight:100},menuOpts:{menuId:T.eH.MenubarSelectionMenu,group:"2_line",title:M.NC({key:"miCopyLinesDown",comment:["&& denotes a mnemonic"]},"Co&&py Line Down"),order:2}})}}class P extends s.R6{constructor(){super({id:"editor.action.duplicateSelection",label:M.NC("duplicateSelection","Duplicate Selection"),alias:"Duplicate Selection",precondition:g.u.writable,menuOpts:{menuId:T.eH.MenubarSelectionMenu,group:"2_line",title:M.NC({key:"miDuplicateSelection",comment:["&& denotes a mnemonic"]},"&&Duplicate Selection"),order:5}})}run(e,t,n){if(!t.hasModel())return;const i=[],o=t.getSelections(),s=t.getModel();for(const a of o)if(a.isEmpty())i.push(new p(a,!0));else{const e=new h.Y(a.endLineNumber,a.endColumn,a.endLineNumber,a.endColumn);i.push(new r.OY(e,s.getValueInRange(a)))}t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}}class E extends s.R6{constructor(e,t){super(t),this.down=e}run(e,t){const n=e.get(_.c_),i=[],o=t.getSelections()||[],s=t.getOption(11);for(const r of o)i.push(new L(r,this.down,s,n));t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}}class A extends E{constructor(){super(!1,{id:"editor.action.moveLinesUpAction",label:M.NC("lines.moveUp","Move Line Up"),alias:"Move Line Up",precondition:g.u.writable,kbOpts:{kbExpr:g.u.editorTextFocus,primary:528,linux:{primary:528},weight:100},menuOpts:{menuId:T.eH.MenubarSelectionMenu,group:"2_line",title:M.NC({key:"miMoveLinesUp",comment:["&& denotes a mnemonic"]},"Mo&&ve Line Up"),order:3}})}}class k extends E{constructor(){super(!0,{id:"editor.action.moveLinesDownAction",label:M.NC("lines.moveDown","Move Line Down"),alias:"Move Line Down",precondition:g.u.writable,kbOpts:{kbExpr:g.u.editorTextFocus,primary:530,linux:{primary:530},weight:100},menuOpts:{menuId:T.eH.MenubarSelectionMenu,group:"2_line",title:M.NC({key:"miMoveLinesDown",comment:["&& denotes a mnemonic"]},"Move &&Line Down"),order:4}})}}class F extends s.R6{constructor(e,t){super(t),this.descending=e}run(e,t){const n=t.getSelections()||[];for(const o of n)if(!y.canRun(t.getModel(),o,this.descending))return;const i=[];for(let o=0,s=n.length;o<s;o++)i[o]=new y(n[o],this.descending);t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}}class V extends F{constructor(){super(!1,{id:"editor.action.sortLinesAscending",label:M.NC("lines.sortAscending","Sort Lines Ascending"),alias:"Sort Lines Ascending",precondition:g.u.writable})}}class H extends F{constructor(){super(!0,{id:"editor.action.sortLinesDescending",label:M.NC("lines.sortDescending","Sort Lines Descending"),alias:"Sort Lines Descending",precondition:g.u.writable})}}class W extends s.R6{constructor(){super({id:"editor.action.removeDuplicateLines",label:M.NC("lines.deleteDuplicates","Delete Duplicate Lines"),alias:"Delete Duplicate Lines",precondition:g.u.writable})}run(e,t){if(!t.hasModel())return;const n=t.getModel();if(1===n.getLineCount()&&1===n.getLineMaxColumn(1))return;const i=[],o=[];let s=0;for(const r of t.getSelections()){const e=new Set,t=[];for(let i=r.startLineNumber;i<=r.endLineNumber;i++){const o=n.getLineContent(i);e.has(o)||(t.push(o),e.add(o))}const a=new h.Y(r.startLineNumber,1,r.endLineNumber,n.getLineMaxColumn(r.endLineNumber)),l=r.startLineNumber-s,c=new h.Y(l,1,l+t.length-1,t[t.length-1].length);i.push(d.h.replace(a,t.join("\n"))),o.push(c),s+=r.endLineNumber-r.startLineNumber+1-t.length}t.pushUndoStop(),t.executeEdits(this.id,i,o),t.pushUndoStop()}}class U extends s.R6{constructor(){super({id:U.ID,label:M.NC("lines.trimTrailingWhitespace","Trim Trailing Whitespace"),alias:"Trim Trailing Whitespace",precondition:g.u.writable,kbOpts:{kbExpr:g.u.editorTextFocus,primary:(0,i.gx)(2089,2102),weight:100}})}run(e,t,n){let i=[];"auto-save"===n.reason&&(i=(t.getSelections()||[]).map((e=>new c.L(e.positionLineNumber,e.positionColumn))));const o=t.getSelection();if(null===o)return;const s=new a.V(o,i);t.pushUndoStop(),t.executeCommands(this.id,[s]),t.pushUndoStop()}}U.ID="editor.action.trimTrailingWhitespace";class B extends s.R6{constructor(){super({id:"editor.action.deleteLines",label:M.NC("lines.delete","Delete Line"),alias:"Delete Line",precondition:g.u.writable,kbOpts:{kbExpr:g.u.textInputFocus,primary:3113,weight:100}})}run(e,t){if(!t.hasModel())return;const n=this._getLinesToRemove(t),i=t.getModel();if(1===i.getLineCount()&&1===i.getLineMaxColumn(1))return;let o=0;const s=[],r=[];for(let a=0,l=n.length;a<l;a++){const e=n[a];let t=e.startLineNumber,l=e.endLineNumber,c=1,u=i.getLineMaxColumn(l);l<i.getLineCount()?(l+=1,u=1):t>1&&(t-=1,c=i.getLineMaxColumn(t)),s.push(d.h.replace(new h.Y(t,c,l,u),"")),r.push(new h.Y(t-o,e.positionColumn,t-o,e.positionColumn)),o+=e.endLineNumber-e.startLineNumber+1}t.pushUndoStop(),t.executeEdits(this.id,s,r),t.pushUndoStop()}_getLinesToRemove(e){const t=e.getSelections().map((e=>{let t=e.endLineNumber;return e.startLineNumber<e.endLineNumber&&1===e.endColumn&&(t-=1),{startLineNumber:e.startLineNumber,selectionStartColumn:e.selectionStartColumn,endLineNumber:t,positionColumn:e.positionColumn}}));t.sort(((e,t)=>e.startLineNumber===t.startLineNumber?e.endLineNumber-t.endLineNumber:e.startLineNumber-t.startLineNumber));const n=[];let i=t[0];for(let o=1;o<t.length;o++)i.endLineNumber+1>=t[o].startLineNumber?i.endLineNumber=t[o].endLineNumber:(n.push(i),i=t[o]);return n.push(i),n}}class K extends s.R6{constructor(){super({id:"editor.action.indentLines",label:M.NC("lines.indent","Indent Line"),alias:"Indent Line",precondition:g.u.writable,kbOpts:{kbExpr:g.u.editorTextFocus,primary:2142,weight:100}})}run(e,t){const n=t._getViewModel();n&&(t.pushUndoStop(),t.executeCommands(this.id,l.u6.indent(n.cursorConfig,t.getModel(),t.getSelections())),t.pushUndoStop())}}class j extends s.R6{constructor(){super({id:"editor.action.outdentLines",label:M.NC("lines.outdent","Outdent Line"),alias:"Outdent Line",precondition:g.u.writable,kbOpts:{kbExpr:g.u.editorTextFocus,primary:2140,weight:100}})}run(e,t){o.wk.Outdent.runEditorCommand(e,t,null)}}class q extends s.R6{constructor(){super({id:"editor.action.insertLineBefore",label:M.NC("lines.insertBefore","Insert Line Above"),alias:"Insert Line Above",precondition:g.u.writable,kbOpts:{kbExpr:g.u.editorTextFocus,primary:3075,weight:100}})}run(e,t){const n=t._getViewModel();n&&(t.pushUndoStop(),t.executeCommands(this.id,l.u6.lineInsertBefore(n.cursorConfig,t.getModel(),t.getSelections())))}}class Y extends s.R6{constructor(){super({id:"editor.action.insertLineAfter",label:M.NC("lines.insertAfter","Insert Line Below"),alias:"Insert Line Below",precondition:g.u.writable,kbOpts:{kbExpr:g.u.editorTextFocus,primary:2051,weight:100}})}run(e,t){const n=t._getViewModel();n&&(t.pushUndoStop(),t.executeCommands(this.id,l.u6.lineInsertAfter(n.cursorConfig,t.getModel(),t.getSelections())))}}class Q extends s.R6{run(e,t){if(!t.hasModel())return;const n=t.getSelection(),i=this._getRangesToDelete(t),o=[];for(let a=0,l=i.length-1;a<l;a++){const e=i[a],t=i[a+1];null===u.e.intersectRanges(e,t)?o.push(e):i[a+1]=u.e.plusRange(e,t)}o.push(i[i.length-1]);const s=this._getEndCursorState(n,o),r=o.map((e=>d.h.replace(e,"")));t.pushUndoStop(),t.executeEdits(this.id,r,s),t.pushUndoStop()}}class $ extends Q{constructor(){super({id:"deleteAllLeft",label:M.NC("lines.deleteAllLeft","Delete All Left"),alias:"Delete All Left",precondition:g.u.writable,kbOpts:{kbExpr:g.u.textInputFocus,primary:0,mac:{primary:2049},weight:100}})}_getEndCursorState(e,t){let n=null;const i=[];let o=0;return t.forEach((t=>{let s;if(1===t.endColumn&&o>0){const e=t.startLineNumber-o;s=new h.Y(e,t.startColumn,e,t.startColumn)}else s=new h.Y(t.startLineNumber,t.startColumn,t.startLineNumber,t.startColumn);o+=t.endLineNumber-t.startLineNumber,t.intersectRanges(e)?n=s:i.push(s)})),n&&i.unshift(n),i}_getRangesToDelete(e){const t=e.getSelections();if(null===t)return[];let n=t;const i=e.getModel();return null===i?[]:(n.sort(u.e.compareRangesUsingStarts),n=n.map((e=>{if(e.isEmpty()){if(1===e.startColumn){const t=Math.max(1,e.startLineNumber-1),n=1===e.startLineNumber?1:i.getLineContent(t).length+1;return new u.e(t,n,e.startLineNumber,1)}return new u.e(e.startLineNumber,1,e.startLineNumber,e.startColumn)}return new u.e(e.startLineNumber,1,e.endLineNumber,e.endColumn)})),n)}}class z extends Q{constructor(){super({id:"deleteAllRight",label:M.NC("lines.deleteAllRight","Delete All Right"),alias:"Delete All Right",precondition:g.u.writable,kbOpts:{kbExpr:g.u.textInputFocus,primary:0,mac:{primary:297,secondary:[2068]},weight:100}})}_getEndCursorState(e,t){let n=null;const i=[];for(let o=0,s=t.length,r=0;o<s;o++){const s=t[o],a=new h.Y(s.startLineNumber-r,s.startColumn,s.startLineNumber-r,s.startColumn);s.intersectRanges(e)?n=a:i.push(a)}return n&&i.unshift(n),i}_getRangesToDelete(e){const t=e.getModel();if(null===t)return[];const n=e.getSelections();if(null===n)return[];const i=n.map((e=>{if(e.isEmpty()){const n=t.getLineMaxColumn(e.startLineNumber);return e.startColumn===n?new u.e(e.startLineNumber,e.startColumn,e.startLineNumber+1,1):new u.e(e.startLineNumber,e.startColumn,e.startLineNumber,n)}return e}));return i.sort(u.e.compareRangesUsingStarts),i}}class G extends s.R6{constructor(){super({id:"editor.action.joinLines",label:M.NC("lines.joinLines","Join Lines"),alias:"Join Lines",precondition:g.u.writable,kbOpts:{kbExpr:g.u.editorTextFocus,primary:0,mac:{primary:296},weight:100}})}run(e,t){const n=t.getSelections();if(null===n)return;let i=t.getSelection();if(null===i)return;n.sort(u.e.compareRangesUsingStarts);const o=[],s=n.reduce(((e,t)=>e.isEmpty()?e.endLineNumber===t.startLineNumber?(i.equalsSelection(e)&&(i=t),t):t.startLineNumber>e.endLineNumber+1?(o.push(e),t):new h.Y(e.startLineNumber,e.startColumn,t.endLineNumber,t.endColumn):t.startLineNumber>e.endLineNumber?(o.push(e),t):new h.Y(e.startLineNumber,e.startColumn,t.endLineNumber,t.endColumn)));o.push(s);const r=t.getModel();if(null===r)return;const a=[],l=[];let c=i,g=0;for(let p=0,m=o.length;p<m;p++){const e=o[p],t=e.startLineNumber,n=1;let s,m,f=0;const v=r.getLineContent(e.endLineNumber).length-e.endColumn;if(e.isEmpty()||e.startLineNumber===e.endLineNumber){const n=e.getStartPosition();n.lineNumber<r.getLineCount()?(s=t+1,m=r.getLineMaxColumn(s)):(s=n.lineNumber,m=r.getLineMaxColumn(n.lineNumber))}else s=e.endLineNumber,m=r.getLineMaxColumn(s);let _=r.getLineContent(t);for(let i=t+1;i<=s;i++){const e=r.getLineContent(i),t=r.getLineFirstNonWhitespaceColumn(i);if(t>=1){let n=!0;""===_&&(n=!1),!n||" "!==_.charAt(_.length-1)&&"\t"!==_.charAt(_.length-1)||(n=!1,_=_.replace(/[\s\uFEFF\xA0]+$/g," "));const i=e.substr(t-1);_+=(n?" ":"")+i,f=n?i.length+1:i.length}else f=0}const C=new u.e(t,n,s,m);if(!C.isEmpty()){let n;e.isEmpty()?(a.push(d.h.replace(C,_)),n=new h.Y(C.startLineNumber-g,_.length-f+1,t-g,_.length-f+1)):e.startLineNumber===e.endLineNumber?(a.push(d.h.replace(C,_)),n=new h.Y(e.startLineNumber-g,e.startColumn,e.endLineNumber-g,e.endColumn)):(a.push(d.h.replace(C,_)),n=new h.Y(e.startLineNumber-g,e.startColumn,e.startLineNumber-g,_.length-v)),null!==u.e.intersectRanges(C,i)?c=n:l.push(n)}g+=C.endLineNumber-C.startLineNumber}l.unshift(c),t.pushUndoStop(),t.executeEdits(this.id,a,l),t.pushUndoStop()}}class Z extends s.R6{constructor(){super({id:"editor.action.transpose",label:M.NC("editor.transpose","Transpose characters around the cursor"),alias:"Transpose characters around the cursor",precondition:g.u.writable})}run(e,t){const n=t.getSelections();if(null===n)return;const i=t.getModel();if(null===i)return;const o=[];for(let s=0,a=n.length;s<a;s++){const e=n[s];if(!e.isEmpty())continue;const t=e.getStartPosition(),a=i.getLineMaxColumn(t.lineNumber);if(t.column>=a){if(t.lineNumber===i.getLineCount())continue;const e=new u.e(t.lineNumber,Math.max(1,t.column-1),t.lineNumber+1,1),n=i.getValueInRange(e).split("").reverse().join("");o.push(new r.T4(new h.Y(t.lineNumber,Math.max(1,t.column-1),t.lineNumber+1,1),n))}else{const e=new u.e(t.lineNumber,Math.max(1,t.column-1),t.lineNumber,t.column+1),n=i.getValueInRange(e).split("").reverse().join("");o.push(new r.hP(e,n,new h.Y(t.lineNumber,t.column+1,t.lineNumber,t.column+1)))}}t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}class J extends s.R6{run(e,t){const n=t.getSelections();if(null===n)return;const i=t.getModel();if(null===i)return;const o=t.getOption(128),s=[];for(const r of n)if(r.isEmpty()){const e=r.getStartPosition(),n=t.getConfiguredWordAtPosition(e);if(!n)continue;const a=new u.e(e.lineNumber,n.startColumn,e.lineNumber,n.endColumn),l=i.getValueInRange(a);s.push(d.h.replace(a,this._modifyText(l,o)))}else{const e=i.getValueInRange(r);s.push(d.h.replace(r,this._modifyText(e,o)))}t.pushUndoStop(),t.executeEdits(this.id,s),t.pushUndoStop()}}class X extends J{constructor(){super({id:"editor.action.transformToUppercase",label:M.NC("editor.transformToUppercase","Transform to Uppercase"),alias:"Transform to Uppercase",precondition:g.u.writable})}_modifyText(e,t){return e.toLocaleUpperCase()}}class ee extends J{constructor(){super({id:"editor.action.transformToLowercase",label:M.NC("editor.transformToLowercase","Transform to Lowercase"),alias:"Transform to Lowercase",precondition:g.u.writable})}_modifyText(e,t){return e.toLocaleLowerCase()}}class te{constructor(e,t){this._pattern=e,this._flags=t,this._actual=null,this._evaluated=!1}get(){if(!this._evaluated){this._evaluated=!0;try{this._actual=new RegExp(this._pattern,this._flags)}catch(e){}}return this._actual}isSupported(){return null!==this.get()}}class ne extends J{constructor(){super({id:"editor.action.transformToTitlecase",label:M.NC("editor.transformToTitlecase","Transform to Title Case"),alias:"Transform to Title Case",precondition:g.u.writable})}_modifyText(e,t){const n=ne.titleBoundary.get();return n?e.toLocaleLowerCase().replace(n,(e=>e.toLocaleUpperCase())):e}}ne.titleBoundary=new te("(^|[^\\p{L}\\p{N}']|((^|\\P{L})'))\\p{L}","gmu");class ie extends J{constructor(){super({id:"editor.action.transformToSnakecase",label:M.NC("editor.transformToSnakecase","Transform to Snake Case"),alias:"Transform to Snake Case",precondition:g.u.writable})}_modifyText(e,t){const n=ie.caseBoundary.get(),i=ie.singleLetters.get();return n&&i?e.replace(n,"$1_$2").replace(i,"$1_$2$3").toLocaleLowerCase():e}}ie.caseBoundary=new te("(\\p{Ll})(\\p{Lu})","gmu"),ie.singleLetters=new te("(\\p{Lu}|\\p{N})(\\p{Lu})(\\p{Ll})","gmu");class oe extends J{constructor(){super({id:"editor.action.transformToCamelcase",label:M.NC("editor.transformToCamelcase","Transform to Camel Case"),alias:"Transform to Camel Case",precondition:g.u.writable})}_modifyText(e,t){const n=oe.wordBoundary.get();if(!n)return e;const i=e.split(n),o=i.shift();return o+i.map((e=>e.substring(0,1).toLocaleUpperCase()+e.substring(1))).join("")}}oe.wordBoundary=new te("[_\\s-]","gm");class se extends J{static isSupported(){const e=[this.caseBoundary,this.singleLetters,this.underscoreBoundary].every((e=>e.isSupported()));return e}constructor(){super({id:"editor.action.transformToKebabcase",label:M.NC("editor.transformToKebabcase","Transform to Kebab Case"),alias:"Transform to Kebab Case",precondition:g.u.writable})}_modifyText(e,t){const n=se.caseBoundary.get(),i=se.singleLetters.get(),o=se.underscoreBoundary.get();return n&&i&&o?e.replace(o,"$1-$3").replace(n,"$1-$2").replace(i,"$1-$2").toLocaleLowerCase():e}}se.caseBoundary=new te("(\\p{Ll})(\\p{Lu})","gmu"),se.singleLetters=new te("(\\p{Lu}|\\p{N})(\\p{Lu}\\p{Ll})","gmu"),se.underscoreBoundary=new te("(\\S)(_)(\\S)","gm"),(0,s.Qr)(O),(0,s.Qr)(D),(0,s.Qr)(P),(0,s.Qr)(A),(0,s.Qr)(k),(0,s.Qr)(V),(0,s.Qr)(H),(0,s.Qr)(W),(0,s.Qr)(U),(0,s.Qr)(B),(0,s.Qr)(K),(0,s.Qr)(j),(0,s.Qr)(q),(0,s.Qr)(Y),(0,s.Qr)($),(0,s.Qr)(z),(0,s.Qr)(G),(0,s.Qr)(Z),(0,s.Qr)(X),(0,s.Qr)(ee),ie.caseBoundary.isSupported()&&ie.singleLetters.isSupported()&&(0,s.Qr)(ie),oe.wordBoundary.isSupported()&&(0,s.Qr)(oe),ne.titleBoundary.isSupported()&&(0,s.Qr)(ne),se.isSupported()&&(0,s.Qr)(se)},69225:(e,t,n)=>{var i=n(21921),o=n(85398),s=n(55191),r=n(60204),a=n(98642),l=n(11271),d=n(70959),c=n(61720),u=n(95896),h=n(48077),g=n(35195),p=n(89999),m=n(33162),f=n(44950),v=n(16375),_=n(97297),C=n(25206),b=n(37174),S=n(16458),w=n(47277),x=n(54732),L=n(96729),y=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},N=function(e,t){return function(n,i){t(n,i,e)}},I=function(e,t,n,i){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function r(e){try{l(i.next(e))}catch(t){s(t)}}function a(e){try{l(i["throw"](e))}catch(t){s(t)}}function l(e){e.done?n(e.value):o(e.value).then(r,a)}l((i=i.apply(e,t||[])).next())}))};const M=new b.uy("LinkedEditingInputVisible",!1),T="linked-editing-decoration";let R=class e extends d.JT{static get(t){return t.getContribution(e.ID)}constructor(e,t,n,i,o){super(),this.languageConfigurationService=i,this._syncRangesToken=0,this._localToDispose=this._register(new d.SL),this._editor=e,this._providers=n.linkedEditingRangeProvider,this._enabled=!1,this._visibleContextKey=M.bindTo(t),this._debounceInformation=o.for(this._providers,"Linked Editing",{max:200}),this._currentDecorations=this._editor.createDecorationsCollection(),this._languageWordPattern=null,this._currentWordPattern=null,this._ignoreChangeEvent=!1,this._localToDispose=this._register(new d.SL),this._rangeUpdateTriggerPromise=null,this._rangeSyncTriggerPromise=null,this._currentRequest=null,this._currentRequestPosition=null,this._currentRequestModelVersion=null,this._register(this._editor.onDidChangeModel((()=>this.reinitialize(!0)))),this._register(this._editor.onDidChangeConfiguration((e=>{(e.hasChanged(68)||e.hasChanged(91))&&this.reinitialize(!1)}))),this._register(this._providers.onDidChange((()=>this.reinitialize(!1)))),this._register(this._editor.onDidChangeModelLanguage((()=>this.reinitialize(!0)))),this.reinitialize(!0)}reinitialize(e){const t=this._editor.getModel(),n=null!==t&&(this._editor.getOption(68)||this._editor.getOption(91))&&this._providers.has(t);if(n===this._enabled&&!e)return;if(this._enabled=n,this.clearRanges(),this._localToDispose.clear(),!n||null===t)return;this._localToDispose.add(l.ju.runAndSubscribe(t.onDidChangeLanguageConfiguration,(()=>{this._languageWordPattern=this.languageConfigurationService.getLanguageConfiguration(t.getLanguageId()).getWordDefinition()})));const i=new o.vp(this._debounceInformation.get(t)),s=()=>{var e;this._rangeUpdateTriggerPromise=i.trigger((()=>this.updateRanges()),null!==(e=this._debounceDuration)&&void 0!==e?e:this._debounceInformation.get(t))},r=new o.vp(0),a=e=>{this._rangeSyncTriggerPromise=r.trigger((()=>this._syncRanges(e)))};this._localToDispose.add(this._editor.onDidChangeCursorPosition((()=>{s()}))),this._localToDispose.add(this._editor.onDidChangeModelContent((e=>{if(!this._ignoreChangeEvent&&this._currentDecorations.length>0){const t=this._currentDecorations.getRange(0);if(t&&e.changes.every((e=>t.intersectRanges(e.range))))return void a(this._syncRangesToken)}s()}))),this._localToDispose.add({dispose:()=>{i.dispose(),r.dispose()}}),this.updateRanges()}_syncRanges(e){if(!this._editor.hasModel()||e!==this._syncRangesToken||0===this._currentDecorations.length)return;const t=this._editor.getModel(),n=this._currentDecorations.getRange(0);if(!n||n.startLineNumber!==n.endLineNumber)return this.clearRanges();const i=t.getValueInRange(n);if(this._currentWordPattern){const e=i.match(this._currentWordPattern),t=e?e[0].length:0;if(t!==i.length)return this.clearRanges()}const o=[];for(let s=1,r=this._currentDecorations.length;s<r;s++){const e=this._currentDecorations.getRange(s);if(e)if(e.startLineNumber!==e.endLineNumber)o.push({range:e,text:i});else{let n=t.getValueInRange(e),s=i,r=e.startColumn,a=e.endColumn;const l=c.Mh(n,s);r+=l,n=n.substr(l),s=s.substr(l);const d=c.P1(n,s);a-=d,n=n.substr(0,n.length-d),s=s.substr(0,s.length-d),r===a&&0===s.length||o.push({range:new m.e(e.startLineNumber,r,e.endLineNumber,a),text:s})}}if(0!==o.length)try{this._editor.popUndoStop(),this._ignoreChangeEvent=!0;const e=this._editor._getViewModel().getPrevEditOperationType();this._editor.executeEdits("linkedEditing",o),this._editor._getViewModel().setPrevEditOperationType(e)}finally{this._ignoreChangeEvent=!1}}dispose(){this.clearRanges(),super.dispose()}clearRanges(){this._visibleContextKey.set(!1),this._currentDecorations.clear(),this._currentRequest&&(this._currentRequest.cancel(),this._currentRequest=null,this._currentRequestPosition=null)}updateRanges(t=!1){return I(this,void 0,void 0,(function*(){if(!this._editor.hasModel())return void this.clearRanges();const n=this._editor.getPosition();if(!this._enabled&&!t||this._editor.getSelections().length>1)return void this.clearRanges();const i=this._editor.getModel(),s=i.getVersionId();if(this._currentRequestPosition&&this._currentRequestModelVersion===s){if(n.equals(this._currentRequestPosition))return;if(this._currentDecorations.length>0){const e=this._currentDecorations.getRange(0);if(e&&e.containsPosition(n))return}}this.clearRanges(),this._currentRequestPosition=n,this._currentRequestModelVersion=s;const r=(0,o.PG)((t=>I(this,void 0,void 0,(function*(){try{const o=new L.G(!1),a=yield P(this._providers,i,n,t);if(this._debounceInformation.update(i,o.elapsed()),r!==this._currentRequest)return;if(this._currentRequest=null,s!==i.getVersionId())return;let l=[];(null===a||void 0===a?void 0:a.ranges)&&(l=a.ranges),this._currentWordPattern=(null===a||void 0===a?void 0:a.wordPattern)||this._languageWordPattern;let d=!1;for(let e=0,t=l.length;e<t;e++)if(m.e.containsPosition(l[e],n)){if(d=!0,0!==e){const t=l[e];l.splice(e,1),l.unshift(t)}break}if(!d)return void this.clearRanges();const c=l.map((t=>({range:t,options:e.DECORATION})));this._visibleContextKey.set(!0),this._currentDecorations.set(c),this._syncRangesToken++}catch(o){(0,a.n2)(o)||(0,a.dL)(o),this._currentRequest!==r&&this._currentRequest||this.clearRanges()}}))));return this._currentRequest=r,r}))}};R.ID="editor.contrib.linkedEditing",R.DECORATION=v.qx.register({description:"linked-editing",stickiness:0,className:T}),R=y([N(1,b.i6),N(2,S.p),N(3,_.c_),N(4,x.A)],R);class O extends h.R6{constructor(){super({id:"editor.action.linkedEditing",label:C.NC("linkedEditing.label","Start Linked Editing"),alias:"Start Linked Editing",precondition:b.Ao.and(f.u.writable,f.u.hasRenameProvider),kbOpts:{kbExpr:f.u.editorTextFocus,primary:3132,weight:100}})}runCommand(e,t){const n=e.get(g.$),[i,o]=Array.isArray(t)&&t||[void 0,void 0];return u.o.isUri(i)&&p.L.isIPosition(o)?n.openCodeEditor({resource:i},n.getActiveCodeEditor()).then((e=>{e&&(e.setPosition(o),e.invokeWithinContext((t=>(this.reportTelemetry(t,e),this.run(t,e)))))}),a.dL):super.runCommand(e,t)}run(e,t){const n=R.get(t);return n?Promise.resolve(n.updateRanges(!0)):Promise.resolve()}}const D=h._l.bindToContribution(R.get);function P(e,t,n,s){const r=e.ordered(t);return(0,o.Ps)(r.map((e=>()=>I(this,void 0,void 0,(function*(){try{return yield e.provideLinkedEditingRanges(t,n,s)}catch(i){return void(0,a.Cp)(i)}})))),(e=>!!e&&i.Of(null===e||void 0===e?void 0:e.ranges)))}(0,h.fK)(new D({id:"cancelLinkedEditingInput",precondition:M,handler:e=>e.clearRanges(),kbOpts:{kbExpr:f.u.editorTextFocus,weight:199,primary:9,secondary:[1033]}}));(0,w.P6G)("editor.linkedEditingBackground",{dark:r.Il.fromHex("#f00").transparent(.3),light:r.Il.fromHex("#f00").transparent(.3),hcDark:r.Il.fromHex("#f00").transparent(.3),hcLight:r.Il.white},C.NC("editorLinkedEditingBackground","Background color when the editor auto renames on type."));(0,h.sb)("_executeLinkedEditingProvider",((e,t,n)=>{const{linkedEditingRangeProvider:i}=e.get(S.p);return P(i,t,n,s.T.None)})),(0,h._K)(R.ID,R,1),(0,h.Qr)(O)},86898:(e,t,n)=>{var i=n(70959),o=n(48077);class s extends i.JT{constructor(e){super(),this._editor=e,this._register(this._editor.onMouseDown((e=>{const t=this._editor.getOption(115);t>=0&&6===e.target.type&&e.target.position.column>=t&&this._editor.updateOptions({stopRenderingLineAfter:-1})})))}}s.ID="editor.contrib.longLinesHelper",(0,o._K)(s.ID,s,2)},92767:(e,t,n)=>{n.d(t,{$:()=>f,N:()=>v});var i=n(8182),o=n(82168),s=n(98642),r=n(11271),a=n(70959),l=n(6155),d=n(61141),c=n(32484),u=n(50960),h=n(6544),g=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},p=function(e,t){return function(n,i){t(n,i,e)}},m=function(e,t,n,i){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function r(e){try{l(i.next(e))}catch(t){s(t)}}function a(e){try{l(i["throw"](e))}catch(t){s(t)}}function l(e){e.done?n(e.value):o(e.value).then(r,a)}l((i=i.apply(e,t||[])).next())}))};let f=class e{constructor(e,t,n){this._options=e,this._languageService=t,this._openerService=n,this._onDidRenderAsync=new r.Q5,this.onDidRenderAsync=this._onDidRenderAsync.event}dispose(){this._onDidRenderAsync.dispose()}render(e,t,n){if(!e){const e=document.createElement("span");return{element:e,dispose:()=>{}}}const o=new a.SL,s=o.add((0,i.ap)(e,Object.assign(Object.assign({},this._getRenderOptions(e,o)),t),n));return s.element.classList.add("rendered-markdown"),{element:s.element,dispose:()=>o.dispose()}}_getRenderOptions(t,n){return{codeBlockRenderer:(t,n)=>m(this,void 0,void 0,(function*(){var i,o,s;let r;t?r=this._languageService.getLanguageIdByLanguageName(t):this._options.editor&&(r=null===(i=this._options.editor.getModel())||void 0===i?void 0:i.getLanguageId()),r||(r=c.bd);const a=yield(0,u.C2)(this._languageService,n,r),d=document.createElement("span");if(d.innerHTML=null!==(s=null===(o=e._ttpTokenizer)||void 0===o?void 0:o.createHTML(a))&&void 0!==s?s:a,this._options.editor){const e=this._options.editor.getOption(49);(0,l.N)(d,e)}else this._options.codeBlockFontFamily&&(d.style.fontFamily=this._options.codeBlockFontFamily);return void 0!==this._options.codeBlockFontSize&&(d.style.fontSize=this._options.codeBlockFontSize),d})),asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:e=>v(this._openerService,e,t.isTrusted),disposables:n}}}};function v(e,t,n){return m(this,void 0,void 0,(function*(){try{return yield e.open(t,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:_(n)})}catch(i){return(0,s.dL)(i),!1}}))}function _(e){return!0===e||!(!e||!Array.isArray(e.enabledCommands))&&e.enabledCommands}f._ttpTokenizer=(0,o.Z)("tokenizeToString",{createHTML(e){return e}}),f=g([p(1,d.O),p(2,h.v4)],f)},11898:(e,t,n)=>{n.d(t,{O:()=>v});var i=n(8182),o=n(69332),s=n(11271),r=n(81478),a=n(70959),l=n(48077),d=n(33162),c=n(92767),u=n(25206),h=n(37174),g=n(6544),p=n(2548),m=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},f=function(e,t){return function(n,i){t(n,i,e)}};let v=class e{static get(t){return t.getContribution(e.ID)}constructor(t,n,i){this._openerService=i,this._messageWidget=new a.XK,this._messageListeners=new a.SL,this._mouseOverMessage=!1,this._editor=t,this._visible=e.MESSAGE_VISIBLE.bindTo(n)}dispose(){var e;null===(e=this._message)||void 0===e||e.dispose(),this._messageListeners.dispose(),this._messageWidget.dispose(),this._visible.reset()}showMessage(e,t){let n;(0,o.Z9)((0,r.Fr)(e)?e.value:e),this._visible.set(!0),this._messageWidget.clear(),this._messageListeners.clear(),this._message=(0,r.Fr)(e)?(0,i.ap)(e,{actionHandler:{callback:t=>(0,c.N)(this._openerService,t,(0,r.Fr)(e)?e.isTrusted:void 0),disposables:this._messageListeners}}):void 0,this._messageWidget.value=new C(this._editor,t,"string"===typeof e?e:this._message.element),this._messageListeners.add(s.ju.debounce(this._editor.onDidBlurEditorText,((e,t)=>t),0)((()=>{this._mouseOverMessage||this._messageWidget.value&&p.jg(document.activeElement,this._messageWidget.value.getDomNode())||this.closeMessage()}))),this._messageListeners.add(this._editor.onDidChangeCursorPosition((()=>this.closeMessage()))),this._messageListeners.add(this._editor.onDidDispose((()=>this.closeMessage()))),this._messageListeners.add(this._editor.onDidChangeModel((()=>this.closeMessage()))),this._messageListeners.add(p.nm(this._messageWidget.value.getDomNode(),p.tw.MOUSE_ENTER,(()=>this._mouseOverMessage=!0),!0)),this._messageListeners.add(p.nm(this._messageWidget.value.getDomNode(),p.tw.MOUSE_LEAVE,(()=>this._mouseOverMessage=!1),!0)),this._messageListeners.add(this._editor.onMouseMove((e=>{e.target.position&&(n?n.containsPosition(e.target.position)||this.closeMessage():n=new d.e(t.lineNumber-3,1,e.target.position.lineNumber+3,1))})))}closeMessage(){this._visible.reset(),this._messageListeners.clear(),this._messageWidget.value&&this._messageListeners.add(C.fadeOut(this._messageWidget.value))}};v.ID="editor.contrib.messageController",v.MESSAGE_VISIBLE=new h.uy("messageVisible",!1,u.NC("messageVisible","Whether the editor is currently showing an inline message")),v=m([f(1,h.i6),f(2,g.v4)],v);const _=l._l.bindToContribution(v.get);(0,l.fK)(new _({id:"leaveEditorMessage",precondition:v.MESSAGE_VISIBLE,handler:e=>e.closeMessage(),kbOpts:{weight:130,primary:9}}));class C{static fadeOut(e){const t=()=>{e.dispose(),clearTimeout(n),e.getDomNode().removeEventListener("animationend",t)},n=setTimeout(t,110);return e.getDomNode().addEventListener("animationend",t),e.getDomNode().classList.add("fadeOut"),{dispose:t}}constructor(e,{lineNumber:t,column:n},i){this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._editor=e,this._editor.revealLinesInCenterIfOutsideViewport(t,t,0),this._position={lineNumber:t,column:n},this._domNode=document.createElement("div"),this._domNode.classList.add("monaco-editor-overlaymessage"),this._domNode.style.marginLeft="-6px";const o=document.createElement("div");o.classList.add("anchor","top"),this._domNode.appendChild(o);const s=document.createElement("div");"string"===typeof i?(s.classList.add("message"),s.textContent=i):(i.classList.add("message"),s.appendChild(i)),this._domNode.appendChild(s);const r=document.createElement("div");r.classList.add("anchor","below"),this._domNode.appendChild(r),this._editor.addContentWidget(this),this._domNode.classList.add("fadeIn")}dispose(){this._editor.removeContentWidget(this)}getId(){return"messageoverlay"}getDomNode(){return this._domNode}getPosition(){return{position:this._position,preference:[1,2],positionAffinity:1}}afterRender(e){this._domNode.classList.toggle("below",2===e)}}(0,l._K)(v.ID,v,4)},52394:(e,t,n)=>{var i=n(69332),o=n(85398),s=n(56082),r=n(70959),a=n(48077),l=n(55880),d=n(33162),c=n(54644),u=n(44950),h=n(36691),g=n(25206),p=n(82693),m=n(37174),f=n(16458),v=n(79781),_=n(21881),C=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},b=function(e,t){return function(n,i){t(n,i,e)}};function S(e,t){const n=t.filter((t=>!e.find((e=>e.equals(t)))));if(n.length>=1){const e=n.map((e=>`line ${e.viewState.position.lineNumber} column ${e.viewState.position.column}`)).join(", "),t=1===n.length?g.NC("cursorAdded","Cursor added: {0}",e):g.NC("cursorsAdded","Cursors added: {0}",e);(0,i.i7)(t)}}class w extends a.R6{constructor(){super({id:"editor.action.insertCursorAbove",label:g.NC("mutlicursor.insertAbove","Add Cursor Above"),alias:"Add Cursor Above",precondition:void 0,kbOpts:{kbExpr:u.u.editorTextFocus,primary:2576,linux:{primary:1552,secondary:[3088]},weight:100},menuOpts:{menuId:p.eH.MenubarSelectionMenu,group:"3_multi",title:g.NC({key:"miInsertCursorAbove",comment:["&& denotes a mnemonic"]},"&&Add Cursor Above"),order:2}})}run(e,t,n){if(!t.hasModel())return;let i=!0;n&&!1===n.logicalLine&&(i=!1);const o=t._getViewModel();if(o.cursorConfig.readOnly)return;o.model.pushStackElement();const s=o.getCursorStates();o.setCursorStates(n.source,3,l.P.addCursorUp(o,s,i)),o.revealTopMostCursor(n.source),S(s,o.getCursorStates())}}class x extends a.R6{constructor(){super({id:"editor.action.insertCursorBelow",label:g.NC("mutlicursor.insertBelow","Add Cursor Below"),alias:"Add Cursor Below",precondition:void 0,kbOpts:{kbExpr:u.u.editorTextFocus,primary:2578,linux:{primary:1554,secondary:[3090]},weight:100},menuOpts:{menuId:p.eH.MenubarSelectionMenu,group:"3_multi",title:g.NC({key:"miInsertCursorBelow",comment:["&& denotes a mnemonic"]},"A&&dd Cursor Below"),order:3}})}run(e,t,n){if(!t.hasModel())return;let i=!0;n&&!1===n.logicalLine&&(i=!1);const o=t._getViewModel();if(o.cursorConfig.readOnly)return;o.model.pushStackElement();const s=o.getCursorStates();o.setCursorStates(n.source,3,l.P.addCursorDown(o,s,i)),o.revealBottomMostCursor(n.source),S(s,o.getCursorStates())}}class L extends a.R6{constructor(){super({id:"editor.action.insertCursorAtEndOfEachLineSelected",label:g.NC("mutlicursor.insertAtEndOfEachLineSelected","Add Cursors to Line Ends"),alias:"Add Cursors to Line Ends",precondition:void 0,kbOpts:{kbExpr:u.u.editorTextFocus,primary:1575,weight:100},menuOpts:{menuId:p.eH.MenubarSelectionMenu,group:"3_multi",title:g.NC({key:"miInsertCursorAtEndOfEachLineSelected",comment:["&& denotes a mnemonic"]},"Add C&&ursors to Line Ends"),order:4}})}getCursorsForSelection(e,t,n){if(!e.isEmpty()){for(let i=e.startLineNumber;i<e.endLineNumber;i++){const e=t.getLineMaxColumn(i);n.push(new c.Y(i,e,i,e))}e.endColumn>1&&n.push(new c.Y(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn))}}run(e,t){if(!t.hasModel())return;const n=t.getModel(),i=t.getSelections(),o=t._getViewModel(),s=o.getCursorStates(),r=[];i.forEach((e=>this.getCursorsForSelection(e,n,r))),r.length>0&&t.setSelections(r),S(s,o.getCursorStates())}}class y extends a.R6{constructor(){super({id:"editor.action.addCursorsToBottom",label:g.NC("mutlicursor.addCursorsToBottom","Add Cursors To Bottom"),alias:"Add Cursors To Bottom",precondition:void 0})}run(e,t){if(!t.hasModel())return;const n=t.getSelections(),i=t.getModel().getLineCount(),o=[];for(let a=n[0].startLineNumber;a<=i;a++)o.push(new c.Y(a,n[0].startColumn,a,n[0].endColumn));const s=t._getViewModel(),r=s.getCursorStates();o.length>0&&t.setSelections(o),S(r,s.getCursorStates())}}class N extends a.R6{constructor(){super({id:"editor.action.addCursorsToTop",label:g.NC("mutlicursor.addCursorsToTop","Add Cursors To Top"),alias:"Add Cursors To Top",precondition:void 0})}run(e,t){if(!t.hasModel())return;const n=t.getSelections(),i=[];for(let r=n[0].startLineNumber;r>=1;r--)i.push(new c.Y(r,n[0].startColumn,r,n[0].endColumn));const o=t._getViewModel(),s=o.getCursorStates();i.length>0&&t.setSelections(i),S(s,o.getCursorStates())}}class I{constructor(e,t,n){this.selections=e,this.revealRange=t,this.revealScrollType=n}}class M{static create(e,t){if(!e.hasModel())return null;const n=t.getState();if(!e.hasTextFocus()&&n.isRevealed&&n.searchString.length>0)return new M(e,t,!1,n.searchString,n.wholeWord,n.matchCase,null);let i,o,s=!1;const r=e.getSelections();1===r.length&&r[0].isEmpty()?(s=!0,i=!0,o=!0):(i=n.wholeWord,o=n.matchCase);const a=e.getSelection();let l,d=null;if(a.isEmpty()){const t=e.getConfiguredWordAtPosition(a.getStartPosition());if(!t)return null;l=t.word,d=new c.Y(a.startLineNumber,t.startColumn,a.startLineNumber,t.endColumn)}else l=e.getModel().getValueInRange(a).replace(/\r\n/g,"\n");return new M(e,t,s,l,i,o,d)}constructor(e,t,n,i,o,s,r){this._editor=e,this.findController=t,this.isDisconnectedFromFindController=n,this.searchText=i,this.wholeWord=o,this.matchCase=s,this.currentMatch=r}addSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new I(t.concat(e),e,0)}moveSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new I(t.slice(0,t.length-1).concat(e),e,0)}_getNextMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const e=this.currentMatch;return this.currentMatch=null,e}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],n=this._editor.getModel().findNextMatch(this.searchText,t.getEndPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(128):null,!1);return n?new c.Y(n.range.startLineNumber,n.range.startColumn,n.range.endLineNumber,n.range.endColumn):null}addSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new I(t.concat(e),e,0)}moveSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new I(t.slice(0,t.length-1).concat(e),e,0)}_getPreviousMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const e=this.currentMatch;return this.currentMatch=null,e}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],n=this._editor.getModel().findPreviousMatch(this.searchText,t.getStartPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(128):null,!1);return n?new c.Y(n.range.startLineNumber,n.range.startColumn,n.range.endLineNumber,n.range.endColumn):null}selectAll(e){if(!this._editor.hasModel())return[];this.findController.highlightFindOptions();const t=this._editor.getModel();return e?t.findMatches(this.searchText,e,!1,this.matchCase,this.wholeWord?this._editor.getOption(128):null,!1,1073741824):t.findMatches(this.searchText,!0,!1,this.matchCase,this.wholeWord?this._editor.getOption(128):null,!1,1073741824)}}class T extends r.JT{static get(e){return e.getContribution(T.ID)}constructor(e){super(),this._sessionDispose=this._register(new r.SL),this._editor=e,this._ignoreSelectionChange=!1,this._session=null}dispose(){this._endSession(),super.dispose()}_beginSessionIfNeeded(e){if(!this._session){const t=M.create(this._editor,e);if(!t)return;this._session=t;const n={searchString:this._session.searchText};this._session.isDisconnectedFromFindController&&(n.wholeWordOverride=1,n.matchCaseOverride=1,n.isRegexOverride=2),e.getState().change(n,!1),this._sessionDispose.add(this._editor.onDidChangeCursorSelection((e=>{this._ignoreSelectionChange||this._endSession()}))),this._sessionDispose.add(this._editor.onDidBlurEditorText((()=>{this._endSession()}))),this._sessionDispose.add(e.getState().onFindReplaceStateChange((e=>{(e.matchCase||e.wholeWord)&&this._endSession()})))}}_endSession(){if(this._sessionDispose.clear(),this._session&&this._session.isDisconnectedFromFindController){const e={wholeWordOverride:0,matchCaseOverride:0,isRegexOverride:0};this._session.findController.getState().change(e,!1)}this._session=null}_setSelections(e){this._ignoreSelectionChange=!0,this._editor.setSelections(e),this._ignoreSelectionChange=!1}_expandEmptyToWord(e,t){if(!t.isEmpty())return t;const n=this._editor.getConfiguredWordAtPosition(t.getStartPosition());return n?new c.Y(t.startLineNumber,n.startColumn,t.startLineNumber,n.endColumn):t}_applySessionResult(e){e&&(this._setSelections(e.selections),e.revealRange&&this._editor.revealRangeInCenterIfOutsideViewport(e.revealRange,e.revealScrollType))}getSession(e){return this._session}addSelectionToNextFindMatch(e){if(this._editor.hasModel()){if(!this._session){const t=this._editor.getSelections();if(t.length>1){const n=e.getState(),i=n.matchCase,o=H(this._editor.getModel(),t,i);if(!o){const e=this._editor.getModel(),n=[];for(let i=0,o=t.length;i<o;i++)n[i]=this._expandEmptyToWord(e,t[i]);return void this._editor.setSelections(n)}}}this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToNextFindMatch())}}addSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToPreviousFindMatch())}moveSelectionToNextFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToNextFindMatch())}moveSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToPreviousFindMatch())}selectAll(e){if(!this._editor.hasModel())return;let t=null;const n=e.getState();if(n.isRevealed&&n.searchString.length>0&&n.isRegex){const e=this._editor.getModel();t=n.searchScope?e.findMatches(n.searchString,n.searchScope,n.isRegex,n.matchCase,n.wholeWord?this._editor.getOption(128):null,!1,1073741824):e.findMatches(n.searchString,!0,n.isRegex,n.matchCase,n.wholeWord?this._editor.getOption(128):null,!1,1073741824)}else{if(this._beginSessionIfNeeded(e),!this._session)return;t=this._session.selectAll(n.searchScope)}if(t.length>0){const e=this._editor.getSelection();for(let n=0,i=t.length;n<i;n++){const i=t[n],o=i.range.intersectRanges(e);if(o){t[n]=t[0],t[0]=i;break}}this._setSelections(t.map((e=>new c.Y(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn))))}}}T.ID="editor.contrib.multiCursorController";class R extends a.R6{run(e,t){const n=T.get(t);if(!n)return;const i=t._getViewModel();if(i){const o=i.getCursorStates(),s=h.pR.get(t);if(s)this._run(n,s);else{const i=e.get(_.TG).createInstance(h.pR,t);this._run(n,i),i.dispose()}S(o,i.getCursorStates())}}}class O extends R{constructor(){super({id:"editor.action.addSelectionToNextFindMatch",label:g.NC("addSelectionToNextFindMatch","Add Selection To Next Find Match"),alias:"Add Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:u.u.focus,primary:2082,weight:100},menuOpts:{menuId:p.eH.MenubarSelectionMenu,group:"3_multi",title:g.NC({key:"miAddSelectionToNextFindMatch",comment:["&& denotes a mnemonic"]},"Add &&Next Occurrence"),order:5}})}_run(e,t){e.addSelectionToNextFindMatch(t)}}class D extends R{constructor(){super({id:"editor.action.addSelectionToPreviousFindMatch",label:g.NC("addSelectionToPreviousFindMatch","Add Selection To Previous Find Match"),alias:"Add Selection To Previous Find Match",precondition:void 0,menuOpts:{menuId:p.eH.MenubarSelectionMenu,group:"3_multi",title:g.NC({key:"miAddSelectionToPreviousFindMatch",comment:["&& denotes a mnemonic"]},"Add P&&revious Occurrence"),order:6}})}_run(e,t){e.addSelectionToPreviousFindMatch(t)}}class P extends R{constructor(){super({id:"editor.action.moveSelectionToNextFindMatch",label:g.NC("moveSelectionToNextFindMatch","Move Last Selection To Next Find Match"),alias:"Move Last Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:u.u.focus,primary:(0,s.gx)(2089,2082),weight:100}})}_run(e,t){e.moveSelectionToNextFindMatch(t)}}class E extends R{constructor(){super({id:"editor.action.moveSelectionToPreviousFindMatch",label:g.NC("moveSelectionToPreviousFindMatch","Move Last Selection To Previous Find Match"),alias:"Move Last Selection To Previous Find Match",precondition:void 0})}_run(e,t){e.moveSelectionToPreviousFindMatch(t)}}class A extends R{constructor(){super({id:"editor.action.selectHighlights",label:g.NC("selectAllOccurrencesOfFindMatch","Select All Occurrences of Find Match"),alias:"Select All Occurrences of Find Match",precondition:void 0,kbOpts:{kbExpr:u.u.focus,primary:3114,weight:100},menuOpts:{menuId:p.eH.MenubarSelectionMenu,group:"3_multi",title:g.NC({key:"miSelectHighlights",comment:["&& denotes a mnemonic"]},"Select All &&Occurrences"),order:7}})}_run(e,t){e.selectAll(t)}}class k extends R{constructor(){super({id:"editor.action.changeAll",label:g.NC("changeAll.label","Change All Occurrences"),alias:"Change All Occurrences",precondition:m.Ao.and(u.u.writable,u.u.editorTextFocus),kbOpts:{kbExpr:u.u.editorTextFocus,primary:2108,weight:100},contextMenuOpts:{group:"1_modification",order:1.2}})}_run(e,t){e.selectAll(t)}}class F{constructor(e,t,n,i,o){this._model=e,this._searchText=t,this._matchCase=n,this._wordSeparators=i,this._modelVersionId=this._model.getVersionId(),this._cachedFindMatches=null,o&&this._model===o._model&&this._searchText===o._searchText&&this._matchCase===o._matchCase&&this._wordSeparators===o._wordSeparators&&this._modelVersionId===o._modelVersionId&&(this._cachedFindMatches=o._cachedFindMatches)}findMatches(){return null===this._cachedFindMatches&&(this._cachedFindMatches=this._model.findMatches(this._searchText,!0,!1,this._matchCase,this._wordSeparators,!1).map((e=>e.range)),this._cachedFindMatches.sort(d.e.compareRangesUsingStarts)),this._cachedFindMatches}}let V=class e extends r.JT{constructor(e,t){super(),this._languageFeaturesService=t,this.editor=e,this._isEnabled=e.getOption(106),this._decorations=e.createDecorationsCollection(),this.updateSoon=this._register(new o.pY((()=>this._update()),300)),this.state=null,this._register(e.onDidChangeConfiguration((t=>{this._isEnabled=e.getOption(106)}))),this._register(e.onDidChangeCursorSelection((e=>{this._isEnabled&&(e.selection.isEmpty()?3===e.reason?(this.state&&this._setState(null),this.updateSoon.schedule()):this._setState(null):this._update())}))),this._register(e.onDidChangeModel((e=>{this._setState(null)}))),this._register(e.onDidChangeModelContent((e=>{this._isEnabled&&this.updateSoon.schedule()})));const n=h.pR.get(e);n&&this._register(n.getState().onFindReplaceStateChange((e=>{this._update()}))),this.updateSoon.schedule()}_update(){this._setState(e._createState(this.state,this._isEnabled,this.editor))}static _createState(e,t,n){if(!t)return null;if(!n.hasModel())return null;const i=n.getSelection();if(i.startLineNumber!==i.endLineNumber)return null;const o=T.get(n);if(!o)return null;const s=h.pR.get(n);if(!s)return null;let r=o.getSession(s);if(!r){const e=n.getSelections();if(e.length>1){const t=s.getState(),i=t.matchCase,o=H(n.getModel(),e,i);if(!o)return null}r=M.create(n,s)}if(!r)return null;if(r.currentMatch)return null;if(/^[ \t]+$/.test(r.searchText))return null;if(r.searchText.length>200)return null;const a=s.getState(),l=a.matchCase;if(a.isRevealed){let e=a.searchString;l||(e=e.toLowerCase());let t=r.searchText;if(l||(t=t.toLowerCase()),e===t&&r.matchCase===a.matchCase&&r.wholeWord===a.wholeWord&&!a.isRegex)return null}return new F(n.getModel(),r.searchText,r.matchCase,r.wholeWord?n.getOption(128):null,e)}_setState(e){if(this.state=e,!this.state)return void this._decorations.clear();if(!this.editor.hasModel())return;const t=this.editor.getModel();if(t.isTooLargeForTokenization())return;const n=this.state.findMatches(),i=this.editor.getSelections();i.sort(d.e.compareRangesUsingStarts);const o=[];for(let a=0,l=0,c=n.length,u=i.length;a<c;){const e=n[a];if(l>=u)o.push(e),a++;else{const t=d.e.compareRangesUsingStarts(e,i[l]);t<0?(!i[l].isEmpty()&&d.e.areIntersecting(e,i[l])||o.push(e),a++):(t>0||a++,l++)}}const s=this._languageFeaturesService.documentHighlightProvider.has(t)&&this.editor.getOption(79),r=o.map((e=>({range:e,options:(0,v.w)(s)})));this._decorations.set(r)}dispose(){this._setState(null),super.dispose()}};function H(e,t,n){const i=W(e,t[0],!n);for(let o=1,s=t.length;o<s;o++){const s=t[o];if(s.isEmpty())return!1;const r=W(e,s,!n);if(i!==r)return!1}return!0}function W(e,t,n){const i=e.getValueInRange(t);return n?i.toLowerCase():i}V.ID="editor.contrib.selectionHighlighter",V=C([b(1,f.p)],V);class U extends a.R6{constructor(){super({id:"editor.action.focusNextCursor",label:g.NC("mutlicursor.focusNextCursor","Focus Next Cursor"),description:{description:g.NC("mutlicursor.focusNextCursor.description","Focuses the next cursor"),args:[]},alias:"Focus Next Cursor",precondition:void 0})}run(e,t,n){if(!t.hasModel())return;const i=t._getViewModel();if(i.cursorConfig.readOnly)return;i.model.pushStackElement();const o=Array.from(i.getCursorStates()),s=o.shift();s&&(o.push(s),i.setCursorStates(n.source,3,o),i.revealPrimaryCursor(n.source,!0),S(o,i.getCursorStates()))}}class B extends a.R6{constructor(){super({id:"editor.action.focusPreviousCursor",label:g.NC("mutlicursor.focusPreviousCursor","Focus Previous Cursor"),description:{description:g.NC("mutlicursor.focusPreviousCursor.description","Focuses the previous cursor"),args:[]},alias:"Focus Previous Cursor",precondition:void 0})}run(e,t,n){if(!t.hasModel())return;const i=t._getViewModel();if(i.cursorConfig.readOnly)return;i.model.pushStackElement();const o=Array.from(i.getCursorStates()),s=o.pop();s&&(o.unshift(s),i.setCursorStates(n.source,3,o),i.revealPrimaryCursor(n.source,!0),S(o,i.getCursorStates()))}}(0,a._K)(T.ID,T,4),(0,a._K)(V.ID,V,1),(0,a.Qr)(w),(0,a.Qr)(x),(0,a.Qr)(L),(0,a.Qr)(O),(0,a.Qr)(D),(0,a.Qr)(P),(0,a.Qr)(E),(0,a.Qr)(A),(0,a.Qr)(k),(0,a.Qr)(y),(0,a.Qr)(N),(0,a.Qr)(U),(0,a.Qr)(B)}}]);