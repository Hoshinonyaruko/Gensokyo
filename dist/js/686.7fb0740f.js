"use strict";(globalThis["webpackChunkfrontend"]=globalThis["webpackChunkfrontend"]||[]).push([[686],{20005:(e,i,t)=>{var n=t(35195),o=t(44950),r=t(25206),s=t(82693),d=t(46871),a=t(37174);const l={value:(0,r.NC)("accessibleDiffViewer","Accessible Diff Viewer"),original:"Accessible Diff Viewer"};class h extends s.Ke{constructor(){super({id:h.id,title:{value:(0,r.NC)("editor.action.accessibleDiffViewer.next","Go to Next Difference"),original:"Go to Next Difference"},category:l,precondition:a.Ao.has("isInDiffEditor"),keybinding:{primary:65,weight:100},f1:!0})}run(e){const i=c(e);null===i||void 0===i||i.accessibleDiffViewerNext()}}h.id="editor.action.accessibleDiffViewer.next",s.BH.appendMenuItem(s.eH.EditorTitle,{command:{id:h.id,title:(0,r.NC)("Open Accessible Diff Viewer","Open Accessible Diff Viewer")},order:10,group:"2_diff",when:a.Ao.and(o.u.accessibleDiffViewerVisible.negate(),a.Ao.has("isInDiffEditor"))});class g extends s.Ke{constructor(){super({id:g.id,title:{value:(0,r.NC)("editor.action.accessibleDiffViewer.prev","Go to Previous Difference"),original:"Go to Previous Difference"},category:l,precondition:a.Ao.has("isInDiffEditor"),keybinding:{primary:1089,weight:100},f1:!0})}run(e){const i=c(e);null===i||void 0===i||i.accessibleDiffViewerPrev()}}function c(e){var i;const t=e.get(n.$),o=t.listDiffEditors(),r=null!==(i=t.getFocusedCodeEditor())&&void 0!==i?i:t.getActiveCodeEditor();if(!r)return null;for(let n=0,s=o.length;n<s;n++){const e=o[n];if(e.getModifiedEditor().getId()===r.getId()||e.getOriginalEditor().getId()===r.getId())return e}if(document.activeElement)for(const n of o){const e=n.getContainerDomNode();if(f(e,document.activeElement))return n}return null}function f(e,i){let t=i;while(t){if(t===e)return!0;t=t.parentElement}return!1}g.id="editor.action.accessibleDiffViewer.prev",d.P.registerCommandAlias("editor.action.diffReview.next",h.id),(0,s.r1)(h),d.P.registerCommandAlias("editor.action.diffReview.prev",g.id),(0,s.r1)(g)},81806:(e,i,t)=>{t.d(i,{p:()=>se,N:()=>oe});var n=t(2548),o=t(26090),r=t(82168),s=t(71162),d=t(18612),a=t(65662),l=t(85398),h=t(8419),g=t(98642),c=t(11271),f=t(81478),u=t(70959),m=t(99588),_=t(6155),p=t(41971),v=t(48077),b=t(35195),E=t(95402),w=t(97469),N=t(24746),L=t(15203),C=t(25206),S=t(10205),D=t(33162),R=t(47606),y=function(e,i,t,n){function o(e){return e instanceof t?e:new t((function(i){i(e)}))}return new(t||(t=Promise))((function(t,r){function s(e){try{a(n.next(e))}catch(i){r(i)}}function d(e){try{a(n["throw"](e))}catch(i){r(i)}}function a(e){e.done?t(e.value):o(e.value).then(s,d)}a((n=n.apply(e,i||[])).next())}))};class I extends u.JT{get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}constructor(e,i,t,o,r,s){super(),this._viewZoneId=e,this._marginDomNode=i,this.editor=t,this.diff=o,this._contextMenuService=r,this._clipboardService=s,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=m.k.asClassName(h.l.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const d=t.getOption(65),a=t.getModel().getEOL();this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${d}px`,this._diffActions.style.lineHeight=`${d}px`,this._marginDomNode.appendChild(this._diffActions);const l=[],g=0===o.modifiedEndLineNumber;l.push(new S.aU("diff.clipboard.copyDeletedContent",g?o.originalEndLineNumber>o.modifiedStartLineNumber?C.NC("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):C.NC("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):o.originalEndLineNumber>o.modifiedStartLineNumber?C.NC("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):C.NC("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,(()=>y(this,void 0,void 0,(function*(){const e=new D.e(o.originalStartLineNumber,1,o.originalEndLineNumber+1,1),i=o.originalModel.getValueInRange(e);yield this._clipboardService.writeText(i)})))));let c,f=0;o.originalEndLineNumber>o.modifiedStartLineNumber&&(c=new S.aU("diff.clipboard.copyDeletedLineContent",g?C.NC("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",o.originalStartLineNumber):C.NC("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",o.originalStartLineNumber),void 0,!0,(()=>y(this,void 0,void 0,(function*(){const e=o.originalModel.getLineContent(o.originalStartLineNumber+f);if(""===e){const e=o.originalModel.getEndOfLineSequence();yield this._clipboardService.writeText(0===e?"\n":"\r\n")}else yield this._clipboardService.writeText(e)})))),l.push(c));const u=t.getOption(89);u||l.push(new S.aU("diff.inline.revertChange",C.NC("diff.inline.revertChange.label","Revert this change"),void 0,!0,(()=>y(this,void 0,void 0,(function*(){const e=new D.e(o.originalStartLineNumber,1,o.originalEndLineNumber,o.originalModel.getLineMaxColumn(o.originalEndLineNumber)),i=o.originalModel.getValueInRange(e);if(0===o.modifiedEndLineNumber){const e=t.getModel().getLineMaxColumn(o.modifiedStartLineNumber);t.executeEdits("diffEditor",[{range:new D.e(o.modifiedStartLineNumber,e,o.modifiedStartLineNumber,e),text:a+i}])}else{const e=t.getModel().getLineMaxColumn(o.modifiedEndLineNumber);t.executeEdits("diffEditor",[{range:new D.e(o.modifiedStartLineNumber,1,o.modifiedEndLineNumber,e),text:i}])}})))));const _=t.getOption(125)&&!R.gn,p=(e,i)=>{var n;this._contextMenuService.showContextMenu({domForShadowRoot:_&&null!==(n=t.getDomNode())&&void 0!==n?n:void 0,getAnchor:()=>({x:e,y:i}),getActions:()=>(c&&(c.label=g?C.NC("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",o.originalStartLineNumber+f):C.NC("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",o.originalStartLineNumber+f)),l),autoSelectFirstItem:!0})};this._register(n.mu(this._diffActions,"mousedown",(e=>{const{top:i,height:t}=n.i(this._diffActions),o=Math.floor(d/3);e.preventDefault(),p(e.posx,i+t+o)}))),this._register(t.onMouseMove((e=>{if(8===e.target.type||5===e.target.type){const i=e.target.detail.viewZoneId;i===this._viewZoneId?(this.visibility=!0,f=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,d)):this.visibility=!1}else this.visibility=!1}))),this._register(t.onMouseDown((e=>{if(e.event.rightButton&&(8===e.target.type||5===e.target.type)){const i=e.target.detail.viewZoneId;i===this._viewZoneId&&(e.event.preventDefault(),f=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,d),p(e.event.posx,e.event.posy+d))}})))}_updateLightBulbPosition(e,i,t){const{top:o}=n.i(e),r=i-o,s=Math.floor(r/t),d=s*t;if(this._diffActions.style.top=`${d}px`,this.diff.viewLineCounts){let e=0;for(let i=0;i<this.diff.viewLineCounts.length;i++)if(e+=this.diff.viewLineCounts[i],s<e)return i}return s}}var O=t(3685),x=t(93215),M=t(89999),T=t(69427),V=t(22668),W=t(44950),P=t(16375),A=t(56998),H=t(93489),F=t(70748),z=t(69479),Z=t(2827),k=t(37174),B=t(93753),U=t(21881),q=t(39159),$=t(18736),j=t(34679),K=t(47277),J=t(98158),X=t(32656),Y=function(e,i,t,n){var o,r=arguments.length,s=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(s=(r<3?o(s):r>3?o(i,t,s):o(i,t))||s);return r>3&&s&&Object.defineProperty(i,t,s),s},G=function(e,i){return function(t,n){i(t,n,e)}},Q=function(e,i,t,n){function o(e){return e instanceof t?e:new t((function(i){i(e)}))}return new(t||(t=Promise))((function(t,r){function s(e){try{a(n.next(e))}catch(i){r(i)}}function d(e){try{a(n["throw"](e))}catch(i){r(i)}}function a(e){e.done?t(e.value):o(e.value).then(s,d)}a((n=n.apply(e,i||[])).next())}))};class ee{constructor(e,i){this._contextMenuService=e,this._clipboardService=i,this._zones=[],this._inlineDiffMargins=[],this._zonesMap={},this._decorations=[]}getForeignViewZones(e){return e.filter((e=>!this._zonesMap[String(e.id)]))}clean(e){this._zones.length>0&&e.changeViewZones((e=>{for(const i of this._zones)e.removeZone(i)})),this._zones=[],this._zonesMap={},e.changeDecorations((e=>{this._decorations=e.deltaDecorations(this._decorations,[])}))}apply(e,i,t,n){const o=n?E.Z.capture(e):null;e.changeViewZones((i=>{var n;for(const e of this._zones)i.removeZone(e);for(const e of this._inlineDiffMargins)e.dispose();this._zones=[],this._zonesMap={},this._inlineDiffMargins=[];for(let o=0,r=t.zones.length;o<r;o++){const r=t.zones[o];r.suppressMouseDown=!0,r.showInHiddenAreas=!0;const s=i.addZone(r);this._zones.push(s),this._zonesMap[String(s)]=!0,t.zones[o].diff&&r.marginDomNode&&(r.suppressMouseDown=!1,0!==(null===(n=t.zones[o].diff)||void 0===n?void 0:n.originalModel.getValueLength())&&this._inlineDiffMargins.push(new I(s,r.marginDomNode,e,t.zones[o].diff,this._contextMenuService,this._clipboardService)))}})),null===o||void 0===o||o.restore(e),e.changeDecorations((e=>{this._decorations=e.deltaDecorations(this._decorations,t.decorations)})),null===i||void 0===i||i.setZones(t.overviewZones)}}let ie=0;const te=(0,J.q5)("diff-insert",h.l.add,C.NC("diffInsertIcon","Line decoration for inserts in the diff editor.")),ne=(0,J.q5)("diff-remove",h.l.remove,C.NC("diffRemoveIcon","Line decoration for removals in the diff editor.")),oe=(0,r.Z)("diffEditorWidget",{createHTML:e=>e}),re=C.NC("diff-aria-navigation-tip"," use Shift + F7 to navigate changes");let se=class e extends u.JT{constructor(i,t,r,s,d,a,h,f,u,m,_){super(),this._editorProgressService=_,this._onDidDispose=this._register(new c.Q5),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModel=this._register(new c.Q5),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidUpdateDiff=this._register(new c.Q5),this.onDidUpdateDiff=this._onDidUpdateDiff.event,this._onDidContentSizeChange=this._register(new c.Q5),this._lastOriginalWarning=null,this._lastModifiedWarning=null,h.willCreateDiffEditor(),this._documentDiffProvider=this._register(a.createInstance(O.Q,t)),this._register(this._documentDiffProvider.onDidChange((e=>this._beginUpdateDecorationsSoon()))),this._codeEditorService=h,this._contextKeyService=this._register(d.createScoped(i)),this._instantiationService=a.createChild(new q.y([k.i6,this._contextKeyService])),this._contextKeyService.createKey("isInDiffEditor",!0),this._themeService=f,this._notificationService=u,this._id=++ie,this._state=0,this._updatingDiffProgress=null,this._domElement=i,t=t||{},this._options=Ce(t,{enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{collapseUnchangedRegions:!1},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1}),this.isEmbeddedDiffEditorKey=W.u.isEmbeddedDiffEditor.bindTo(this._contextKeyService),this.isEmbeddedDiffEditorKey.set("undefined"!==typeof t.isInEmbeddedEditor&&t.isInEmbeddedEditor),this._updateDecorationsRunner=this._register(new l.pY((()=>this._updateDecorations()),0)),this._containerDomElement=document.createElement("div"),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide),this._containerDomElement.style.position="relative",this._containerDomElement.style.height="100%",this._domElement.appendChild(this._containerDomElement),this._overviewViewportDomElement=(0,o.X)(document.createElement("div")),this._overviewViewportDomElement.setClassName("diffViewport"),this._overviewViewportDomElement.setPosition("absolute"),this._overviewDomElement=document.createElement("div"),this._overviewDomElement.className="diffOverview",this._overviewDomElement.style.position="absolute",this._overviewDomElement.appendChild(this._overviewViewportDomElement.domNode),this._register(n.mu(this._overviewDomElement,n.tw.POINTER_DOWN,(e=>{this._modifiedEditor.delegateVerticalScrollbarPointerDown(e)}))),this._register(n.nm(this._overviewDomElement,n.tw.MOUSE_WHEEL,(e=>{this._modifiedEditor.delegateScrollFromMouseWheelEvent(e)}),{passive:!1})),this._options.renderOverviewRuler&&this._containerDomElement.appendChild(this._overviewDomElement),this._originalDomNode=document.createElement("div"),this._originalDomNode.className="editor original",this._originalDomNode.style.position="absolute",this._originalDomNode.style.height="100%",this._containerDomElement.appendChild(this._originalDomNode),this._modifiedDomNode=document.createElement("div"),this._modifiedDomNode.className="editor modified",this._modifiedDomNode.style.position="absolute",this._modifiedDomNode.style.height="100%",this._containerDomElement.appendChild(this._modifiedDomNode),this._beginUpdateDecorationsTimeout=-1,this._currentlyChangingViewZones=!1,this._diffComputationToken=0,this._originalEditorState=new ee(m,s),this._modifiedEditorState=new ee(m,s),this._isVisible=!0,this._isHandlingScrollEvent=!1,this._elementSizeObserver=this._register(new p.I(this._containerDomElement,t.dimension)),this._register(this._elementSizeObserver.onDidChange((()=>this._onDidContainerSizeChanged()))),t.automaticLayout&&this._elementSizeObserver.startObserving(),this._diffComputationResult=null,this._originalEditor=this._createLeftHandSideEditor(t,r.originalEditor||{}),this._modifiedEditor=this._createRightHandSideEditor(t,r.modifiedEditor||{}),this._originalOverviewRuler=null,this._modifiedOverviewRuler=null,this._reviewPane=a.createInstance(L.j,this),this._containerDomElement.appendChild(this._reviewPane.domNode.domNode),this._containerDomElement.appendChild(this._reviewPane.shadow.domNode),this._containerDomElement.appendChild(this._reviewPane.actionBarContainer.domNode),this._options.renderSideBySide?this._setStrategy(new ce(this._createDataSource(),this._options.enableSplitViewResizing,this._options.splitViewDefaultRatio)):this._setStrategy(new ue(this._createDataSource(),this._options.enableSplitViewResizing)),this._register(f.onDidColorThemeChange((i=>{this._strategy&&this._strategy.applyColors(i)&&this._updateDecorationsRunner.schedule(),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide)})));const b=v.Uc.getDiffEditorContributions();for(const e of b)try{this._register(a.createInstance(e.ctor,this))}catch(E){(0,g.dL)(E)}this._codeEditorService.addDiffEditor(this)}_setState(e){this._state!==e&&(this._state=e,this._updatingDiffProgress&&(this._updatingDiffProgress.done(),this._updatingDiffProgress=null),1===this._state&&(this._updatingDiffProgress=this._editorProgressService.show(!0,1e3)))}accessibleDiffViewerNext(){this._reviewPane.next()}accessibleDiffViewerPrev(){this._reviewPane.prev()}static _getClassName(e,i){let t="monaco-diff-editor monaco-editor-background ";return i&&(t+="side-by-side "),t+=(0,X.m6)(e.type),t}_disposeOverviewRulers(){this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose(),this._originalOverviewRuler=null),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose(),this._modifiedOverviewRuler=null)}_createOverviewRulers(){this._options.renderOverviewRuler&&(a.ok(!this._originalOverviewRuler&&!this._modifiedOverviewRuler),this._originalEditor.hasModel()&&(this._originalOverviewRuler=this._originalEditor.createOverviewRuler("original diffOverviewRuler"),this._overviewDomElement.appendChild(this._originalOverviewRuler.getDomNode())),this._modifiedEditor.hasModel()&&(this._modifiedOverviewRuler=this._modifiedEditor.createOverviewRuler("modified diffOverviewRuler"),this._overviewDomElement.appendChild(this._modifiedOverviewRuler.getDomNode())),this._layoutOverviewRulers())}_createLeftHandSideEditor(i,t){const n=this._createInnerEditor(this._instantiationService,this._originalDomNode,this._adjustOptionsForLeftHandSide(i),t);this._register(n.onDidScrollChange((e=>{this._isHandlingScrollEvent||(e.scrollTopChanged||e.scrollLeftChanged||e.scrollHeightChanged)&&(this._isHandlingScrollEvent=!0,this._modifiedEditor.setScrollPosition({scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())}))),this._register(n.onDidChangeViewZones((()=>{this._onViewZonesChanged()}))),this._register(n.onDidChangeConfiguration((e=>{n.getModel()&&(e.hasChanged(49)&&this._updateDecorationsRunner.schedule(),e.hasChanged(143)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))}))),this._register(n.onDidChangeHiddenAreas((()=>{this._updateDecorationsRunner.cancel(),this._updateDecorations()}))),this._register(n.onDidChangeModelContent((()=>{this._isVisible&&this._beginUpdateDecorationsSoon()})));const o=this._contextKeyService.createKey("isInDiffLeftEditor",n.hasWidgetFocus());return this._register(n.onDidFocusEditorWidget((()=>o.set(!0)))),this._register(n.onDidBlurEditorWidget((()=>o.set(!1)))),this._register(n.onDidContentSizeChange((i=>{const t=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+e.ONE_OVERVIEW_WIDTH,n=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:n,contentWidth:t,contentHeightChanged:i.contentHeightChanged,contentWidthChanged:i.contentWidthChanged})}))),n}_createRightHandSideEditor(i,t){const n=this._createInnerEditor(this._instantiationService,this._modifiedDomNode,this._adjustOptionsForRightHandSide(i),t);this._register(n.onDidScrollChange((e=>{this._isHandlingScrollEvent||(e.scrollTopChanged||e.scrollLeftChanged||e.scrollHeightChanged)&&(this._isHandlingScrollEvent=!0,this._originalEditor.setScrollPosition({scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())}))),this._register(n.onDidChangeViewZones((()=>{this._onViewZonesChanged()}))),this._register(n.onDidChangeConfiguration((e=>{n.getModel()&&(e.hasChanged(49)&&this._updateDecorationsRunner.schedule(),e.hasChanged(143)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))}))),this._register(n.onDidChangeHiddenAreas((()=>{this._updateDecorationsRunner.cancel(),this._updateDecorations()}))),this._register(n.onDidChangeModelContent((()=>{this._isVisible&&this._beginUpdateDecorationsSoon()}))),this._register(n.onDidChangeModelOptions((e=>{e.tabSize&&this._updateDecorationsRunner.schedule()})));const o=this._contextKeyService.createKey("isInDiffRightEditor",n.hasWidgetFocus());return this._register(n.onDidFocusEditorWidget((()=>o.set(!0)))),this._register(n.onDidBlurEditorWidget((()=>o.set(!1)))),this._register(n.onDidContentSizeChange((i=>{const t=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+e.ONE_OVERVIEW_WIDTH,n=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:n,contentWidth:t,contentHeightChanged:i.contentHeightChanged,contentWidthChanged:i.contentWidthChanged})}))),this._register(n.onMouseDown((e=>{var i,t;if(!e.event.rightButton&&e.target.position&&(null===(i=e.target.element)||void 0===i?void 0:i.className.includes("arrow-revert-change"))){const i=e.target.position.lineNumber,n=e.target,o=null===(t=this._diffComputationResult)||void 0===t?void 0:t.changes.find((e=>(null===n||void 0===n?void 0:n.detail.afterLineNumber)===e.modifiedStartLineNumber||e.modifiedEndLineNumber>0&&e.modifiedStartLineNumber===i));return o&&this.revertChange(o),e.event.stopPropagation(),void this._updateDecorations()}}))),n}revertChange(e){const i=this._modifiedEditor,t=this._originalEditor.getModel(),n=this._modifiedEditor.getModel();if(!t||!n||!i)return;const o=e.originalEndLineNumber>0?new D.e(e.originalStartLineNumber,1,e.originalEndLineNumber,t.getLineMaxColumn(e.originalEndLineNumber)):null,r=o?t.getValueInRange(o):null,s=e.modifiedEndLineNumber>0?new D.e(e.modifiedStartLineNumber,1,e.modifiedEndLineNumber,n.getLineMaxColumn(e.modifiedEndLineNumber)):null,d=n.getEOL();if(0===e.originalEndLineNumber&&s){let t=s;e.modifiedStartLineNumber>1?t=s.setStartPosition(e.modifiedStartLineNumber-1,n.getLineMaxColumn(e.modifiedStartLineNumber-1)):e.modifiedEndLineNumber<n.getLineCount()&&(t=s.setEndPosition(e.modifiedEndLineNumber+1,1)),i.executeEdits("diffEditor",[{range:t,text:""}])}else if(0===e.modifiedEndLineNumber&&null!==r){const t=e.modifiedStartLineNumber<n.getLineCount()?new M.L(e.modifiedStartLineNumber+1,1):new M.L(e.modifiedStartLineNumber,n.getLineMaxColumn(e.modifiedStartLineNumber));i.executeEdits("diffEditor",[{range:D.e.fromPositions(t,t),text:e.modifiedStartLineNumber<n.getLineCount()?r+d:d+r}])}else s&&null!==r&&i.executeEdits("diffEditor",[{range:s,text:r}])}_createInnerEditor(e,i,t,n){return e.createInstance(w.Gm,i,t,n)}dispose(){this._codeEditorService.removeDiffEditor(this),-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._cleanViewZonesAndDecorations(),this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose()),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose()),this._overviewDomElement.removeChild(this._overviewViewportDomElement.domNode),this._options.renderOverviewRuler&&this._containerDomElement.removeChild(this._overviewDomElement),this._containerDomElement.removeChild(this._originalDomNode),this._originalEditor.dispose(),this._containerDomElement.removeChild(this._modifiedDomNode),this._modifiedEditor.dispose(),this._strategy.dispose(),this._containerDomElement.removeChild(this._reviewPane.domNode.domNode),this._containerDomElement.removeChild(this._reviewPane.shadow.domNode),this._containerDomElement.removeChild(this._reviewPane.actionBarContainer.domNode),this._reviewPane.dispose(),this._domElement.removeChild(this._containerDomElement),this._onDidDispose.fire(),super.dispose()}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return V.g.IDiffEditor}getLineChanges(){return this._diffComputationResult?this._diffComputationResult.changes:null}getOriginalEditor(){return this._originalEditor}getModifiedEditor(){return this._modifiedEditor}updateOptions(i){const t=Ce(i,this._options),n=Se(this._options,t);this._options=t,this.isEmbeddedDiffEditorKey.set("undefined"!==typeof i.isInEmbeddedEditor&&i.isInEmbeddedEditor);const o=n.ignoreTrimWhitespace||n.renderIndicators||n.renderMarginRevertIcon,r=this._isVisible&&(n.maxComputationTime||n.maxFileSize);this._documentDiffProvider.setOptions(t),o?this._beginUpdateDecorations():r&&this._beginUpdateDecorationsSoon(),this._modifiedEditor.updateOptions(this._adjustOptionsForRightHandSide(i)),this._originalEditor.updateOptions(this._adjustOptionsForLeftHandSide(i)),this._strategy.setEnableSplitViewResizing(this._options.enableSplitViewResizing,this._options.splitViewDefaultRatio),n.renderSideBySide&&(this._options.renderSideBySide?this._setStrategy(new ce(this._createDataSource(),this._options.enableSplitViewResizing,this._options.splitViewDefaultRatio)):this._setStrategy(new ue(this._createDataSource(),this._options.enableSplitViewResizing)),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide)),n.renderOverviewRuler&&(this._options.renderOverviewRuler?this._containerDomElement.appendChild(this._overviewDomElement):this._containerDomElement.removeChild(this._overviewDomElement))}getModel(){return{original:this._originalEditor.getModel(),modified:this._modifiedEditor.getModel()}}createViewModel(e){return{model:e,waitForDiff(){return Q(this,void 0,void 0,(function*(){}))}}}setModel(e){if(e&&"model"in e&&(e=e.model),e&&(!e.original||!e.modified))throw new Error(e.original?"DiffEditorWidget.setModel: Modified model is null":"DiffEditorWidget.setModel: Original model is null");this._cleanViewZonesAndDecorations(),this._disposeOverviewRulers(),this._originalEditor.setModel(e?e.original:null),this._modifiedEditor.setModel(e?e.modified:null),this._updateDecorationsRunner.cancel(),e&&(this._originalEditor.setScrollTop(0),this._modifiedEditor.setScrollTop(0)),this._diffComputationResult=null,this._diffComputationToken++,this._setState(0),e&&(this._createOverviewRulers(),this._beginUpdateDecorations()),this._layoutOverviewViewport(),this._onDidChangeModel.fire(),this._diffNavigator=this._register(this._instantiationService.createInstance(N.F,this,{alwaysRevealFirst:!1,findResultLoop:this.getModifiedEditor().getOption(40).loop}))}getContainerDomNode(){return this._domElement}getVisibleColumnFromPosition(e){return this._modifiedEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._modifiedEditor.getPosition()}setPosition(e,i="api"){this._modifiedEditor.setPosition(e,i)}revealLine(e,i=0){this._modifiedEditor.revealLine(e,i)}revealLineInCenter(e,i=0){this._modifiedEditor.revealLineInCenter(e,i)}revealLineInCenterIfOutsideViewport(e,i=0){this._modifiedEditor.revealLineInCenterIfOutsideViewport(e,i)}revealLineNearTop(e,i=0){this._modifiedEditor.revealLineNearTop(e,i)}revealPosition(e,i=0){this._modifiedEditor.revealPosition(e,i)}revealPositionInCenter(e,i=0){this._modifiedEditor.revealPositionInCenter(e,i)}revealPositionInCenterIfOutsideViewport(e,i=0){this._modifiedEditor.revealPositionInCenterIfOutsideViewport(e,i)}revealPositionNearTop(e,i=0){this._modifiedEditor.revealPositionNearTop(e,i)}getSelection(){return this._modifiedEditor.getSelection()}getSelections(){return this._modifiedEditor.getSelections()}setSelection(e,i="api"){this._modifiedEditor.setSelection(e,i)}setSelections(e,i="api"){this._modifiedEditor.setSelections(e,i)}revealLines(e,i,t=0){this._modifiedEditor.revealLines(e,i,t)}revealLinesInCenter(e,i,t=0){this._modifiedEditor.revealLinesInCenter(e,i,t)}revealLinesInCenterIfOutsideViewport(e,i,t=0){this._modifiedEditor.revealLinesInCenterIfOutsideViewport(e,i,t)}revealLinesNearTop(e,i,t=0){this._modifiedEditor.revealLinesNearTop(e,i,t)}revealRange(e,i=0,t=!1,n=!0){this._modifiedEditor.revealRange(e,i,t,n)}revealRangeInCenter(e,i=0){this._modifiedEditor.revealRangeInCenter(e,i)}revealRangeInCenterIfOutsideViewport(e,i=0){this._modifiedEditor.revealRangeInCenterIfOutsideViewport(e,i)}revealRangeNearTop(e,i=0){this._modifiedEditor.revealRangeNearTop(e,i)}revealRangeNearTopIfOutsideViewport(e,i=0){this._modifiedEditor.revealRangeNearTopIfOutsideViewport(e,i)}revealRangeAtTop(e,i=0){this._modifiedEditor.revealRangeAtTop(e,i)}getSupportedActions(){return this._modifiedEditor.getSupportedActions()}focus(){this._modifiedEditor.focus()}trigger(e,i,t){this._modifiedEditor.trigger(e,i,t)}createDecorationsCollection(e){return this._modifiedEditor.createDecorationsCollection(e)}changeDecorations(e){return this._modifiedEditor.changeDecorations(e)}saveViewState(){const e=this._originalEditor.saveViewState(),i=this._modifiedEditor.saveViewState();return{original:e,modified:i}}restoreViewState(e){if(e&&e.original&&e.modified){const i=e;this._originalEditor.restoreViewState(i.original),this._modifiedEditor.restoreViewState(i.modified)}}layout(e){this._elementSizeObserver.observe(e)}hasTextFocus(){return this._originalEditor.hasTextFocus()||this._modifiedEditor.hasTextFocus()}_onDidContainerSizeChanged(){this._doLayout()}_getReviewHeight(){return this._reviewPane.isVisible()?this._elementSizeObserver.getHeight():0}_layoutOverviewRulers(){if(!this._options.renderOverviewRuler)return;if(!this._originalOverviewRuler||!this._modifiedOverviewRuler)return;const i=this._elementSizeObserver.getHeight(),t=this._getReviewHeight(),n=e.ENTIRE_DIFF_OVERVIEW_WIDTH-2*e.ONE_OVERVIEW_WIDTH,o=this._modifiedEditor.getLayoutInfo();o&&(this._originalOverviewRuler.setLayout({top:0,width:e.ONE_OVERVIEW_WIDTH,right:n+e.ONE_OVERVIEW_WIDTH,height:i-t}),this._modifiedOverviewRuler.setLayout({top:0,right:0,width:e.ONE_OVERVIEW_WIDTH,height:i-t}))}_onViewZonesChanged(){this._currentlyChangingViewZones||this._updateDecorationsRunner.schedule()}_beginUpdateDecorationsSoon(){-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._beginUpdateDecorationsTimeout=window.setTimeout((()=>this._beginUpdateDecorations()),e.UPDATE_DIFF_DECORATIONS_DELAY)}static _equals(e,i){return!e&&!i||!(!e||!i)&&e.toString()===i.toString()}_beginUpdateDecorations(){-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1);const i=this._originalEditor.getModel(),t=this._modifiedEditor.getModel();if(!i||!t)return;this._diffComputationToken++;const n=this._diffComputationToken,o=1024*this._options.maxFileSize*1024,r=e=>{const i=e.getValueLength();return 0===o||i<=o};r(i)&&r(t)?(this._setState(1),this._documentDiffProvider.computeDiff(i,t,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace,maxComputationTimeMs:this._options.maxComputationTime,computeMoves:!1}).then((e=>{n===this._diffComputationToken&&i===this._originalEditor.getModel()&&t===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult={identical:e.identical,quitEarly:e.quitEarly,changes2:e.changes,changes:e.changes.map((e=>{let i,t,n,o,r=e.innerChanges;return e.originalRange.isEmpty?(i=e.originalRange.startLineNumber-1,t=0,r=void 0):(i=e.originalRange.startLineNumber,t=e.originalRange.endLineNumberExclusive-1),e.modifiedRange.isEmpty?(n=e.modifiedRange.startLineNumber-1,o=0,r=void 0):(n=e.modifiedRange.startLineNumber,o=e.modifiedRange.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:t,modifiedStartLineNumber:n,modifiedEndLineNumber:o,charChanges:null===r||void 0===r?void 0:r.map((e=>({originalStartLineNumber:e.originalRange.startLineNumber,originalStartColumn:e.originalRange.startColumn,originalEndLineNumber:e.originalRange.endLineNumber,originalEndColumn:e.originalRange.endColumn,modifiedStartLineNumber:e.modifiedRange.startLineNumber,modifiedStartColumn:e.modifiedRange.startColumn,modifiedEndLineNumber:e.modifiedRange.endLineNumber,modifiedEndColumn:e.modifiedRange.endColumn})))}}))},this._updateDecorationsRunner.schedule(),this._onDidUpdateDiff.fire())}),(e=>{n===this._diffComputationToken&&i===this._originalEditor.getModel()&&t===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult=null,this._updateDecorationsRunner.schedule())}))):e._equals(i.uri,this._lastOriginalWarning)&&e._equals(t.uri,this._lastModifiedWarning)||(this._lastOriginalWarning=i.uri,this._lastModifiedWarning=t.uri,this._notificationService.warn(C.NC("diff.tooLarge","Cannot compare files because one file is too large.")))}_cleanViewZonesAndDecorations(){this._originalEditorState.clean(this._originalEditor),this._modifiedEditorState.clean(this._modifiedEditor)}_updateDecorations(){if(!this._originalEditor.getModel()||!this._modifiedEditor.getModel())return;const e=this._diffComputationResult?this._diffComputationResult.changes:[],i=this._originalEditorState.getForeignViewZones(this._originalEditor.getWhitespaces()),t=this._modifiedEditorState.getForeignViewZones(this._modifiedEditor.getWhitespaces()),n=this._options.renderMarginRevertIcon&&!this._modifiedEditor.getOption(89),o=this._strategy.getEditorsDiffDecorations(e,this._options.ignoreTrimWhitespace,this._options.renderIndicators,n,i,t);try{this._currentlyChangingViewZones=!0,this._originalEditorState.apply(this._originalEditor,this._originalOverviewRuler,o.original,!1),this._modifiedEditorState.apply(this._modifiedEditor,this._modifiedOverviewRuler,o.modified,!0)}finally{this._currentlyChangingViewZones=!1}}_adjustOptionsForSubEditor(e){const i=Object.assign({},e);return i.inDiffEditor=!0,i.automaticLayout=!1,i.scrollbar=Object.assign({},i.scrollbar||{}),i.scrollbar.vertical="visible",i.folding=!1,i.codeLens=this._options.diffCodeLens,i.fixedOverflowWidgets=!0,i.minimap=Object.assign({},i.minimap||{}),i.minimap.enabled=!1,i}_adjustOptionsForLeftHandSide(e){const i=this._adjustOptionsForSubEditor(e);return this._options.renderSideBySide?i.wordWrapOverride1=this._options.diffWordWrap:(i.wordWrapOverride1="off",i.wordWrapOverride2="off",i.stickyScroll={enabled:!1}),e.originalAriaLabel&&(i.ariaLabel=e.originalAriaLabel),this._updateAriaLabel(i),i.readOnly=!this._options.originalEditable,i.dropIntoEditor={enabled:!i.readOnly},i.extraEditorClassName="original-in-monaco-diff-editor",Object.assign(Object.assign({},i),{dimension:{height:0,width:0}})}_updateAriaLabel(e){var i;let t=null!==(i=e.ariaLabel)&&void 0!==i?i:"";this._options.accessibilityVerbose?t+=re:t&&(t=t.replaceAll(re,"")),e.ariaLabel=t}_adjustOptionsForRightHandSide(i){const t=this._adjustOptionsForSubEditor(i);return i.modifiedAriaLabel&&(t.ariaLabel=i.modifiedAriaLabel),this._updateAriaLabel(t),t.wordWrapOverride1=this._options.diffWordWrap,t.revealHorizontalRightPadding=x.BH.revealHorizontalRightPadding.defaultValue+e.ENTIRE_DIFF_OVERVIEW_WIDTH,t.scrollbar.verticalHasArrows=!1,t.extraEditorClassName="modified-in-monaco-diff-editor",Object.assign(Object.assign({},t),{dimension:{height:0,width:0}})}doLayout(){this._elementSizeObserver.observe(),this._doLayout()}_doLayout(){const i=this._elementSizeObserver.getWidth(),t=this._elementSizeObserver.getHeight(),n=this._getReviewHeight(),o=this._strategy.layout();this._originalDomNode.style.width=o+"px",this._originalDomNode.style.left="0px",this._modifiedDomNode.style.width=i-o-e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._modifiedDomNode.style.left=o+"px",this._overviewDomElement.style.top="0px",this._overviewDomElement.style.height=t-n+"px",this._overviewDomElement.style.width=e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewDomElement.style.left=i-e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewViewportDomElement.setWidth(e.ENTIRE_DIFF_OVERVIEW_WIDTH),this._overviewViewportDomElement.setHeight(30),this._originalEditor.layout({width:o,height:t-n}),this._modifiedEditor.layout({width:i-o-(this._options.renderOverviewRuler?e.ENTIRE_DIFF_OVERVIEW_WIDTH:0),height:t-n}),(this._originalOverviewRuler||this._modifiedOverviewRuler)&&this._layoutOverviewRulers(),this._reviewPane.layout(t-n,i,n),this._layoutOverviewViewport()}_layoutOverviewViewport(){const e=this._computeOverviewViewport();e?(this._overviewViewportDomElement.setTop(e.top),this._overviewViewportDomElement.setHeight(e.height)):(this._overviewViewportDomElement.setTop(0),this._overviewViewportDomElement.setHeight(0))}_computeOverviewViewport(){const e=this._modifiedEditor.getLayoutInfo();if(!e)return null;const i=this._modifiedEditor.getScrollTop(),t=this._modifiedEditor.getScrollHeight(),n=Math.max(0,e.height),o=Math.max(0,n-0),r=t>0?o/t:0,s=Math.max(0,Math.floor(e.height*r)),d=Math.floor(i*r);return{height:s,top:d}}_createDataSource(){return{getWidth:()=>this._elementSizeObserver.getWidth(),getHeight:()=>this._elementSizeObserver.getHeight()-this._getReviewHeight(),getOptions:()=>({renderOverviewRuler:this._options.renderOverviewRuler}),getContainerDomNode:()=>this._containerDomElement,relayoutEditors:()=>{this._doLayout()},getOriginalEditor:()=>this._originalEditor,getModifiedEditor:()=>this._modifiedEditor}}_setStrategy(e){var i;null===(i=this._strategy)||void 0===i||i.dispose(),this._strategy=e,this._boundarySashes&&e.setBoundarySashes(this._boundarySashes),e.applyColors(this._themeService.getColorTheme()),this._diffComputationResult&&this._updateDecorations(),this._doLayout()}};se.ONE_OVERVIEW_WIDTH=15,se.ENTIRE_DIFF_OVERVIEW_WIDTH=30,se.UPDATE_DIFF_DECORATIONS_DELAY=200,se=Y([G(3,Z.p),G(4,k.i6),G(5,U.TG),G(6,b.$),G(7,X.XE),G(8,$.lT),G(9,B.i),G(10,j.ek)],se);class de extends u.JT{constructor(e){super(),this._dataSource=e,this._insertColor=null,this._removeColor=null}applyColors(e){const i=e.getColor(K.P6Y)||(e.getColor(K.ypS)||K.CzK).transparent(2),t=e.getColor(K.F9q)||(e.getColor(K.P4M)||K.keg).transparent(2),n=!i.equals(this._insertColor)||!t.equals(this._removeColor);return this._insertColor=i,this._removeColor=t,n}getEditorsDiffDecorations(e,i,t,n,o,r){r=r.sort(((e,i)=>e.afterLineNumber-i.afterLineNumber)),o=o.sort(((e,i)=>e.afterLineNumber-i.afterLineNumber));const s=this._getViewZones(e,o,r,t),d=this._getOriginalEditorDecorations(s,e,i,t),a=this._getModifiedEditorDecorations(s,e,i,t,n);return{original:{decorations:d.decorations,overviewZones:d.overviewZones,zones:s.original},modified:{decorations:a.decorations,overviewZones:a.overviewZones,zones:s.modified}}}setBoundarySashes(e){}}class ae{constructor(e){this._source=e,this._index=-1,this.current=null,this.advance()}advance(){this._index++,this._index<this._source.length?this.current=this._source[this._index]:this.current=null}}class le{constructor(e,i,t,n,o){this._lineChanges=e,this._originalForeignVZ=i,this._modifiedForeignVZ=t,this._originalEditor=n,this._modifiedEditor=o}static _getViewLineCount(e,i,t){const n=e.getModel(),o=e._getViewModel();if(n&&o){const e=Le(n,o,i,t);return e.endLineNumber-e.startLineNumber+1}return t-i+1}getViewZones(){const e=this._originalEditor.getOption(65),i=this._modifiedEditor.getOption(65),t=-1!==this._originalEditor.getOption(143).wrappingColumn,n=-1!==this._modifiedEditor.getOption(143).wrappingColumn,o=t||n,r=this._originalEditor.getModel(),s=this._originalEditor._getViewModel().coordinatesConverter,d=this._modifiedEditor._getViewModel().coordinatesConverter,a={original:[],modified:[]};let l=0,h=0,g=0,c=0,f=0,u=0;const m=(e,i)=>e.afterLineNumber-i.afterLineNumber,_=(e,i)=>{if(null===i.domNode&&e.length>0){const t=e[e.length-1];if(t.afterLineNumber===i.afterLineNumber&&null===t.domNode)return void(t.heightInLines+=i.heightInLines)}e.push(i)},p=new ae(this._modifiedForeignVZ),v=new ae(this._originalForeignVZ);let b=1,E=1;for(let w=0,N=this._lineChanges.length;w<=N;w++){const t=w<N?this._lineChanges[w]:null;null!==t?(g=t.originalStartLineNumber+(t.originalEndLineNumber>0?-1:0),c=t.modifiedStartLineNumber+(t.modifiedEndLineNumber>0?-1:0),h=t.originalEndLineNumber>0?le._getViewLineCount(this._originalEditor,t.originalStartLineNumber,t.originalEndLineNumber):0,l=t.modifiedEndLineNumber>0?le._getViewLineCount(this._modifiedEditor,t.modifiedStartLineNumber,t.modifiedEndLineNumber):0,f=Math.max(t.originalStartLineNumber,t.originalEndLineNumber),u=Math.max(t.modifiedStartLineNumber,t.modifiedEndLineNumber)):(g+=1e7+h,c+=1e7+l,f=g,u=c);let n=[],L=[];if(o){let e;e=t?t.originalEndLineNumber>0?t.originalStartLineNumber-b:t.modifiedStartLineNumber-E:r.getLineCount()-b+1;for(let i=0;i<e;i++){const e=b+i,t=E+i,o=s.getModelLineViewLineCount(e),r=d.getModelLineViewLineCount(t);o<r?n.push({afterLineNumber:e,heightInLines:r-o,domNode:null,marginDomNode:null}):o>r&&L.push({afterLineNumber:t,heightInLines:o-r,domNode:null,marginDomNode:null})}t&&(b=(t.originalEndLineNumber>0?t.originalEndLineNumber:t.originalStartLineNumber)+1,E=(t.modifiedEndLineNumber>0?t.modifiedEndLineNumber:t.modifiedStartLineNumber)+1)}while(p.current&&p.current.afterLineNumber<=u){let e;e=p.current.afterLineNumber<=c?g-c+p.current.afterLineNumber:f;let o=null;t&&t.modifiedStartLineNumber<=p.current.afterLineNumber&&p.current.afterLineNumber<=t.modifiedEndLineNumber&&(o=this._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion()),n.push({afterLineNumber:e,heightInLines:p.current.height/i,domNode:null,marginDomNode:o}),p.advance()}while(v.current&&v.current.afterLineNumber<=f){let i;i=v.current.afterLineNumber<=g?c-g+v.current.afterLineNumber:u,L.push({afterLineNumber:i,heightInLines:v.current.height/e,domNode:null}),v.advance()}if(null!==t&&pe(t)){const e=this._produceOriginalFromDiff(t,h,l);e&&n.push(e)}if(null!==t&&ve(t)){const e=this._produceModifiedFromDiff(t,h,l);e&&L.push(e)}let C=0,S=0;n=n.sort(m),L=L.sort(m);while(C<n.length&&S<L.length){const e=n[C],i=L[S],t=e.afterLineNumber-g,o=i.afterLineNumber-c;t<o?(_(a.original,e),C++):o<t?(_(a.modified,i),S++):e.shouldNotShrink?(_(a.original,e),C++):i.shouldNotShrink?(_(a.modified,i),S++):e.heightInLines>=i.heightInLines?(e.heightInLines-=i.heightInLines,S++):(i.heightInLines-=e.heightInLines,C++)}while(C<n.length)_(a.original,n[C]),C++;while(S<L.length)_(a.modified,L[S]),S++}return{original:le._ensureDomNodes(a.original),modified:le._ensureDomNodes(a.modified)}}static _ensureDomNodes(e){return e.map((e=>(e.domNode||(e.domNode=we()),e)))}}function he(e,i,t,n,o){return{range:new D.e(e,i,t,n),options:o}}const ge={arrowRevertChange:P.qx.register({description:"diff-editor-arrow-revert-change",glyphMarginHoverMessage:new f.W5(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(C.NC("revertChangeHoverMessage","Click to revert change")),glyphMarginClassName:"arrow-revert-change "+m.k.asClassName(h.l.arrowRight),zIndex:10001}),charDelete:P.qx.register({description:"diff-editor-char-delete",className:"char-delete"}),charDeleteWholeLine:P.qx.register({description:"diff-editor-char-delete-whole-line",className:"char-delete",isWholeLine:!0}),charInsert:P.qx.register({description:"diff-editor-char-insert",className:"char-insert"}),charInsertWholeLine:P.qx.register({description:"diff-editor-char-insert-whole-line",className:"char-insert",isWholeLine:!0}),lineInsert:P.qx.register({description:"diff-editor-line-insert",className:"line-insert",marginClassName:"gutter-insert",isWholeLine:!0}),lineInsertWithSign:P.qx.register({description:"diff-editor-line-insert-with-sign",className:"line-insert",linesDecorationsClassName:"insert-sign "+m.k.asClassName(te),marginClassName:"gutter-insert",isWholeLine:!0}),lineDelete:P.qx.register({description:"diff-editor-line-delete",className:"line-delete",marginClassName:"gutter-delete",isWholeLine:!0}),lineDeleteWithSign:P.qx.register({description:"diff-editor-line-delete-with-sign",className:"line-delete",linesDecorationsClassName:"delete-sign "+m.k.asClassName(ne),marginClassName:"gutter-delete",isWholeLine:!0}),lineDeleteMargin:P.qx.register({description:"diff-editor-line-delete-margin",marginClassName:"gutter-delete"})};class ce extends de{constructor(e,i,t){super(e),this._disableSash=!1===i,this._defaultRatio=t,this._sashRatio=null,this._sashPosition=null,this._startSashPosition=null,this._sash=this._register(new d.g(this._dataSource.getContainerDomNode(),this,{orientation:0})),this._disableSash&&(this._sash.state=0),this._sash.onDidStart((()=>this._onSashDragStart())),this._sash.onDidChange((e=>this._onSashDrag(e))),this._sash.onDidEnd((()=>this._onSashDragEnd())),this._sash.onDidReset((()=>this._onSashReset()))}setEnableSplitViewResizing(e,i){this._defaultRatio=i;const t=!1===e;this._disableSash!==t&&(this._disableSash=t,this._sash.state=this._disableSash?0:3)}layout(e=this._sashRatio||this._defaultRatio){const i=this._dataSource.getWidth(),t=i-(this._dataSource.getOptions().renderOverviewRuler?se.ENTIRE_DIFF_OVERVIEW_WIDTH:0);let n=Math.floor((e||this._defaultRatio)*t);const o=Math.floor(this._defaultRatio*t);return n=this._disableSash?o:n||o,t>2*ce.MINIMUM_EDITOR_WIDTH?(n<ce.MINIMUM_EDITOR_WIDTH&&(n=ce.MINIMUM_EDITOR_WIDTH),n>t-ce.MINIMUM_EDITOR_WIDTH&&(n=t-ce.MINIMUM_EDITOR_WIDTH)):n=o,this._sashPosition!==n&&(this._sashPosition=n),this._sash.layout(),this._sashPosition}_onSashDragStart(){this._startSashPosition=this._sashPosition}_onSashDrag(e){const i=this._dataSource.getWidth(),t=i-(this._dataSource.getOptions().renderOverviewRuler?se.ENTIRE_DIFF_OVERVIEW_WIDTH:0),n=this.layout((this._startSashPosition+(e.currentX-e.startX))/t);this._sashRatio=n/t,this._dataSource.relayoutEditors()}_onSashDragEnd(){this._sash.layout()}_onSashReset(){this._sashRatio=this._defaultRatio,this._dataSource.relayoutEditors(),this._sash.layout()}getVerticalSashTop(e){return 0}getVerticalSashLeft(e){return this._sashPosition}getVerticalSashHeight(e){return this._dataSource.getHeight()}setBoundarySashes(e){this._sash.orthogonalEndSash=e.bottom}_getViewZones(e,i,t){const n=this._dataSource.getOriginalEditor(),o=this._dataSource.getModifiedEditor(),r=new fe(e,i,t,n,o);return r.getViewZones()}_getOriginalEditorDecorations(e,i,t,n){const o=this._dataSource.getOriginalEditor(),r=String(this._removeColor),s={decorations:[],overviewZones:[]},d=o.getModel(),a=o._getViewModel();for(const l of i)if(ve(l)){s.decorations.push({range:new D.e(l.originalStartLineNumber,1,l.originalEndLineNumber,1073741824),options:n?ge.lineDeleteWithSign:ge.lineDelete}),pe(l)&&l.charChanges||s.decorations.push(he(l.originalStartLineNumber,1,l.originalEndLineNumber,1073741824,ge.charDeleteWholeLine));const e=Le(d,a,l.originalStartLineNumber,l.originalEndLineNumber);if(s.overviewZones.push(new z.EY(e.startLineNumber,e.endLineNumber,0,r)),l.charChanges)for(const i of l.charChanges)if(Ee(i))if(t)for(let e=i.originalStartLineNumber;e<=i.originalEndLineNumber;e++){let t,n;t=e===i.originalStartLineNumber?i.originalStartColumn:d.getLineFirstNonWhitespaceColumn(e),n=e===i.originalEndLineNumber?i.originalEndColumn:d.getLineLastNonWhitespaceColumn(e),s.decorations.push(he(e,t,e,n,ge.charDelete))}else s.decorations.push(he(i.originalStartLineNumber,i.originalStartColumn,i.originalEndLineNumber,i.originalEndColumn,ge.charDelete))}return s}_getModifiedEditorDecorations(e,i,t,n,o){const r=this._dataSource.getModifiedEditor(),s=String(this._insertColor),d={decorations:[],overviewZones:[]},a=r.getModel(),l=r._getViewModel();for(const h of i){if(o)if(h.modifiedEndLineNumber>0)d.decorations.push({range:new D.e(h.modifiedStartLineNumber,1,h.modifiedStartLineNumber,1),options:ge.arrowRevertChange});else{const i=e.modified.find((e=>e.afterLineNumber===h.modifiedStartLineNumber));i&&(i.marginDomNode=Ne())}if(pe(h)){d.decorations.push({range:new D.e(h.modifiedStartLineNumber,1,h.modifiedEndLineNumber,1073741824),options:n?ge.lineInsertWithSign:ge.lineInsert}),ve(h)&&h.charChanges||d.decorations.push(he(h.modifiedStartLineNumber,1,h.modifiedEndLineNumber,1073741824,ge.charInsertWholeLine));const e=Le(a,l,h.modifiedStartLineNumber,h.modifiedEndLineNumber);if(d.overviewZones.push(new z.EY(e.startLineNumber,e.endLineNumber,0,s)),h.charChanges)for(const i of h.charChanges)if(be(i))if(t)for(let e=i.modifiedStartLineNumber;e<=i.modifiedEndLineNumber;e++){let t,n;t=e===i.modifiedStartLineNumber?i.modifiedStartColumn:a.getLineFirstNonWhitespaceColumn(e),n=e===i.modifiedEndLineNumber?i.modifiedEndColumn:a.getLineLastNonWhitespaceColumn(e),d.decorations.push(he(e,t,e,n,ge.charInsert))}else d.decorations.push(he(i.modifiedStartLineNumber,i.modifiedStartColumn,i.modifiedEndLineNumber,i.modifiedEndColumn,ge.charInsert))}}return d}}ce.MINIMUM_EDITOR_WIDTH=100;class fe extends le{constructor(e,i,t,n,o){super(e,i,t,n,o)}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){return null}_produceOriginalFromDiff(e,i,t){return t>i?{afterLineNumber:Math.max(e.originalStartLineNumber,e.originalEndLineNumber),heightInLines:t-i,domNode:null}:null}_produceModifiedFromDiff(e,i,t){return i>t?{afterLineNumber:Math.max(e.modifiedStartLineNumber,e.modifiedEndLineNumber),heightInLines:i-t,domNode:null}:null}}class ue extends de{constructor(e,i){super(e),this._decorationsLeft=e.getOriginalEditor().getLayoutInfo().decorationsLeft,this._register(e.getOriginalEditor().onDidLayoutChange((i=>{this._decorationsLeft!==i.decorationsLeft&&(this._decorationsLeft=i.decorationsLeft,e.relayoutEditors())})))}setEnableSplitViewResizing(e){}_getViewZones(e,i,t,n){const o=this._dataSource.getOriginalEditor(),r=this._dataSource.getModifiedEditor(),s=new me(e,i,t,o,r,n);return s.getViewZones()}_getOriginalEditorDecorations(e,i,t,n){const o=String(this._removeColor),r={decorations:[],overviewZones:[]},s=this._dataSource.getOriginalEditor(),d=s.getModel(),a=s._getViewModel();let l=0;for(const h of i)if(ve(h)){r.decorations.push({range:new D.e(h.originalStartLineNumber,1,h.originalEndLineNumber,1073741824),options:ge.lineDeleteMargin});while(l<e.modified.length){const i=e.modified[l];if(i.diff&&i.diff.originalStartLineNumber>=h.originalStartLineNumber)break;l++}let i=0;if(l<e.modified.length){const t=e.modified[l];t.diff&&t.diff.originalStartLineNumber===h.originalStartLineNumber&&t.diff.originalEndLineNumber===h.originalEndLineNumber&&t.diff.modifiedStartLineNumber===h.modifiedStartLineNumber&&t.diff.modifiedEndLineNumber===h.modifiedEndLineNumber&&(i=t.heightInLines)}const t=Le(d,a,h.originalStartLineNumber,h.originalEndLineNumber);r.overviewZones.push(new z.EY(t.startLineNumber,t.endLineNumber,i,o))}return r}_getModifiedEditorDecorations(e,i,t,n,o){const r=this._dataSource.getModifiedEditor(),s=String(this._insertColor),d={decorations:[],overviewZones:[]},a=r.getModel(),l=r._getViewModel();for(const h of i)if(pe(h)){d.decorations.push({range:new D.e(h.modifiedStartLineNumber,1,h.modifiedEndLineNumber,1073741824),options:n?ge.lineInsertWithSign:ge.lineInsert});const e=Le(a,l,h.modifiedStartLineNumber,h.modifiedEndLineNumber);if(d.overviewZones.push(new z.EY(e.startLineNumber,e.endLineNumber,0,s)),h.charChanges){for(const i of h.charChanges)if(be(i))if(t)for(let e=i.modifiedStartLineNumber;e<=i.modifiedEndLineNumber;e++){let t,n;t=e===i.modifiedStartLineNumber?i.modifiedStartColumn:a.getLineFirstNonWhitespaceColumn(e),n=e===i.modifiedEndLineNumber?i.modifiedEndColumn:a.getLineLastNonWhitespaceColumn(e),d.decorations.push(he(e,t,e,n,ge.charInsert))}else d.decorations.push(he(i.modifiedStartLineNumber,i.modifiedStartColumn,i.modifiedEndLineNumber,i.modifiedEndColumn,ge.charInsert))}else d.decorations.push(he(h.modifiedStartLineNumber,1,h.modifiedEndLineNumber,1073741824,ge.charInsertWholeLine))}return d}layout(){return Math.max(5,this._decorationsLeft)}}class me extends le{constructor(e,i,t,n,o,r){super(e,i,t,n,o),this._originalModel=n.getModel(),this._renderIndicators=r,this._pendingLineChange=[],this._pendingViewZones=[],this._lineBreaksComputer=this._modifiedEditor._getViewModel().createLineBreaksComputer()}getViewZones(){const e=super.getViewZones();return this._finalize(e),e}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){const e=document.createElement("div");return e.className="inline-added-margin-view-zone",e}_produceOriginalFromDiff(e,i,t){const n=document.createElement("div");return n.className="inline-added-margin-view-zone",{afterLineNumber:Math.max(e.originalStartLineNumber,e.originalEndLineNumber),heightInLines:t,domNode:document.createElement("div"),marginDomNode:n}}_produceModifiedFromDiff(e,i,t){const n=document.createElement("div");n.className=`view-lines line-delete ${s.S}`;const o=document.createElement("div");o.className="inline-deleted-margin-view-zone";const r={shouldNotShrink:!0,afterLineNumber:0===e.modifiedEndLineNumber?e.modifiedStartLineNumber:e.modifiedStartLineNumber-1,heightInLines:i,minWidthInPx:0,domNode:n,marginDomNode:o,diff:{originalStartLineNumber:e.originalStartLineNumber,originalEndLineNumber:e.originalEndLineNumber,modifiedStartLineNumber:e.modifiedStartLineNumber,modifiedEndLineNumber:e.modifiedEndLineNumber,originalModel:this._originalModel,viewLineCounts:null}};for(let s=e.originalStartLineNumber;s<=e.originalEndLineNumber;s++)this._lineBreaksComputer.addRequest(this._originalModel.getLineContent(s),null,null);return this._pendingLineChange.push(e),this._pendingViewZones.push(r),r}_finalize(e){const i=this._modifiedEditor.getOptions(),t=this._modifiedEditor.getModel().getOptions().tabSize,n=i.get(49),o=i.get(32),r=n.typicalHalfwidthCharacterWidth,s=i.get(102),d=this._originalModel.mightContainNonBasicASCII(),a=this._originalModel.mightContainRTL(),l=i.get(65),h=i.get(142),g=h.decorationsWidth,c=i.get(115),f=i.get(97),u=i.get(92),m=i.get(50),p=this._lineBreaksComputer.finalize();let v=0;for(let b=0;b<this._pendingLineChange.length;b++){const i=this._pendingLineChange[b],h=this._pendingViewZones[b],E=h.domNode;(0,_.N)(E,n);const w=h.marginDomNode;(0,_.N)(w,n);const N=[];if(i.charChanges)for(const e of i.charChanges)Ee(e)&&N.push(new F.$t(new D.e(e.originalStartLineNumber,e.originalStartColumn,e.originalEndLineNumber,e.originalEndColumn),"char-delete",0));const L=N.length>0,C=new T.HT(1e4);let S=0,R=0,y=null;for(let r=i.originalStartLineNumber;r<=i.originalEndLineNumber;r++){const s=r-i.originalStartLineNumber,_=this._originalModel.tokenization.getLineTokens(r),b=_.getLineContent(),E=p[v++],D=A.Kp.filter(N,r,1,b.length+1);if(E){let i=0;for(const e of E.breakOffsets){const r=_.sliceAndInflate(i,e,0),s=b.substring(i,e);S=Math.max(S,this._renderOriginalLine(R++,s,r,A.Kp.extractWrapped(D,i,e),L,d,a,n,o,l,g,c,f,u,m,t,C,w)),i=e}y||(y=[]);while(y.length<s)y[y.length]=1;y[s]=E.breakOffsets.length,h.heightInLines+=E.breakOffsets.length-1;const p=document.createElement("div");p.className="gutter-delete",e.original.push({afterLineNumber:r,afterColumn:0,heightInLines:E.breakOffsets.length-1,domNode:we(),marginDomNode:p})}else S=Math.max(S,this._renderOriginalLine(R++,b,_,D,L,d,a,n,o,l,g,c,f,u,m,t,C,w))}S+=s;const I=C.build(),O=oe?oe.createHTML(I):I;if(E.innerHTML=O,h.minWidthInPx=S*r,y){const e=i.originalEndLineNumber-i.originalStartLineNumber;while(y.length<=e)y[y.length]=1}h.diff.viewLineCounts=y}e.original.sort(((e,i)=>e.afterLineNumber-i.afterLineNumber))}_renderOriginalLine(e,i,t,n,o,r,s,d,a,l,h,g,c,f,u,_,p,v){p.appendString('<div class="view-line'),o||p.appendString(" char-delete"),p.appendString('" style="top:'),p.appendString(String(e*l)),p.appendString('px;width:1000000px;">');const b=F.wA.isBasicASCII(i,r),E=F.wA.containsRTL(i,b,s),w=(0,H.d1)(new H.IJ(d.isMonospace&&!a,d.canUseHalfwidthRightwardsArrow,i,!1,b,E,0,t,n,_,0,d.spaceWidth,d.middotWidth,d.wsmiddotWidth,g,c,f,u!==x.n0.OFF,null),p);if(p.appendString("</div>"),this._renderIndicators){const i=document.createElement("div");i.className=`delete-sign ${m.k.asClassName(ne)}`,i.setAttribute("style",`position:absolute;top:${e*l}px;width:${h}px;height:${l}px;right:0;`),v.appendChild(i)}return w.characterMapping.getHorizontalOffset(w.characterMapping.length)}}function _e(e,i){return(0,x.NY)(e,i,["off","on","inherit"])}function pe(e){return e.modifiedEndLineNumber>0}function ve(e){return e.originalEndLineNumber>0}function be(e){return e.modifiedStartLineNumber===e.modifiedEndLineNumber?e.modifiedEndColumn-e.modifiedStartColumn>0:e.modifiedEndLineNumber-e.modifiedStartLineNumber>0}function Ee(e){return e.originalStartLineNumber===e.originalEndLineNumber?e.originalEndColumn-e.originalStartColumn>0:e.originalEndLineNumber-e.originalStartLineNumber>0}function we(){const e=document.createElement("div");return e.className="diagonal-fill",e}function Ne(){const e=document.createElement("div");return e.className="arrow-revert-change "+m.k.asClassName(h.l.arrowRight),n.$("div",{},e)}function Le(e,i,t,n){const o=e.getLineCount();return t=Math.min(o,Math.max(1,t)),n=Math.min(o,Math.max(1,n)),i.coordinatesConverter.convertModelRangeToViewRange(new D.e(t,e.getLineMinColumn(t),n,e.getLineMaxColumn(n)))}function Ce(e,i){return{enableSplitViewResizing:(0,x.O7)(e.enableSplitViewResizing,i.enableSplitViewResizing),splitViewDefaultRatio:(0,x.L_)(e.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:(0,x.O7)(e.renderSideBySide,i.renderSideBySide),renderMarginRevertIcon:(0,x.O7)(e.renderMarginRevertIcon,i.renderMarginRevertIcon),maxComputationTime:(0,x.Zc)(e.maxComputationTime,i.maxComputationTime,0,1073741824),maxFileSize:(0,x.Zc)(e.maxFileSize,i.maxFileSize,0,1073741824),ignoreTrimWhitespace:(0,x.O7)(e.ignoreTrimWhitespace,i.ignoreTrimWhitespace),renderIndicators:(0,x.O7)(e.renderIndicators,i.renderIndicators),originalEditable:(0,x.O7)(e.originalEditable,i.originalEditable),diffCodeLens:(0,x.O7)(e.diffCodeLens,i.diffCodeLens),renderOverviewRuler:(0,x.O7)(e.renderOverviewRuler,i.renderOverviewRuler),diffWordWrap:_e(e.diffWordWrap,i.diffWordWrap),diffAlgorithm:(0,x.NY)(e.diffAlgorithm,i.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:(0,x.O7)(e.accessibilityVerbose,i.accessibilityVerbose),experimental:{collapseUnchangedRegions:!1},isInEmbeddedEditor:(0,x.O7)(e.isInEmbeddedEditor,i.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:!1}}function Se(e,i){return{enableSplitViewResizing:e.enableSplitViewResizing!==i.enableSplitViewResizing,renderSideBySide:e.renderSideBySide!==i.renderSideBySide,renderMarginRevertIcon:e.renderMarginRevertIcon!==i.renderMarginRevertIcon,maxComputationTime:e.maxComputationTime!==i.maxComputationTime,maxFileSize:e.maxFileSize!==i.maxFileSize,ignoreTrimWhitespace:e.ignoreTrimWhitespace!==i.ignoreTrimWhitespace,renderIndicators:e.renderIndicators!==i.renderIndicators,originalEditable:e.originalEditable!==i.originalEditable,diffCodeLens:e.diffCodeLens!==i.diffCodeLens,renderOverviewRuler:e.renderOverviewRuler!==i.renderOverviewRuler,diffWordWrap:e.diffWordWrap!==i.diffWordWrap,diffAlgorithm:e.diffAlgorithm!==i.diffAlgorithm,accessibilityVerbose:e.accessibilityVerbose!==i.accessibilityVerbose}}(0,X.Ic)(((e,i)=>{const t=e.getColor(K.L_t);i.addRule(`\n\t.monaco-editor .diagonal-fill {\n\t\tbackground-image: linear-gradient(\n\t\t\t-45deg,\n\t\t\t${t} 12.5%,\n\t\t\t#0000 12.5%, #0000 50%,\n\t\t\t${t} 50%, ${t} 62.5%,\n\t\t\t#0000 62.5%, #0000 100%\n\t\t);\n\t\tbackground-size: 8px 8px;\n\t}\n\t`)}))},20801:(e,i,t)=>{t.d(i,{K:()=>F});var n=t(2548),o=t(21921),r=t(85398),s=t(8419),d=t(70959),a=t(90168),l=t(61818),h=t(99588),g=t(55455),c=t(6155),f=t(95402),u=t(30039),m=t(44811),_=t(10205),p=t(47606),v=t(25206),b=function(e,i,t,n){function o(e){return e instanceof t?e:new t((function(i){i(e)}))}return new(t||(t=Promise))((function(t,r){function s(e){try{a(n.next(e))}catch(i){r(i)}}function d(e){try{a(n["throw"](e))}catch(i){r(i)}}function a(e){e.done?t(e.value):o(e.value).then(s,d)}a((n=n.apply(e,i||[])).next())}))};class E extends d.JT{get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}constructor(e,i,t,o,r,d,a,l,g){super(),this._getViewZoneId=e,this._marginDomNode=i,this._modifiedEditor=t,this._diff=o,this._editor=r,this._viewLineCounts=d,this._originalTextModel=a,this._contextMenuService=l,this._clipboardService=g,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=h.k.asClassName(s.l.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const c=this._modifiedEditor.getOption(65);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${c}px`,this._diffActions.style.lineHeight=`${c}px`,this._marginDomNode.appendChild(this._diffActions);let f=0;const u=t.getOption(125)&&!p.gn,m=(e,i)=>{var n;this._contextMenuService.showContextMenu({domForShadowRoot:u&&null!==(n=t.getDomNode())&&void 0!==n?n:void 0,getAnchor:()=>({x:e,y:i}),getActions:()=>{const e=[],i=o.modifiedRange.isEmpty;e.push(new _.aU("diff.clipboard.copyDeletedContent",i?o.originalRange.length>1?(0,v.NC)("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):(0,v.NC)("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):o.originalRange.length>1?(0,v.NC)("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):(0,v.NC)("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,(()=>b(this,void 0,void 0,(function*(){const e=this._originalTextModel.getValueInRange(o.originalRange.toExclusiveRange());yield this._clipboardService.writeText(e)}))))),o.originalRange.length>1&&e.push(new _.aU("diff.clipboard.copyDeletedLineContent",i?(0,v.NC)("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",o.originalRange.startLineNumber+f):(0,v.NC)("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",o.originalRange.startLineNumber+f),void 0,!0,(()=>b(this,void 0,void 0,(function*(){let e=this._originalTextModel.getLineContent(o.originalRange.startLineNumber+f);if(""===e){const i=this._originalTextModel.getEndOfLineSequence();e=0===i?"\n":"\r\n"}yield this._clipboardService.writeText(e)})))));const n=t.getOption(89);return n||e.push(new _.aU("diff.inline.revertChange",(0,v.NC)("diff.inline.revertChange.label","Revert this change"),void 0,!0,(()=>b(this,void 0,void 0,(function*(){this._editor.revert(this._diff)}))))),e},autoSelectFirstItem:!0})};this._register((0,n.mu)(this._diffActions,"mousedown",(e=>{const{top:i,height:t}=(0,n.i)(this._diffActions),o=Math.floor(c/3);e.preventDefault(),m(e.posx,i+t+o)}))),this._register(t.onMouseMove((e=>{8!==e.target.type&&5!==e.target.type||e.target.detail.viewZoneId!==this._getViewZoneId()?this.visibility=!1:(f=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,c),this.visibility=!0)}))),this._register(t.onMouseDown((e=>{if(e.event.rightButton&&(8===e.target.type||5===e.target.type)){const i=e.target.detail.viewZoneId;i===this._getViewZoneId()&&(e.event.preventDefault(),f=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,c),m(e.event.posx,e.event.posy+c))}})))}_updateLightBulbPosition(e,i,t){const{top:o}=(0,n.i)(e),r=i-o,s=Math.floor(r/t),d=s*t;if(this._diffActions.style.top=`${d}px`,this._viewLineCounts){let e=0;for(let i=0;i<this._viewLineCounts.length;i++)if(e+=this._viewLineCounts[i],s<e)return i}return s}}var w=t(81806),N=t(93215),L=t(69427),C=t(56998),S=t(93489),D=t(70748);const R=w.N;function y(e,i,t,n){(0,c.N)(n,i.fontInfo);const o=t.length>0,r=new L.HT(1e4);let s=0,d=0;const a=[];for(let c=0;c<e.lineTokens.length;c++){const n=c+1,l=e.lineTokens[c],h=e.lineBreakData[c],g=C.Kp.filter(t,n,1,Number.MAX_SAFE_INTEGER);if(h){let t=0;for(const n of h.breakOffsets){const a=l.sliceAndInflate(t,n,0);s=Math.max(s,x(d,a,C.Kp.extractWrapped(g,t,n),o,e.mightContainNonBasicASCII,e.mightContainRTL,i,r)),d++,t=n}a.push(h.breakOffsets.length)}else a.push(1),s=Math.max(s,x(d,l,g,o,e.mightContainNonBasicASCII,e.mightContainRTL,i,r)),d++}s+=i.scrollBeyondLastColumn;const l=r.build(),h=R?R.createHTML(l):l;n.innerHTML=h;const g=s*i.typicalHalfwidthCharacterWidth;return{heightInLines:d,minWidthInPx:g,viewLineCounts:a}}class I{constructor(e,i,t,n){this.lineTokens=e,this.lineBreakData=i,this.mightContainNonBasicASCII=t,this.mightContainRTL=n}}class O{static fromEditor(e){var i;const t=e.getOptions(),n=t.get(49),o=t.get(142);return new O((null===(i=e.getModel())||void 0===i?void 0:i.getOptions().tabSize)||0,n,t.get(32),n.typicalHalfwidthCharacterWidth,t.get(102),t.get(65),o.decorationsWidth,t.get(115),t.get(97),t.get(92),t.get(50))}constructor(e,i,t,n,o,r,s,d,a,l,h){this.tabSize=e,this.fontInfo=i,this.disableMonospaceOptimizations=t,this.typicalHalfwidthCharacterWidth=n,this.scrollBeyondLastColumn=o,this.lineHeight=r,this.lineDecorationsWidth=s,this.stopRenderingLineAfter=d,this.renderWhitespace=a,this.renderControlCharacters=l,this.fontLigatures=h}}function x(e,i,t,n,o,r,s,d){d.appendString('<div class="view-line'),n||d.appendString(" char-delete"),d.appendString('" style="top:'),d.appendString(String(e*s.lineHeight)),d.appendString('px;width:1000000px;">');const a=i.getLineContent(),l=D.wA.isBasicASCII(a,o),h=D.wA.containsRTL(a,l,r),g=(0,S.d1)(new S.IJ(s.fontInfo.isMonospace&&!s.disableMonospaceOptimizations,s.fontInfo.canUseHalfwidthRightwardsArrow,a,!1,l,h,0,i,t,s.tabSize,0,s.fontInfo.spaceWidth,s.fontInfo.middotWidth,s.fontInfo.wsmiddotWidth,s.stopRenderingLineAfter,s.renderWhitespace,s.renderControlCharacters,s.fontLigatures!==N.n0.OFF,null),d);return d.appendString("</div>"),g.characterMapping.getHorizontalOffset(g.characterMapping.length)}var M=t(18513),T=t(66676),V=t(89999),W=t(2827),P=t(93753),A=function(e,i,t,n){var o,r=arguments.length,s=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(s=(r<3?o(s):r>3?o(i,t,s):o(i,t))||s);return r>3&&s&&Object.defineProperty(i,t,s),s},H=function(e,i){return function(t,n){i(t,n,e)}};let F=class extends d.JT{constructor(e,i,t,o,_,p,v){super(),this._editors=e,this._diffModel=i,this._options=t,this._diffEditorWidget=o,this._canIgnoreViewZoneUpdateEvent=_,this._clipboardService=p,this._contextMenuService=v,this._originalTopPadding=(0,a.uh)("originalTopPadding",0),this._originalScrollOffset=(0,a.uh)("originalScrollOffset",0),this._originalScrollOffsetAnimated=(0,M.Vm)(this._originalScrollOffset,this._store),this._modifiedTopPadding=(0,a.uh)("modifiedTopPadding",0),this._modifiedScrollOffset=(0,a.uh)("modifiedScrollOffset",0),this._modifiedScrollOffsetAnimated=(0,M.Vm)(this._modifiedScrollOffset,this._store);let b=!1;const w=(0,a.uh)("state",0),N=this._register(new r.pY((()=>{w.set(w.get()+1,void 0)}),0));this._register(this._editors.original.onDidChangeViewZones((e=>{b||this._canIgnoreViewZoneUpdateEvent()||N.schedule()}))),this._register(this._editors.modified.onDidChangeViewZones((e=>{b||this._canIgnoreViewZoneUpdateEvent()||N.schedule()}))),this._register(this._editors.original.onDidChangeConfiguration((e=>{e.hasChanged(143)&&N.schedule()}))),this._register(this._editors.modified.onDidChangeConfiguration((e=>{e.hasChanged(143)&&N.schedule()})));const L=this._diffModel.map((e=>e?(0,a.rD)(e.model.original.onDidChangeTokens,(()=>2===e.model.original.tokenization.backgroundTokenizationState)):void 0)).map(((e,i)=>null===e||void 0===e?void 0:e.read(i))),C=new Set,S=new Set,R=(0,a.nK)("alignments",(e=>{const i=this._diffModel.read(e),t=null===i||void 0===i?void 0:i.diff.read(e);if(!i||!t)return null;w.read(e);const n=this._options.renderSideBySide.read(e),o=n;return z(this._editors.original,this._editors.modified,t.mappings,C,S,o)})),x=(0,a.nK)("alignments",(e=>{var i;const t=null===(i=this._diffModel.read(e))||void 0===i?void 0:i.syncedMovedTexts.read(e);if(!t)return null;w.read(e);const n=t.changes.map((e=>new m.hM(e)));return z(this._editors.original,this._editors.modified,n,C,S,!0)}));function T(){const e=document.createElement("div");return e.className="diagonal-fill",e}const V=this._register(new d.SL),W=(0,a.nK)("alignment viewzones",(e=>{var i,t,o,r,d,a,l,f;V.clear();const m=R.read(e)||[],_=[],p=[],v=this._modifiedTopPadding.read(e);v>0&&p.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:v,showInHiddenAreas:!0});const b=this._originalTopPadding.read(e);b>0&&_.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:b,showInHiddenAreas:!0});const w=this._options.renderSideBySide.read(e),N=w||null===(i=this._editors.modified._getViewModel())||void 0===i?void 0:i.createLineBreaksComputer();if(N)for(const F of m)if(F.diff)for(let z=F.originalRange.startLineNumber;z<F.originalRange.endLineNumberExclusive;z++)null===N||void 0===N||N.addRequest(this._editors.original.getModel().getLineContent(z),null,null);const C=null!==(t=null===N||void 0===N?void 0:N.finalize())&&void 0!==t?t:[];let S=0;const M=this._editors.modified.getOption(65),W=null===(o=this._diffModel.read(e))||void 0===o?void 0:o.syncedMovedTexts.read(e),P=null!==(d=null===(r=this._editors.original.getModel())||void 0===r?void 0:r.mightContainNonBasicASCII())&&void 0!==d&&d,A=null!==(l=null===(a=this._editors.original.getModel())||void 0===a?void 0:a.mightContainRTL())&&void 0!==l&&l,H=O.fromEditor(this._editors.modified);for(const Z of m)if(Z.diff&&!w){if(!Z.originalRange.isEmpty){L.read(e);const B=document.createElement("div");B.classList.add("view-lines","line-delete","monaco-mouse-cursor-text");const U=new I(Z.originalRange.mapToLineArray((e=>this._editors.original.getModel().tokenization.getLineTokens(e))),Z.originalRange.mapToLineArray((e=>C[S++])),P,A),q=[];for(const J of Z.diff.innerChanges||[])q.push(new D.$t(J.originalRange.delta(-(Z.diff.originalRange.startLineNumber-1)),u.rq.className,0));const $=y(U,H,q,B),j=document.createElement("div");if(j.className="inline-deleted-margin-view-zone",(0,c.N)(j,H.fontInfo),this._options.renderIndicators.read(e))for(let X=0;X<$.heightInLines;X++){const Y=document.createElement("div");Y.className=`delete-sign ${h.k.asClassName(u.fO)}`,Y.setAttribute("style",`position:absolute;top:${X*M}px;width:${H.lineDecorationsWidth}px;height:${M}px;right:0;`),j.appendChild(Y)}let K;V.add(new E((()=>(0,g.cW)(K)),j,this._editors.modified,Z.diff,this._diffEditorWidget,$.viewLineCounts,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let G=0;G<$.viewLineCounts.length;G++){const Q=$.viewLineCounts[G];Q>1&&_.push({afterLineNumber:Z.originalRange.startLineNumber+G,domNode:T(),heightInPx:(Q-1)*M,showInHiddenAreas:!0})}p.push({afterLineNumber:Z.modifiedRange.startLineNumber-1,domNode:B,heightInPx:$.heightInLines*M,minWidthInPx:$.minWidthInPx,marginDomNode:j,setZoneId(e){K=e},showInHiddenAreas:!0})}const k=document.createElement("div");k.className="gutter-delete",_.push({afterLineNumber:Z.originalRange.endLineNumberExclusive-1,domNode:T(),heightInPx:Z.modifiedHeightInPx,marginDomNode:k,showInHiddenAreas:!0})}else{const ee=Z.modifiedHeightInPx-Z.originalHeightInPx;if(ee>0){if(null===W||void 0===W?void 0:W.lineRangeMapping.original.contains(Z.originalRange.endLineNumberExclusive-1))continue;_.push({afterLineNumber:Z.originalRange.endLineNumberExclusive-1,domNode:T(),heightInPx:ee,showInHiddenAreas:!0})}else{if(null===W||void 0===W?void 0:W.lineRangeMapping.modified.contains(Z.modifiedRange.endLineNumberExclusive-1))continue;function ie(){const e=document.createElement("div");return e.className="arrow-revert-change "+h.k.asClassName(s.l.arrowRight),(0,n.$)("div",{},e)}let te;Z.diff&&Z.diff.modifiedRange.isEmpty&&this._options.shouldRenderRevertArrows.read(e)&&(te=ie()),p.push({afterLineNumber:Z.modifiedRange.endLineNumberExclusive-1,domNode:T(),heightInPx:-ee,marginDomNode:te,showInHiddenAreas:!0})}}for(const ne of null!==(f=x.read(e))&&void 0!==f?f:[]){if(!(null===W||void 0===W?void 0:W.lineRangeMapping.original.intersect(ne.originalRange))&&!(null===W||void 0===W?void 0:W.lineRangeMapping.modified.intersect(ne.modifiedRange)))continue;const oe=ne.modifiedHeightInPx-ne.originalHeightInPx;oe>0?_.push({afterLineNumber:ne.originalRange.endLineNumberExclusive-1,domNode:T(),heightInPx:oe,showInHiddenAreas:!0}):p.push({afterLineNumber:ne.modifiedRange.endLineNumberExclusive-1,domNode:T(),heightInPx:-oe,showInHiddenAreas:!0})}return{orig:_,mod:p}}));this._register((0,l.b2)("alignment viewzones",(e=>{const i=f.Z.capture(this._editors.modified),t=W.read(e);b=!0,this._editors.original.changeViewZones((e=>{for(const i of C)e.removeZone(i);C.clear();for(const i of t.orig){const t=e.addZone(i);i.setZoneId&&i.setZoneId(t),C.add(t)}})),this._editors.modified.changeViewZones((e=>{for(const i of S)e.removeZone(i);S.clear();for(const i of t.mod){const t=e.addZone(i);i.setZoneId&&i.setZoneId(t),S.add(t)}})),b=!1,i.restore(this._editors.modified)}))),this._register((0,d.OF)((()=>{this._editors.original.changeViewZones((e=>{for(const i of C)e.removeZone(i);C.clear()})),this._editors.modified.changeViewZones((e=>{for(const i of S)e.removeZone(i);S.clear()}))})));let P=!1;this._register(this._editors.original.onDidScrollChange((e=>{e.scrollLeftChanged&&!P&&(P=!0,this._editors.modified.setScrollLeft(e.scrollLeft),P=!1)}))),this._register(this._editors.modified.onDidScrollChange((e=>{e.scrollLeftChanged&&!P&&(P=!0,this._editors.original.setScrollLeft(e.scrollLeft),P=!1)}))),this._originalScrollTop=(0,a.rD)(this._editors.original.onDidScrollChange,(()=>this._editors.original.getScrollTop())),this._modifiedScrollTop=(0,a.rD)(this._editors.modified.onDidScrollChange,(()=>this._editors.modified.getScrollTop())),this._register((0,l.EH)("update scroll modified",(e=>{const i=this._originalScrollTop.read(e)-(this._originalScrollOffsetAnimated.get()-this._modifiedScrollOffsetAnimated.read(e))-(this._originalTopPadding.get()-this._modifiedTopPadding.read(e));i!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(i,1)}))),this._register((0,l.EH)("update scroll original",(e=>{const i=this._modifiedScrollTop.read(e)-(this._modifiedScrollOffsetAnimated.get()-this._originalScrollOffsetAnimated.read(e))-(this._modifiedTopPadding.get()-this._originalTopPadding.read(e));i!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(i,1)}))),this._register((0,l.EH)("update",(e=>{var i;const t=null===(i=this._diffModel.read(e))||void 0===i?void 0:i.syncedMovedTexts.read(e);let n=0;if(t){const e=this._editors.original.getTopForLineNumber(t.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.get(),i=this._editors.modified.getTopForLineNumber(t.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.get();n=i-e}n>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(n,void 0)):n<0?(this._modifiedTopPadding.set(-n,void 0),this._originalTopPadding.set(0,void 0)):setTimeout((()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)}),400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.get()-n,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.get()+n,void 0,!0)})))}};function z(e,i,t,n,r,s){const d=new o.H9(Z(e,n)),a=new o.H9(Z(i,r)),l=e.getOption(65),h=i.getOption(65),g=[];let c=0,f=0;function u(e,i){while(1){let t=d.peek(),n=a.peek();if(t&&t.lineNumber>=e&&(t=void 0),n&&n.lineNumber>=i&&(n=void 0),!t&&!n)break;const o=t?t.lineNumber-c:Number.MAX_VALUE,r=n?n.lineNumber-f:Number.MAX_VALUE;o<r?(d.dequeue(),n={lineNumber:t.lineNumber-c+f,heightInPx:0}):o>r?(a.dequeue(),t={lineNumber:n.lineNumber-f+c,heightInPx:0}):(d.dequeue(),a.dequeue()),g.push({originalRange:T.z.ofLength(t.lineNumber,1),modifiedRange:T.z.ofLength(n.lineNumber,1),originalHeightInPx:l+t.heightInPx,modifiedHeightInPx:h+n.heightInPx,diff:void 0})}}for(const m of t){const _=m.lineRangeMapping;u(_.originalRange.startLineNumber,_.modifiedRange.startLineNumber);let p=!0,v=_.modifiedRange.startLineNumber,b=_.originalRange.startLineNumber;function E(e,i){var t,n,o,r;if(e<b||i<v)return;if(p)p=!1;else if(e===b||i===v)return;const s=new T.z(b,e),c=new T.z(v,i);if(s.isEmpty&&c.isEmpty)return;const f=null!==(n=null===(t=d.takeWhile((i=>i.lineNumber<e)))||void 0===t?void 0:t.reduce(((e,i)=>e+i.heightInPx),0))&&void 0!==n?n:0,u=null!==(r=null===(o=a.takeWhile((e=>e.lineNumber<i)))||void 0===o?void 0:o.reduce(((e,i)=>e+i.heightInPx),0))&&void 0!==r?r:0;g.push({originalRange:s,modifiedRange:c,originalHeightInPx:s.length*l+f,modifiedHeightInPx:c.length*h+u,diff:m.lineRangeMapping}),b=e,v=i}if(s)for(const w of _.innerChanges||[])w.originalRange.startColumn>1&&w.modifiedRange.startColumn>1&&E(w.originalRange.startLineNumber,w.modifiedRange.startLineNumber),w.originalRange.endColumn<e.getModel().getLineMaxColumn(w.originalRange.endLineNumber)&&E(w.originalRange.endLineNumber,w.modifiedRange.endLineNumber);E(_.originalRange.endLineNumberExclusive,_.modifiedRange.endLineNumberExclusive),c=_.originalRange.endLineNumberExclusive,f=_.modifiedRange.endLineNumberExclusive}return u(Number.MAX_VALUE,Number.MAX_VALUE),g}function Z(e,i){const t=[],n=[],o=-1!==e.getOption(143).wrappingColumn,r=e._getViewModel().coordinatesConverter,s=e.getOption(65);if(o)for(let a=1;a<=e.getModel().getLineCount();a++){const e=r.getModelLineViewLineCount(a);e>1&&n.push({lineNumber:a,heightInPx:s*(e-1)})}for(const a of e.getWhitespaces()){if(i.has(a.id))continue;const e=0===a.afterLineNumber?0:r.convertViewPositionToModelPosition(new V.L(a.afterLineNumber,1)).lineNumber;t.push({lineNumber:e,heightInPx:a.height})}const d=(0,M.Ap)(t,n,(e=>e.lineNumber),((e,i)=>({lineNumber:e.lineNumber,heightInPx:e.heightInPx+i.heightInPx})));return d}F=A([H(5,W.p),H(6,P.i)],F)},1360:(e,i,t)=>{t.d(i,{o:()=>r});var n=t(70959),o=t(90168);class r extends n.JT{constructor(e,i,t,n,s){super(),this._rootElement=e,this._diffModel=i,this._originalEditorLayoutInfo=t,this._modifiedEditorLayoutInfo=n,this._editors=s;const d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(d),this._register((0,o.EH)("update",(e=>{const i=this._originalEditorLayoutInfo.read(e),t=this._modifiedEditorLayoutInfo.read(e);i&&t&&(d.style.left=i.width-i.verticalScrollbarWidth+"px",d.style.height=`${i.height}px`,d.style.width=i.verticalScrollbarWidth+i.contentLeft-r.movedCodeBlockPadding+"px")})));const a=(0,o.rD)(this._editors.original.onDidScrollChange,(()=>this._editors.original.getScrollTop())),l=(0,o.rD)(this._editors.modified.onDidScrollChange,(()=>this._editors.modified.getScrollTop())),h=(0,o.aq)("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones);this._register((0,o.EH)("update",(e=>{var i,t;d.replaceChildren(),h.read(e);const n=this._originalEditorLayoutInfo.read(e),o=this._modifiedEditorLayoutInfo.read(e);if(!n||!o)return;const s=n.verticalScrollbarWidth+n.contentLeft-r.movedCodeBlockPadding,g=null===(t=null===(i=this._diffModel.read(e))||void 0===i?void 0:i.diff.read(e))||void 0===t?void 0:t.movedTexts;if(!g)return;let c=0;for(const f of g){function u(e,i){const t=i.getTopForLineNumber(e.startLineNumber),n=i.getTopForLineNumber(e.endLineNumberExclusive);return(t+n)/2}const m=u(f.lineRangeMapping.original,this._editors.original),_=a.read(e),p=u(f.lineRangeMapping.modified,this._editors.modified),v=l.read(e),b=m-_,E=p-v,w=s/2-5*g.length+10*c;c++;const N=document.createElementNS("http://www.w3.org/2000/svg","path");N.setAttribute("d",`M 0 ${b} L ${w} ${b} L ${w} ${E} L ${s} ${E}`),N.setAttribute("fill","none"),d.appendChild(N)}})))}}r.movedCodeBlockPadding=4},62941:(e,i,t)=>{t.d(i,{e:()=>_});var n=t(2548),o=t(26090),r=t(69758),s=t(70959),d=t(90168),a=t(61818),l=t(18513),h=t(89999),g=t(69479),c=t(47277),f=t(32656),u=function(e,i,t,n){var o,r=arguments.length,s=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(s=(r<3?o(s):r>3?o(i,t,s):o(i,t))||s);return r>3&&s&&Object.defineProperty(i,t,s),s},m=function(e,i){return function(t,n){i(t,n,e)}};let _=class e extends s.JT{constructor(i,t,s,f,u,m,_,p){super(),this._editors=i,this._rootElement=t,this._diffModel=s,this._rootWidth=f,this._rootHeight=u,this._modifiedEditorLayoutInfo=m,this._options=_,this._themeService=p;const v=(0,d.rD)(this._themeService.onDidColorThemeChange,(()=>this._themeService.getColorTheme())),b=(0,d.nK)("colors",(e=>{const i=v.read(e),t=i.getColor(c.P6Y)||(i.getColor(c.ypS)||c.CzK).transparent(2),n=i.getColor(c.F9q)||(i.getColor(c.P4M)||c.keg).transparent(2);return{insertColor:t,removeColor:n}})),E=(0,d.rD)(this._editors.modified.onDidScrollChange,(()=>this._editors.modified.getScrollTop())),w=(0,d.rD)(this._editors.modified.onDidScrollChange,(()=>this._editors.modified.getScrollHeight()));this._register((0,a.b2)("create diff editor overview ruler if enabled",((i,t)=>{if(!this._options.renderOverviewRuler.read(i))return;const s=(0,o.X)(document.createElement("div"));s.setClassName("diffViewport"),s.setPosition("absolute");const c=(0,n.h)("div.diffOverview",{style:{position:"absolute",top:"0px",width:e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;t.add((0,l.xx)(c,s.domNode)),t.add((0,n.mu)(c,n.tw.POINTER_DOWN,(e=>{this._editors.modified.delegateVerticalScrollbarPointerDown(e)}))),t.add((0,n.nm)(c,n.tw.MOUSE_WHEEL,(e=>{this._editors.modified.delegateScrollFromMouseWheelEvent(e)}),{passive:!1})),t.add((0,l.xx)(this._rootElement,c)),t.add((0,a.b2)("recreate overview rules when model changes",((i,t)=>{const n=this._diffModel.read(i),o=this._editors.original.createOverviewRuler("original diffOverviewRuler");o&&(t.add(o),t.add((0,l.xx)(c,o.getDomNode())));const a=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(a&&(t.add(a),t.add((0,l.xx)(c,a.getDomNode()))),!o||!a)return;const f=(0,d.aq)("viewZoneChanged",this._editors.original.onDidChangeViewZones),u=(0,d.aq)("viewZoneChanged",this._editors.modified.onDidChangeViewZones),m=(0,d.aq)("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),_=(0,d.aq)("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);t.add((0,d.EH)("set overview ruler zones",(e=>{var i;f.read(e),u.read(e),m.read(e),_.read(e);const t=b.read(e),r=null===(i=null===n||void 0===n?void 0:n.diff.read(e))||void 0===i?void 0:i.mappings;function s(e,i,t){const n=t._getViewModel();return n?e.filter((e=>e.length>0)).map((e=>{const t=n.coordinatesConverter.convertModelPositionToViewPosition(new h.L(e.startLineNumber,1)),o=n.coordinatesConverter.convertModelPositionToViewPosition(new h.L(e.endLineNumberExclusive,1));return new g.EY(t.lineNumber,o.lineNumber,0,i.toString())})):[]}null===o||void 0===o||o.setZones(s((r||[]).map((e=>e.lineRangeMapping.originalRange)),t.removeColor,this._editors.original)),null===a||void 0===a||a.setZones(s((r||[]).map((e=>e.lineRangeMapping.modifiedRange)),t.insertColor,this._editors.modified))}))),t.add((0,d.EH)("layout overview ruler",(i=>{const t=this._rootHeight.read(i),n=this._rootWidth.read(i),d=this._modifiedEditorLayoutInfo.read(i);if(d){const n=e.ENTIRE_DIFF_OVERVIEW_WIDTH-2*e.ONE_OVERVIEW_WIDTH;o.setLayout({top:0,height:t,right:n+e.ONE_OVERVIEW_WIDTH,width:e.ONE_OVERVIEW_WIDTH}),a.setLayout({top:0,height:t,right:0,width:e.ONE_OVERVIEW_WIDTH});const l=E.read(i),h=w.read(i),g=this._editors.modified.getOption(101),c=new r.M(g.verticalHasArrows?g.arrowSize:0,g.verticalScrollbarSize,0,d.height,h,l);s.setTop(c.getSliderPosition()),s.setHeight(c.getSliderSize())}else s.setTop(0),s.setHeight(0);c.style.height=t+"px",c.style.left=n-e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",s.setWidth(e.ENTIRE_DIFF_OVERVIEW_WIDTH)})))})))})))}};_.ONE_OVERVIEW_WIDTH=15,_.ENTIRE_DIFF_OVERVIEW_WIDTH=2*_.ONE_OVERVIEW_WIDTH,_=u([m(7,f.XE)],_)},23365:(e,i,t)=>{t.d(i,{V:()=>v});var n=t(2548),o=t(66426),r=t(8419),s=t(81478),d=t(70959),a=t(90168),l=t(61818),h=t(82861),g=t(99588),c=t(55455),f=t(18513),u=t(66676),m=t(89999),_=t(33162),p=t(25206);class v extends d.JT{get isUpdatingViewZones(){return this._isUpdatingViewZones}constructor(e,i,t){super(),this._editors=e,this._diffModel=i,this._options=t,this._isUpdatingViewZones=!1,this._register(this._editors.original.onDidChangeCursorPosition((e=>{if(3===e.reason){const e=this._diffModel.get();(0,a.PS)((i=>{for(const t of this._editors.original.getSelections()||[])null===e||void 0===e||e.ensureOriginalLineIsVisible(t.getStartPosition().lineNumber,i),null===e||void 0===e||e.ensureOriginalLineIsVisible(t.getEndPosition().lineNumber,i)}))}}))),this._register(this._editors.modified.onDidChangeCursorPosition((e=>{if(3===e.reason){const e=this._diffModel.get();(0,a.PS)((i=>{for(const t of this._editors.modified.getSelections()||[])null===e||void 0===e||e.ensureModifiedLineIsVisible(t.getStartPosition().lineNumber,i),null===e||void 0===e||e.ensureModifiedLineIsVisible(t.getEndPosition().lineNumber,i)}))}})));const n=this._diffModel.map(((e,i)=>{var t,n;return 0===(null===(t=null===e||void 0===e?void 0:e.diff.read(i))||void 0===t?void 0:t.mappings.length)?[]:null!==(n=null===e||void 0===e?void 0:e.unchangedRegions.read(i))&&void 0!==n?n:[]})),o=(0,h.Be)("view zones",((e,i)=>{const t=[],o=[],r=this._options.renderSideBySide.read(e),s=n.read(e);for(const n of s)if(!n.shouldHideControls(e)){{const e=(0,h.nK)("hiddenOriginalRangeStart",(e=>n.getHiddenOriginalRange(e).startLineNumber-1)),o=new f.GD(e,24);t.push(o),i.add(new b(this._editors.original,o,n,!r))}{const e=(0,h.nK)("hiddenModifiedRangeStart",(e=>n.getHiddenModifiedRange(e).startLineNumber-1)),t=new f.GD(e,24);o.push(t),i.add(new b(this._editors.modified,t,n,!1))}}return{origViewZones:t,modViewZones:o}})),d={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},v={description:"Fold Unchanged",glyphMarginHoverMessage:new s.W5(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown((0,p.NC)("foldUnchanged","Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+g.k.asClassName(r.l.fold),zIndex:10001};this._register((0,f.RP)(this._editors.original,(0,h.nK)("decorations",(e=>{const i=n.read(e),t=i.map((e=>({range:e.originalRange.toInclusiveRange(),options:d})));for(const n of i)n.shouldHideControls(e)&&t.push({range:_.e.fromPositions(new m.L(n.originalLineNumber,1)),options:v});return t})))),this._register((0,f.RP)(this._editors.modified,(0,h.nK)("decorations",(e=>{const i=n.read(e),t=i.map((e=>({range:e.modifiedRange.toInclusiveRange(),options:d})));for(const n of i)n.shouldHideControls(e)&&t.push({range:u.z.ofLength(n.modifiedLineNumber,1).toInclusiveRange(),options:v});return t})))),this._register((0,f.Sv)(this._editors.original,o.map((e=>e.origViewZones)),(e=>this._isUpdatingViewZones=e))),this._register((0,f.Sv)(this._editors.modified,o.map((e=>e.modViewZones)),(e=>this._isUpdatingViewZones=e))),this._register((0,l.b2)("update folded unchanged regions",((e,i)=>{const t=n.read(e);this._editors.original.setHiddenAreas(t.map((i=>i.getHiddenOriginalRange(e).toInclusiveRange())).filter(c.$K)),this._editors.modified.setHiddenAreas(t.map((i=>i.getHiddenModifiedRange(e).toInclusiveRange())).filter(c.$K))}))),this._register(this._editors.modified.onMouseUp((e=>{var i;if(!e.event.rightButton&&e.target.position&&(null===(i=e.target.element)||void 0===i?void 0:i.className.includes("fold-unchanged"))){const i=e.target.position.lineNumber,t=this._diffModel.get();if(!t)return;const n=t.unchangedRegions.get().find((e=>e.modifiedRange.includes(i)));if(!n)return;n.setState(0,0,void 0),e.event.stopPropagation(),e.event.preventDefault()}}))),this._register(this._editors.original.onMouseUp((e=>{var i;if(!e.event.rightButton&&e.target.position&&(null===(i=e.target.element)||void 0===i?void 0:i.className.includes("fold-unchanged"))){const i=e.target.position.lineNumber,t=this._diffModel.get();if(!t)return;const n=t.unchangedRegions.get().find((e=>e.originalRange.includes(i)));if(!n)return;n.setState(0,0,void 0),e.event.stopPropagation(),e.event.preventDefault()}})))}}class b extends f.N9{constructor(e,i,t,r){const s=(0,n.h)("div.diff-hidden-lines-widget");super(e,i,s.root),this._editor=e,this._unchangedRegion=t,this.hide=r,this._nodes=(0,n.h)("div.diff-hidden-lines",[(0,n.h)("div.top@top",{title:"Click or drag to show more above"}),(0,n.h)("div.center@content",{style:{display:"flex"}},[(0,n.h)("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},[(0,n.$)("a",{title:"Show all",role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...(0,o.T)("$(unfold)"))]),(0,n.h)("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),(0,n.h)("div.bottom@bottom",{title:"Click or drag to show more below",role:"button"})]),s.root.appendChild(this._nodes.root);const d=(0,a.rD)(this._editor.onDidLayoutChange,(()=>this._editor.getLayoutInfo()));this.hide?(0,n.mc)(this._nodes.first):this._register((0,f.bg)(this._nodes.first,{width:d.map((e=>e.contentLeft))}));const h=this._editor;this._register((0,n.nm)(this._nodes.top,"mousedown",(e=>{if(0!==e.button)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),e.preventDefault();const i=e.clientY;let t=!1;const o=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set(!0,void 0);const r=(0,n.nm)(window,"mousemove",(e=>{const n=e.clientY,r=n-i;t=t||Math.abs(r)>2;const s=Math.round(r/h.getOption(65)),d=Math.max(0,Math.min(o+s,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(d,void 0)})),s=(0,n.nm)(window,"mouseup",(e=>{t||this._unchangedRegion.showMoreAbove(20,void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(!1,void 0),r.dispose(),s.dispose()}))}))),this._register((0,n.nm)(this._nodes.bottom,"mousedown",(e=>{if(0!==e.button)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),e.preventDefault();const i=e.clientY;let t=!1;const o=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set(!0,void 0);const r=(0,n.nm)(window,"mousemove",(e=>{const n=e.clientY,r=n-i;t=t||Math.abs(r)>2;const s=Math.round(r/h.getOption(65)),d=Math.max(0,Math.min(o-s,this._unchangedRegion.getMaxVisibleLineCountBottom())),a=h.getTopForLineNumber(this._unchangedRegion.originalRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(d,void 0);const l=h.getTopForLineNumber(this._unchangedRegion.originalRange.endLineNumberExclusive);h.setScrollTop(h.getScrollTop()+(l-a))})),s=(0,n.nm)(window,"mouseup",(e=>{if(this._unchangedRegion.isDragged.set(!1,void 0),!t){const e=h.getTopForLineNumber(this._unchangedRegion.originalRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(20,void 0);const i=h.getTopForLineNumber(this._unchangedRegion.originalRange.endLineNumberExclusive);h.setScrollTop(h.getScrollTop()+(i-e))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),r.dispose(),s.dispose()}))}))),this._register((0,l.EH)("update labels",(e=>{const i=[];if(!this.hide){const o=t.getHiddenModifiedRange(e).length,r=`${o} Hidden Lines`;i.push((0,n.$)("span",{title:r},r))}(0,n.mc)(this._nodes.others,...i)})))}}},18513:(e,i,t)=>{t.d(i,{Ap:()=>s,DU:()=>l,GD:()=>f,N9:()=>c,NW:()=>_,RP:()=>d,Sv:()=>v,Vm:()=>h,bg:()=>m,xx:()=>a});var n=t(70959),o=t(90168),r=t(41971);function s(e,i,t,n){if(0===e.length)return i;if(0===i.length)return e;const o=[];let r=0,s=0;while(r<e.length&&s<i.length){const d=e[r],a=i[s],l=t(d),h=t(a);l<h?(o.push(d),r++):l>h?(o.push(a),s++):(o.push(n(d,a)),r++,s++)}while(r<e.length)o.push(e[r]),r++;while(s<i.length)o.push(i[s]),s++;return o}function d(e,i){const t=new n.SL,r=e.createDecorationsCollection();return t.add((0,o.EH)(`Apply decorations from ${i.debugName}`,(e=>{const t=i.read(e);r.set(t)}))),t.add({dispose:()=>{r.clear()}}),t}function a(e,i){return e.appendChild(i),(0,n.OF)((()=>{e.removeChild(i)}))}class l extends n.JT{get width(){return this._width}get height(){return this._height}constructor(e,i){super(),this.elementSizeObserver=this._register(new r.I(e,i)),this._width=(0,o.uh)("width",this.elementSizeObserver.getWidth()),this._height=(0,o.uh)("height",this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange((e=>(0,o.PS)((e=>{this._width.set(this.elementSizeObserver.getWidth(),e),this._height.set(this.elementSizeObserver.getHeight(),e)})))))}observe(e){this.elementSizeObserver.observe(e)}setAutomaticLayout(e){e?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}}function h(e,i){let t=e.get(),n=t,r=t;const s=(0,o.uh)("animatedValue",t);let d=-1;const a=300;let l;function h(){const e=Date.now()-d;r=Math.floor(g(e,n,t-n,a)),e<a?l=requestAnimationFrame(h):r=t,s.set(r,void 0)}return i.add((0,o.nJ)("update value",{createEmptyChangeSummary:()=>({animate:!1}),handleChange:(i,t)=>(i.didChange(e)&&(t.animate=t.animate||i.change),!0)},((i,o)=>{void 0!==l&&(cancelAnimationFrame(l),l=void 0),n=r,t=e.read(i),d=Date.now()-(o.animate?0:a),h()}))),s}function g(e,i,t,n){return e===n?i+t:t*(1-Math.pow(2,-10*e/n))+i}class c extends n.JT{constructor(e,i,t){super(),this._register(new u(e,t)),this._register(m(t,{height:i.actualHeight,top:i.actualTop}))}}class f{get afterLineNumber(){return this._afterLineNumber.get()}constructor(e,i){this._afterLineNumber=e,this.heightInPx=i,this.domNode=document.createElement("div"),this._actualTop=(0,o.uh)("actualTop",void 0),this._actualHeight=(0,o.uh)("actualHeight",void 0),this.actualTop=this._actualTop,this.actualHeight=this._actualHeight,this.showInHiddenAreas=!0,this.onChange=this._afterLineNumber,this.onDomNodeTop=e=>{this._actualTop.set(e,void 0)},this.onComputedHeight=e=>{this._actualHeight.set(e,void 0)}}}class u{constructor(e,i){this._editor=e,this._domElement=i,this._overlayWidgetId="managedOverlayWidget-"+u._counter++,this._overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null},this._editor.addOverlayWidget(this._overlayWidget)}dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}}function m(e,i){return(0,o.EH)("applyStyle",(t=>{for(let[n,o]of Object.entries(i))o&&"object"===typeof o&&"read"in o&&(o=o.read(t)),"number"===typeof o&&(o=`${o}px`),e.style[n]=o}))}function _(e,i){return p([e],i),e}function p(e,i){const t=globalThis.$hotReload_deprecateExports;if(!t)return;const n=(0,o.aq)("reload",(i=>{function n(t,n){return!![...Object.values(t)].some((i=>e.includes(i)))&&(i(void 0),!0)}return t.add(n),{dispose(){t.delete(n)}}}));n.read(i)}function v(e,i,t){const r=new n.SL,s=[];return r.add((0,o.EH)("applyViewZones",(n=>{const d=i.read(n),a=new Map,l=new Map;t&&t(!0),e.changeViewZones((e=>{for(const i of s)e.removeZone(i);s.length=0;for(const i of d){const t=e.addZone(i);s.push(t),a.set(i,t)}})),t&&t(!1),r.add((0,o.nJ)("layoutZone on change",{createEmptyChangeSummary(){return[]},handleChange(e,i){const t=l.get(e.changedObservable);return void 0!==t&&i.push(t),!0}},((i,n)=>{for(const e of d)e.onChange&&(l.set(e.onChange,a.get(e)),e.onChange.read(i));t&&t(!0),e.changeViewZones((e=>{for(const i of n)e.layoutZone(i)})),t&&t(!1)})))}))),r.add({dispose(){t&&t(!0),e.changeViewZones((e=>{for(const i of s)e.removeZone(i)})),t&&t(!1)}}),r}u._counter=0},24746:(e,i,t)=>{t.d(i,{F:()=>u});var n=t(65662),o=t(11271),r=t(70959),s=t(2179),d=t(33162),a=t(70936),l=t(35195),h=t(55907),g=function(e,i,t,n){var o,r=arguments.length,s=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(s=(r<3?o(s):r>3?o(i,t,s):o(i,t))||s);return r>3&&s&&Object.defineProperty(i,t,s),s},c=function(e,i){return function(t,n){i(t,n,e)}};const f={followsCaret:!0,ignoreCharChanges:!0,alwaysRevealFirst:!0,findResultLoop:!0};let u=class extends r.JT{constructor(e,i={},t,n,r){super(),this._audioCueService=t,this._codeEditorService=n,this._accessibilityService=r,this._onDidUpdate=this._register(new o.Q5),this._editor=e,this._options=s.jB(i,f,!1),this.disposed=!1,this.nextIdx=-1,this.ranges=[],this.ignoreSelectionChange=!1,this.revealFirst=Boolean(this._options.alwaysRevealFirst),this._register(this._editor.onDidUpdateDiff((()=>this._onDiffUpdated()))),this._options.followsCaret&&this._register(this._editor.getModifiedEditor().onDidChangeCursorPosition((e=>{this.ignoreSelectionChange||(this._updateAccessibilityState(e.position.lineNumber),this.nextIdx=-1)}))),this._init()}_init(){this._editor.getLineChanges()}_onDiffUpdated(){this._init(),this._compute(this._editor.getLineChanges()),this.revealFirst&&null!==this._editor.getLineChanges()&&(this.revealFirst=!1,this.nextIdx=-1,this.next(1))}_compute(e){this.ranges=[],e&&e.forEach((e=>{!this._options.ignoreCharChanges&&e.charChanges?e.charChanges.forEach((e=>{this.ranges.push({rhs:!0,range:new d.e(e.modifiedStartLineNumber,e.modifiedStartColumn,e.modifiedEndLineNumber,e.modifiedEndColumn)})})):0===e.modifiedEndLineNumber?this.ranges.push({rhs:!0,range:new d.e(e.modifiedStartLineNumber,1,e.modifiedStartLineNumber+1,1)}):this.ranges.push({rhs:!0,range:new d.e(e.modifiedStartLineNumber,1,e.modifiedEndLineNumber+1,1)})})),this.ranges.sort(((e,i)=>d.e.compareRangesUsingStarts(e.range,i.range))),this._onDidUpdate.fire(this)}_initIdx(e){let i=!1;const t=this._editor.getPosition();if(t){for(let n=0,o=this.ranges.length;n<o&&!i;n++){const o=this.ranges[n].range;t.isBeforeOrEqual(o.getStartPosition())&&(this.nextIdx=n+(e?0:-1),i=!0)}i||(this.nextIdx=e?0:this.ranges.length-1),this.nextIdx<0&&(this.nextIdx=this.ranges.length-1)}else this.nextIdx=0}_move(e,i){if(n.ok(!this.disposed,"Illegal State - diff navigator has been disposed"),!this.canNavigate())return;-1===this.nextIdx?this._initIdx(e):e?(this.nextIdx+=1,this.nextIdx>=this.ranges.length&&(this.nextIdx=0)):(this.nextIdx-=1,this.nextIdx<0&&(this.nextIdx=this.ranges.length-1));const t=this.ranges[this.nextIdx];this.ignoreSelectionChange=!0;try{const e=t.range.getStartPosition();this._editor.setPosition(e),this._editor.revealRangeInCenter(t.range,i),this._updateAccessibilityState(e.lineNumber,!0)}finally{this.ignoreSelectionChange=!1}}_updateAccessibilityState(e,i){var t;const n=null===(t=this._editor.getModel())||void 0===t?void 0:t.modified;if(!n)return;const o=n.getLineDecorations(e).find((e=>"line-insert"===e.options.className));if(o)this._audioCueService.playAudioCue(a.y$.diffLineModified,!0);else{if(!i)return;this._audioCueService.playAudioCue(a.y$.diffLineDeleted,!0)}const r=this._codeEditorService.getActiveCodeEditor();i&&r&&o&&this._accessibilityService.isScreenReaderOptimized()&&(r.setSelection({startLineNumber:e,startColumn:0,endLineNumber:e,endColumn:Number.MAX_VALUE}),r.writeScreenReaderContent("diff-navigation"))}canNavigate(){return this.ranges&&this.ranges.length>0}next(e=0){this.canNavigateNext()&&this._move(!0,e)}previous(e=0){this.canNavigatePrevious()&&this._move(!1,e)}canNavigateNext(){return this.canNavigateLoop()||this.nextIdx<this.ranges.length-1}canNavigatePrevious(){return this.canNavigateLoop()||0!==this.nextIdx}canNavigateLoop(){return Boolean(this._options.findResultLoop)}dispose(){super.dispose(),this.ranges=[],this.disposed=!0}};u=g([c(2,a.e7),c(3,l.$),c(4,h.F)],u)},15203:(e,i,t)=>{t.d(i,{j:()=>M});var n=t(2548),o=t(26090),r=t(82168),s=t(78089),d=t(60841),a=t(10205),l=t(8419),h=t(70959),g=t(99588),c=t(6155),f=t(93215),u=t(89999),m=t(61141),_=t(81083),p=t(93489),v=t(70748),b=t(25206),E=t(70936),w=t(47596),N=t(98158),L=function(e,i,t,n){var o,r=arguments.length,s=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(s=(r<3?o(s):r>3?o(i,t,s):o(i,t))||s);return r>3&&s&&Object.defineProperty(i,t,s),s},C=function(e,i){return function(t,n){i(t,n,e)}},S=function(e,i,t,n){function o(e){return e instanceof t?e:new t((function(i){i(e)}))}return new(t||(t=Promise))((function(t,r){function s(e){try{a(n.next(e))}catch(i){r(i)}}function d(e){try{a(n["throw"](e))}catch(i){r(i)}}function a(e){e.done?t(e.value):o(e.value).then(s,d)}a((n=n.apply(e,i||[])).next())}))};const D=3;class R{constructor(e,i,t,n){this.originalLineStart=e,this.originalLineEnd=i,this.modifiedLineStart=t,this.modifiedLineEnd=n}getType(){return 0===this.originalLineStart?1:0===this.modifiedLineStart?2:0}}class y{constructor(e){this.entries=e}}const I=(0,N.q5)("diff-review-insert",l.l.add,b.NC("diffReviewInsertIcon","Icon for 'Insert' in diff review.")),O=(0,N.q5)("diff-review-remove",l.l.remove,b.NC("diffReviewRemoveIcon","Icon for 'Remove' in diff review.")),x=(0,N.q5)("diff-review-close",l.l.close,b.NC("diffReviewCloseIcon","Icon for 'Close' in diff review."));let M=class e extends h.JT{constructor(e,i,t,r){super(),this._languageService=i,this._audioCueService=t,this._configurationService=r,this._width=0,this._diffEditor=e,this._isVisible=!1,this.shadow=(0,o.X)(document.createElement("div")),this.shadow.setClassName("diff-review-shadow"),this.actionBarContainer=(0,o.X)(document.createElement("div")),this.actionBarContainer.setClassName("diff-review-actions"),this._actionBar=this._register(new s.o(this.actionBarContainer.domNode)),this._actionBar.push(new a.aU("diffreview.close",b.NC("label.close","Close"),"close-diff-review "+g.k.asClassName(x),!0,(()=>S(this,void 0,void 0,(function*(){return this.hide()})))),{label:!1,icon:!0}),this.domNode=(0,o.X)(document.createElement("div")),this.domNode.setClassName("diff-review monaco-editor-background"),this._content=(0,o.X)(document.createElement("div")),this._content.setClassName("diff-review-content"),this._content.setAttribute("role","code"),this.scrollbar=this._register(new d.s$(this._content.domNode,{})),this.domNode.domNode.appendChild(this.scrollbar.getDomNode()),this._register(e.onDidUpdateDiff((()=>{this._isVisible&&(this._diffs=this._compute(),this._render())}))),this._register(e.getModifiedEditor().onDidChangeCursorPosition((()=>{this._isVisible&&this._render()}))),this._register(n.mu(this.domNode.domNode,"click",(e=>{e.preventDefault();const i=n.Fx(e.target,"diff-review-row");i&&this._goToRow(i)}))),this._register(n.mu(this.domNode.domNode,"keydown",(e=>{(e.equals(18)||e.equals(2066)||e.equals(530))&&(e.preventDefault(),this._goToRow(this._getNextRow(),"next")),(e.equals(16)||e.equals(2064)||e.equals(528))&&(e.preventDefault(),this._goToRow(this._getPrevRow(),"previous")),(e.equals(9)||e.equals(2057)||e.equals(521)||e.equals(1033)||e.equals(10)||e.equals(3))&&(e.preventDefault(),this.accept())}))),this._register(this._configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("accessibility.verbosity.diffEditor")&&this._diffEditor.updateOptions({accessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.diffEditor")})}))),this._diffs=[],this._currentDiff=null}prev(){let e=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let i=-1;for(let e=0,t=this._diffs.length;e<t;e++)if(this._diffs[e]===this._currentDiff){i=e;break}e=this._diffs.length+i-1}else e=this._findDiffIndex(this._diffEditor.getPosition());if(0===this._diffs.length)return;e%=this._diffs.length;const i=this._diffs[e].entries;this._diffEditor.setPosition(new u.L(i[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:i[0].modifiedLineStart,endColumn:1073741824,endLineNumber:i[i.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getPrevRow(),"previous")}next(){let e=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let i=-1;for(let e=0,t=this._diffs.length;e<t;e++)if(this._diffs[e]===this._currentDiff){i=e;break}e=i+1}else e=this._findDiffIndex(this._diffEditor.getPosition());if(0===this._diffs.length)return;e%=this._diffs.length;const i=this._diffs[e].entries;this._diffEditor.setPosition(new u.L(i[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:i[0].modifiedLineStart,endColumn:1073741824,endLineNumber:i[i.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getNextRow(),"next")}accept(){let e=-1;const i=this._getCurrentFocusedRow();if(i){const t=parseInt(i.getAttribute("data-line"),10);isNaN(t)||(e=t)}this.hide(),-1!==e&&(this._diffEditor.setPosition(new u.L(e,1)),this._diffEditor.revealPosition(new u.L(e,1),1))}hide(){this._isVisible=!1,this._diffEditor.updateOptions({readOnly:!1}),this._diffEditor.focus(),this._diffEditor.doLayout(),this._render()}_getPrevRow(){const e=this._getCurrentFocusedRow();return e?e.previousElementSibling?e.previousElementSibling:e:this._getFirstRow()}_getNextRow(){const e=this._getCurrentFocusedRow();return e?e.nextElementSibling?e.nextElementSibling:e:this._getFirstRow()}_getFirstRow(){return this.domNode.domNode.querySelector(".diff-review-row")}_getCurrentFocusedRow(){const e=document.activeElement;return e&&/diff-review-row/.test(e.className)?e:null}_goToRow(e,i){const t=this._getCurrentFocusedRow();e.tabIndex=0,e.focus(),t&&t!==e&&(t.tabIndex=-1);const n=i?"next"===i?null===t||void 0===t?void 0:t.nextElementSibling:null===t||void 0===t?void 0:t.previousElementSibling:t;(null===n||void 0===n?void 0:n.classList.contains("line-insert"))?this._audioCueService.playAudioCue(E.y$.diffLineInserted,!0):(null===n||void 0===n?void 0:n.classList.contains("line-delete"))&&this._audioCueService.playAudioCue(E.y$.diffLineDeleted,!0),this.scrollbar.scanDomNode()}isVisible(){return this._isVisible}layout(e,i,t){this._width=i,this.shadow.setTop(e-6),this.shadow.setWidth(i),this.shadow.setHeight(this._isVisible?6:0),this.domNode.setTop(e),this.domNode.setWidth(i),this.domNode.setHeight(t),this._content.setHeight(t),this._content.setWidth(i),this._isVisible?(this.actionBarContainer.setAttribute("aria-hidden","false"),this.actionBarContainer.setDisplay("block")):(this.actionBarContainer.setAttribute("aria-hidden","true"),this.actionBarContainer.setDisplay("none"))}_compute(){const i=this._diffEditor.getLineChanges();if(!i||0===i.length)return[];const t=this._diffEditor.getOriginalEditor().getModel(),n=this._diffEditor.getModifiedEditor().getModel();return t&&n?e._mergeAdjacent(i,t.getLineCount(),n.getLineCount()):[]}static _mergeAdjacent(e,i,t){if(!e||0===e.length)return[];const n=[];let o=0;for(let a=0,l=e.length;a<l;a++){const r=e[a],s=r.originalStartLineNumber,d=r.originalEndLineNumber,h=r.modifiedStartLineNumber,g=r.modifiedEndLineNumber,c=[];let f=0;{const i=0===d?s:s-1,t=0===g?h:h-1;let n=1,o=1;if(a>0){const i=e[a-1];n=0===i.originalEndLineNumber?i.originalStartLineNumber+1:i.originalEndLineNumber+1,o=0===i.modifiedEndLineNumber?i.modifiedStartLineNumber+1:i.modifiedEndLineNumber+1}let r=i-D+1,l=t-D+1;if(r<n){const e=n-r;r+=e,l+=e}if(l<o){const e=o-l;r+=e,l+=e}c[f++]=new R(r,i,l,t)}0!==d&&(c[f++]=new R(s,d,0,0)),0!==g&&(c[f++]=new R(0,0,h,g));{const n=0===d?s+1:d+1,o=0===g?h+1:g+1;let r=i,u=t;if(a+1<l){const i=e[a+1];r=0===i.originalEndLineNumber?i.originalStartLineNumber:i.originalStartLineNumber-1,u=0===i.modifiedEndLineNumber?i.modifiedStartLineNumber:i.modifiedStartLineNumber-1}let m=n+D-1,_=o+D-1;if(m>r){const e=r-m;m+=e,_+=e}if(_>u){const e=u-_;m+=e,_+=e}c[f++]=new R(n,m,o,_)}n[o++]=new y(c)}let r=n[0].entries;const s=[];let d=0;for(let a=1,l=n.length;a<l;a++){const e=n[a].entries,i=r[r.length-1],t=e[0];0===i.getType()&&0===t.getType()&&t.originalLineStart<=i.originalLineEnd?(r[r.length-1]=new R(i.originalLineStart,t.originalLineEnd,i.modifiedLineStart,t.modifiedLineEnd),r=r.concat(e.slice(1))):(s[d++]=new y(r),r=e)}return s[d++]=new y(r),s}_findDiffIndex(e){const i=e.lineNumber;for(let t=0,n=this._diffs.length;t<n;t++){const e=this._diffs[t].entries,n=e[e.length-1].modifiedLineEnd;if(i<=n)return t}return 0}_render(){const i=this._diffEditor.getOriginalEditor().getOptions(),t=this._diffEditor.getModifiedEditor().getOptions(),o=this._diffEditor.getOriginalEditor().getModel(),r=this._diffEditor.getModifiedEditor().getModel(),s=o.getOptions(),d=r.getOptions();if(!this._isVisible||!o||!r)return n.PO(this._content.domNode),this._currentDiff=null,void this.scrollbar.scanDomNode();this._diffEditor.updateOptions({readOnly:!0});const a=this._findDiffIndex(this._diffEditor.getPosition());if(this._diffs[a]===this._currentDiff)return;this._currentDiff=this._diffs[a];const l=this._diffs[a].entries,h=document.createElement("div");h.className="diff-review-table",h.setAttribute("role","list"),h.setAttribute("aria-label",'Difference review. Use "Stage | Unstage | Revert Selected Ranges" commands'),(0,c.N)(h,t.get(49));let g=0,f=0,u=0,m=0;for(let e=0,n=l.length;e<n;e++){const i=l[e],t=i.originalLineStart,n=i.originalLineEnd,o=i.modifiedLineStart,r=i.modifiedLineEnd;0!==t&&(0===g||t<g)&&(g=t),0!==n&&(0===f||n>f)&&(f=n),0!==o&&(0===u||o<u)&&(u=o),0!==r&&(0===m||r>m)&&(m=r)}const _=document.createElement("div");_.className="diff-review-row";const p=document.createElement("div");p.className="diff-review-cell diff-review-summary";const v=f-g+1,E=m-u+1;p.appendChild(document.createTextNode(`${a+1}/${this._diffs.length}: @@ -${g},${v} +${u},${E} @@`)),_.setAttribute("data-line",String(u));const w=e=>0===e?b.NC("no_lines_changed","no lines changed"):1===e?b.NC("one_line_changed","1 line changed"):b.NC("more_lines_changed","{0} lines changed",e),N=w(v),L=w(E);_.setAttribute("aria-label",b.NC({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",a+1,this._diffs.length,g,N,u,L)),_.appendChild(p),_.setAttribute("role","listitem"),h.appendChild(_);const C=t.get(65);let S=u;for(let n=0,c=l.length;n<c;n++){const a=l[n];e._renderSection(h,a,S,C,this._width,i,o,s,t,r,d,this._languageService.languageIdCodec),0!==a.modifiedLineStart&&(S=a.modifiedLineEnd)}n.PO(this._content.domNode),this._content.domNode.appendChild(h),this.scrollbar.scanDomNode()}static _renderSection(i,t,n,o,r,s,d,a,l,h,c,f){const u=t.getType();let m="diff-review-row",_="";const p="diff-review-spacer";let v=null;switch(u){case 1:m="diff-review-row line-insert",_=" char-insert",v=I;break;case 2:m="diff-review-row line-delete",_=" char-delete",v=O;break}const E=t.originalLineStart,w=t.originalLineEnd,N=t.modifiedLineStart,L=t.modifiedLineEnd,C=Math.max(L-N,w-E),S=s.get(142),D=S.glyphMarginWidth+S.lineNumbersWidth,R=l.get(142),y=10+R.glyphMarginWidth+R.lineNumbersWidth;for(let I=0;I<=C;I++){const t=0===E?0:E+I,w=0===N?0:N+I,L=document.createElement("div");L.style.minWidth=r+"px",L.className=m,L.setAttribute("role","listitem"),0!==w&&(n=w),L.setAttribute("data-line",String(n));const C=document.createElement("div");C.className="diff-review-cell",C.style.height=`${o}px`,L.appendChild(C);const S=document.createElement("span");S.style.width=D+"px",S.style.minWidth=D+"px",S.className="diff-review-line-number"+_,0!==t?S.appendChild(document.createTextNode(String(t))):S.innerText="",C.appendChild(S);const R=document.createElement("span");R.style.width=y+"px",R.style.minWidth=y+"px",R.style.paddingRight="10px",R.className="diff-review-line-number"+_,0!==w?R.appendChild(document.createTextNode(String(w))):R.innerText="",C.appendChild(R);const O=document.createElement("span");if(O.className=p,v){const e=document.createElement("span");e.className=g.k.asClassName(v),e.innerText="",O.appendChild(e)}else O.innerText="";let x;if(C.appendChild(O),0!==w){let i=this._renderLine(h,l,c.tabSize,w,f);e._ttPolicy&&(i=e._ttPolicy.createHTML(i)),C.insertAdjacentHTML("beforeend",i),x=h.getLineContent(w)}else{let i=this._renderLine(d,s,a.tabSize,t,f);e._ttPolicy&&(i=e._ttPolicy.createHTML(i)),C.insertAdjacentHTML("beforeend",i),x=d.getLineContent(t)}0===x.length&&(x=b.NC("blankLine","blank"));let M="";switch(u){case 0:M=t===w?b.NC({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",x,t):b.NC("equalLine","{0} original line {1} modified line {2}",x,t,w);break;case 1:M=b.NC("insertLine","+ {0} modified line {1}",x,w);break;case 2:M=b.NC("deleteLine","- {0} original line {1}",x,t);break}L.setAttribute("aria-label",M),i.appendChild(L)}}static _renderLine(e,i,t,n,o){const r=e.getLineContent(n),s=i.get(49),d=_.A.createEmpty(r,o),a=v.wA.isBasicASCII(r,e.mightContainNonBasicASCII()),l=v.wA.containsRTL(r,a,e.mightContainRTL()),h=(0,p.tF)(new p.IJ(s.isMonospace&&!i.get(32),s.canUseHalfwidthRightwardsArrow,r,!1,a,l,0,d,[],t,0,s.spaceWidth,s.middotWidth,s.wsmiddotWidth,i.get(115),i.get(97),i.get(92),i.get(50)!==f.n0.OFF,null));return h.html}};M._ttPolicy=(0,r.Z)("diffReview",{createHTML:e=>e}),M=L([C(1,m.O),C(2,E.e7),C(3,w.Ui)],M)},24788:(e,i,t)=>{t.d(i,{H:()=>_});var n=t(2179),o=t(35195),r=t(97469),s=t(46871),d=t(37174),a=t(21881),l=t(18736),h=t(32656),g=t(55907),c=t(97297),f=t(16458),u=function(e,i,t,n){var o,r=arguments.length,s=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(s=(r<3?o(s):r>3?o(i,t,s):o(i,t))||s);return r>3&&s&&Object.defineProperty(i,t,s),s},m=function(e,i){return function(t,n){i(t,n,e)}};let _=class extends r.Gm{constructor(e,i,t,n,o,r,s,d,a,l,h,g,c){super(e,Object.assign(Object.assign({},n.getRawOptions()),{overflowWidgetsDomNode:n.getOverflowWidgetsDomNode()}),t,o,r,s,d,a,l,h,g,c),this._parentEditor=n,this._overwriteOptions=i,super.updateOptions(this._overwriteOptions),this._register(n.onDidChangeConfiguration((e=>this._onParentConfigurationChanged(e))))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){n.jB(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};_=u([m(4,a.TG),m(5,o.$),m(6,s.H),m(7,d.i6),m(8,h.XE),m(9,l.lT),m(10,g.F),m(11,c.c_),m(12,f.p)],_)},3685:(e,i,t)=>{t.d(i,{Q:()=>c});var n=t(11271),o=t(96729),r=t(66676),s=t(60309),d=t(52473),a=t(38857),l=function(e,i,t,n){var o,r=arguments.length,s=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(s=(r<3?o(s):r>3?o(i,t,s):o(i,t))||s);return r>3&&s&&Object.defineProperty(i,t,s),s},h=function(e,i){return function(t,n){i(t,n,e)}},g=function(e,i,t,n){function o(e){return e instanceof t?e:new t((function(i){i(e)}))}return new(t||(t=Promise))((function(t,r){function s(e){try{a(n.next(e))}catch(i){r(i)}}function d(e){try{a(n["throw"](e))}catch(i){r(i)}}function a(e){e.done?t(e.value):o(e.value).then(s,d)}a((n=n.apply(e,i||[])).next())}))};let c=class e{constructor(e,i,t){this.editorWorkerService=i,this.telemetryService=t,this.onDidChangeEventEmitter=new n.Q5,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(e)}dispose(){var e;null===(e=this.diffAlgorithmOnDidChangeSubscription)||void 0===e||e.dispose()}computeDiff(i,t,n){var d;return g(this,void 0,void 0,(function*(){if("string"!==typeof this.diffAlgorithm)return this.diffAlgorithm.computeDiff(i,t,n);if(1===i.getLineCount()&&1===i.getLineMaxColumn(1))return{changes:[new s.f0(new r.z(1,2),new r.z(1,t.getLineCount()+1),[new s.iy(i.getFullModelRange(),t.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};const a=JSON.stringify([i.uri.toString(),t.uri.toString()]),l=JSON.stringify([i.id,t.id,i.getAlternativeVersionId(),t.getAlternativeVersionId(),JSON.stringify(n)]),h=e.diffCache.get(a);if(h&&h.context===l)return h.result;const g=o.G.create(),c=yield this.editorWorkerService.computeDiff(i.uri,t.uri,n,this.diffAlgorithm),f=g.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:f,timedOut:null===(d=null===c||void 0===c?void 0:c.quitEarly)||void 0===d||d}),!c)throw new Error("no diff result available");return e.diffCache.size>10&&e.diffCache.delete(e.diffCache.keys().next().value),e.diffCache.set(a,{result:c,context:l}),c}))}setOptions(e){var i;let t=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&(null===(i=this.diffAlgorithmOnDidChangeSubscription)||void 0===i||i.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,"string"!==typeof e.diffAlgorithm&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange((()=>this.onDidChangeEventEmitter.fire()))),t=!0),t&&this.onDidChangeEventEmitter.fire()}};c.diffCache=new Map,c=l([h(1,d.p),h(2,a.b)],c)}}]);